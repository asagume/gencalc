{"version":3,"file":"js/chunk-common.4f06d0db.js","mappings":"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AAYC,GAAiBA,EAAM5X,MAAM,KAAM6X,MAAO7X,MAAM,KAAM8X,O,qCCzC/E,MAAMC,GAAOC,EAAAA,EAAAA,GAAW,CACtBC,QAAQ,EACRC,OAAQ,QACRC,eAAgB,QAChBC,UAAU,IAEZ,K,ulDCJO,MAAM3U,EAAe,CACxB,OACA,QACA,SAES4U,EAAe,CACxB,OACA,MACA,MACA,QAESC,EAAe,CACxB,MACA,SACA,UACA,UACA,WACA,WACA,UAESzR,EAAoB,CAC7B,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YAESC,EAAkB,CAC3B,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QAESC,EAAc,CACvB,aACA,WACA,aACA,cACA,aACA,WAESC,EAAgB,CACzB,cACA,YACA,cACA,eACA,cACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aAESC,EAAc,CACvB,WACA,WACA,YACA,WACA,WACA,YACA,WACA,WACA,WACA,WACA,YACA,YACA,YACA,aAESsR,EAAgB,CACzB,SACA,MACA,OACA,OACA,MACA,OACA,QAESC,EAAe,CACxB,SACA,QACA,QACA,SACA,QACA,WACA,YACA,YACA,cAESjV,EAAmB,CAC5B,WAESkV,EAAmB,CAC5B,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SAESC,EAAkB,CAC3B,QAGSC,EAAiB,IAAI/S,IAAI,CAClC,CAAC,UAAWnC,GACZ,CAAC,UAAW4U,GACZ,CAAC,UAAWC,GACZ,CAAC,eAAgBzR,GACjB,CAAC,aAAcC,GACf,CAAC,SAAUC,GACX,CAAC,WAAYC,GACb,CAAC,SAAUC,GACX,CAAC,MAAOsR,GACR,CAAC,UAAWC,GACZ,CAAC,UAAWjV,GACZ,CAAC,cAAekV,GAChB,CAAC,aAAcC,KAGNE,EAAoB,IAC1BN,KAAiBzR,KAAsBC,KAAoBC,KAAgBE,KAAgBwR,EAC9F,OAAQ,QAOZ,SAASI,IACL,MAAMtT,EAAmB,CAAC,EAW1B,OAVAoT,EAAe/Y,SAASuN,IACpBA,EAAMvN,SAAQG,IACVwF,EAASxF,GAAQ,CAAC,GACpB,IAENwF,EAAS,OAAS,EAClBA,EAAS,UAAY,GACrBA,EAAS,YAAc,IACvBA,EAAS,QAAU,EACnBA,EAAS,QAAU,EACZA,CACX,CACO,MAAMvC,EAAgB6V,IAE7B,SAASC,IACL,MAAMvT,EAAmB,CAAC,EAO1B,MANA,CAACuB,GAAiBlH,SAASuN,IACvBA,EAAMvN,SAAQG,IACVwF,EAASxF,GAAQ,CAAC,GACpB,IAENwF,EAAS,OAAS,EACXA,CACX,CAC8BuT,IAAvB,MAEMC,EAAoB,wBAC7B,OAAQ,QACX,KACYC,EAAoB,wBAC7B,QAAS,SACZ,KACYC,EAAoB,wBAC7B,aACA,QACA,SACA,SACA,SACA,aACA,QACA,SACA,SACA,UACH,KACYC,EAAoB,wBAC7B,cACA,cACA,cACA,cACA,cACA,cACA,cACA,aACA,QACA,SACA,SACA,SACA,cACA,cACA,cACA,cACA,cACA,cACA,cACA,aACA,QACA,SACA,SACA,UACH,KACYC,EAAoB,wBAC7B,QACA,WACA,QACA,SACA,SACA,SACA,YACA,QACA,WACA,QACA,SACA,SACA,SACA,aACH,KAEYxY,EAAe,wBACxB,MACA,KACA,OACA,MACA,OACA,MACA,OACA,MACA,SACA,YACH,KACYyY,EAAmB,UAC5B,OACA,MACA,OACA,OACA,MACA,SACA,WACA,KACA,MACA,OACH,KAEYC,EAAmB,CAC5B,GAAM,EACN,MAAO,EACP,MAAO,EACP,OAAQ,EACR,MAAO,EACP,SAAU,EACV,WAAY,EACZ,MAAO,EACP,OAAQ,EACR,OAAQ,EACR,YAAa,EACb,YAAa,EACb,YAAa,EACb,YAAa,EACb,YAAa,EACb,YAAa,EACb,YAAa,EACb,WAAY,EACZ,UAAW,GAGF5O,EAAe,CACxBxH,KAAI,IACJqW,SAAQ,EACRC,SAAQ,EACRC,SAAQ,EACRC,SAAQ,EACRC,UAAS,EACTC,SAAQ,EACRC,UAAS,EACTC,SAAQ,EACRC,OAAM,IACNC,QAAO,EACPC,UAAS,EACTC,SAAQ,EACRC,SAAQ,EACRC,UAAS,EACTC,UAAS,EACTC,UAAS,EACTC,UAAS,EACTC,YAAW,EACXC,eAAc,EACdC,YAA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","sources":["webpack://gencalc/./src/calculate.ts","webpack://gencalc/./src/common.ts","webpack://gencalc/./src/i18n.ts","webpack://gencalc/./src/input.ts","webpack://gencalc/./src/master.ts","webpack://gencalc/./src/particlemaster.ts","webpack://gencalc/./src/components/ArtifactItem.vue?52dd","webpack://gencalc/./src/components/ArtifactItem.vue?f1bd","webpack://gencalc/./src/components/ArtifactItem.vue","webpack://gencalc/./src/components/ArtifactSetSelect.vue?96cd","webpack://gencalc/./src/components/ArtifactSetSelect.vue?c0d4","webpack://gencalc/./src/components/ArtifactSetSelect.vue","webpack://gencalc/./src/components/CharacterSelect.vue?9536","webpack://gencalc/./src/components/CharacterSelect.vue?1f8b","webpack://gencalc/./src/components/CharacterSelect.vue","webpack://gencalc/./src/components/CompositionFunction.vue?c68d","webpack://gencalc/./src/components/CompositionFunction.vue","webpack://gencalc/./src/pages/TeamManager/MemberItem.vue?2696","webpack://gencalc/./src/pages/TeamManager/MemberItem.vue?b372","webpack://gencalc/./src/pages/TeamManager/MemberItem.vue","webpack://gencalc/./src/pages/TeamManager/TeamEditorModal.vue?893c","webpack://gencalc/./src/pages/TeamManager/TeamEditorModal.vue?47be","webpack://gencalc/./src/pages/TeamManager/TeamEditorModal.vue","webpack://gencalc/./src/pages/TeamManager/TeamItem.vue?cb4b","webpack://gencalc/./src/pages/TeamManager/TeamItem.vue?4cc0","webpack://gencalc/./src/pages/TeamManager/TeamItem.vue","webpack://gencalc/./src/pages/TeamManager/TeamRotation.vue?d65a","webpack://gencalc/./src/pages/TeamManager/ERCalculator.vue?a4a4","webpack://gencalc/./src/pages/TeamManager/ERCalculatorCommon.ts","webpack://gencalc/./src/pages/TeamManager/ERCalculatorFuncCharacter.ts","webpack://gencalc/./src/pages/TeamManager/ERCalculatorFuncWeapon.ts","webpack://gencalc/./src/pages/TeamManager/ERCalculatorFunc.ts","webpack://gencalc/./src/pages/TeamManager/ERCalculator.vue?0eca","webpack://gencalc/./src/pages/TeamManager/ERCalculator.vue","webpack://gencalc/./src/pages/TeamManager/TeamRotation.vue?a17d","webpack://gencalc/./src/pages/TeamManager/TeamRotation.vue"],"sourcesContent":["import _ from 'lodash';\r\nimport { isNumber, overwriteObject } from '@/common';\r\nimport {\r\n    CHANGE_KIND_STATUS,\r\n    CHANGE_KIND_TALENT,\r\n    DAMAGE_RESULT_TEMPLATE,\r\n    getStatValue,\r\n    NUMBER_CONDITION_VALUE_RE,\r\n    TArtifactDetailInput,\r\n    TCharacterInput,\r\n    TConditionInput,\r\n    TConditionValues,\r\n    TDamageResult,\r\n    TDamageResultEntry,\r\n    TOptionInput,\r\n    TStats,\r\n    TStatsInput,\r\n    ステータスTEMPLATE,\r\n    ステータスチーム内最高ARRAY,\r\n    ダメージバフARRAY,\r\n    元素ステータス_ダメージARRAY,\r\n    元素ステータス_耐性ARRAY,\r\n    元素反応TEMPLATE,\r\n    元素反応バフARRAY,\r\n    基礎ステータスARRAY,\r\n    実数ダメージ加算ARRAY,\r\n    突破レベルレベルARRAY,\r\n    聖遺物サブ効果ARRAY,\r\n    loadRecommendation,\r\n    makeDamageDetailObjArrObjCharacter,\r\n    makeDamageDetailObjArrObjWeapon,\r\n    makeDamageDetailObjArrObjArtifactSets,\r\n    setupConditionValues,\r\n    updateNumberConditionValues,\r\n    TDamageResultElementalReaction,\r\n    getDefaultCharacterInput,\r\n    getDefaultArtifactDetailInput,\r\n    getDefaultConditionInput,\r\n    getDefaultStatsInput,\r\n    getDefaultDamageResultInput,\r\n} from '@/input';\r\nimport { ALL_ELEMENTS, ARTIFACT_MAIN_MASTER, ARTIFACT_SUB_MASTER, DAMAGE_CATEGORY_ARRAY, ELEMENTAL_REACTION_MASTER, ELEMENTAL_RESONANCE_MASTER, getCharacterMasterDetail, TArtifactMainRarity, TArtifactMainStat, TCharacterKey } from '@/master';\r\n\r\n/** [突破レベル, レベル] => レベル\\+?  */\r\nexport function getLevelStr(ascension: number, level: number): string {\r\n    return level + 突破レベルレベルARRAY[ascension][0] == level ? '+' : '';\r\n}\r\n\r\n/** キャラクターのレベルに応じた（基礎/突破）ステータスを算出します */\r\nexport function getStatValueByLevel(statObj: any, ascension: number, level: number): number {\r\n    if (!statObj) return 0;\r\n    const myLevelStr = getLevelStr(ascension, level);\r\n    if (myLevelStr in statObj) {\r\n        return statObj[myLevelStr];\r\n    }\r\n    const lowLevel = 突破レベルレベルARRAY[ascension][0];\r\n    const highLevel = 突破レベルレベルARRAY[ascension][突破レベルレベルARRAY[ascension].length - 1];\r\n    const lowValue = statObj[lowLevel + '+'];\r\n    const highValue = statObj[highLevel];\r\n    return lowValue + (highValue - lowValue) * (level - lowLevel) / (highLevel - lowLevel);\r\n}\r\n\r\n/** 武器のレベルに応じた（基礎/突破）ステータスを算出します */\r\nexport function getPropertyValueByLevel(statObj: any, ascension: number): number {\r\n    const lowLevel = 突破レベルレベルARRAY[ascension][0];\r\n    return statObj[lowLevel + '+'];\r\n}\r\n\r\nexport function getValueByLevel(level: number | string, valueObj: any): number {\r\n    if (level in valueObj) return valueObj[level];\r\n    level = Number(level);\r\n    const levelArr = Object.keys(valueObj).map(s => Number(s));\r\n    let lowLevel;\r\n    let highLevel;\r\n    for (let i = 0; i < levelArr.length - 1; i++) {\r\n        if (levelArr[i] <= level && levelArr[i + 1] >= level) {\r\n            lowLevel = levelArr[i];\r\n            highLevel = levelArr[i + 1];\r\n        }\r\n    }\r\n    if (!lowLevel || !highLevel) return 0;\r\n    return valueObj[lowLevel] + (valueObj[highLevel] - valueObj[lowLevel]) * (level - lowLevel) / (highLevel - lowLevel);\r\n}\r\n\r\n/** 聖遺物メイン効果のステータスを算出します */\r\nexport function calculateArtifactStatsMain(artifactStatsMain: any, mainstats: string[]) {\r\n    (Object.keys(artifactStatsMain) as (keyof typeof artifactStatsMain)[]).forEach(\r\n        (key) => {\r\n            artifactStatsMain[key] = 0;\r\n        }\r\n    );\r\n    for (const statWithRarity of mainstats) {\r\n        if (!statWithRarity) continue;\r\n        const stat: any[] = statWithRarity.split('_');\r\n        artifactStatsMain[stat[1]] += ARTIFACT_MAIN_MASTER[stat[0] as TArtifactMainRarity][stat[1] as TArtifactMainStat];\r\n    }\r\n}\r\n\r\n/** 聖遺物優先するサブ効果のステータスを算出します */\r\nexport function calculateArtifactSubStatByPriority(\r\n    artifactStatsSub: any,\r\n    mainstats: string[],\r\n    prioritySubstats: string[],\r\n    priotritySubstatIndices: number[],\r\n    priotritySubstatValues: number[][],\r\n    prioritySubstatCounts: number[]) {\r\n    (Object.keys(artifactStatsSub) as (keyof typeof artifactStatsSub)[]).forEach((key) => {\r\n        artifactStatsSub[key] = 0;\r\n    });\r\n    let totalCount = 0;\r\n    for (let i = 0; i < prioritySubstats.length; i++) {\r\n        if (!prioritySubstats[i]) continue;\r\n        if (priotritySubstatIndices[i] === undefined || priotritySubstatIndices[i] < 0) continue;\r\n        if (!prioritySubstatCounts[i]) continue;\r\n        artifactStatsSub[prioritySubstats[i]] += priotritySubstatValues[i][priotritySubstatIndices[i]] * prioritySubstatCounts[i];\r\n        totalCount += prioritySubstatCounts[i];\r\n    }\r\n    // 初期: 3 or 4\r\n    // 強化: 5 (+4 +8 +12 +16 +20)\r\n    // 初期+強化: min=40 max=45\r\n    const noPrioritySubstatArr = 聖遺物サブ効果ARRAY.filter(s => !prioritySubstats.includes(s));\r\n    let noPriorityCount = Math.min(45, 40 + Math.floor(Math.max(0, (totalCount - 12) / 5)));\r\n    noPriorityCount -= Math.min(45, totalCount);\r\n    for (let i = noPriorityCount; i > 0; i--) {\r\n        const substat = noPrioritySubstatArr[i % noPrioritySubstatArr.length] as keyof typeof ARTIFACT_SUB_MASTER;\r\n        artifactStatsSub[substat] += ARTIFACT_SUB_MASTER[substat][3];\r\n    }\r\n    const star4Count = mainstats.filter(s => s && s.startsWith('4')).length;\r\n    const multiplier = 1 - (0.07 * star4Count); // ★4聖遺物ひとつにつきステータスを7%下げます\r\n    (Object.keys(artifactStatsSub) as (keyof typeof artifactStatsSub)[]).forEach(\r\n        (key) => {\r\n            artifactStatsSub[key] *= multiplier;\r\n            artifactStatsSub[key] = Math.round(artifactStatsSub[key] * 10) / 10;\r\n        }\r\n    );\r\n}\r\n\r\nexport function calculateArtifactStats(artifactDetailInput: TArtifactDetailInput) {\r\n    const artifactStats = artifactDetailInput.聖遺物ステータス;\r\n    const artifactStatsMain = artifactDetailInput.聖遺物ステータスメイン効果;\r\n    const artifactStatsSub = artifactDetailInput.聖遺物ステータスサブ効果;\r\n    for (const stat of Object.keys(artifactStats)) {\r\n        (artifactStats as any)[stat] = 0;\r\n    }\r\n    for (const stat of Object.keys(artifactStatsMain)) {\r\n        if (stat in artifactStats) (artifactStats as any)[stat] += (artifactStatsMain as any)[stat];\r\n        else (artifactStats as any)[stat] = (artifactStatsMain as any)[stat];\r\n    }\r\n    for (const stat of Object.keys(artifactStatsSub)) {\r\n        if (stat in artifactStats) (artifactStats as any)[stat] += (artifactStatsSub as any)[stat];\r\n        else (artifactStats as any)[stat] = (artifactStatsSub as any)[stat];\r\n    }\r\n}\r\n\r\n/** キャラクターのステータスを計算します */\r\nexport const calculateStats = function (\r\n    statsInput: TStatsInput,\r\n    characterInput: TCharacterInput,\r\n    artifactDetailInput: TArtifactDetailInput,\r\n    conditionInput: TConditionInput,\r\n    optionInput: TOptionInput\r\n) {\r\n    if (!characterInput) return;\r\n    if (!artifactDetailInput) return;\r\n    if (!conditionInput) return;\r\n    if (!optionInput) return;\r\n\r\n    try {\r\n        const characterMaster = characterInput.characterMaster;\r\n        const ascension = characterInput.突破レベル;\r\n        const level = characterInput.レベル;\r\n        const constellation = characterInput.命ノ星座;\r\n        const weaponMaster = characterInput.weaponMaster;\r\n        const weaponAscension = characterInput.武器突破レベル;\r\n        const weaponLevel = characterInput.武器レベル;\r\n\r\n        const workStatsObj = _.cloneDeep(ステータスTEMPLATE);\r\n\r\n        workStatsObj['突破レベル'] = ascension;\r\n        workStatsObj['レベル'] = level;\r\n        workStatsObj['命ノ星座'] = constellation;\r\n        (workStatsObj as any)['元素'] = characterMaster.元素;\r\n\r\n        // キャラクターマスターから元素エネルギーを設定します\r\n        if ('元素エネルギー' in characterMaster['元素爆発']) {\r\n            workStatsObj['元素エネルギー'] = characterMaster['元素爆発']['元素エネルギー'];\r\n        }\r\n        if ('固有変数' in characterMaster) {\r\n            for (const name of Object.keys(characterMaster['固有変数'])) {\r\n                if (name in conditionInput.conditionValues) {\r\n                    workStatsObj[name] = Number(conditionInput.conditionValues[name]);\r\n                } else {\r\n                    workStatsObj[name] = characterMaster['固有変数'][name];\r\n                }\r\n            }\r\n        }\r\n\r\n        // 敵マスターから敵のステータス（耐性）を設定します\r\n        for (const stat of Object.keys(statsInput.enemyMaster).filter(s => s != 'key')) {\r\n            const toStat = '敵' + stat;\r\n            workStatsObj[toStat] = statsInput.enemyMaster[stat];\r\n        }\r\n\r\n        // ステータス補正を計上します\r\n        Object.keys(statsInput.statAdjustments).filter(s => !ステータスチーム内最高ARRAY.includes(s)).forEach(stat => {\r\n            if (stat in workStatsObj) workStatsObj[stat] += statsInput.statAdjustments[stat];\r\n        });\r\n        Object.keys(statsInput.statAdjustmentsEx).filter(s => !ステータスチーム内最高ARRAY.includes(s)).forEach(stat => {\r\n            if (stat in workStatsObj) workStatsObj[stat] += statsInput.statAdjustmentsEx[stat];\r\n        });\r\n\r\n        // キャラクターの基礎ステータスと突破ステータスを計上します\r\n        for (const stat of Object.keys(characterMaster['ステータス'])) {\r\n            if (基礎ステータスARRAY.includes(stat)) {\r\n                workStatsObj[stat] += getStatValueByLevel(characterMaster['ステータス'][stat], ascension, level);\r\n            } else {\r\n                const toStat = ['HP', '攻撃力', '防御力'].includes(stat) ? stat + '+' : stat;\r\n                if (toStat in workStatsObj) {\r\n                    workStatsObj[toStat] += getPropertyValueByLevel(characterMaster['ステータス'][stat], ascension);\r\n                }\r\n            }\r\n        }\r\n\r\n        // 武器の基礎ステータスと突破ステータスを計上します\r\n        for (const stat of Object.keys(weaponMaster['ステータス'])) {\r\n            workStatsObj[stat] += getStatValueByLevel(weaponMaster['ステータス'][stat], weaponAscension, weaponLevel);\r\n        }\r\n\r\n        // 聖遺物のステータスを計上します\r\n        const artifactStats = artifactDetailInput.聖遺物ステータス;\r\n        for (const stat of Object.keys(artifactStats)) {\r\n            const toStat = ['HP', '攻撃力', '防御力'].includes(stat) ? stat + '+' : stat;\r\n            workStatsObj[toStat] += (artifactStats as any)[stat];\r\n        }\r\n\r\n        let 通常攻撃_元素Var = characterMaster.武器 == '法器' ? characterMaster.元素 : '物理';\r\n        let 重撃_元素Var = characterMaster.武器 == '法器' ? characterMaster.元素 : '物理';\r\n        let 落下攻撃_元素Var = characterMaster.武器 == '法器' ? characterMaster.元素 : '物理';\r\n\r\n        if (optionInput) {\r\n            // 元素共鳴、チームオプション、その他オプションを計上します\r\n            [optionInput.elementalResonance, optionInput.teamOption, optionInput.miscOption].forEach(optionObj => {\r\n                if (optionObj && optionObj.conditionAdjustments) {\r\n                    Object.keys(optionObj.conditionAdjustments).forEach(stat => {\r\n                        const workValue = optionObj.conditionAdjustments[stat];\r\n                        if (workValue === Infinity) {\r\n                            if (stat.endsWith('元素付与')) {\r\n                                if (['片手剣', '両手剣', '長柄武器'].includes(characterMaster.武器)) {\r\n                                    const my付与元素 = stat.replace(/元素付与$/, '');\r\n                                    通常攻撃_元素Var = my付与元素;\r\n                                    重撃_元素Var = my付与元素;\r\n                                    落下攻撃_元素Var = my付与元素;\r\n                                }\r\n                            }\r\n                        } else if (workValue !== null) {\r\n                            if (stat in workStatsObj) {\r\n                                workStatsObj[stat] += workValue;\r\n                            } else {\r\n                                workStatsObj[stat] = workValue;\r\n                            }\r\n                            if (stat.endsWith('V1') || stat.endsWith('V2') || stat.endsWith('V3')) {\r\n                                const toStat = stat.replace(/V[1-3]$/, '');\r\n                                if (toStat in workStatsObj) {\r\n                                    workStatsObj[toStat] += workValue;\r\n                                } else {\r\n                                    workStatsObj[toStat] = workValue;\r\n                                }\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        }\r\n\r\n        const validConditionValueArr = makeValidConditionValueArr(conditionInput);\r\n\r\n        // チーム内で最も高いステータス値を求めます\r\n        calculateStatsTop(workStatsObj, optionInput);\r\n        // ステータス補正を計上します\r\n        ステータスチーム内最高ARRAY.forEach(stat => {\r\n            if (stat in statsInput.statAdjustments) {\r\n                if (stat in workStatsObj) {\r\n                    workStatsObj[stat] += statsInput.statAdjustments[stat];\r\n                }\r\n            }\r\n        });\r\n\r\n        // ステータス変化\r\n        const conditionAdjustments = updateStatsWithCondition(characterInput, validConditionValueArr, workStatsObj);\r\n\r\n        // 天賦性能変化\r\n        for (const myDamageDetail of [characterInput.damageDetailMyCharacter, characterInput.damageDetailMyWeapon, characterInput.damageDetailMyArtifactSets]) {\r\n            if (myDamageDetail && CHANGE_KIND_TALENT in myDamageDetail) {\r\n                for (const myDetailObj of myDamageDetail[CHANGE_KIND_TALENT]) {\r\n                    if (myDetailObj['条件']) {\r\n                        const number = checkConditionMatches(myDetailObj['条件'], validConditionValueArr, constellation);\r\n                        if (number == 0) continue;\r\n                    }\r\n                    if (myDetailObj['種類'] && myDetailObj['種類'].endsWith('元素付与')) {\r\n                        const my元素 = myDetailObj['種類'].replace('元素付与', '');\r\n                        if (!myDetailObj['対象']) {\r\n                            通常攻撃_元素Var = my元素;\r\n                            重撃_元素Var = my元素;\r\n                            落下攻撃_元素Var = my元素;\r\n                        } else if (myDetailObj['対象'] == '通常攻撃ダメージ') {\r\n                            通常攻撃_元素Var = my元素;\r\n                        } else if (myDetailObj['対象'] == '重撃ダメージ') {\r\n                            重撃_元素Var = my元素;\r\n                        } else if (myDetailObj['対象'] == '落下攻撃ダメージ') {\r\n                            落下攻撃_元素Var = my元素;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        conditionInput.攻撃元素 = [通常攻撃_元素Var, 重撃_元素Var, 落下攻撃_元素Var];\r\n\r\n        overwriteObject(statsInput.statsObj, workStatsObj);\r\n        overwriteObject(conditionInput.conditionAdjustments, conditionAdjustments);\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(statsInput, characterInput, artifactDetailInput, conditionInput, optionInput);\r\n        // throw error;\r\n    }\r\n}\r\n\r\nfunction updateStatsWithCondition(\r\n    characterInput: TCharacterInput,\r\n    validConditionValueArr: string[],\r\n    workStatsObj: TStats\r\n) {\r\n    const constellation = characterInput.命ノ星座;\r\n    const workConditionAdjustments = {} as { [key: string]: number };\r\n    const statFormulaMap: Map<string, any[]> = new Map();\r\n\r\n    for (const myDamageDetail of [characterInput.damageDetailMyCharacter, characterInput.damageDetailMyWeapon, characterInput.damageDetailMyArtifactSets]) {\r\n        if (myDamageDetail && CHANGE_KIND_STATUS in myDamageDetail) {\r\n            for (const myDetailObj of myDamageDetail[CHANGE_KIND_STATUS]) {\r\n                let hasCondition = false;\r\n                let myNew数値 = myDetailObj['数値'];\r\n                if (myDetailObj['条件']) {\r\n                    const number = checkConditionMatches(myDetailObj.条件, validConditionValueArr, constellation);\r\n                    if (number == 0) continue;\r\n                    if (number != 1) {\r\n                        myNew数値 = (myNew数値 as any).concat(['*', number]);\r\n                    }\r\n                    hasCondition = true;\r\n                }\r\n                let myNew種類 = myDetailObj['種類'];\r\n                if (myNew種類) {\r\n                    if (myDetailObj['対象']) {\r\n                        myNew種類 += '.' + myDetailObj['対象'];\r\n                    }\r\n                    if (!statFormulaMap.has(myNew種類)) {\r\n                        statFormulaMap.set(myNew種類, []);\r\n                    }\r\n                    statFormulaMap.get(myNew種類)?.push([myNew種類, myNew数値, myDetailObj.上限, myDetailObj.下限, hasCondition]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    const hpStatArr = ['基礎HP', 'HP%', 'HP+', 'HP上限'];\r\n    const defStatArr = ['基礎防御力', '防御力%', '防御力+', '防御力'];\r\n    const atkStatArr = ['基礎攻撃力', '攻撃力%', '攻撃力+', '攻撃力'];\r\n    const otherStatArr = [...元素ステータス_ダメージARRAY, ...元素ステータス_耐性ARRAY, ...ダメージバフARRAY, ...実数ダメージ加算ARRAY, ...元素反応バフARRAY, 'ダメージ軽減'];\r\n    otherStatArr.push(...Array.from(statFormulaMap.keys()).filter(s => s.indexOf('.') != -1));\r\n\r\n    const formulaStatArr = [...new Set(Array.from(statFormulaMap.keys()).map(s => s.replace(/V[1-3]$/, '')))].filter(s => ![...hpStatArr, ...defStatArr, ...atkStatArr, ...otherStatArr].includes(s));\r\n    formulaStatArr.sort(compareFunction);\r\n\r\n    // HPを計算します\r\n    for (const stat of hpStatArr) {\r\n        const oldStatsObj: TStats = {};\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const workStat = stat + postfix;\r\n            if (workStat in workStatsObj) {\r\n                oldStatsObj[workStat] = workStatsObj[workStat];\r\n            } else {\r\n                oldStatsObj[workStat] = 0;\r\n            }\r\n        });\r\n        updateStatsWithConditionSub(workConditionAdjustments, workStatsObj, statFormulaMap, stat);\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const fromStat = stat + postfix;\r\n            if (workStatsObj[fromStat]) {\r\n                if (stat in workStatsObj) {\r\n                    workStatsObj[stat] += workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                } else {\r\n                    workStatsObj[stat] = workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                }\r\n            }\r\n        });\r\n    }\r\n    workStatsObj['HP上限'] += workStatsObj['基礎HP'] + workStatsObj['HP+'];\r\n    workStatsObj['HP上限'] += (workStatsObj['基礎HP'] * workStatsObj['HP%']) / 100;\r\n\r\n    for (const stat of formulaStatArr) {\r\n        const oldStatsObj: TStats = {};\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const workStat = stat + postfix;\r\n            if (workStat in workStatsObj) {\r\n                oldStatsObj[workStat] = workStatsObj[workStat];\r\n            } else {\r\n                oldStatsObj[workStat] = 0;\r\n            }\r\n        });\r\n        updateStatsWithConditionSub(workConditionAdjustments, workStatsObj, statFormulaMap, stat);\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const fromStat = stat + postfix;\r\n            if (workStatsObj[fromStat]) {\r\n                if (stat in workStatsObj) {\r\n                    workStatsObj[stat] += workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                } else {\r\n                    workStatsObj[stat] = workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    // 防御力を計算します\r\n    for (const stat of defStatArr) {\r\n        const oldStatsObj: TStats = {};\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const workStat = stat + postfix;\r\n            if (workStat in workStatsObj) {\r\n                oldStatsObj[workStat] = workStatsObj[workStat];\r\n            } else {\r\n                oldStatsObj[workStat] = 0;\r\n            }\r\n        });\r\n        updateStatsWithConditionSub(workConditionAdjustments, workStatsObj, statFormulaMap, stat);\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const fromStat = stat + postfix;\r\n            if (workStatsObj[fromStat]) {\r\n                if (stat in workStatsObj) {\r\n                    workStatsObj[stat] += workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                } else {\r\n                    workStatsObj[stat] = workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                }\r\n            }\r\n        });\r\n    }\r\n    workStatsObj['防御力'] += workStatsObj['基礎防御力'] + workStatsObj['防御力+'];\r\n    workStatsObj['防御力'] += (workStatsObj['基礎防御力'] * workStatsObj['防御力%']) / 100;\r\n\r\n    // 攻撃力を計算します\r\n    for (const stat of atkStatArr) {\r\n        const oldStatsObj: TStats = {};\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const workStat = stat + postfix;\r\n            if (workStat in workStatsObj) {\r\n                oldStatsObj[workStat] = workStatsObj[workStat];\r\n            } else {\r\n                oldStatsObj[workStat] = 0;\r\n            }\r\n        });\r\n        updateStatsWithConditionSub(workConditionAdjustments, workStatsObj, statFormulaMap, stat);\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const fromStat = stat + postfix;\r\n            if (workStatsObj[fromStat]) {\r\n                if (stat in workStatsObj) {\r\n                    workStatsObj[stat] += workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                } else {\r\n                    workStatsObj[stat] = workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                }\r\n            }\r\n        });\r\n    }\r\n    workStatsObj['攻撃力'] += workStatsObj['基礎攻撃力'] + workStatsObj['攻撃力+'];\r\n    workStatsObj['攻撃力'] += (workStatsObj['基礎攻撃力'] * workStatsObj['攻撃力%']) / 100;\r\n\r\n    // 元素ステータスおよび隠しステータスを計算します\r\n    for (const stat of otherStatArr) {\r\n        const oldStatsObj: TStats = {};\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const workStat = stat + postfix;\r\n            if (workStat in workStatsObj) {\r\n                oldStatsObj[workStat] = workStatsObj[workStat];\r\n            } else {\r\n                oldStatsObj[workStat] = 0;\r\n            }\r\n        });\r\n        updateStatsWithConditionSub(workConditionAdjustments, workStatsObj, statFormulaMap, stat);\r\n        ['V1', 'V2', 'V3'].forEach(postfix => {\r\n            const fromStat = stat + postfix;\r\n            if (workStatsObj[fromStat]) {\r\n                if (stat in workStatsObj) {\r\n                    workStatsObj[stat] += workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                } else {\r\n                    workStatsObj[stat] = workStatsObj[fromStat] - oldStatsObj[fromStat];\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    return workConditionAdjustments;\r\n}\r\n\r\nfunction updateStatsWithConditionSub(\r\n    workConditionAdjustments: TStats,\r\n    workStatsObj: TStats,\r\n    statFormulaMap: Map<string, any[]>,\r\n    formulaKey: string\r\n) {\r\n    for (const formulaArr of [statFormulaMap.get(formulaKey), ...['V1', 'V2', 'V3'].map(s => statFormulaMap.get(formulaKey + s))]) {\r\n        if (!formulaArr) continue;\r\n        formulaArr.forEach(formula => {\r\n            const diffStats = updateStats(workStatsObj, formula[0], formula[1], formula[2], formula[3]);\r\n            for (const stat of Object.keys(diffStats)) {\r\n                if (ステータスチーム内最高ARRAY.includes(stat + 'TOP')) {\r\n                    const statValue = getStatValue(stat + 'X7', workStatsObj);\r\n                    const topValue = workStatsObj[stat + 'TOP'];\r\n                    if (statValue !== undefined && topValue !== undefined) {\r\n                        if (statValue > topValue) {\r\n                            workStatsObj[stat + 'TOP'] = statValue;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (formula[4]) {\r\n                for (const stat of Object.keys(diffStats)) {\r\n                    if (stat in workConditionAdjustments) {\r\n                        workConditionAdjustments[stat] += diffStats[stat];\r\n                    } else {\r\n                        workConditionAdjustments[stat] = diffStats[stat];\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nfunction compareFunction(a: string, b: string) {\r\n    const arr = ['元素熟知', '会心率', '会心ダメージ', '与える治療効果', '受ける治療効果', '元素チャージ効率', 'シールド強化'];\r\n    const lowestArr = ['ダメージ軽減'];\r\n    let aIndex = arr.indexOf(a);\r\n    if (lowestArr.indexOf(a) >= 0) {\r\n        aIndex = arr.length + 1;\r\n    }\r\n    let bIndex = arr.indexOf(b);\r\n    if (lowestArr.indexOf(b) >= 0) {\r\n        bIndex = arr.length + 1;\r\n    }\r\n    return (aIndex != -1 ? aIndex : arr.length) - (bIndex != -1 ? bIndex : arr.length);\r\n}\r\n\r\nexport function calculateElementalResonance(\r\n    conditionValues: TConditionValues,\r\n    conditionInput: TConditionInput,\r\n): TStats {\r\n    const result: TStats = {};\r\n    const validConditionValueArr = makeValidConditionValueArr(conditionInput);\r\n    for (const key of Object.keys(ELEMENTAL_RESONANCE_MASTER)) {\r\n        if (!conditionValues[key]) continue;\r\n        const master = (ELEMENTAL_RESONANCE_MASTER as any)[key];\r\n        if (master.詳細) {\r\n            for (const detailObj of master.詳細) {\r\n                if (detailObj.条件) {\r\n                    const matchRet = checkConditionMatches(detailObj.条件, validConditionValueArr, 0);\r\n                    if (matchRet == 0) continue;\r\n                }\r\n                if (detailObj.種類 && detailObj.数値) {\r\n                    if (detailObj.種類 in result) {\r\n                        result[detailObj.種類] += detailObj.数値;\r\n                    } else {\r\n                        result[detailObj.種類] = detailObj.数値;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (key == '草元素共鳴' && conditionValues.dendroOption) {\r\n            result['元素熟知'] += Number(conditionValues.dendroOption);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/** げんかるくスタイルの式データから結果（数値）を計算します */\r\nexport function calculateFormulaArray(\r\n    formulaArr: any,\r\n    statsObj: TStats,\r\n    damageResult: TDamageResult,\r\n    opt_max: number | string | Array<number | string> | null = null,\r\n    opt_min: number | string | Array<number | string> | null = null\r\n): number {\r\n    try {\r\n        let result = 0;\r\n        if (Array.isArray(formulaArr)) {\r\n            let operator: string | null = null;\r\n            for (const entry of formulaArr) {\r\n                let subResult = 0;\r\n                if (['+', '-', '*', '/'].includes(entry)) {\r\n                    operator = entry;\r\n                    continue;\r\n                } else if (isNumber(entry)) {\r\n                    subResult = Number(entry);\r\n                } else if (Array.isArray(entry)) {\r\n                    subResult = calculateFormulaArray(entry, statsObj, damageResult);\r\n                } else if (entry.indexOf('#') != -1) {\r\n                    const nameArr = entry.split('#');\r\n                    if (damageResult && nameArr[0] in damageResult) {\r\n                        const damageArrArr = damageResult[nameArr[0]] as TDamageResultEntry[];\r\n                        let damage = null;\r\n                        for (const damageArr of damageArrArr) {\r\n                            if (nameArr[1] == damageArr[0]) {\r\n                                damage = damageArr[4];  // 非会心\r\n                                break;\r\n                            }\r\n                        }\r\n                        if (damage != null) {\r\n                            subResult = damage;\r\n                        } else {\r\n                            console.error(formulaArr, statsObj, damageResult, opt_max, opt_min, entry);\r\n                        }\r\n                    }\r\n                } else {\r\n                    const temp = getStatValue(entry, statsObj);\r\n                    if (temp === undefined) {\r\n                        console.error(formulaArr, statsObj, null, opt_max, opt_min, entry);\r\n                    } else {\r\n                        subResult = temp;\r\n                    }\r\n                }\r\n                if (operator == null) {\r\n                    result += subResult;\r\n                } else {\r\n                    switch (operator) {\r\n                        case '+':\r\n                            result += subResult;\r\n                            break;\r\n                        case '-':\r\n                            result -= subResult;\r\n                            break;\r\n                        case '*':\r\n                            result *= subResult;\r\n                            result = Math.floor(result * 100) / 100;\r\n                            break;\r\n                        case '/':\r\n                            result /= subResult;\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        } else if (isNumber(formulaArr)) {\r\n            result = Number(formulaArr);\r\n        } else if (formulaArr.indexOf('#') != -1) {\r\n            const nameArr = formulaArr.split('#');\r\n            if (damageResult && nameArr[0] in damageResult) {\r\n                const damageArrArr = damageResult[nameArr[0]] as TDamageResultEntry[];\r\n                for (const damageArr of damageArrArr) {\r\n                    if (nameArr[1] == damageArr[0]) {\r\n                        result = damageArr[4];  // 非会心\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            const temp = getStatValue(formulaArr, statsObj);\r\n            if (temp !== undefined) {\r\n                result = temp;\r\n            } else {\r\n                console.error(formulaArr, statsObj, null, opt_max, opt_min);\r\n                result = 0; // 暫定\r\n            }\r\n        }\r\n        if (opt_max != null) {\r\n            const maxValue = calculateFormulaArray(opt_max, statsObj, damageResult);\r\n            result = Math.min(result, maxValue);\r\n        }\r\n        if (opt_min != null) {\r\n            const minValue = calculateFormulaArray(opt_min, statsObj, damageResult);\r\n            result = Math.max(result, minValue);\r\n        }\r\n        return result;\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(formulaArr, statsObj, damageResult, opt_max, opt_min);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** ダメージ計算を実施します */\r\nexport function calculateDamageResult(\r\n    damageResult: TDamageResult,\r\n    characterInput: TCharacterInput,\r\n    conditionInput: TConditionInput,\r\n    statsInput: TStatsInput,\r\n) {\r\n    try {\r\n        if (!characterInput) return;\r\n        if (!conditionInput) return;\r\n        if (!statsInput) return;\r\n        const characterMaster = characterInput.characterMaster;\r\n        const constellation = characterInput['命ノ星座'];\r\n        const vision = characterMaster['元素'];\r\n\r\n        // 元素反応を計算します\r\n        const reactionResult = _.cloneDeep(元素反応TEMPLATE);\r\n        const reactionMasterArr = [];\r\n        const dmgElementSet = new Set<string>();\r\n        dmgElementSet.add(vision); // 神の目の元素ダメージによる元素反応\r\n        if (conditionInput.selectList.filter(s => s.name == '元素変化').length) {\r\n            const selectEntry = conditionInput.selectList.filter(s => s.name == '元素変化')[0];\r\n            const selectedIndex = conditionInput.conditionValues['元素変化'] as number;\r\n            if (selectedIndex) {\r\n                const dmgElement = selectEntry.options[selectedIndex].replace(/元素$/, '');\r\n                dmgElementSet.add(dmgElement); // 元素変化したダメージによる元素反応\r\n            }\r\n        }\r\n        if (conditionInput.selectList.filter(s => s.name == '拡散').length) {\r\n            const selectEntry = conditionInput.selectList.filter(s => s.name == '拡散')[0];\r\n            const selectedIndex = conditionInput.conditionValues['拡散'] as number;\r\n            if (selectedIndex) {\r\n                const dmgElement = selectEntry.options[selectedIndex].replace(/元素$/, '');\r\n                dmgElementSet.add(dmgElement); // 拡散ダメージによる元素反応\r\n            }\r\n        }\r\n        for (const dmgElement of conditionInput.攻撃元素) {\r\n            if (dmgElement && dmgElement != '物理') {\r\n                dmgElementSet.add(dmgElement); // 元素付与で変化した通常攻撃/重撃/落下攻撃ダメージによる元素反応\r\n            }\r\n        }\r\n        for (const dmgElement of dmgElementSet) {\r\n            reactionMasterArr.push([dmgElement, (ELEMENTAL_REACTION_MASTER as any)[dmgElement]]);\r\n        }\r\n        let has氷砕き = false;\r\n        if (characterMaster.元素 == '岩' || characterMaster.武器 == '両手剣') {\r\n            has氷砕き = true;\r\n        } else {\r\n            const characterArr = (ELEMENTAL_REACTION_MASTER as any).破砕?.氷砕き?.キャラクター;\r\n            if (characterArr && characterArr.includes(characterMaster.名前)) {\r\n                has氷砕き = true;\r\n            }\r\n        }\r\n        if (has氷砕き) {\r\n            const dmgElement = '破砕';\r\n            reactionMasterArr.push([dmgElement, (ELEMENTAL_REACTION_MASTER as any)[dmgElement]]);\r\n        }\r\n        reactionResult['元素'] = vision;\r\n        reactionMasterArr.forEach(entry => {\r\n            const element = entry[0];\r\n            const reactionMaster = entry[1];\r\n            Object.keys(reactionMaster).forEach(reaction => {\r\n                const reactionObj = reactionMaster[reaction];\r\n                let resultValue = 0;\r\n                if (reaction == '結晶') {\r\n                    resultValue = calculate結晶シールド吸収量(element, statsInput.statsObj);\r\n                } else if (reaction == '拡散') {\r\n                    let dmgElement = '炎';\r\n                    for (const entry of conditionInput.selectList) {\r\n                        if (entry.name == '拡散') {\r\n                            const optionValue = entry.options[Number(conditionInput.conditionValues['拡散'])];\r\n                            if (optionValue) dmgElement = optionValue.replace(/元素$/, '');\r\n                            break;\r\n                        }\r\n                    }\r\n                    reactionResult['拡散元素'] = dmgElement;\r\n                    resultValue = calculate固定値系元素反応ダメージ(reaction, element, statsInput.statsObj, dmgElement);\r\n                } else {\r\n                    switch (reactionObj['種類']) {\r\n                        case '乗算':    // 蒸発 溶解\r\n                            resultValue = calculate乗算系元素反応倍率(reaction, element, statsInput.statsObj);\r\n                            break;\r\n                        case '固定':    // 過負荷 感電 超電導 氷砕き\r\n                            resultValue = calculate固定値系元素反応ダメージ(reaction, element, statsInput.statsObj);\r\n                            break;\r\n                        case '加算':    // 超激化 草激化\r\n                            resultValue = calculate加算系元素反応ダメージ(reaction, element, statsInput.statsObj);\r\n                            break;\r\n                    }\r\n                }\r\n                ['倍率', 'ダメージ', '吸収量'].forEach(suffix => {\r\n                    let key = reaction + suffix;\r\n                    if (suffix === '倍率') {\r\n                        key += '_' + element;\r\n                    }\r\n                    if (key in reactionResult) {\r\n                        (reactionResult as any)[key] = resultValue;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n        Object.keys(reactionResult).filter(s => s.endsWith('ダメージ') && s.indexOf('会心') == -1).forEach(dmg => {\r\n            ['会心率', '会心ダメージ'].forEach(stat => {\r\n                const key = dmg + stat;\r\n                if (key in statsInput.statsObj) {\r\n                    (reactionResult as any)[key] = statsInput.statsObj[key];\r\n                }\r\n            });\r\n        });\r\n        overwriteObject(damageResult.元素反応, reactionResult);\r\n        console.debug('元素反応', damageResult.元素反応);\r\n\r\n        // 戦闘天賦およびその他のダメージを計算します\r\n        const validConditionValueArr = makeValidConditionValueArr(conditionInput);\r\n\r\n        const damageDetailMyCharacter = characterInput.damageDetailMyCharacter;\r\n        const damageDetailMyWeapon = characterInput.damageDetailMyWeapon;\r\n        const damageDetailMyArtifactSets = characterInput.damageDetailMyArtifactSets;\r\n\r\n        if (Array.isArray(damageResult['キャラクター注釈'])) {\r\n            damageResult['キャラクター注釈'].splice(0, damageResult['キャラクター注釈'].length);\r\n        }\r\n\r\n        if (damageDetailMyCharacter) {\r\n            for (const category of ['通常攻撃', '重撃', '落下攻撃']) {\r\n                damageResult[category] = [];\r\n                if (!(category in damageDetailMyCharacter)) continue;\r\n                const element = conditionInput.攻撃元素[['通常攻撃', '重撃', '落下攻撃'].indexOf(category)];\r\n                let talentDetailArr = (damageDetailMyCharacter as any)[category];\r\n                if (('特殊' + category) in damageDetailMyCharacter) {\r\n                    const workObj = (damageDetailMyCharacter as any)['特殊' + category];\r\n                    if (checkConditionMatches(workObj['条件'], validConditionValueArr, constellation) != 0) {\r\n                        talentDetailArr = workObj['詳細'];\r\n                    }\r\n                }\r\n                for (const talentDetail of talentDetailArr) {\r\n                    if (talentDetail['条件'] && checkConditionMatches(talentDetail['条件'], validConditionValueArr, constellation) == 0) {\r\n                        continue;\r\n                    }\r\n                    const resultArr = calculateDamageFromDetail(talentDetail, characterInput, conditionInput, statsInput.statsObj, damageResult, element);\r\n                    (damageResult[category] as any).push(resultArr);\r\n                }\r\n                if (category == '通常攻撃') {\r\n                    let n = 0;\r\n                    const sum = ['合計ダメージ', null, 0, 0, 0, null, 0, 0, 1] as TDamageResultEntry;\r\n                    for (const entry of damageResult[category]) {\r\n                        if ((entry[0].endsWith('段ダメージ') || ['水月ダメージ'].includes(entry[0])) && !entry[0].startsWith('非表示_')) {  // ニィロウ\r\n                            sum[1] = entry[1];\r\n                            sum[2] += entry[2];\r\n                            if (entry[3] == null) sum[3] = null;\r\n                            else if (sum[3] != null) sum[3] += entry[3];\r\n                            sum[4] += entry[4];\r\n                            if (sum[6] != null) {   // HIT数\r\n                                if (entry[6]) sum[6] += entry[6];\r\n                                else sum[6]++;\r\n                            }\r\n                            sum[7] = entry[7];  // ダメージバフ\r\n                            sum[8] = entry[8];  // 敵の防御補正\r\n                            n++;\r\n                        }\r\n                    }\r\n                    if (n > 0) {\r\n                        damageResult[category].splice(n, 0, sum);\r\n                    }\r\n                }\r\n            }\r\n            for (const category of ['元素スキル', '元素爆発', 'その他']) {\r\n                damageResult[category] = [];\r\n                if (!(category in damageDetailMyCharacter)) continue;\r\n                const talentDetailArr = (damageDetailMyCharacter as any)[category];\r\n                for (const talentDetail of talentDetailArr) {\r\n                    if (talentDetail['条件'] && checkConditionMatches(talentDetail['条件'], validConditionValueArr, constellation) == 0) {\r\n                        continue;\r\n                    }\r\n                    const resultArr = calculateDamageFromDetail(talentDetail, characterInput, conditionInput, statsInput.statsObj, damageResult);\r\n                    (damageResult[category] as TDamageResultEntry[]).push(resultArr);\r\n                }\r\n            }\r\n        }\r\n\r\n        // 武器と聖遺物セット効果\r\n        for (const myDamageDetail of [damageDetailMyWeapon, damageDetailMyArtifactSets]) {\r\n            const category = 'その他';\r\n            if (!myDamageDetail || !(category in myDamageDetail)) continue;\r\n            const talentDetailArr = (myDamageDetail as any)[category];\r\n            for (const talentDetail of talentDetailArr) {\r\n                if (talentDetail['条件'] && checkConditionMatches(talentDetail['条件'], validConditionValueArr, constellation) == 0) {\r\n                    continue;\r\n                }\r\n                const resultArr = calculateDamageFromDetail(talentDetail, characterInput, conditionInput, statsInput.statsObj, damageResult);\r\n                (damageResult[category] as TDamageResultEntry[]).push(resultArr);\r\n            }\r\n        }\r\n\r\n        // 被ダメージを計算します\r\n        const damageTakenArr = [] as any;\r\n        for (const stat of 元素ステータス_耐性ARRAY) {\r\n            const element = stat.replace(/元素耐性$/, '').replace(/耐性$/, '');\r\n            const damageTaken = calculateDamageTaken(statsInput.statsObj, 10000, element);\r\n            damageTakenArr.push({ key: element, value: damageTaken });\r\n        }\r\n        damageResult['被ダメージ'] = damageTakenArr;\r\n\r\n        // 耐久スコアを計算します\r\n        const resScoreArr = [] as any;\r\n        for (const damageTaken of damageTakenArr) {\r\n            resScoreArr.push({ key: damageTaken.key, value: statsInput.statsObj['HP上限'] * 10000 / damageTaken.value });\r\n        }\r\n        damageResult['耐久スコア'] = resScoreArr;\r\n\r\n        console.debug(damageResult);\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(damageResult, characterInput, conditionInput, statsInput);\r\n        // throw error;\r\n    }\r\n}\r\n\r\nexport function makeValidConditionValueArr(conditionInput: any) {\r\n    try {\r\n        const result = [] as string[];\r\n        if (!conditionInput) return result;\r\n        const checkboxList = conditionInput.checkboxList;\r\n        if (checkboxList) {\r\n            checkboxList.forEach((entry: any) => {\r\n                if (conditionInput.conditionValues[entry.name]) {\r\n                    result.push(entry.name);\r\n                }\r\n            });\r\n        }\r\n        const selectList = conditionInput.selectList;\r\n        if (selectList) {\r\n            selectList.forEach((entry: any) => {\r\n                const value = conditionInput.conditionValues[entry.name];\r\n                if (value !== undefined && value !== null) {\r\n                    if (value > 0 || (value == 0 && entry.required)) {\r\n                        result.push(entry.name + '@' + entry.options[value]);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        const numberList = conditionInput.numberList;\r\n        if (numberList) {\r\n            numberList.forEach((entry: any) => {\r\n                const value = conditionInput.conditionValues[entry.name];\r\n                if (value !== undefined && value !== null) {\r\n                    result.push(entry.name + '=' + value);\r\n                }\r\n            });\r\n        }\r\n        return result;\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(conditionInput);\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport function checkConditionMatches(\r\n    conditionStr: string,\r\n    validConditionValueArr: string[],\r\n    constellation: number,\r\n): number {\r\n    const myCondStr = conditionStr.split('^')[0];\r\n\r\n    if (myCondStr.indexOf('|') != -1) {  // |はOR条件です\r\n        const myCondStrArr = myCondStr.split('|');\r\n        for (let i = 0; i < myCondStrArr.length; i++) {\r\n            const resultSub = checkConditionMatchesSub(myCondStrArr[i], validConditionValueArr, constellation);\r\n            if (resultSub == 1) {\r\n                return 1;   // マッチ\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    const myCondStrArr = myCondStr.split('&');    // &はAND条件です\r\n    let result = 1;\r\n    for (let i = 0; i < myCondStrArr.length; i++) {\r\n        const resultSub = checkConditionMatchesSub(myCondStrArr[i], validConditionValueArr, constellation);\r\n        if (resultSub == 0) {\r\n            return 0;   // アンマッチ\r\n        }\r\n        if (resultSub != 1) {\r\n            result = resultSub;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction checkConditionMatchesSub(\r\n    conditionStr: string,\r\n    validConditionValueArr: string[],\r\n    constellation: number,\r\n): number {\r\n    const myCondArr = conditionStr.split(/[@=]/);\r\n    if (myCondArr[0] == '命ノ星座') {\r\n        if (myCondArr.length == 2) {\r\n            if (isNumber(myCondArr[1])) {\r\n                const work = Number(myCondArr[1]);\r\n                if (work <= constellation) {\r\n                    return 1;\r\n                }\r\n            }\r\n        }\r\n        return 0;   // アンマッチ\r\n    }\r\n    if (validConditionValueArr.includes(conditionStr) || validConditionValueArr.includes(conditionStr.replace('=', '@'))) {\r\n        return 1;   // マッチ 等倍\r\n    }\r\n    if (myCondArr.length == 1) {\r\n        if (validConditionValueArr.filter(s => s.split('@')[0] == conditionStr).length > 0) {\r\n            return 1;   // マッチ 等倍\r\n        }\r\n        return 0;   // アンマッチ\r\n    }\r\n    if (conditionStr.indexOf('=') != -1) {\r\n        if (NUMBER_CONDITION_VALUE_RE.test(myCondArr[1])) { // 数値入力条件\r\n            const workArr = validConditionValueArr.filter(s => s.split('=')[0] == myCondArr[0]);\r\n            if (workArr.length > 0) {\r\n                return Number(workArr[0].split('=')[1]);   // マッチ\r\n            }\r\n        }\r\n        return 0;   // アンマッチ\r\n    }\r\n    const re = new RegExp('[^0-9]*?([\\\\-0-9\\\\.]+).*');    // 条件値={prefix}{倍率}{postfix}\r\n    for (let i = 0; i < validConditionValueArr.length; i++) {\r\n        if (validConditionValueArr[i].startsWith(myCondArr[0] + '@')) {\r\n            const workCondArr = validConditionValueArr[i].split('@');\r\n            const reRet = re.exec(workCondArr[1]);\r\n            if (reRet) {\r\n                const work = Number(reRet[1]);\r\n                return work;    // マッチ 倍率\r\n            }\r\n        }\r\n    }\r\n    return 0;   // アンマッチ\r\n}\r\n\r\n/** 蒸発、溶解のダメージを計算します */\r\nfunction calculate乗算系元素反応倍率(\r\n    reaction: any,\r\n    element: string,\r\n    statsObj: any,\r\n) {\r\n    try {\r\n        if (!element || element == '物理') return 0;\r\n        const elementalMastery = statsObj['元素熟知'];\r\n        const dmgBuff = statsObj[reaction + '反応ボーナス'] ?? 0;\r\n        let result = (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['数値'];\r\n        result *= 1 + (25 * elementalMastery / (9 * (elementalMastery + 1400))) + dmgBuff / 100;\r\n        return result;\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(reaction, element, statsObj);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * 過負荷、感電、超電導、拡散のダメージを計算します\r\n */\r\nfunction calculate固定値系元素反応ダメージ(\r\n    reaction: any,\r\n    element: string,\r\n    statsObj: TStats,\r\n    opt_dmgElement?: string,\r\n) {\r\n    try {\r\n        if (!element || element == '物理') return 0;\r\n        const level = statsObj['レベル'];\r\n        const elementalMastery = statsObj['元素熟知'];\r\n        const dmgBuff = statsObj[reaction + '反応ボーナス'] ?? 0;\r\n        const dmgElement = opt_dmgElement ?? (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['元素'];\r\n        let result = getValueByLevel(level, (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['数値']);\r\n        result *= 1 + (16 * elementalMastery / (elementalMastery + 2000)) + dmgBuff / 100;\r\n        result *= calculateEnemyRes(dmgElement, statsObj);\r\n        return result;\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(reaction, element, statsObj, opt_dmgElement);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** 結晶シールドの吸収量を計算します */\r\nfunction calculate結晶シールド吸収量(element: string, statsObj: TStats) {\r\n    try {\r\n        if (!element || element == '物理') return 0;\r\n        const level = statsObj['レベル'];\r\n        const elementalMastery = statsObj['元素熟知'];\r\n        const dmgBuff = statsObj['結晶反応ボーナス'] ?? 0;\r\n        let result = getValueByLevel(level, (ELEMENTAL_REACTION_MASTER as any)[element]['結晶']['数値']);\r\n        result *= 1 + (40 * elementalMastery / (9 * (elementalMastery + 1400))) + dmgBuff / 100;\r\n        return result;\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(element, statsObj);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** 超激化、草激化のダメージを計算します */\r\nfunction calculate加算系元素反応ダメージ(reaction: any, element: string, statsObj: TStats) {\r\n    try {\r\n        if (!element || element == '物理') return 0;\r\n        const level = statsObj['レベル'];\r\n        const elementalMastery = statsObj['元素熟知'];\r\n        const dmgBuff = statsObj[reaction + '反応ボーナス'] ?? 0;\r\n        const dmgElement = (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['元素'];\r\n        let result = getValueByLevel(level, (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['数値']);\r\n        result *= 1 + (5 * elementalMastery / (elementalMastery + 1200)) + dmgBuff / 100;\r\n        result *= calculateEnemyRes(dmgElement, statsObj);\r\n        return result;\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(reaction, element, statsObj);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** 防御力補正を計算します */\r\nexport function calculateEnemyDef(statsObj: TStats, opt_ignoreDef = 0) { // 防御力, 防御無視\r\n    try {\r\n        const level = statsObj['レベル'] ?? 0;\r\n        const enemyLevel = statsObj['敵レベル'] ?? 0;\r\n        const calcIgnoreDef = opt_ignoreDef / 100;\r\n        const calcDef = Math.max(-100, statsObj['敵防御力'] ?? 0) / 100;    // 下限 -100%\r\n        const result = (level + 100) / ((1 - calcIgnoreDef) * (1 + calcDef) * (enemyLevel + 100) + level + 100);\r\n        return result;\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(statsObj, opt_ignoreDef);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** 元素(物理)耐性補正を計算します */\r\nfunction calculateRes(res: number) {\r\n    if (res == Infinity) return 0;  // 完全耐性\r\n    let result = res;\r\n    if (result < 0) {\r\n        result = 100 - result / 2;\r\n    } else if (result < 75) {\r\n        result = 100 - result;\r\n    } else {\r\n        result = 10000 / (4 * result + 100)\r\n    }\r\n    result /= 100;\r\n    return result;\r\n}\r\n\r\n/** 敵の元素(物理)耐性補正を計算します */\r\nexport function calculateEnemyRes(element: string, statsObj: TStats) {\r\n    try {\r\n        const statName = '敵' + element + (element != '物理' ? '元素' : '') + '耐性';\r\n        const result = calculateRes(statsObj[statName] ?? 0);\r\n        return result;\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(element, statsObj);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** ダメージを計算します */\r\nfunction calculateDamageFromDetail(\r\n    detailObj: any,\r\n    characterInput: TCharacterInput,\r\n    conditionInput: TConditionInput,\r\n    statsObj: TStats,\r\n    damageResult: TDamageResult,\r\n    opt_element: string | null = null\r\n): TDamageResultEntry {\r\n    try {\r\n        const myバフArr = [] as Array<string>;\r\n        let is会心Calc = true;\r\n        let is防御補正Calc = true;\r\n        let is耐性補正Calc = true;\r\n        let my元素 = detailObj['元素'] != null ? detailObj['元素'] : opt_element != null ? opt_element : null;\r\n        let my防御無視 = 0; // for 雷電将軍\r\n        let my別枠乗算 = 0; // for 宵宮\r\n        const myHIT数 = detailObj['HIT数'] != null ? Number(detailObj['HIT数']) : 1;\r\n        const myステータス補正 = {} as { [key: string]: number };\r\n\r\n        const constellation = statsObj['命ノ星座'];\r\n        const talentChangeDetailObjArr = getChangeDetailObjArr(characterInput, CHANGE_KIND_TALENT);\r\n\r\n        let validConditionValueArr = makeValidConditionValueArr(conditionInput);  // 有効な条件\r\n        const myConditionValuesAfter = _.cloneDeep(conditionInput.conditionValues);\r\n\r\n        if (detailObj['除外条件']) {\r\n            for (const delCondition of detailObj['除外条件']) {\r\n                let work = delCondition;\r\n                if (_.isPlainObject(delCondition)) {\r\n                    work = delCondition.名前;\r\n                }\r\n                if (work in myConditionValuesAfter) {\r\n                    if (isNumber(myConditionValuesAfter[work])) {\r\n                        myConditionValuesAfter[work] = 0;\r\n                    } else if (_.isBoolean(myConditionValuesAfter[work])) {\r\n                        myConditionValuesAfter[work] = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (detailObj['適用条件']) {\r\n            for (const addCondition of detailObj['適用条件']) {\r\n                if (_.isString(addCondition)) {\r\n                    if (addCondition in myConditionValuesAfter) {\r\n                        if (_.isBoolean(myConditionValuesAfter[addCondition])) {\r\n                            myConditionValuesAfter[addCondition] = true;\r\n                        }\r\n                    }\r\n                } else if (_.isPlainObject(addCondition)) {\r\n                    if (addCondition.名前 in myConditionValuesAfter) {\r\n                        let newValue = myConditionValuesAfter[addCondition.名前];\r\n                        if ('数値' in addCondition) {\r\n                            if (_.isString(addCondition.数値)) {\r\n                                const work = String(addCondition.数値).replace(/^\\+/, '');\r\n                                (newValue as number) += Number(work);\r\n                            } else if (isNumber(addCondition.数値)) {\r\n                                newValue = addCondition.数値;\r\n                            } else {\r\n                                newValue = addCondition.数値;\r\n                            }\r\n                            if (newValue !== null && isNumber(newValue)) {\r\n                                if ((newValue as number) < 0) {\r\n                                    newValue = 0;\r\n                                } else {\r\n                                    conditionInput.selectList.filter(s => s.name == addCondition.名前).forEach(entry => {\r\n                                        if (newValue !== null && (newValue as number) >= entry.options.length) {\r\n                                            newValue = entry.options.length - 1;\r\n                                        }\r\n                                    })\r\n                                }\r\n                            }\r\n                        } else {\r\n                            newValue = true;\r\n                        }\r\n                        myConditionValuesAfter[addCondition.名前] = newValue;\r\n                    }\r\n                    if (addCondition.説明) {\r\n                        if (Array.isArray(addCondition.説明)) {\r\n                            addCondition.説明.forEach((desc: string) => {\r\n                                if (!damageResult['キャラクター注釈'].includes(desc)) {\r\n                                    damageResult['キャラクター注釈'].push(desc);\r\n                                }\r\n                            })\r\n                        } else {\r\n                            const desc = addCondition.説明;\r\n                            if (!damageResult['キャラクター注釈'].includes(desc)) {\r\n                                damageResult['キャラクター注釈'].push(desc);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (detailObj['除外条件'] || detailObj['適用条件']) {\r\n            const myConditionInputAfter: TConditionInput = _.cloneDeep(conditionInput);\r\n            myConditionInputAfter.conditionValues = myConditionValuesAfter;\r\n            const validConditionValueArrAfter = makeValidConditionValueArr(myConditionInputAfter);\r\n\r\n            [characterInput.damageDetailMyCharacter, characterInput.damageDetailMyWeapon, characterInput.damageDetailMyArtifactSets].forEach(damageDetail => {\r\n                if (!damageDetail) return;\r\n                damageDetail.ステータス変更系詳細.filter(s => s.条件).forEach(damageDetailObj => {\r\n                    const conditionStr = damageDetailObj.条件 as string;\r\n                    let valueBefore = 0;\r\n                    let valueAfter = 0;\r\n                    const matchesBefore = checkConditionMatches(conditionStr, validConditionValueArr, constellation);\r\n                    const matchesAfter = checkConditionMatches(conditionStr, validConditionValueArrAfter, constellation);\r\n                    if (matchesBefore == matchesAfter) return;\r\n                    if (matchesBefore != 0) {\r\n                        let new数値 = damageDetailObj.数値;\r\n                        if (matchesBefore != 1) {\r\n                            new数値 = (new数値 as any[]).concat(['*', matchesBefore]);\r\n                        }\r\n                        valueBefore = calculateFormulaArray(new数値, statsObj, damageResult, damageDetailObj.上限, damageDetailObj.下限);\r\n                    }\r\n                    if (matchesAfter != 0) {\r\n                        let new数値 = damageDetailObj.数値;\r\n                        if (matchesAfter != 1) {\r\n                            new数値 = (new数値 as any[]).concat(['*', matchesAfter]);\r\n                        }\r\n                        valueAfter = calculateFormulaArray(new数値, statsObj, damageResult, damageDetailObj.上限, damageDetailObj.下限);\r\n                    }\r\n                    const diff = valueAfter - valueBefore;\r\n                    if (diff) {\r\n                        let new種類 = damageDetailObj.種類 as string;\r\n                        if (damageDetailObj.対象) {\r\n                            new種類 += '.' + damageDetailObj.対象;\r\n                        }\r\n                        if (new種類 in myステータス補正) {\r\n                            myステータス補正[new種類] += diff;\r\n                        } else {\r\n                            myステータス補正[new種類] = diff;\r\n                        }\r\n                    }\r\n                })\r\n            })\r\n\r\n            validConditionValueArr = validConditionValueArrAfter;\r\n        }\r\n\r\n        const myTalentChangeDetailObjArr = [] as any[];\r\n        if (talentChangeDetailObjArr) {\r\n            // 対象指定ありのダメージ計算（主に加算）を適用したい\r\n            talentChangeDetailObjArr.forEach(valueObj => {\r\n                let number = null;\r\n                if (valueObj.条件) {\r\n                    number = checkConditionMatches(valueObj.条件, validConditionValueArr, constellation);\r\n                    if (number == 0) {\r\n                        return;\r\n                    }\r\n                }\r\n                if (valueObj.対象) {\r\n                    if (valueObj.対象.endsWith('元素ダメージ')) {    // for 申鶴\r\n                        if (!valueObj.対象.startsWith(my元素)) {\r\n                            return;\r\n                        }\r\n                    } else if (valueObj.対象 == '物理ダメージ') {\r\n                        if (my元素 != '物理') {\r\n                            return;\r\n                        }\r\n                    } else {\r\n                        // 大分類 or 大分類.小分類\r\n                        const myダメージ種類 = detailObj.種類;\r\n                        const my対象カテゴリArr = valueObj.対象.split('.');\r\n                        if (my対象カテゴリArr[0] != myダメージ種類) {\r\n                            return;\r\n                        }\r\n                        if (my対象カテゴリArr.length > 1 && my対象カテゴリArr[my対象カテゴリArr.length - 1] != detailObj.名前) {\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n                if (valueObj['種類'].endsWith('元素付与')) {   // 元素付与は先んじて適用します\r\n                    if (['通常攻撃ダメージ', '重撃ダメージ', '落下攻撃ダメージ'].includes(detailObj.種類)) {\r\n                        if (!detailObj['元素付与無効']) {\r\n                            my元素 = valueObj['種類'].replace('元素付与', '');\r\n                        }\r\n                    }\r\n                } else if (valueObj.種類 == '防御無視') {   // 防御無視は先んじて適用します for 雷電将軍\r\n                    const myValue = calculateFormulaArray(valueObj.数値, statsObj, damageResult, valueObj.上限, valueObj.下限);\r\n                    my防御無視 += myValue;\r\n                } else if (valueObj.種類 == '固有変数') {\r\n                    // nop\r\n                } else {\r\n                    if (number != null && number != 1) {    // オプションの@以降の数値でスケールする場合あり\r\n                        const myNewValueObj = JSON.parse(JSON.stringify(valueObj)); // _.cloneDeep\r\n                        myNewValueObj.数値 = myNewValueObj.数値.concat(['*', number]);\r\n                        myTalentChangeDetailObjArr.push(myNewValueObj);\r\n                    } else {\r\n                        myTalentChangeDetailObjArr.push(valueObj);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        console.debug(detailObj['名前'] + ':myTalentChangeDetailObjArr');\r\n        console.debug(myTalentChangeDetailObjArr);\r\n\r\n        // 対象指定ありのステータスアップを適用したい\r\n        const tempStatsObj: TStats = {};\r\n        [statsObj, myステータス補正].forEach(entryObj => {\r\n            Object.keys(entryObj).forEach(stat => {\r\n                const tempArr = stat.split('.');\r\n                if (tempArr.length == 1) return;\r\n                let isValid = false;\r\n                if (tempArr[1] == detailObj.種類) {\r\n                    if (tempArr.length == 2) {\r\n                        isValid = true;\r\n                    } else if (tempArr[2] == detailObj.名前) {\r\n                        if (tempArr.length == 3) {\r\n                            isValid = true;\r\n                        }\r\n                    }\r\n                } else if (tempArr[1] == (my元素 + '元素ダメージ')) {\r\n                    if (tempArr.length == 2) {\r\n                        isValid = true;\r\n                    }\r\n                } else if (tempArr[1] == '物理ダメージ' && my元素 == '物理') {\r\n                    if (tempArr.length == 2) {\r\n                        isValid = true;\r\n                    }\r\n                }\r\n                if (isValid) {\r\n                    const toStat = tempArr[0];\r\n                    if (toStat in tempStatsObj) {\r\n                        if (toStat == '別枠乗算' && tempStatsObj[toStat] > 0) {\r\n                            tempStatsObj[toStat] *= entryObj[stat] / 100;   // for ディオナ\r\n                        } else {\r\n                            tempStatsObj[toStat] += entryObj[stat];\r\n                        }\r\n                    } else {\r\n                        tempStatsObj[toStat] = entryObj[stat];\r\n                    }\r\n                }\r\n            })\r\n        })\r\n        Object.keys(tempStatsObj).forEach(stat => {\r\n            if (stat in myステータス補正) {\r\n                if (stat.startsWith('別枠乗算') && myステータス補正[stat] > 0) {\r\n                    myステータス補正[stat] *= tempStatsObj[stat] / 100;   // for ディオナ\r\n                } else {\r\n                    myステータス補正[stat] += tempStatsObj[stat];\r\n                }\r\n            } else {\r\n                myステータス補正[stat] = tempStatsObj[stat];\r\n            }\r\n        });\r\n        console.debug('myステータス補正', myステータス補正);\r\n\r\n        // for 来歆の余響 「ダメージを与えた0.05秒後にクリアされる」\r\n        const damageDetailMyArtifactSets = characterInput.damageDetailMyArtifactSets;\r\n        if (damageDetailMyArtifactSets) {\r\n            if (detailObj.種類 == '通常攻撃ダメージ' && detailObj.HIT数 > 1\r\n                && characterInput.artifactSets[0] == '来歆の余響' && characterInput.artifactSets[1] == '来歆の余響') {\r\n                let isValid = false;\r\n                for (const valueObj of damageDetailMyArtifactSets[CHANGE_KIND_STATUS].filter(s => s.条件 && s.種類 && s.数値)) {\r\n                    const my種類 = valueObj.種類 as string; // 通常攻撃ダメージアップ\r\n                    const my条件 = valueObj.条件 as string;\r\n                    const myHIT数 = detailObj.HIT数;\r\n                    if (checkConditionMatches(my条件, validConditionValueArr, constellation) != 0) {\r\n                        const myValue = calculateFormulaArray(valueObj.数値, statsObj, damageResult, valueObj.上限, valueObj.下限);\r\n                        if (!(my種類 in myステータス補正)) {\r\n                            myステータス補正[my種類] = 0;\r\n                        }\r\n                        myステータス補正[my種類] -= myValue * (myHIT数 - Math.max(1, Math.floor(myHIT数 / 2))) / myHIT数;\r\n                        isValid = true;\r\n                    }\r\n                }\r\n                if (isValid) {\r\n                    const description = '来歆の余響4セット効果の幽谷祭祀のダメージアップは多段HITダメージの全てには乗らない。3HIT以下：1回分、4HIT：2回分を計上する';\r\n                    if (!damageResult['キャラクター注釈'].includes(description)) {\r\n                        damageResult['キャラクター注釈'].push(description);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // 一時的にステータスを書き換えます。\r\n        Object.keys(myステータス補正).forEach(stat => {\r\n            if (stat in statsObj) {\r\n                if (stat.startsWith('別枠乗算') && statsObj[stat] > 0) {\r\n                    statsObj[stat] *= myステータス補正[stat];\r\n                } else {\r\n                    statsObj[stat] += myステータス補正[stat];\r\n                }\r\n            } else {\r\n                statsObj[stat] = myステータス補正[stat];\r\n            }\r\n            console.debug('ステータス補正', stat, myステータス補正[stat]);\r\n        });\r\n\r\n        if (statsObj['別枠乗算']) {\r\n            my別枠乗算 = statsObj['別枠乗算'];\r\n        }\r\n\r\n        switch (detailObj.種類) {\r\n            case 'HP回復':\r\n                myバフArr.push('与える治療効果');\r\n                myバフArr.push('受ける治療効果');\r\n                is会心Calc = false;\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                my元素 = null;\r\n                break;\r\n            case 'シールド':\r\n                myバフArr.push('シールド強化');\r\n                is会心Calc = false;\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                break;\r\n            case '元素創造物HP':    // for アンバー 甘雨\r\n                is会心Calc = false;\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                my元素 = null;\r\n                break;\r\n            case '他所基準ダメージ':\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                break;\r\n            case '他所基準HP回復':\r\n                is会心Calc = false;\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                my元素 = null;\r\n                break;\r\n            case '付加元素ダメージ':    // for 風キャラ\r\n                if (!['炎', '水', '雷', '氷'].includes(my元素)) {\r\n                    my元素 = '炎';\r\n                }\r\n                break;\r\n            case 'HP消費':  // for リネ リネット\r\n                is会心Calc = false;\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                my元素 = null;\r\n                break;\r\n            default:\r\n                if (detailObj.種類.startsWith('表示') || detailObj.種類.startsWith('非表示')) {\r\n                    is会心Calc = false;\r\n                    is防御補正Calc = false;\r\n                    is耐性補正Calc = false;\r\n                    my元素 = null;\r\n                } else {\r\n                    myバフArr.push('与えるダメージ');\r\n                    if (detailObj.ダメージバフ != 'NONE') {  // for コレイ\r\n                        if (detailObj.ダメージバフ) {\r\n                            myバフArr.push(detailObj.ダメージバフ);\r\n                        } else if (DAMAGE_CATEGORY_ARRAY.includes(detailObj.種類)) {\r\n                            myバフArr.push(detailObj.種類 + 'バフ');\r\n                        }\r\n                    }\r\n                    if (my元素) {\r\n                        myバフArr.push(my元素 == '物理' ? '物理ダメージバフ' : my元素 + '元素ダメージバフ');\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n        const my計算Result = calculateDamageFromDetailSub(statsObj, damageResult, detailObj.数値, myバフArr, is会心Calc, is防御補正Calc, is耐性補正Calc, my元素, my防御無視, my別枠乗算, detailObj.上限, detailObj.下限);\r\n\r\n        myTalentChangeDetailObjArr.forEach(valueObj => {\r\n            const myResultWork = calculateDamageFromDetailSub(statsObj, damageResult, valueObj.数値, myバフArr, is会心Calc, is防御補正Calc, is耐性補正Calc, my元素, my防御無視, null, valueObj.上限, valueObj.下限);\r\n            if (valueObj.種類.endsWith('ダメージアップ')) {  // 実数ダメージ加算\r\n                if (detailObj.名前 == 'ダメージアップ') return;  // for 申鶴\r\n                if (DAMAGE_CATEGORY_ARRAY.includes(detailObj.種類)) {\r\n                    // 複数回HITするダメージについては、HIT数を乗算します\r\n                    if (myHIT数 > 1) {\r\n                        myResultWork[2] *= myHIT数;\r\n                        if (myResultWork[3] != null) {\r\n                            myResultWork[3] *= myHIT数;\r\n                        }\r\n                        myResultWork[4] *= myHIT数;\r\n                    }\r\n                }\r\n            }\r\n            my計算Result[2] += myResultWork[2];\r\n            if (my計算Result[3] != null && myResultWork[3]) {\r\n                my計算Result[3] += myResultWork[3];\r\n            }\r\n            my計算Result[4] += myResultWork[4];\r\n        });\r\n\r\n        // ステータスによる実数ダメージ加算を計算します\r\n        if ([...DAMAGE_CATEGORY_ARRAY, 'その他ダメージ'].includes(detailObj.種類)) {\r\n            let myダメージ種類 = detailObj.種類;\r\n            if (detailObj.ダメージバフ) {    // for 夢想の一心状態の時、雷電将軍の通常攻撃、重撃、落下攻撃のダメージは元素爆発ダメージと見なす\r\n                const temp = detailObj.ダメージバフ.replace(/バフ$/, '');\r\n                if (DAMAGE_CATEGORY_ARRAY.includes(temp)) {\r\n                    myダメージ種類 = temp;\r\n                }\r\n            }\r\n\r\n            const dmgUpStatArr = [];\r\n            dmgUpStatArr.push(myダメージ種類 + 'アップ');\r\n            if (my元素) {\r\n                dmgUpStatArr.push(my元素 == '物理' ? '物理ダメージアップ' : my元素 + '元素ダメージアップ');\r\n            }\r\n            dmgUpStatArr.forEach(dmgUpStat => {\r\n                if (!statsObj[dmgUpStat]) return;\r\n                if (!is防御補正Calc || !is耐性補正Calc) return;\r\n\r\n                if (detailObj.名前.startsWith('非表示_狼の魂基礎')) return;    // for レザー\r\n\r\n                const myResultWork = calculateDamageFromDetailSub(statsObj, damageResult, statsObj[dmgUpStat], myバフArr, is会心Calc, is防御補正Calc, is耐性補正Calc, my元素, my防御無視, null);\r\n                // 複数回HITするダメージについては、HIT数を乗算します\r\n                if (myHIT数 > 1) {\r\n                    myResultWork[2] *= myHIT数;\r\n                    if (myResultWork[3] != null) {\r\n                        myResultWork[3] *= myHIT数;\r\n                    }\r\n                    myResultWork[4] *= myHIT数;\r\n                }\r\n                my計算Result[2] += myResultWork[2];\r\n                if (my計算Result[3] != null && myResultWork[3]) {\r\n                    my計算Result[3] += myResultWork[3];\r\n                }\r\n                my計算Result[4] += myResultWork[4];\r\n            });\r\n        }\r\n\r\n        // 書き換えたステータスを元に戻します。\r\n        Object.keys(myステータス補正).forEach(statName => {\r\n            statsObj[statName] -= myステータス補正[statName];\r\n        });\r\n\r\n        if (detailObj.種類 == 'シールド') {\r\n            if (my計算Result[1] == '岩') {  // 岩元素シールド for ノエル 鍾離\r\n                my計算Result[2] = my計算Result[2] * 1.5;\r\n                my計算Result[4] = my計算Result[4] * 1.5;\r\n            }\r\n        }\r\n\r\n        const resultArr = [detailObj.名前, my計算Result[1], my計算Result[2], my計算Result[3], my計算Result[4], detailObj.種類, detailObj.HIT数, my計算Result[7], my計算Result[8]] as TDamageResultEntry;\r\n        console.debug('calculateDamageFromDetail', detailObj, characterInput, conditionInput, statsObj, opt_element, resultArr);\r\n        return resultArr;\r\n    } catch (error) {\r\n        console.error(error);\r\n        console.error(detailObj, characterInput, conditionInput, statsObj, opt_element);\r\n        throw error;\r\n    }\r\n}\r\n\r\nfunction calculateDamageFromDetailSub(\r\n    statsObj: TStats,\r\n    damageResult: TDamageResult,\r\n    formula: number | string | (number | string)[],\r\n    buffArr: Array<string> | null,\r\n    is会心Calc: boolean,\r\n    is防御補正Calc: boolean,\r\n    is耐性補正Calc: boolean,\r\n    元素: string,\r\n    防御無視: number,\r\n    別枠乗算: number | null,\r\n    opt_max: number | string | Array<number | string> | null = null,\r\n    opt_min: number | string | Array<number | string> | null = null\r\n): TDamageResultEntry {\r\n    const myダメージ基礎値 = calculateFormulaArray(formula, statsObj, damageResult, opt_max, opt_min);\r\n    let myダメージ = myダメージ基礎値;\r\n\r\n    if (別枠乗算) { // 別枠乗算 for 宵宮\r\n        myダメージ *= 別枠乗算 / 100;\r\n    } else {\r\n        別枠乗算 = 1;\r\n    }\r\n\r\n    // 計算済みの値を参照する場合は、バフと防御、耐性補正の計算を省略します\r\n    if (isUseReference(formula)) {\r\n        buffArr = null;\r\n        is防御補正Calc = false;\r\n        is耐性補正Calc = false;\r\n    }\r\n\r\n    let myダメージバフ補正 = 1;\r\n    if (buffArr) {\r\n        myダメージバフ補正 = 100;   // percent\r\n        buffArr.forEach(buff => {\r\n            if (statsObj[buff]) {\r\n                myダメージバフ補正 += statsObj[buff];\r\n            }\r\n        });\r\n        myダメージバフ補正 = myダメージバフ補正 / 100;\r\n        myダメージ *= myダメージバフ補正;\r\n    }\r\n\r\n    let my防御補正 = 1;\r\n    if (is防御補正Calc) {\r\n        my防御補正 = calculateEnemyDef(statsObj, 防御無視);\r\n        myダメージ *= my防御補正;\r\n    }\r\n\r\n    let my耐性補正 = 1;\r\n    if (is耐性補正Calc && 元素) {\r\n        my耐性補正 = calculateEnemyRes(元素, statsObj);\r\n        myダメージ *= my耐性補正;\r\n    }\r\n\r\n    let my会心率 = statsObj['会心率'];\r\n    if (元素 == '物理') {\r\n        if ('物理ダメージ会心率' in statsObj) {\r\n            my会心率 += statsObj['物理ダメージ会心率'];\r\n        }\r\n    } else if ((元素 + '元素ダメージ会心率') in statsObj) {\r\n        my会心率 += statsObj[元素 + '元素ダメージ会心率'];\r\n    }\r\n    my会心率 = Math.min(100, Math.max(0, my会心率)) / 100;    // 0≦会心率≦1\r\n\r\n    let my会心ダメージ = statsObj['会心ダメージ'];\r\n    if (元素 == '物理') {\r\n        if ('物理ダメージ会心ダメージ' in statsObj) {\r\n            my会心ダメージ += statsObj['物理ダメージ会心ダメージ'];\r\n        }\r\n    } else if ((元素 + '元素ダメージ会心ダメージ') in statsObj) {\r\n        my会心ダメージ += statsObj[元素 + '元素ダメージ会心ダメージ'];\r\n    }\r\n    my会心ダメージ = (100 + my会心ダメージ) / 100;\r\n\r\n    let my会心Result = null;\r\n    let my期待値Result = myダメージ;\r\n    if (is会心Calc && my会心率 > 0) {\r\n        my会心Result = myダメージ * my会心ダメージ;\r\n        my期待値Result = (my会心Result * my会心率) + (myダメージ * (1 - my会心率));\r\n    }\r\n\r\n    console.debug('%f * %f * [%o]=%f * [%f,%f] * %f * %f => %f,%f,%f', myダメージ基礎値, 別枠乗算, buffArr, myダメージバフ補正, my会心率, my会心ダメージ, my防御補正, my耐性補正, my期待値Result, my会心Result, myダメージ);\r\n    return ['未設定', 元素, my期待値Result, my会心Result, myダメージ, null, null, myダメージバフ補正, my防御補正];\r\n}\r\n\r\nfunction getChangeDetailObjArr(characterInput: TCharacterInput, changeKind: string) {\r\n    let result = [] as any[];\r\n    if (!characterInput) return result;\r\n\r\n    if (characterInput.damageDetailMyCharacter && changeKind in characterInput.damageDetailMyCharacter) {\r\n        result = result.concat((characterInput.damageDetailMyCharacter as any)[changeKind]);\r\n    }\r\n    if (characterInput.damageDetailMyWeapon && changeKind in characterInput.damageDetailMyWeapon) {\r\n        result = result.concat((characterInput.damageDetailMyWeapon as any)[changeKind]);\r\n    }\r\n    if (characterInput.damageDetailMyArtifactSets && changeKind in characterInput.damageDetailMyArtifactSets) {\r\n        result = result.concat((characterInput.damageDetailMyArtifactSets as any)[changeKind]);\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * 計算式内の参照有無を求めます\r\n */\r\nexport function isUseReference(formulaArr: number | string | Array<number | string>): boolean {\r\n    if (!Array.isArray(formulaArr)) {\r\n        if (isNumber(formulaArr)) {\r\n            return false;\r\n        }\r\n        return String(formulaArr).indexOf('#') != -1;\r\n    }\r\n    let result = false;\r\n    formulaArr.forEach(entry => {\r\n        if (['+', '-', '*', '/'].includes(String(entry))) {\r\n            return;\r\n        } else if (isNumber(entry)) {\r\n            return;\r\n        } else if (Array.isArray(entry)) {\r\n            if (isUseReference(entry)) {\r\n                result = true;\r\n            }\r\n        } else {\r\n            if (String(entry).indexOf('#') != -1) {\r\n                result = true;\r\n            }\r\n        }\r\n    });\r\n    return result;\r\n}\r\n\r\n/**\r\n * ステータスを更新します\r\n */\r\nfunction updateStats(\r\n    statsObj: TStats,\r\n    statName: string,\r\n    formulaArr: number | string | Array<number | string>,\r\n    opt_max: number | string | Array<number | string> | null = null,\r\n    opt_min: number | string | Array<number | string> | null = null,\r\n) {\r\n    const value = calculateFormulaArray(formulaArr, statsObj, DAMAGE_RESULT_TEMPLATE, opt_max, opt_min);    // DAMAGE_RESULT_TEMPLATEは参照しない想定なのでダミーです\r\n    if (!isNumber(value)) {\r\n        console.error(statsObj, statName, formulaArr, value);\r\n    }\r\n    const nameArr = [];\r\n    if (statName == 'HP') {\r\n        nameArr.push('HP上限');\r\n    } else if (statName.startsWith('自元素')) {\r\n        nameArr.push(statName.replace(/^自/, String(statsObj['元素'])));\r\n    } else if (statName.startsWith('全元素')) {\r\n        ALL_ELEMENTS.forEach(entry => {\r\n            nameArr.push(statName.replace(/^全/, entry));\r\n        });\r\n    } else if (statName.startsWith('敵自元素')) {\r\n        nameArr.push(statName.replace(/^敵自/, '敵' + String(statsObj['元素'])));\r\n    } else if (statName.startsWith('敵全元素')) {\r\n        ALL_ELEMENTS.forEach(entry => {\r\n            nameArr.push(statName.replace(/^敵全/, '敵' + entry));\r\n        });\r\n    } else {\r\n        nameArr.push(statName);\r\n    }\r\n    const diffStats = {} as { [key: string]: number };\r\n    nameArr.forEach(name => {\r\n        diffStats[name] = value;\r\n    });\r\n    for (const name of Object.keys(diffStats)) {\r\n        if (name in statsObj) {\r\n            if (name.startsWith('別枠乗算') && diffStats[name] > 0) {\r\n                statsObj[name] *= diffStats[name] / 100;    // for ディオナ\r\n            } else {\r\n                statsObj[name] += diffStats[name];\r\n            }\r\n        } else {\r\n            statsObj[name] = diffStats[name];\r\n        }\r\n    }\r\n    console.debug(updateStats.name, null, statName, formulaArr, '=>', diffStats);\r\n    return diffStats;\r\n}\r\n\r\n/** 被ダメージを計算します */\r\nfunction calculateDamageTaken(statsObj: TStats, damage: number, element: string) {\r\n    const def = statsObj['防御力'];\r\n    const enemyLevel = statsObj['敵レベル'];\r\n    const dmgReduction = statsObj['ダメージ軽減'];\r\n    const res = calculateRes(statsObj[element == '物理' ? '物理耐性' : element + '元素耐性']);\r\n    let result = damage * (1 - def / (def + 5 * enemyLevel + 501)) * (100 - dmgReduction) / 100 * res;\r\n    result = Math.max(0, result);\r\n    return result;\r\n}\r\n\r\n// function flattenArray(value: any) {\r\n//     const result: any[] = [];\r\n//     if (Array.isArray(value)) {\r\n//         value.forEach(e => {\r\n//             if (Array.isArray(e)) {\r\n//                 result.push(...flattenArray(e));\r\n//             } else {\r\n//                 result.push(e);\r\n//             }\r\n//         });\r\n//     }\r\n//     return result;\r\n// }\r\n\r\nexport type TArtifactScoreFormulaElement = [string, number];\r\nexport type TArtifactScoreFormula = TArtifactScoreFormulaElement[];\r\n\r\nexport const ARTIFACT_SCORE_FACTORS = [\r\n    'HP%', '攻撃力%', '防御力%', '元素熟知', '会心率', '会心ダメージ', '元素チャージ効率',\r\n];\r\n\r\nexport const ARTIFACT_SCORE_FORMULA_TEMPLATE: TArtifactScoreFormula[] = [\r\n    [['会心率', 2], ['会心ダメージ', 1]],\r\n    [['攻撃力%', 1], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['HP%', 1], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['防御力%', 1], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['HP%', 0.5], ['攻撃力%', 0.5], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['攻撃力%', 0.5], ['防御力%', 0.5], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['攻撃力%', 0.5], ['元素熟知', 0.125], ['会心率', 2], ['会心ダメージ', 1]],\r\n];\r\n\r\nexport function calculateArtifactScore(\r\n    characterInput: TCharacterInput,\r\n    artifactDetailInput: TArtifactDetailInput,\r\n    scoringStats: [string, number][]\r\n) {\r\n    let result = 0;\r\n    for (const scoringStat of scoringStats) {\r\n        const stat = scoringStat[0];\r\n        const magnification = scoringStat[1];\r\n        const statValue = (artifactDetailInput.聖遺物ステータスサブ効果 as any)[stat];\r\n        if (statValue) {\r\n            result += statValue * magnification;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function calculateStatsTop(\r\n    statsObj: TStats,\r\n    optionInput: TOptionInput,\r\n) {\r\n    ステータスチーム内最高ARRAY.forEach(stat => {\r\n        const srcStat = stat.replace(/TOP$/, 'X7');\r\n        let srcStatValue = getStatValue(srcStat, statsObj);\r\n        if (srcStatValue) {\r\n            statsObj[stat] = srcStatValue;\r\n        }\r\n        for (const member of optionInput.teamMembers) {\r\n            const calculatedSupporter = optionInput.supporters[member];\r\n            if (!calculatedSupporter?.statsInput?.statsObj) continue;\r\n            srcStatValue = getStatValue(srcStat, calculatedSupporter.statsInput.statsObj);\r\n            if (srcStatValue !== undefined) {\r\n                if (statsObj[stat] < srcStatValue) {\r\n                    statsObj[stat] = srcStatValue;\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nexport async function calculateSupporter(\r\n    optionInput: TOptionInput,\r\n    supporter: TCharacterKey,\r\n    build: string,\r\n    character: TCharacterKey,\r\n): Promise<[TStats, TDamageResult]> {\r\n    const characterInput = getDefaultCharacterInput();\r\n    const artifactDetailInput = getDefaultArtifactDetailInput();\r\n    const conditionInput = getDefaultConditionInput();\r\n    const statsInput = getDefaultStatsInput();\r\n    const damageResult = getDefaultDamageResultInput();\r\n\r\n    characterInput.character = supporter;\r\n    characterInput.characterMaster = await getCharacterMasterDetail(characterInput.character);\r\n\r\n    const builddata = JSON.parse(build);\r\n\r\n    await loadRecommendation(characterInput, artifactDetailInput, conditionInput, optionInput, builddata);\r\n    makeDamageDetailObjArrObjCharacter(characterInput);\r\n    makeDamageDetailObjArrObjWeapon(characterInput);\r\n    makeDamageDetailObjArrObjArtifactSets(characterInput);\r\n    setupConditionValues(conditionInput, characterInput, optionInput);\r\n    calculateArtifactStatsMain(artifactDetailInput.聖遺物ステータスメイン効果, artifactDetailInput.聖遺物メイン効果);\r\n    calculateArtifactStats(artifactDetailInput);\r\n    if (optionInput.elementalResonance) {\r\n        optionInput.elementalResonance.conditionAdjustments = calculateElementalResonance(optionInput.elementalResonance.conditionValues, conditionInput);\r\n    }\r\n    calculateStats(statsInput, characterInput, artifactDetailInput, conditionInput, optionInput);\r\n    updateNumberConditionValues(conditionInput, characterInput, statsInput.statsObj);\r\n    calculateStats(statsInput, characterInput, artifactDetailInput, conditionInput, optionInput);\r\n\r\n    if (characterInput.character == '雷電将軍') {\r\n        // for 雷罰悪曜の眼\r\n        const myCharacterMaster = await getCharacterMasterDetail(character);\r\n        if ('元素エネルギー' in myCharacterMaster['元素爆発']) {\r\n            statsInput.statsObj['元素エネルギー'] = myCharacterMaster['元素爆発']['元素エネルギー'];\r\n        }\r\n    }\r\n\r\n    calculateDamageResult(damageResult, characterInput, conditionInput, statsInput);\r\n\r\n    optionInput.supporters[supporter] = {\r\n        characterInput: characterInput,\r\n        artifactDetailInput: artifactDetailInput,\r\n        conditionInput: conditionInput,\r\n        statsInput: statsInput,\r\n        damageResult: damageResult,\r\n    };\r\n\r\n    return [statsInput.statsObj, damageResult];\r\n}\r\n\r\nexport type TRotationDamageEntry = {\r\n    name: string;\r\n    category: string;\r\n    reactions: object[];\r\n    counts: number[];\r\n};\r\n\r\nexport type TRotationDamageInfo = {\r\n    totalDamage: number,\r\n    rotationDamages: TRotationDamageEntry[],\r\n};\r\n\r\nexport function getCritFromResultEntry(entry: TDamageResultEntry) {\r\n    let critRate = 0;\r\n    let critDmg = 0;\r\n    if (entry[2] && entry[3] && entry[4]) {\r\n        critRate = entry[2] - entry[4]; // 期待値 - 非会心\r\n        critRate /= entry[3] - entry[4]; // 会心 - 非会心\r\n        critRate = Math.round(critRate * 1000) / 10;\r\n        critDmg = Math.round((entry[3] / entry[4] - 1) * 1000) / 10;\r\n    }\r\n    return [critRate, critDmg];\r\n}\r\n\r\nexport const REACTION_DMG_ARR = [\r\n    '過負荷ダメージ',\r\n    '感電ダメージ',\r\n    '超電導ダメージ',\r\n    '拡散ダメージ',\r\n    '燃焼ダメージ',\r\n    '開花ダメージ',\r\n    '烈開花ダメージ',\r\n    '超開花ダメージ',\r\n];\r\n\r\nexport const REACTION_DMG_ELEMENT_MAP = new Map<string, string>();\r\nfunction setupReactionDmgElementMap() {\r\n    REACTION_DMG_ARR.forEach((reactionDmg) => {\r\n        const reaction = reactionDmg.replace(/ダメージ$/, '');\r\n        Object.keys(ELEMENTAL_REACTION_MASTER).forEach((element) => {\r\n            const reactionMaster = (ELEMENTAL_REACTION_MASTER as any)[element];\r\n            const workArr = Object.keys(reactionMaster);\r\n            if (workArr.includes(reaction)) {\r\n                if ('元素' in reactionMaster[reaction]) {\r\n                    REACTION_DMG_ELEMENT_MAP.set(reactionDmg, reactionMaster[reaction].元素);\r\n                }\r\n            }\r\n        });\r\n    });\r\n}\r\nsetupReactionDmgElementMap();\r\n\r\nexport function getDamageResultArr(\r\n    rotationDamageEntry: TRotationDamageEntry,\r\n    damageResult: TDamageResult,\r\n): TDamageResultEntry[] {\r\n    const result = [] as TDamageResultEntry[];\r\n    const category = rotationDamageEntry.category;\r\n    if (REACTION_DMG_ARR.includes(category)) {\r\n        result.push([\r\n            category,\r\n            REACTION_DMG_ELEMENT_MAP?.get(category) ?? null,\r\n            (damageResult.元素反応 as any)[category],\r\n            null,\r\n            (damageResult.元素反応 as any)[category],\r\n            null,\r\n            1,\r\n            null,\r\n            null,\r\n        ]);\r\n    } else {\r\n        for (let entry of damageResult[category] as TDamageResultEntry[]) {\r\n            if (entry[0].startsWith('非表示')) continue;\r\n            if (entry[0].endsWith('合計ダメージ')) continue;\r\n            if (entry[5]?.endsWith('ダメージ')) {\r\n                if (entry[0].startsWith('法獣の灼眼')) {  // 会心した時の追加なので\r\n                    entry = _.cloneDeep(entry);\r\n                    const [critRate] = getCritFromResultEntry(entry);\r\n                    entry[2] = entry[2] * critRate / 100;\r\n                }\r\n                result.push(entry);\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function calculateRotationDamageEntry(\r\n    rotationDamageEntry: TRotationDamageEntry,\r\n    index: number,\r\n    damageResult: TDamageResult,\r\n) {\r\n    let result = 0;\r\n    const list = getDamageResultArr(rotationDamageEntry, damageResult);\r\n    if (list && list.length > index && rotationDamageEntry.reactions.length > index) {\r\n        const dmgResultEntry = list[index];\r\n        const reactionObj: any = rotationDamageEntry.reactions[index];\r\n        const count = rotationDamageEntry.counts[index];\r\n        const plainDmg = calculateReactedDamage(dmgResultEntry, 2, damageResult.元素反応, ''); // 元素反応なし\r\n        for (let n = 0; n < count; n++) {\r\n            let workDmg = plainDmg;\r\n            ['蒸発', '溶解'].forEach((reaction) => {\r\n                if (reaction in reactionObj && n < reactionObj[reaction]) {\r\n                    workDmg = calculateReactedDamage(dmgResultEntry, 2, damageResult.元素反応, reaction);\r\n                }\r\n            });\r\n            result += workDmg;\r\n        }\r\n        ['超激化', '草激化'].forEach((reaction) => {\r\n            if (reaction in reactionObj) {\r\n                result += calculateReactedDamage(dmgResultEntry, 2, damageResult.元素反応, reaction, reactionObj[reaction]) - plainDmg;\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function calculateRotationTotalDamage(\r\n    rotationDamageArr: TRotationDamageEntry[],\r\n    damageResult: TDamageResult,\r\n) {\r\n    let result = 0;\r\n    rotationDamageArr.forEach((rotationDamageEntry) => {\r\n        const list = getDamageResultArr(rotationDamageEntry, damageResult);\r\n        for (let i = 0; i < list.length; i++) {\r\n            result += calculateRotationDamageEntry(rotationDamageEntry, i, damageResult);\r\n        }\r\n    });\r\n    return result;\r\n}\r\n\r\n/** 元素反応込みのダメージを算出します */\r\nexport function calculateReactedDamage(\r\n    dmgResultEntry: TDamageResultEntry,\r\n    dmgIndex: number,\r\n    elementalReaction: TDamageResultElementalReaction,\r\n    reaction: string,\r\n    reactionTimes = 1\r\n) {\r\n    let result = Number(dmgResultEntry[dmgIndex]); // 2:期待値/3:会心/4:非会心\r\n    const dmgElement = dmgResultEntry[1];\r\n    if (reaction && dmgElement) {\r\n        if (['蒸発', '溶解'].includes(reaction)) {\r\n            const reactionKey = reaction + '倍率_' + dmgElement;\r\n            if (reactionKey in elementalReaction) {\r\n                result *= (elementalReaction as any)[reactionKey];\r\n            }\r\n        } else if (['超激化', '草激化'].includes(reaction)) {\r\n            const reactionKey = reaction + 'ダメージ';\r\n            if (reactionKey in elementalReaction) {\r\n                let reactionDmg = (elementalReaction as any)[reactionKey];\r\n                if (dmgResultEntry[2]) {\r\n                    reactionDmg *= result / dmgResultEntry[4]; // ÷ 非会心\r\n                }\r\n                if (dmgResultEntry[7]) {\r\n                    reactionDmg *= dmgResultEntry[7]; // ダメージバフ\r\n                }\r\n                if (dmgResultEntry[8]) {\r\n                    reactionDmg *= dmgResultEntry[8]; // 敵の防御補正\r\n                }\r\n                reactionDmg *= reactionTimes; // 反応回数\r\n                result += reactionDmg;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getAmplifyingReactionElement(reaction: string, dmgElement: string) {\r\n    let reactionElement;\r\n    if (reaction === '蒸発' && dmgElement === '炎') {\r\n        reactionElement = '水';\r\n    } else if (reaction === '蒸発' && dmgElement === '水') {\r\n        reactionElement = '炎';\r\n    } else if (reaction === '溶解' && dmgElement === '炎') {\r\n        reactionElement = '氷';\r\n    } else if (reaction === '溶解' && dmgElement === '氷') {\r\n        reactionElement = '炎';\r\n    } else if (reaction === '超激化' && dmgElement === '雷') {\r\n        reactionElement = '草';\r\n    } else if (reaction === '草激化' && dmgElement === '草') {\r\n        reactionElement = '雷';\r\n    }\r\n    return reactionElement;\r\n}\r\n","import _ from 'lodash';\r\n\r\nexport type TKeyValue = {\r\n    key: string, value: any,\r\n};\r\n\r\nexport function isString(value: any): boolean {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\n\r\nexport function isNumber(value: any): boolean {\r\n    return isFinite(value) && value != null;\r\n}\r\n\r\nexport function isBoolean(value: any): boolean {\r\n    return value === true || value === false;\r\n}\r\n\r\nexport function isPlainObject(value: any): boolean {\r\n    const myType = Object.prototype.toString.call(value);\r\n    return myType === '[object Object]';\r\n}\r\n\r\n// /** 簡易なdeep copy。undefinedなどは消失します */\r\n// export function deepcopy(value: any): any {\r\n//     const result = JSON.parse(JSON.stringify(value));\r\n//     return result;\r\n// }\r\n\r\nexport function overwriteObject(dst: any, src: any) {\r\n    if (_.isPlainObject(src) && _.isPlainObject(dst)) {\r\n        const srcKeys = Object.keys(src);\r\n        for (const key of srcKeys) {\r\n            dst[key] = src[key];\r\n        }\r\n        for (const key of Object.keys(dst)) {\r\n            if (!srcKeys.includes(key)) delete dst[key];\r\n        }\r\n    }\r\n    return dst;\r\n}\r\n\r\n// eslint-disable-next-line\r\nexport const basename = (path: string) => path!.split('/')!.pop()!.split('.')!.shift()!;\r\n","import { createI18n } from 'vue-i18n'\r\n\r\nconst i18n = createI18n({\r\n  legacy: false,\r\n  locale: 'ja-jp',\r\n  fallbackLocale: 'en-us',\r\n  isGlobal: true,\r\n})\r\nexport default i18n;\r\n","import { ALL_ELEMENTS, ARTIFACT_SET_MASTER, ARTIFACT_STAT_JA_EN_ABBREV_MAP, ARTIFACT_SUB_MASTER, CHARACTER_MASTER, DAMAGE_CATEGORY_ARRAY, ELEMENTAL_RESONANCE_MASTER, ELEMENTAL_RESONANCE_MASTER_LIST, ENEMY_MASTER_LIST, GENSEN_MASTER_LIST, getCharacterMasterDetail, getWeaponMasterDetail, IMG_SRC_DUMMY, NUMBER_OF_PRIORITY_SUBSTATS, RECOMMEND_ABBREV_MAP, TAnyObject, TArtifactSet, TArtifactSetEntry, TArtifactSetKey, TArtifactSubKey, TCharacterDetail, TCharacterKey, TEnemyEntry, TWeaponDetail, TWeaponKey, TWeaponTypeKey, WEAPON_MASTER, キャラクター構成PROPERTY_MAP } from '@/master';\r\nimport _ from 'lodash';\r\nimport { basename, isNumber, overwriteObject } from './common';\r\n\r\nexport const 基礎ステータスARRAY = [\r\n    '基礎HP',\r\n    '基礎攻撃力',\r\n    '基礎防御力'\r\n];\r\nexport const 基本ステータスARRAY = [\r\n    'HP上限',\r\n    '攻撃力',\r\n    '防御力',\r\n    '元素熟知'\r\n];\r\nexport const 高級ステータスARRAY = [\r\n    '会心率',\r\n    '会心ダメージ',\r\n    '与える治療効果',\r\n    '受ける治療効果',\r\n    '元素チャージ効率',\r\n    'クールタイム短縮',\r\n    'シールド強化'\r\n];\r\nexport const 元素ステータス_ダメージARRAY = [\r\n    '炎元素ダメージバフ',\r\n    '水元素ダメージバフ',\r\n    '風元素ダメージバフ',\r\n    '雷元素ダメージバフ',\r\n    '草元素ダメージバフ',\r\n    '氷元素ダメージバフ',\r\n    '岩元素ダメージバフ',\r\n    '物理ダメージバフ'\r\n];\r\nexport const 元素ステータス_耐性ARRAY = [\r\n    '炎元素耐性',\r\n    '水元素耐性',\r\n    '風元素耐性',\r\n    '雷元素耐性',\r\n    '草元素耐性',\r\n    '氷元素耐性',\r\n    '岩元素耐性',\r\n    '物理耐性'\r\n];\r\nexport const ダメージバフARRAY = [\r\n    '通常攻撃ダメージバフ',\r\n    '重撃ダメージバフ',\r\n    '落下攻撃ダメージバフ',\r\n    '元素スキルダメージバフ',\r\n    '元素爆発ダメージバフ',\r\n    '与えるダメージ',\r\n];\r\nexport const 実数ダメージ加算ARRAY = [\r\n    '通常攻撃ダメージアップ',\r\n    '重撃ダメージアップ',\r\n    '落下攻撃ダメージアップ',\r\n    '元素スキルダメージアップ',\r\n    '元素爆発ダメージアップ',\r\n    '炎元素ダメージアップ',\r\n    '水元素ダメージアップ',\r\n    '風元素ダメージアップ',\r\n    '雷元素ダメージアップ',\r\n    '草元素ダメージアップ',\r\n    '氷元素ダメージアップ',\r\n    '岩元素ダメージアップ',\r\n    '物理ダメージアップ'\r\n];\r\nexport const 元素反応バフARRAY = [\r\n    '蒸発反応ボーナス',\r\n    '溶解反応ボーナス',\r\n    '過負荷反応ボーナス',\r\n    '感電反応ボーナス',\r\n    '凍結反応ボーナス',\r\n    '超電導反応ボーナス',\r\n    '拡散反応ボーナス',\r\n    '結晶反応ボーナス',\r\n    '燃焼反応ボーナス',\r\n    '開花反応ボーナス',\r\n    '烈開花反応ボーナス',\r\n    '超開花反応ボーナス',\r\n    '超激化反応ボーナス',\r\n    '草激化反応ボーナス',\r\n];\r\nexport const ステータスその他ARRAY = [\r\n    'ダメージ軽減',\r\n    'HP%',\r\n    '攻撃力%',\r\n    '防御力%',\r\n    'HP+',\r\n    '攻撃力+',\r\n    '防御力+',\r\n];\r\nexport const ステータス連動ARRAY = [\r\n    'HP上限V1',\r\n    '攻撃力V1',\r\n    '防御力V1',\r\n    '元素熟知V1',\r\n    '会心率V1',\r\n    '会心ダメージV1',\r\n    '与える治療効果V1',\r\n    '受ける治療効果V1',\r\n    '元素チャージ効率V1',\r\n];\r\nexport const ステータスチーム内最高ARRAY = [\r\n    '元素熟知TOP',\r\n];\r\nexport const 敵ステータス_元素耐性ARRAY = [\r\n    '敵炎元素耐性',\r\n    '敵水元素耐性',\r\n    '敵風元素耐性',\r\n    '敵雷元素耐性',\r\n    '敵草元素耐性',\r\n    '敵氷元素耐性',\r\n    '敵岩元素耐性',\r\n    '敵物理耐性'\r\n];\r\nexport const 敵ステータス_その他ARRAY = [\r\n    '敵防御力'\r\n];\r\n\r\nexport const ステータスARRAY_MAP = new Map([\r\n    ['基礎ステータス', 基礎ステータスARRAY],\r\n    ['基本ステータス', 基本ステータスARRAY],\r\n    ['高級ステータス', 高級ステータスARRAY],\r\n    ['元素ステータス·ダメージ', 元素ステータス_ダメージARRAY],\r\n    ['元素ステータス·耐性', 元素ステータス_耐性ARRAY],\r\n    ['ダメージバフ', ダメージバフARRAY],\r\n    ['実数ダメージ加算', 実数ダメージ加算ARRAY],\r\n    ['元素反応バフ', 元素反応バフARRAY],\r\n    ['その他', ステータスその他ARRAY],\r\n    ['ステータス連動', ステータス連動ARRAY],\r\n    ['チーム内最高値', ステータスチーム内最高ARRAY],\r\n    ['敵ステータス·元素耐性', 敵ステータス_元素耐性ARRAY],\r\n    ['敵ステータス·その他', 敵ステータス_その他ARRAY],\r\n]);\r\n\r\nexport const STAT_PERCENT_LIST = [\r\n    ...高級ステータスARRAY, ...元素ステータス_ダメージARRAY, ...元素ステータス_耐性ARRAY, ...ダメージバフARRAY, ...元素反応バフARRAY, ...敵ステータス_元素耐性ARRAY,\r\n    '別枠乗算', '敵防御力',\r\n];\r\n\r\nexport type TStats = {\r\n    [key: string]: number,\r\n};\r\n\r\nfunction makeStatusTenmplate() {\r\n    const statsObj: TStats = {};\r\n    ステータスARRAY_MAP.forEach((value) => {\r\n        value.forEach(stat => {\r\n            statsObj[stat] = 0;\r\n        });\r\n    });\r\n    statsObj['会心率'] = 5;\r\n    statsObj['会心ダメージ'] = 50;\r\n    statsObj['元素チャージ効率'] = 100;\r\n    statsObj['敵レベル'] = 0;\r\n    statsObj['敵防御力'] = 0;\r\n    return statsObj;\r\n}\r\nexport const ステータスTEMPLATE = makeStatusTenmplate();\r\n\r\nfunction makeEnemyStatusTemplate() {\r\n    const statsObj: TStats = {};\r\n    [元素ステータス_耐性ARRAY].forEach((value) => {\r\n        value.forEach(stat => {\r\n            statsObj[stat] = 0;\r\n        });\r\n    });\r\n    statsObj['防御力'] = 0;\r\n    return statsObj;\r\n}\r\nexport const 敵ステータスTEMPLATE = makeEnemyStatusTemplate();\r\n\r\nexport const 聖遺物メイン効果_生の花ARRAY = [\r\n    '5_HP', '4_HP'\r\n];\r\nexport const 聖遺物メイン効果_死の羽ARRAY = [\r\n    '5_攻撃力', '4_攻撃力'\r\n];\r\nexport const 聖遺物メイン効果_時の砂ARRAY = [\r\n    '5_元素チャージ効率',\r\n    '5_HP%',\r\n    '5_攻撃力%',\r\n    '5_防御力%',\r\n    '5_元素熟知',\r\n    '4_元素チャージ効率',\r\n    '4_HP%',\r\n    '4_攻撃力%',\r\n    '4_防御力%',\r\n    '4_元素熟知'\r\n];\r\nexport const 聖遺物メイン効果_空の杯ARRAY = [\r\n    '5_炎元素ダメージバフ',\r\n    '5_水元素ダメージバフ',\r\n    '5_風元素ダメージバフ',\r\n    '5_雷元素ダメージバフ',\r\n    '5_草元素ダメージバフ',\r\n    '5_氷元素ダメージバフ',\r\n    '5_岩元素ダメージバフ',\r\n    '5_物理ダメージバフ',\r\n    '5_HP%',\r\n    '5_攻撃力%',\r\n    '5_防御力%',\r\n    '5_元素熟知',\r\n    '4_炎元素ダメージバフ',\r\n    '4_水元素ダメージバフ',\r\n    '4_風元素ダメージバフ',\r\n    '4_雷元素ダメージバフ',\r\n    '4_草元素ダメージバフ',\r\n    '4_氷元素ダメージバフ',\r\n    '4_岩元素ダメージバフ',\r\n    '4_物理ダメージバフ',\r\n    '4_HP%',\r\n    '4_攻撃力%',\r\n    '4_防御力%',\r\n    '4_元素熟知'\r\n];\r\nexport const 聖遺物メイン効果_理の冠ARRAY = [\r\n    '5_会心率',\r\n    '5_会心ダメージ',\r\n    '5_HP%',\r\n    '5_攻撃力%',\r\n    '5_防御力%',\r\n    '5_元素熟知',\r\n    '5_与える治療効果',\r\n    '4_会心率',\r\n    '4_会心ダメージ',\r\n    '4_HP%',\r\n    '4_攻撃力%',\r\n    '4_防御力%',\r\n    '4_元素熟知',\r\n    '4_与える治療効果'\r\n];\r\n\r\nexport const 聖遺物サブ効果ARRAY = [\r\n    'HP%',\r\n    'HP',\r\n    '攻撃力%',\r\n    '攻撃力',\r\n    '防御力%',\r\n    '防御力',\r\n    '元素熟知',\r\n    '会心率',\r\n    '会心ダメージ',\r\n    '元素チャージ効率',\r\n];\r\nexport const 聖遺物優先するサブ効果ARRAY = [\r\n    '攻撃力%',\r\n    'HP%',\r\n    '防御力%',\r\n    '元素熟知',\r\n    '会心率',\r\n    '会心ダメージ',\r\n    '元素チャージ効率',\r\n    'HP',\r\n    '攻撃力',\r\n    '防御力',\r\n];\r\n\r\nexport const 聖遺物ステータスTEMPLATE = {\r\n    'HP': 0,\r\n    '攻撃力': 0,\r\n    '防御力': 0,\r\n    '元素熟知': 0,\r\n    '会心率': 0,\r\n    '会心ダメージ': 0,\r\n    '元素チャージ効率': 0,\r\n    'HP%': 0,\r\n    '攻撃力%': 0,\r\n    '防御力%': 0,\r\n    '炎元素ダメージバフ': 0,\r\n    '水元素ダメージバフ': 0,\r\n    '風元素ダメージバフ': 0,\r\n    '雷元素ダメージバフ': 0,\r\n    '草元素ダメージバフ': 0,\r\n    '氷元素ダメージバフ': 0,\r\n    '岩元素ダメージバフ': 0,\r\n    '物理ダメージバフ': 0,\r\n    '与える治療効果': 0,\r\n};\r\n\r\nexport const 元素反応TEMPLATE = {\r\n    元素: '炎',\r\n    蒸発倍率_炎: 0,                 // 1.5倍\r\n    蒸発倍率_水: 0,                 // 2倍\r\n    溶解倍率_氷: 0,                 // 1.5倍\r\n    溶解倍率_炎: 0,                 // 2倍\r\n    過負荷ダメージ: 0,\r\n    感電ダメージ: 0,\r\n    超電導ダメージ: 0,\r\n    拡散ダメージ: 0,\r\n    拡散元素: '炎',\r\n    結晶吸収量: 0,\r\n    氷砕きダメージ: 0,\r\n    燃焼ダメージ: 0,\r\n    開花ダメージ: 0,\r\n    烈開花ダメージ: 0,\r\n    超開花ダメージ: 0,\r\n    超激化ダメージ: 0,\r\n    草激化ダメージ: 0,\r\n    燃焼ダメージ会心率: 0,          // for ナヒーダ\r\n    燃焼ダメージ会心ダメージ: 0,    // for ナヒーダ\r\n    開花ダメージ会心率: 0,          // for ナヒーダ\r\n    開花ダメージ会心ダメージ: 0,    // for ナヒーダ\r\n    烈開花ダメージ会心率: 0,        // for ナヒーダ\r\n    烈開花ダメージ会心ダメージ: 0,  // for ナヒーダ\r\n    超開花ダメージ会心率: 0,        // for ナヒーダ\r\n    超開花ダメージ会心ダメージ: 0,  // for ナヒーダ\r\n};\r\nexport type TDamageResultElementalReaction = typeof 元素反応TEMPLATE;\r\nexport type TDamageResultElementalReactionKey = keyof typeof 元素反応TEMPLATE;\r\n\r\nexport type TDamageResultEntry = [string, string | null, number, number | null, number, string | null, number | null, number | null, number | null];    // 0:名前, 1:元素, 2:期待値, 3:会心, 4:非会心, 5:種類, 6:HIT数, 7:ダメージバフ, 8:敵の防御補正\r\nexport type TDamageResult = {\r\n    元素反応: TDamageResultElementalReaction,\r\n    通常攻撃: TDamageResultEntry[],\r\n    重撃: TDamageResultEntry[],\r\n    落下攻撃: TDamageResultEntry[],\r\n    元素スキル: TDamageResultEntry[],\r\n    元素爆発: TDamageResultEntry[],\r\n    その他: TDamageResultEntry[],\r\n    キャラクター注釈: string[],\r\n    [key: string]: TDamageResultElementalReaction | TDamageResultEntry[] | string[],\r\n};\r\n\r\nexport const DAMAGE_RESULT_TEMPLATE = {\r\n    元素反応: _.cloneDeep(元素反応TEMPLATE) as TDamageResultElementalReaction,\r\n    通常攻撃: [] as TDamageResultEntry[],\r\n    重撃: [] as TDamageResultEntry[],\r\n    落下攻撃: [] as TDamageResultEntry[],\r\n    元素スキル: [] as TDamageResultEntry[],\r\n    元素爆発: [] as TDamageResultEntry[],\r\n    その他: [] as TDamageResultEntry[],\r\n    キャラクター注釈: [] as string[],\r\n};\r\n\r\nexport const 突破レベルレベルARRAY = [\r\n    Array.from({ length: 20 }, (_, i) => i + 1),\r\n    Array.from({ length: 21 }, (_, i) => i + 20),\r\n    Array.from({ length: 11 }, (_, i) => i + 40),\r\n    Array.from({ length: 11 }, (_, i) => i + 50),\r\n    Array.from({ length: 11 }, (_, i) => i + 60),\r\n    Array.from({ length: 11 }, (_, i) => i + 70),\r\n    Array.from({ length: 11 }, (_, i) => i + 80),\r\n];\r\n\r\nexport type TDamageDetailObj = {\r\n    名前: string | null,\r\n    種類: string | null,\r\n    元素: string | null,\r\n    数値: number | string | Array<any> | null,\r\n    条件: string | null,\r\n    対象: string | null,\r\n    上限: number | string | Array<any> | null,\r\n    下限: number | string | Array<any> | null,\r\n    HIT数: number | null,\r\n    ダメージバフ: string | null,\r\n    元素付与無効: boolean | null,\r\n    除外条件: (string | object)[] | null,\r\n    適用条件: (string | object)[] | null,\r\n};\r\n\r\nexport type TDamageDetail = {\r\n    通常攻撃?: TDamageDetailObj[],\r\n    重撃?: TDamageDetailObj[],\r\n    落下攻撃?: TDamageDetailObj[],\r\n    元素スキル?: TDamageDetailObj[],\r\n    元素爆発?: TDamageDetailObj[],\r\n    その他?: TDamageDetailObj[],\r\n    ステータス変更系詳細: TDamageDetailObj[],\r\n    天賦性能変更系詳細: TDamageDetailObj[],\r\n    条件: Map<string, string[]>,\r\n    排他: Map<string, string[]>,\r\n};\r\n\r\nexport const ARTIFACT_SET_MASTER_DUMMY = {\r\n    key: 'NONE' as TArtifactSetKey,\r\n    レアリティ: 5,\r\n    image: IMG_SRC_DUMMY,\r\n} as TArtifactSet;\r\n\r\nexport const CHARACTER_INPUT_TEMPLATE = {\r\n    character: 'アンバー' as TCharacterKey,\r\n    characterMaster: {} as TCharacterDetail,\r\n    突破レベル: 6,\r\n    レベル: 90,\r\n    命ノ星座: 0,\r\n    通常攻撃レベル: 8,\r\n    元素スキルレベル: 8,\r\n    元素爆発レベル: 8,\r\n    weapon: '西風猟弓' as TWeaponKey,\r\n    weaponMaster: {} as TWeaponDetail,\r\n    武器突破レベル: 6,\r\n    武器レベル: 90,\r\n    武器精錬ランク: 1,\r\n    artifactSets: ['NONE' as TArtifactSetKey, 'NONE' as TArtifactSetKey],\r\n    artifactSetMasters: [ARTIFACT_SET_MASTER_DUMMY, ARTIFACT_SET_MASTER_DUMMY] as TArtifactSetEntry[],\r\n    damageDetailMyCharacter: null as TDamageDetail | null,\r\n    damageDetailMyWeapon: null as TDamageDetail | null,\r\n    damageDetailMyArtifactSets: null as TDamageDetail | null,\r\n    damageDetailElementalResonance: null as TDamageDetail | null,\r\n    buildname: '',\r\n    recommendationSelectedIndex: 0,\r\n    saveDisabled: true,     // ローカルストレージへの構成保存不可か？\r\n    removeDisabled: true,   // ローカルストレージの構成削除不可か？\r\n};\r\nexport type TCharacterInput = typeof CHARACTER_INPUT_TEMPLATE;\r\n\r\nexport const ARTIFACT_TEMPLATE = {\r\n    name: '',\r\n    rarity: 1,\r\n    setname: 'NONE',\r\n    cat_id: 1,\r\n    mainStat: '',\r\n    mainStatValue: 0,\r\n    subStats: [\r\n        { name: 'HP', value: 0 },\r\n        { name: '攻撃力', value: 0 },\r\n        { name: '防御力', value: 0 },\r\n        { name: '元素熟知', value: 0 },\r\n    ]\r\n};\r\nexport type TArtifact = typeof ARTIFACT_TEMPLATE;\r\n\r\nexport const ARTIFACT_DETAIL_INPUT_TEMPLATE = {\r\n    聖遺物メイン効果: ['', '', '', '', ''],\r\n    聖遺物優先するサブ効果: _.fill(Array(NUMBER_OF_PRIORITY_SUBSTATS), ''),\r\n    聖遺物優先するサブ効果上昇値: Array.from(GENSEN_MASTER_LIST[2].values),     // 厳選1ヶ月\r\n    聖遺物優先するサブ効果上昇回数: Array.from(GENSEN_MASTER_LIST[2].counts),   // 厳選1ヶ月\r\n    聖遺物ステータス: _.cloneDeep(聖遺物ステータスTEMPLATE),\r\n    聖遺物ステータスメイン効果: _.cloneDeep(聖遺物ステータスTEMPLATE),\r\n    聖遺物ステータスサブ効果: _.cloneDeep(聖遺物ステータスTEMPLATE),\r\n    聖遺物優先するサブ効果Disabled: false,\r\n    artifact_list: [] as TArtifact[],\r\n};\r\nexport type TArtifactDetailInput = typeof ARTIFACT_DETAIL_INPUT_TEMPLATE;\r\n\r\nexport type TCheckboxEntry = {\r\n    name: string;\r\n    displayName?: string;\r\n};\r\nexport type TSelectEntry = {\r\n    name: string;\r\n    displayName?: string;\r\n    options: string[];\r\n    required: boolean;\r\n};\r\nexport type TNumberEntry = {\r\n    name: string;\r\n    displayName?: string;\r\n    min: number | string;\r\n    max?: number | string;\r\n    step?: number;\r\n};\r\nexport type TConditionValues = {\r\n    [key: string]: boolean | number | null,\r\n};\r\nexport type TConditionAdjustments = {\r\n    [key: string]: number | null,\r\n};\r\nexport const CONDITION_INPUT_TEMPLATE = {\r\n    checkboxList: [] as TCheckboxEntry[],\r\n    selectList: [] as TSelectEntry[],\r\n    numberList: [] as TNumberEntry[],\r\n    conditionValues: {} as TConditionValues,\r\n    conditionAdjustments: {} as TConditionAdjustments,\r\n    攻撃元素: [null, null, null] as (string | null)[],\r\n};\r\nexport type TConditionInput = typeof CONDITION_INPUT_TEMPLATE;\r\n\r\nexport const STATS_INPUT_TEMPLATE = {\r\n    statsObj: _.cloneDeep(ステータスTEMPLATE) as TStats,\r\n    statAdjustments: _.cloneDeep(ステータスTEMPLATE) as TStats,\r\n    statAdjustmentsEx: {} as TStats,\r\n    enemyMaster: ENEMY_MASTER_LIST[0] as TEnemyEntry,\r\n};\r\nfor (const stat of Object.keys(STATS_INPUT_TEMPLATE.statAdjustments)) {\r\n    STATS_INPUT_TEMPLATE.statAdjustments[stat] = 0;\r\n}\r\nexport type TStatsInput = typeof STATS_INPUT_TEMPLATE;\r\n\r\nexport function getDefaultCharacterInput(): TCharacterInput {\r\n    return _.cloneDeep(CHARACTER_INPUT_TEMPLATE);\r\n}\r\nexport function getDefaultArtifactDetailInput(): TArtifactDetailInput {\r\n    return _.cloneDeep(ARTIFACT_DETAIL_INPUT_TEMPLATE);\r\n}\r\nexport function getDefaultConditionInput(): TConditionInput {\r\n    return _.cloneDeep(CONDITION_INPUT_TEMPLATE);\r\n}\r\nexport function getDefaultOptionInput(): TOptionInput {\r\n    return _.cloneDeep(OPTION_INPUT_TEMPLATE);\r\n}\r\nexport function getDefaultStatsInput(): TStatsInput {\r\n    return _.cloneDeep(STATS_INPUT_TEMPLATE);\r\n}\r\nexport function getDefaultDamageResultInput(): TDamageResult {\r\n    return _.cloneDeep(DAMAGE_RESULT_TEMPLATE);\r\n}\r\n\r\nexport type TElementalResonance = {\r\n    conditionValues: TConditionValues,\r\n    conditionAdjustments: TConditionAdjustments,\r\n};\r\n\r\nexport const SUPPORTER_INPUT_TEMPLATE = {\r\n    characterInput: getDefaultCharacterInput(),\r\n    artifactDetailInput: getDefaultArtifactDetailInput(),\r\n    conditionInput: getDefaultConditionInput(),\r\n    statsInput: getDefaultStatsInput(),\r\n    damageResult: getDefaultDamageResultInput(),\r\n};\r\nexport type TSupporterInput = typeof SUPPORTER_INPUT_TEMPLATE;\r\n\r\nexport const OPTION_INPUT_TEMPLATE = {\r\n    elementalResonance: {\r\n        conditionValues: {},\r\n        conditionAdjustments: {},\r\n    } as TElementalResonance,\r\n    supporterBuildname: {} as { [key: string]: string | undefined },\r\n    supporters: {} as { [key: string]: TSupporterInput | undefined },\r\n    teamMembers: [] as string[],\r\n    teamOption: _.cloneDeep(CONDITION_INPUT_TEMPLATE) as TConditionInput,\r\n    miscOption: _.cloneDeep(CONDITION_INPUT_TEMPLATE) as TConditionInput,\r\n};\r\nexport type TOptionInput = typeof OPTION_INPUT_TEMPLATE;\r\n\r\n/** レベル文字列（1+,20,20+,...,90）を突破レベルとレベルに分割します */\r\nfunction parseLevelStr(levelStr: number | string): [number, number] {\r\n    let result: [number, number] = [0, 1];\r\n    try {\r\n        let level: number;\r\n        if (_.isString(levelStr)) {\r\n            level = Number(String(levelStr).replace('+', ''));\r\n        } else {\r\n            level = Number(levelStr);\r\n        }\r\n        let ascension = 0;\r\n        for (let i = (突破レベルレベルARRAY.length - 1); i >= 0; i--) {\r\n            ascension = i;\r\n            if (突破レベルレベルARRAY[i][0] > level) continue;\r\n            if (突破レベルレベルARRAY[i][0] == level && !String(levelStr).endsWith('+')) {\r\n                ascension--;\r\n            }\r\n            break;\r\n        }\r\n        result = [Math.max(0, ascension), level];\r\n    } catch (error) {\r\n        console.error(levelStr);\r\n        // throw error;\r\n    }\r\n    return result;\r\n}\r\n\r\nexport type TRecommendation = {\r\n    name: string,\r\n    build: any,\r\n    overwrite: boolean\r\n}\r\n\r\nexport function makeDefaultBuildname(character: any) {\r\n    return 'あなたの' + character;\r\n}\r\n\r\nexport function makeBuildStorageKey(character: TCharacterKey | string, buildname?: string) {\r\n    let result = '構成_' + character;\r\n    if (buildname && buildname != makeDefaultBuildname(character)) {\r\n        result += '_' + buildname;\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function makeOptionStorageKey(character: TCharacterKey | string, buildname?: string) {\r\n    return 'オプション' + makeBuildStorageKey(character, buildname);\r\n}\r\n\r\nexport function makeArtifactScoringStorageKey(character: TCharacterKey | string, buildname?: string) {\r\n    return makeBuildStorageKey(character, buildname).replace(/^構成/, 'ArtifactScoring');\r\n}\r\n\r\nexport function makeSupporterBuildnameStorageKey(character: TCharacterKey | string, buildname?: string) {\r\n    return makeBuildStorageKey(character, buildname).replace(/^構成/, 'SupporterBuildname');\r\n}\r\n\r\n/** おすすめセットのリストを作成します. [おすすめセットの名前, おすすめセットの内容, 上書き可不可][] */\r\nexport function makeRecommendationList(\r\n    characterMaster: TAnyObject,\r\n    opt_buildData?: TAnyObject,\r\n): TRecommendation[] {\r\n    const result: TRecommendation[] = [];\r\n\r\n    const character = characterMaster['名前'];\r\n    let isSavable: boolean | null = null;\r\n\r\n    if (opt_buildData) {\r\n        result.push({ name: 'IMPORTED DATA', build: opt_buildData, overwrite: false });\r\n        isSavable = true;\r\n        console.log(opt_buildData);\r\n    }\r\n\r\n    const storageKeyArr: string[] = [];\r\n    Object.keys(localStorage).forEach(key => {\r\n        if (key.startsWith(makeBuildStorageKey(character))) {\r\n            storageKeyArr.push(key);\r\n            if (isSavable == null) {\r\n                isSavable = false;\r\n            }\r\n        }\r\n    });\r\n    storageKeyArr.sort();\r\n    const re = new RegExp('^構成_' + character + '_');\r\n    storageKeyArr.forEach(key => {\r\n        let buildname;\r\n        if (key == makeBuildStorageKey(character)) {\r\n            buildname = makeDefaultBuildname(character);\r\n        } else {\r\n            buildname = key.replace(re, '');\r\n        }\r\n        const buildObj = JSON.parse(localStorage[key]);\r\n        const key2 = 'オプション' + key;\r\n        if (key2 in localStorage) {\r\n            const optionsObj = JSON.parse(localStorage[key2]);\r\n            buildObj.options = optionsObj;\r\n        }\r\n        const key3 = key.replace(/^構成/, 'ArtifactScoring');\r\n        if (key3 in localStorage) {\r\n            const artifactScoringObj = JSON.parse(localStorage[key3]);\r\n            buildObj.artifactScoring = artifactScoringObj;\r\n        }\r\n        const key4 = key.replace(/^構成/, 'SupporterBuildname');\r\n        if (key4 in localStorage) {\r\n            const supporterBuildnameObj = JSON.parse(localStorage[key4]);\r\n            buildObj.supporterBuildname = supporterBuildnameObj;\r\n        }\r\n        result.push({ name: buildname, build: buildObj, overwrite: true });\r\n    });\r\n\r\n    characterMaster['おすすめセット'].forEach((obj: { [key: string]: any }) => {\r\n        const myRecommendation = obj;\r\n        for (let i = 1; i <= NUMBER_OF_PRIORITY_SUBSTATS; i++) {\r\n            const subkey = '聖遺物優先するサブ効果' + i;\r\n            if (!(subkey in obj)) {\r\n                obj[subkey] = null;\r\n            }\r\n        }\r\n        const artifactRarerityArrArr = [[5, 5, 5, 5, 5], [4, 4, 5, 5, 5], [4, 4, 4, 5, 4]];\r\n        let artifactRarerity4Num = 0;\r\n        const artifactSet1 = myRecommendation['聖遺物セット効果1'] as TArtifactSetKey;\r\n        const artifactSet2 = myRecommendation['聖遺物セット効果2'] as TArtifactSetKey;\r\n        if (ARTIFACT_SET_MASTER[artifactSet1]['レアリティ'] == 4) {\r\n            artifactRarerity4Num++;\r\n        }\r\n        if (ARTIFACT_SET_MASTER[artifactSet2]['レアリティ'] == 4) {\r\n            artifactRarerity4Num++;\r\n        }\r\n        for (let i = 0; i < 2; i++) {\r\n            const name = '聖遺物メイン効果' + (i + 1);\r\n            if (!(name in myRecommendation)) {\r\n                if (i == 0) {\r\n                    myRecommendation[name] = artifactRarerityArrArr[artifactRarerity4Num][i] + '_HP';\r\n                } else if (i == 1) {\r\n                    myRecommendation[name] = artifactRarerityArrArr[artifactRarerity4Num][i] + '_攻撃力';\r\n                }\r\n            }\r\n        }\r\n\r\n        let buildname = myRecommendation['武器'];\r\n        buildname += ' ';\r\n        if (myRecommendation['聖遺物セット効果1'] == myRecommendation['聖遺物セット効果2']) {\r\n            buildname += myRecommendation['聖遺物セット効果1'];\r\n        } else {\r\n            buildname += makeArtifactSetAbbrev(myRecommendation['聖遺物セット効果1']);\r\n            buildname += '/';\r\n            buildname += makeArtifactSetAbbrev(myRecommendation['聖遺物セット効果2']);\r\n        }\r\n        buildname += ' [';\r\n        for (let i = 3; i <= 5; i++) {\r\n            const statusName = myRecommendation['聖遺物メイン効果' + i].split('_')[1];\r\n            if (RECOMMEND_ABBREV_MAP.has(statusName)) {\r\n                buildname += RECOMMEND_ABBREV_MAP.get(statusName);\r\n            } else {\r\n                buildname += statusName.substring(0, 1);\r\n            }\r\n        }\r\n        buildname += ']';\r\n        result.push({ name: buildname, build: myRecommendation, overwrite: false });\r\n    });\r\n\r\n    return result;\r\n}\r\n\r\n/** 聖遺物セット名の略称を作成します */\r\nfunction makeArtifactSetAbbrev(name: string): string {\r\n    const abbrRe = /[\\p{sc=Hiragana}\\p{sc=Katakana}ー]+/ug;\r\n    let abbr = name.replace(abbrRe, '');\r\n    if (abbr.length > 2) {\r\n        abbr = name.split(abbrRe).sort((a, b) => {\r\n            return b.length - a.length;\r\n        })[0];\r\n    }\r\n    if (abbr.length > 3) {\r\n        abbr = abbr.substring(0, 2);\r\n    }\r\n    return abbr;\r\n}\r\n\r\nexport function makePrioritySubstatValueList(\r\n    prioritySubstats: TArtifactSubKey[],\r\n    index: number,\r\n    opt_substat?: TArtifactSubKey\r\n) {\r\n    const result: number[] = [];\r\n    if (prioritySubstats[index]) {\r\n        if (!opt_substat) opt_substat = prioritySubstats[index];\r\n        if (opt_substat && opt_substat in ARTIFACT_SUB_MASTER) {\r\n            const valueArr = ARTIFACT_SUB_MASTER[opt_substat];\r\n            for (let i = 0; i < valueArr.length; i++) {\r\n                result.push(valueArr[i]);\r\n                if (i < valueArr.length - 1) {\r\n                    const diff = valueArr[i + 1] - valueArr[i];\r\n                    result.push(valueArr[i] + diff / 2);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function makeEasyInputSubstatValueList(\r\n    substat: TArtifactSubKey\r\n) {\r\n    const result: number[] = [];\r\n    if (substat && substat in ARTIFACT_SUB_MASTER) {\r\n        const valueArr = ARTIFACT_SUB_MASTER[substat];\r\n        for (let i = 0; i < valueArr.length; i++) {\r\n            result.push(valueArr[i]);\r\n            if (i < valueArr.length - 1) {\r\n                const diff = valueArr[i + 1] - valueArr[i];\r\n                result.push(valueArr[i] + diff / 2);\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/** おすすめセットをロードします */\r\nexport async function loadRecommendation(\r\n    characterInput: TCharacterInput,\r\n    artifactDetailInput: TArtifactDetailInput,\r\n    conditionInput: TConditionInput,\r\n    optionInput: TOptionInput,\r\n    build: { [key: string]: any }\r\n) {\r\n    try {\r\n        const character = characterInput.character;\r\n        const characterMaster = await getCharacterMasterDetail(character);\r\n        characterInput.characterMaster = characterMaster;\r\n        const artifactStatsSub = _.cloneDeep(聖遺物ステータスTEMPLATE);\r\n\r\n        if ('レベル' in build) {\r\n            [characterInput.突破レベル, characterInput.レベル] = parseLevelStr(build['レベル']);\r\n        }\r\n        ['命ノ星座', '通常攻撃レベル', '元素スキルレベル', '元素爆発レベル'].forEach(key => {\r\n            if (key in build) {\r\n                (characterInput as any)[key] = Number(build[key]);\r\n            }\r\n        });\r\n\r\n        const weaponType = characterMaster['武器'];\r\n        if ('武器' in build) {\r\n            if (Object.keys(WEAPON_MASTER[weaponType]).includes(build['武器'])) {\r\n                characterInput.weapon = build['武器'] as TWeaponKey;\r\n            } else {\r\n                characterInput.weapon = Object.keys(WEAPON_MASTER[weaponType]).filter(s => s.startsWith('西風'))[0] as TWeaponKey;\r\n            }\r\n            characterInput.weaponMaster = await getWeaponMasterDetail(characterInput.weapon, weaponType);\r\n        }\r\n        if ('武器レベル' in build) {\r\n            [characterInput.武器突破レベル, characterInput.武器レベル] = parseLevelStr(build['武器レベル']);\r\n        }\r\n        if ('精錬ランク' in build) {\r\n            characterInput.武器精錬ランク = Number(build['精錬ランク']);\r\n        }\r\n\r\n        let prioritySubstatsDisabled = false;\r\n        for (const key of Object.keys(build).filter((s: string) => s.startsWith('聖遺物サブ効果'))) {\r\n            let toKey = key.replace(/^聖遺物サブ効果/, '');\r\n            if (toKey != 'HP') toKey = toKey.replace(/P$/, '%');\r\n            if (build[key] || build[key] == 0) {\r\n                prioritySubstatsDisabled = true;\r\n                (artifactStatsSub as any)[toKey] = Number(build[key]);\r\n            }\r\n        }\r\n        artifactDetailInput.聖遺物優先するサブ効果Disabled = prioritySubstatsDisabled;\r\n\r\n        ['聖遺物セット効果1', '聖遺物セット効果2'].forEach((key, index) => {\r\n            if (!(key in build)) return;\r\n            const artifactSet = build[key] as TArtifactSetKey;\r\n            if (artifactSet && artifactSet in ARTIFACT_SET_MASTER) {\r\n                characterInput.artifactSets[index] = artifactSet;\r\n                characterInput.artifactSetMasters[index] = ARTIFACT_SET_MASTER[artifactSet] as TArtifactSetEntry;\r\n            } else {\r\n                characterInput.artifactSetMasters[index] = ARTIFACT_SET_MASTER_DUMMY as TArtifactSetEntry;\r\n            }\r\n        });\r\n\r\n        ['聖遺物メイン効果1', '聖遺物メイン効果2'].forEach((key, index) => {\r\n            if (key in build) {\r\n                artifactDetailInput['聖遺物メイン効果'][index] = build[key];\r\n            } else {\r\n                artifactDetailInput['聖遺物メイン効果'][index] = ['5_HP', '5_攻撃力'][index];\r\n            }\r\n        });\r\n        ['聖遺物メイン効果3', '聖遺物メイン効果4', '聖遺物メイン効果5'].forEach((key, index) => {\r\n            if (!(key in build)) return;\r\n            const mainstat = build[key];\r\n            artifactDetailInput['聖遺物メイン効果'][index + 2] = mainstat;\r\n        });\r\n\r\n        for (let i = 0; i < artifactDetailInput['聖遺物優先するサブ効果'].length; i++) {\r\n            const subkey1 = '聖遺物優先するサブ効果' + (i + 1);\r\n            const subkey2 = subkey1 + '上昇値';\r\n            const subkey3 = subkey1 + '上昇回数';\r\n            const substat = build[subkey1];\r\n            const substatValue = build[subkey2];\r\n            const substatCount = build[subkey3];\r\n            artifactDetailInput['聖遺物優先するサブ効果'][i] = substat ?? '';\r\n            if (substat && substatValue && isNumber(substatValue)) {\r\n                const prioritySubstatValueList = makePrioritySubstatValueList([substat], 0);\r\n                prioritySubstatValueList.forEach((value, index) => {\r\n                    if (substatValue <= value) {\r\n                        artifactDetailInput['聖遺物優先するサブ効果上昇値'][i] = index;\r\n                    }\r\n                })\r\n            } else {\r\n                if (artifactDetailInput['聖遺物優先するサブ効果'][i] && !artifactDetailInput['聖遺物優先するサブ効果上昇値'][i]) {\r\n                    artifactDetailInput['聖遺物優先するサブ効果上昇値'][i] = GENSEN_MASTER_LIST[2].values[i];\r\n                }\r\n            }\r\n            if (substat && substatCount && isNumber(substatCount)) {\r\n                artifactDetailInput['聖遺物優先するサブ効果上昇回数'][i] = substatCount;\r\n            } else {\r\n                if (artifactDetailInput['聖遺物優先するサブ効果'][i] && !artifactDetailInput['聖遺物優先するサブ効果上昇回数'][i]) {\r\n                    artifactDetailInput['聖遺物優先するサブ効果上昇回数'][i] = GENSEN_MASTER_LIST[2].counts[i];\r\n                }\r\n            }\r\n        }\r\n\r\n        Object.keys(build).filter(s => !キャラクター構成PROPERTY_MAP.has(s) && !['options', 'artifactScoring', 'supporterBuildname', 'artifact_list'].includes(s)).forEach(key => {\r\n            if (build[key] == null) {\r\n                conditionInput.conditionValues[key] = build[key];   // null\r\n            } else if (_.isString(build[key])) {\r\n                conditionInput.conditionValues[key] = Number(build[key]);\r\n            } else {\r\n                conditionInput.conditionValues[key] = build[key];\r\n            }\r\n        });\r\n\r\n        if ('options' in build) {\r\n            const keys = Object.keys(build.options);\r\n            if (keys.length) {\r\n                overwriteObject(optionInput.elementalResonance.conditionValues, {});\r\n                overwriteObject(optionInput.teamOption.conditionValues, {});\r\n                overwriteObject(optionInput.miscOption.conditionValues, {});\r\n                keys.forEach(key => {\r\n                    if (key in ELEMENTAL_RESONANCE_MASTER || key == 'dendroOption') {\r\n                        // 元素共鳴\r\n                        optionInput.elementalResonance.conditionValues[key] = build.options[key];\r\n                    } else {\r\n                        const astarIndex = key.indexOf('*');\r\n                        if (astarIndex != -1) {\r\n                            const workCharacter = key.substring(0, astarIndex);\r\n                            if (workCharacter in CHARACTER_MASTER) {\r\n                                // チーム\r\n                                optionInput.teamOption.conditionValues[key] = build.options[key];\r\n                            } else {\r\n                                // その他\r\n                                optionInput.miscOption.conditionValues[key] = build.options[key];\r\n                            }\r\n                        } else {\r\n                            // その他\r\n                            optionInput.miscOption.conditionValues[key] = build.options[key];\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n        }\r\n\r\n        if ('supporterBuildname' in build) {\r\n            const keys = Object.keys(build.supporterBuildname);\r\n            if (keys.length) {\r\n                overwriteObject(optionInput.supporterBuildname, {});\r\n                keys.forEach(key => {\r\n                    optionInput.supporterBuildname[key] = build.supporterBuildname[key];\r\n                });\r\n            }\r\n        }\r\n\r\n        if ('artifact_list' in build) {\r\n            const ARTIFACT_KEYS = Object.keys(ARTIFACT_TEMPLATE).sort();\r\n            const newList = build.artifact_list.filter((s: any) => _.isEqual(Object.keys(s).sort(), ARTIFACT_KEYS));\r\n            artifactDetailInput.artifact_list.splice(0, artifactDetailInput.artifact_list.length, ...newList);\r\n        } else {\r\n            artifactDetailInput.artifact_list.splice(0, artifactDetailInput.artifact_list.length);\r\n        }\r\n\r\n        overwriteObject(artifactDetailInput.聖遺物ステータスサブ効果, artifactStatsSub);\r\n\r\n        console.debug('loadRecommendation', characterInput, artifactDetailInput, conditionInput, build);\r\n    }\r\n    catch (error) {\r\n        console.error(characterInput, artifactDetailInput, conditionInput, build);\r\n        // throw error;\r\n    }\r\n}\r\n\r\nexport function makeSavedata(characterInput: TCharacterInput, artifactDetailInput: TArtifactDetailInput, conditionInput: TConditionInput) {\r\n    const resultObj = {} as any;\r\n\r\n    // キャラクター\r\n    resultObj['キャラクター'] = characterInput.character;\r\n    // レベル\r\n    resultObj['レベル'] = characterInput.レベル + (突破レベルレベルARRAY[characterInput.突破レベル][0] == characterInput.レベル ? '+' : '');\r\n    // 命ノ星座\r\n    resultObj['命ノ星座'] = characterInput.命ノ星座;\r\n    // 通常攻撃レベル\r\n    resultObj['通常攻撃レベル'] = characterInput.通常攻撃レベル;\r\n    // 元素スキルレベル\r\n    resultObj['元素スキルレベル'] = characterInput.元素スキルレベル;\r\n    // 元素爆発レベル\r\n    resultObj['元素爆発レベル'] = characterInput.元素爆発レベル;\r\n    // 武器\r\n    resultObj['武器'] = characterInput.weapon;\r\n    // 武器レベル\r\n    resultObj['武器レベル'] = characterInput.武器レベル + (突破レベルレベルARRAY[characterInput.突破レベル][0] == characterInput.武器レベル ? '+' : '');\r\n    // 精錬ランク\r\n    resultObj['精錬ランク'] = characterInput.武器精錬ランク;\r\n    // 聖遺物セット効果1\r\n    resultObj['聖遺物セット効果1'] = characterInput.artifactSets[0];\r\n    // 聖遺物セット効果2\r\n    resultObj['聖遺物セット効果2'] = characterInput.artifactSets[1];\r\n    // 聖遺物メイン効果1\r\n    resultObj['聖遺物メイン効果1'] = artifactDetailInput.聖遺物メイン効果[0];\r\n    // 聖遺物メイン効果2\r\n    resultObj['聖遺物メイン効果2'] = artifactDetailInput.聖遺物メイン効果[1];\r\n    // 聖遺物メイン効果3\r\n    resultObj['聖遺物メイン効果3'] = artifactDetailInput.聖遺物メイン効果[2];\r\n    // 聖遺物メイン効果4\r\n    resultObj['聖遺物メイン効果4'] = artifactDetailInput.聖遺物メイン効果[3];\r\n    // 聖遺物メイン効果5\r\n    resultObj['聖遺物メイン効果5'] = artifactDetailInput.聖遺物メイン効果[4];\r\n    // 聖遺物サブ効果HP\r\n    resultObj['聖遺物サブ効果HP'] = artifactDetailInput.聖遺物ステータスサブ効果['HP'];\r\n    // 聖遺物サブ効果攻撃力\r\n    resultObj['聖遺物サブ効果攻撃力'] = artifactDetailInput.聖遺物ステータスサブ効果['攻撃力'];\r\n    // 聖遺物サブ効果防御力\r\n    resultObj['聖遺物サブ効果防御力'] = artifactDetailInput.聖遺物ステータスサブ効果['防御力'];\r\n    // 聖遺物サブ効果元素熟知\r\n    resultObj['聖遺物サブ効果元素熟知'] = artifactDetailInput.聖遺物ステータスサブ効果['元素熟知'];\r\n    // 聖遺物サブ効果会心率\r\n    resultObj['聖遺物サブ効果会心率'] = artifactDetailInput.聖遺物ステータスサブ効果['会心率'];\r\n    // 聖遺物サブ効果会心ダメージ\r\n    resultObj['聖遺物サブ効果会心ダメージ'] = artifactDetailInput.聖遺物ステータスサブ効果['会心ダメージ'];\r\n    // 聖遺物サブ効果元素チャージ効率\r\n    resultObj['聖遺物サブ効果元素チャージ効率'] = artifactDetailInput.聖遺物ステータスサブ効果['元素チャージ効率'];\r\n    // 聖遺物サブ効果HPP\r\n    resultObj['聖遺物サブ効果HPP'] = artifactDetailInput.聖遺物ステータスサブ効果['HP%'];\r\n    // 聖遺物サブ効果攻撃力P\r\n    resultObj['聖遺物サブ効果攻撃力P'] = artifactDetailInput.聖遺物ステータスサブ効果['攻撃力%'];\r\n    // 聖遺物サブ効果防御力P\r\n    resultObj['聖遺物サブ効果防御力P'] = artifactDetailInput.聖遺物ステータスサブ効果['防御力%'];\r\n    // 聖遺物優先するサブ効果*,  聖遺物優先するサブ効果*上昇値, 聖遺物優先するサブ効果*上昇回数\r\n    for (let i = 0; i < artifactDetailInput.聖遺物優先するサブ効果.length; i++) {\r\n        const substat = artifactDetailInput.聖遺物優先するサブ効果[i];\r\n        if (substat) {\r\n            const key = '聖遺物優先するサブ効果' + (i + 1);\r\n            resultObj[key] = substat;\r\n            resultObj[key + '上昇値'] = artifactDetailInput.聖遺物優先するサブ効果上昇値[i];\r\n            resultObj[key + '上昇回数'] = artifactDetailInput.聖遺物優先するサブ効果上昇回数[i];\r\n        }\r\n    }\r\n\r\n    for (const entry of conditionInput.checkboxList) {\r\n        resultObj[entry.name] = conditionInput.conditionValues[entry.name];\r\n    }\r\n    for (const entry of conditionInput.selectList) {\r\n        resultObj[entry.name] = conditionInput.conditionValues[entry.name];\r\n    }\r\n\r\n    resultObj['artifact_list'] = artifactDetailInput.artifact_list;\r\n\r\n    return resultObj;\r\n}\r\n\r\nexport function makeOptionsSavedata(character: string, optionInput: TOptionInput) {\r\n    const resultObj = {} as any;\r\n\r\n    // 元素共鳴\r\n    {\r\n        const conditionValues = optionInput.elementalResonance.conditionValues;\r\n        Object.keys(conditionValues).forEach(key => {\r\n            if (conditionValues[key]) {\r\n                resultObj[key] = conditionValues[key];\r\n            }\r\n        })\r\n    }\r\n\r\n    // チーム\r\n    {\r\n        const conditionValues = optionInput.teamOption.conditionValues;\r\n        Object.keys(conditionValues).forEach(key => {\r\n            if (key.startsWith(character + '*')) return;\r\n            if (conditionValues[key]) {\r\n                resultObj[key] = conditionValues[key];\r\n            }\r\n        })\r\n    }\r\n\r\n    // その他\r\n    {\r\n        const conditionValues = optionInput.miscOption.conditionValues;\r\n        Object.keys(conditionValues).forEach(key => {\r\n            if (conditionValues[key]) {\r\n                resultObj[key] = conditionValues[key];\r\n            }\r\n        })\r\n    }\r\n\r\n    return resultObj;\r\n}\r\n\r\nexport function makeSupporterBuildnameSavedata(buildnameSelection: TAnyObject, optionInput: TOptionInput) {\r\n    const result: TAnyObject = {};\r\n    const conditionKeys = Object.keys(optionInput.teamOption.conditionValues);\r\n    for (const supporter of Object.keys(buildnameSelection)) {\r\n        if (!buildnameSelection[supporter]) continue;\r\n        if (conditionKeys.filter(s => s.startsWith(supporter + '*')).length == 0) continue;\r\n        result[supporter] = buildnameSelection[supporter];\r\n    }\r\n    return result;\r\n}\r\n\r\nexport const CHANGE_KIND_STATUS = 'ステータス変更系詳細';\r\nexport const CHANGE_KIND_TALENT = '天賦性能変更系詳細';\r\n\r\nexport function makeDamageDetailObjArrObjCharacter(characterInput: TCharacterInput): TDamageDetail {\r\n    const result = {} as any;\r\n    try {\r\n        const characterMaster = characterInput.characterMaster as any;\r\n\r\n        let myTalentDetail;\r\n        let myTalentLevel: number;\r\n        let myDefaultKind: string | null;\r\n        let myDefaultElement: string | null;\r\n        const myInputCategory = 'キャラクター';\r\n\r\n        const myStatusChangeDetailObjArr = [] as any[];\r\n        const myTalentChangeDetailObjArr = [] as any[];\r\n\r\n        // 通常攻撃 重撃 落下攻撃\r\n        myTalentLevel = characterInput['通常攻撃レベル'];\r\n        myDefaultElement = characterMaster['武器'] === '法器' ? characterMaster['元素'] : null;\r\n        ['通常攻撃', '重撃', '落下攻撃'].forEach(category => {\r\n            myTalentDetail = characterMaster[category];\r\n            myDefaultKind = category + 'ダメージ';\r\n            result[category] = makeDamageDetailObjArr(myTalentDetail, myTalentLevel, myDefaultKind, myDefaultElement, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n        });\r\n\r\n        ['通常攻撃', '重撃', '落下攻撃'].forEach(category => {\r\n            const workCategory = '特殊' + category;\r\n            if (workCategory in characterMaster) {\r\n                myTalentDetail = characterMaster[workCategory];\r\n                if ('種類' in myTalentDetail) {\r\n                    myDefaultKind = myTalentDetail['種類'];\r\n                    switch (myDefaultKind) {\r\n                        case '元素スキルダメージ':\r\n                            myTalentLevel = characterInput['元素スキルレベル'];\r\n                            break;\r\n                        case '元素爆発ダメージ':\r\n                            myTalentLevel = characterInput['元素爆発レベル'];\r\n                            break;\r\n                    }\r\n                }\r\n                if ('元素' in myTalentDetail) {\r\n                    myDefaultElement = myTalentDetail['元素'];\r\n                }\r\n                const workObj = {\r\n                    条件: myTalentDetail['条件'],\r\n                    詳細: makeDamageDetailObjArr(myTalentDetail, myTalentLevel, myDefaultKind, myDefaultElement, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory)\r\n                };\r\n                result[workCategory] = workObj;\r\n            }\r\n        });\r\n\r\n        // 元素スキル\r\n        myTalentLevel = characterInput['元素スキルレベル'];\r\n        myDefaultKind = '元素スキルダメージ';\r\n        myDefaultElement = characterMaster['元素'];\r\n        result['元素スキル'] = makeDamageDetailObjArr(characterMaster['元素スキル'], myTalentLevel, myDefaultKind, myDefaultElement, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n\r\n        // 元素爆発\r\n        myTalentLevel = characterInput['元素爆発レベル'];\r\n        myDefaultKind = '元素爆発ダメージ';\r\n        myDefaultElement = characterMaster['元素'];\r\n        result['元素爆発'] = makeDamageDetailObjArr(characterMaster['元素爆発'], myTalentLevel, myDefaultKind, myDefaultElement, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n\r\n        result['その他'] = [] as TDamageDetailObj[];\r\n\r\n        // その他戦闘天賦\r\n        if ('その他戦闘天賦' in characterMaster) {\r\n            characterMaster['その他戦闘天賦'].forEach((myTalentDetail: any) => {\r\n                const workArr = makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n                if (workArr.length > 0) result['その他'].push(...workArr);\r\n            });\r\n        }\r\n\r\n        // 固有天賦\r\n        characterMaster['固有天賦'].forEach((myTalentDetail: any) => {\r\n            const workArr = makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n            if (workArr.length > 0) result['その他'].push(...workArr);\r\n        });\r\n\r\n        // 命ノ星座\r\n        if ('命ノ星座' in characterMaster) {\r\n            Object.keys(characterMaster['命ノ星座']).forEach(key => {\r\n                if (Number(key) > characterInput.命ノ星座) return;\r\n                myTalentDetail = characterMaster['命ノ星座'][key];\r\n                const workArr = makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n                if (workArr.length > 0) result['その他'].push(...workArr);\r\n            });\r\n        }\r\n\r\n        // 風元素キャラクター\r\n        if (characterMaster['元素'] == '風') {\r\n            if (myTalentChangeDetailObjArr.filter(s => s.条件 && s.条件.startsWith('拡散@')).length == 0) {\r\n                ['炎元素', '水元素', '雷元素', '氷元素'].forEach(cond => {\r\n                    myTalentChangeDetailObjArr.push({\r\n                        名前: null,\r\n                        種類: '固有変数',\r\n                        元素: null,\r\n                        数値: null,\r\n                        条件: '拡散@' + cond,\r\n                        対象: null,\r\n                        上限: null,\r\n                        HIT数: null,\r\n                        ダメージバフ: null,\r\n                        元素付与無効: null,\r\n                        除外条件: null,\r\n                        適用条件: null\r\n                    });\r\n                });\r\n            }\r\n            if ('オプション初期値' in characterMaster) {\r\n                if (Object.keys(characterMaster['オプション初期値']).filter(s => s == '拡散').length == 0) {\r\n                    characterMaster['オプション初期値']['拡散'] = 1;\r\n                }\r\n            } else {\r\n                characterMaster['オプション初期値'] = { 拡散: 1 };\r\n            }\r\n        }\r\n\r\n        result[CHANGE_KIND_STATUS] = myStatusChangeDetailObjArr;\r\n        result[CHANGE_KIND_TALENT] = myTalentChangeDetailObjArr;\r\n\r\n        const conditionMap = new Map();\r\n        const exclusionMap = new Map();\r\n        myStatusChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        myTalentChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        // conditionMap.delete('命ノ星座');\r\n        conditionMap.forEach((value, key) => {\r\n            if (value && Array.isArray(value)) {\r\n                if (!value[0].startsWith('required_')) {\r\n                    conditionMap.set(key, ['', ...value]);\r\n                }\r\n            }\r\n        });\r\n        result['条件'] = conditionMap;\r\n        result['排他'] = exclusionMap;\r\n\r\n        characterInput.damageDetailMyCharacter = result;\r\n    } catch (error) {\r\n        console.error(characterInput, result);\r\n        // throw error;\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function makeDamageDetailObjArrObjWeapon(characterInput: any) {\r\n    const result = {} as any;\r\n    try {\r\n        const name = characterInput.weapon;\r\n        const weaponMaster = characterInput.weaponMaster;\r\n        if (!name || !weaponMaster) return result;\r\n\r\n        let myTalentDetail;\r\n        const myLevel = characterInput.武器精錬ランク;\r\n        const myInputCategory = '武器';\r\n\r\n        const myStatusChangeDetailObjArr = [] as any[];\r\n        const myTalentChangeDetailObjArr = [] as any[];\r\n\r\n        if ('武器スキル' in weaponMaster) {\r\n            myTalentDetail = weaponMaster['武器スキル'];\r\n            result['その他'] = makeDamageDetailObjArr(myTalentDetail, myLevel, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n        }\r\n\r\n        result[CHANGE_KIND_STATUS] = myStatusChangeDetailObjArr;\r\n        result[CHANGE_KIND_TALENT] = myTalentChangeDetailObjArr;\r\n\r\n        const conditionMap = new Map();\r\n        const exclusionMap = new Map();\r\n        myStatusChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            let condition = detailObj['条件'];\r\n            if (_.isPlainObject(condition) && myLevel in condition) {\r\n                condition = condition[myLevel];\r\n            }\r\n            makeConditionExclusionMapFromStr(condition, conditionMap, exclusionMap);\r\n        });\r\n        myTalentChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            let condition = detailObj['条件'];\r\n            if (_.isPlainObject(condition) && myLevel in condition) {\r\n                condition = condition[myLevel];\r\n            }\r\n            makeConditionExclusionMapFromStr(condition, conditionMap, exclusionMap);\r\n        });\r\n        conditionMap.forEach((value, key) => {\r\n            if (value && Array.isArray(value)) {\r\n                if (!value[0].startsWith('required_')) {\r\n                    conditionMap.set(key, ['', ...value]);\r\n                }\r\n            }\r\n        });\r\n        result['条件'] = conditionMap;\r\n        result['排他'] = exclusionMap;\r\n\r\n        characterInput.damageDetailMyWeapon = result;\r\n    } catch (error) {\r\n        console.error(characterInput, result);\r\n        // throw error;\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function makeDamageDetailObjArrObjArtifactSets(characterInput: any) {\r\n    const result = [] as any;\r\n    try {\r\n        let myTalentDetail;\r\n        const myInputCategory = '聖遺物セット効果';\r\n\r\n        const myStatusChangeDetailObjArr = [] as any[];\r\n        const myTalentChangeDetailObjArr = [] as any[];\r\n\r\n        const artifactSetMasters = characterInput.artifactSetMasters.filter((s: any) => s);\r\n\r\n        if (artifactSetMasters.length > 0) {\r\n            const damageDetailObjArr = [] as TDamageDetailObj[];\r\n            if ('2セット効果' in artifactSetMasters[0]) {\r\n                myTalentDetail = artifactSetMasters[0]['2セット効果'];\r\n                damageDetailObjArr.push(...makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory));\r\n            }\r\n            if (artifactSetMasters.length == 2) {\r\n                if (artifactSetMasters[0] == artifactSetMasters[1]) {\r\n                    myTalentDetail = artifactSetMasters[0]['4セット効果'];\r\n                    damageDetailObjArr.push(...makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory));\r\n                } else {\r\n                    myTalentDetail = artifactSetMasters[1]['2セット効果'];\r\n                    damageDetailObjArr.push(...makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory));\r\n                }\r\n            }\r\n            result['その他'] = damageDetailObjArr;\r\n        }\r\n\r\n        result[CHANGE_KIND_STATUS] = myStatusChangeDetailObjArr;\r\n        result[CHANGE_KIND_TALENT] = myTalentChangeDetailObjArr;\r\n\r\n        const conditionMap = new Map();\r\n        const exclusionMap = new Map();\r\n        myStatusChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        myTalentChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        conditionMap.forEach((value, key) => {\r\n            if (value && Array.isArray(value)) {\r\n                if (!value[0].startsWith('required_')) {\r\n                    conditionMap.set(key, ['', ...value]);\r\n                }\r\n            }\r\n        });\r\n        result['条件'] = conditionMap;\r\n        result['排他'] = exclusionMap;\r\n\r\n        characterInput.damageDetailMyArtifactSets = result;\r\n    } catch (error) {\r\n        console.error(characterInput, result);\r\n        // throw error;\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function makeDamageDetailObjArrObjElementalResonance(characterInput: any) {\r\n    const result = [] as any;\r\n    try {\r\n        const myInputCategory = '元素共鳴';\r\n        const damageDetailObjArr = [] as TDamageDetailObj[];\r\n        const myStatusChangeDetailObjArr = [] as any[];\r\n        const myTalentChangeDetailObjArr = [] as any[];\r\n        for (const myTalentDetail of ELEMENTAL_RESONANCE_MASTER_LIST) {\r\n            const workObj = _.cloneDeep(myTalentDetail);\r\n            if (workObj.詳細) {\r\n                workObj.詳細.forEach((detailObj: TAnyObject) => {\r\n                    detailObj.名前 = myTalentDetail.key;\r\n                });\r\n            }\r\n            damageDetailObjArr.push(...makeDamageDetailObjArr(workObj, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory));\r\n        }\r\n        result['その他'] = damageDetailObjArr;\r\n        result[CHANGE_KIND_STATUS] = myStatusChangeDetailObjArr;\r\n        result[CHANGE_KIND_TALENT] = myTalentChangeDetailObjArr;\r\n\r\n        const conditionMap = new Map();\r\n        const exclusionMap = new Map();\r\n        myStatusChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        myTalentChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        conditionMap.forEach((value, key) => {\r\n            if (value && Array.isArray(value)) {\r\n                if (!value[0].startsWith('required_')) {\r\n                    conditionMap.set(key, ['', ...value]);\r\n                }\r\n            }\r\n        });\r\n        result['条件'] = conditionMap;\r\n        result['排他'] = exclusionMap;\r\n\r\n        characterInput.damageDetailElementalResonance = result;\r\n    } catch (error) {\r\n        console.error(characterInput, result);\r\n        // throw error;\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction makeDetailObj(\r\n    detailObj: any,\r\n    level: number | null,\r\n    defaultKind: string | null,\r\n    defaultElement: string | null,\r\n    inputCategory: string | null,\r\n    opt_condition?: string,\r\n): TDamageDetailObj {\r\n    let my種類 = '種類' in detailObj ? detailObj['種類'] : defaultKind;\r\n    let my対象 = null;\r\n    if (my種類.indexOf('.') != -1) {\r\n        my対象 = my種類.substring(my種類.indexOf('.') + 1);\r\n        my種類 = my種類.substring(0, my種類.indexOf('.'));\r\n    } else if ('対象' in detailObj) {\r\n        my対象 = detailObj['対象'];\r\n    }\r\n    let my数値 = null;\r\n    if ('数値' in detailObj) {\r\n        my数値 = detailObj['数値'];\r\n        if (isNumber(my数値) || _.isString(my数値)) {\r\n            // nop\r\n        } else if (_.isPlainObject(my数値) && level && level in my数値) { // キャラクター|武器のサブステータス\r\n            my数値 = my数値[level];\r\n        } else {\r\n            console.error(detailObj, level, defaultKind, defaultElement, my数値);\r\n        }\r\n        if (DAMAGE_CATEGORY_ARRAY.includes(my種類 + 'ダメージ') || my種類.endsWith('ダメージ')) {\r\n            my数値 = analyzeFormulaStr(my数値, '攻撃力');\r\n        } else {\r\n            my数値 = analyzeFormulaStr(my数値, my種類);\r\n        }\r\n    }\r\n    let my条件 = null;\r\n    if ('条件' in detailObj) {\r\n        if (_.isPlainObject(detailObj['条件']) && level && level in detailObj['条件']) {  // 武器は精錬ランクによって数値を変えたいときがあるので\r\n            my条件 = detailObj['条件'][level];\r\n        } else {\r\n            my条件 = detailObj['条件'];\r\n        }\r\n    } else {\r\n        my条件 = opt_condition ?? null;\r\n    }\r\n    let my上限 = null;\r\n    if ('上限' in detailObj) {\r\n        my上限 = detailObj['上限'];\r\n        if (_.isPlainObject(my上限) && level && level in my上限) {   // 草薙の稲光\r\n            my上限 = my上限[level];\r\n        }\r\n        my上限 = analyzeFormulaStr(my上限);\r\n    }\r\n    let my下限 = null;\r\n    if ('下限' in detailObj) {  // ニィロウ\r\n        my下限 = detailObj['下限'];\r\n        if (_.isPlainObject(my下限) && level && level in my下限) {\r\n            my下限 = my下限[level];\r\n        }\r\n        my下限 = analyzeFormulaStr(my下限);\r\n    }\r\n    const resultObj: TDamageDetailObj = {\r\n        名前: detailObj['名前'],\r\n        種類: my種類,\r\n        元素: '元素' in detailObj ? detailObj['元素'] : defaultElement,\r\n        数値: my数値,\r\n        条件: my条件,\r\n        対象: my対象,\r\n        上限: my上限,\r\n        下限: my下限,\r\n        HIT数: 'HIT数' in detailObj ? detailObj['HIT数'] : null,\r\n        ダメージバフ: 'ダメージバフ' in detailObj ? detailObj['ダメージバフ'] : null,\r\n        元素付与無効: '元素付与無効' in detailObj ? detailObj['元素付与無効'] : inputCategory == '武器',\r\n        除外条件: '除外条件' in detailObj ? detailObj['除外条件'] : null,\r\n        適用条件: '適用条件' in detailObj ? detailObj['適用条件'] : null,\r\n    }\r\n    return resultObj;\r\n}\r\n\r\nexport function getChangeKind(kind: string) {\r\n    if (kind in ステータスTEMPLATE\r\n        || new RegExp('[自全].+(バフ|アップ)').exec(kind)\r\n        || ['その他ダメージアップ'].includes(kind)  // for 放浪者\r\n        || new RegExp('敵?[自全]元素耐性').exec(kind)\r\n        || ['別枠乗算', '回復量アップ'].includes(kind)\r\n        || ['敵防御力'].includes(kind)\r\n        || ['発動回数', '使用回数'].includes(kind)\r\n        || ['攻撃速度', '通常攻撃速度', '重撃速度', '移動速度'].includes(kind)\r\n        || kind.endsWith('継続時間')\r\n        || kind.endsWith('クールタイム')\r\n        || kind.endsWith('会心率')\r\n        || kind.endsWith('会心ダメージ')\r\n    ) {\r\n        return 'STATUS';\r\n    } else if (kind.endsWith('強化')\r\n        || kind.endsWith('付与')\r\n        || kind == '防御無視' ||\r\n        kind == '固有変数'\r\n    ) {   // ex.元素爆発強化,氷元素付与\r\n        return 'TALENT';\r\n    }\r\n    return undefined;\r\n}\r\n\r\nexport function makeDamageDetailObjArr(\r\n    talentDataObj: any,\r\n    level: number | null,\r\n    defaultKind: string | null,\r\n    defaultElement: string | null,\r\n    statusChangeDetailObjArr: any[],\r\n    talentChangeDetailObjArr: any[],\r\n    inputCategory: string,\r\n    opt_condition?: string,\r\n): TDamageDetailObj[] {\r\n    const resultArr = [] as any[];\r\n    if (!('詳細' in talentDataObj)) return resultArr;\r\n\r\n    talentDataObj['詳細'].forEach((detailObj: TAnyObject) => {\r\n        const resultObj = makeDetailObj(detailObj, level, defaultKind, defaultElement, inputCategory, opt_condition);\r\n        const my種類 = resultObj.種類 as string;\r\n        if (statusChangeDetailObjArr != null && getChangeKind(my種類) == 'STATUS') {\r\n            resultObj['元素'] = '元素' in detailObj ? detailObj['元素'] : null;\r\n            statusChangeDetailObjArr.push(resultObj);\r\n            return;\r\n        }\r\n        if (talentChangeDetailObjArr != null && getChangeKind(my種類) == 'TALENT') {\r\n            resultObj['元素'] = '元素' in detailObj ? detailObj['元素'] : null;\r\n            talentChangeDetailObjArr.push(resultObj);\r\n            return;\r\n        }\r\n        resultArr.push(resultObj);\r\n    });\r\n\r\n    return resultArr;\r\n}\r\n\r\nexport function makeTeamOptionDetailObjArr(\r\n    detailObjArr: any[],\r\n): TDamageDetailObj[] {\r\n    const resultArr = [] as any[];\r\n\r\n    detailObjArr.forEach((detailObj: { [x: string]: any; }) => {\r\n        const resultObj = makeDetailObj(detailObj, null, null, null, null);\r\n        if (resultObj) {\r\n            resultArr.push(resultObj);\r\n        }\r\n    });\r\n\r\n    return resultArr;\r\n}\r\n\r\n// 条件名\r\n// 条件名@prefix数値postfix\r\n// 条件名@prefix数値(From)-数値(To)postfix\r\n// 条件名@prefix数値1,数値2,数値3postfix\r\n// 条件名=prefix数値postfix\r\n// 条件名@文字列\r\n// 条件名=文字列\r\n// 条件名={min=数値|文字列,max=数値|文字列,step=数値}\r\n// OR条件   条件A|条件B\r\n// AND条件  条件A&条件B\r\n// 排他条件 条件A^条件B\r\nexport function makeConditionExclusionMapFromStr(\r\n    conditionStr: string,\r\n    conditionMap: Map<string, string[] | null | object>,\r\n    exclusionMap: Map<string, string[] | null>\r\n) {\r\n    // 排他条件を抽出します\r\n    let exclusionCond: string | null = null;\r\n    let myCondStrArr = conditionStr.split('^');\r\n    if (myCondStrArr.length > 1) {\r\n        exclusionCond = myCondStrArr[1];\r\n    }\r\n    const myCondStr = myCondStrArr[0];\r\n    if (myCondStr.indexOf('|') != -1) {\r\n        // OR条件 for 申鶴\r\n        myCondStrArr = myCondStr.split('|');\r\n        myCondStrArr.forEach((myCondStr: string) => {\r\n            makeConditionExclusionMapFromStrSub(myCondStr, conditionMap, exclusionMap, exclusionCond);\r\n        });\r\n    } else {\r\n        // AND条件\r\n        myCondStrArr = myCondStr.split('&');\r\n        myCondStrArr.forEach((myCondStr: string) => {\r\n            makeConditionExclusionMapFromStrSub(myCondStr, conditionMap, exclusionMap, exclusionCond);\r\n        });\r\n    }\r\n}\r\n\r\nexport const NUMBER_CONDITION_VALUE_RE = /^\\s*{.+}\\s*$/;\r\n\r\nfunction makeConditionExclusionMapFromStrSub(\r\n    conditionStr: string,\r\n    conditionMap: Map<string, string[] | null | object>,\r\n    exclusionMap: Map<string, string[] | null>,\r\n    exclusion: string | null\r\n) {\r\n    const myCondStrArr = conditionStr.split(/[@=]/);\r\n    const myName = myCondStrArr[0];\r\n    if (myCondStrArr.length == 1) {\r\n        pushToMapValueArray(conditionMap, myName, null);\r\n    } else if (myCondStrArr.length == 2) {\r\n        if (NUMBER_CONDITION_VALUE_RE.test(myCondStrArr[1])) {\r\n            try {\r\n                const workObj = JSON.parse(myCondStrArr[1]);\r\n                if ('min' in workObj) { // minは必須\r\n                    const conditionObj = {\r\n                        min: workObj.min,\r\n                        max: workObj.max,\r\n                        step: workObj.step,\r\n                    };\r\n                    pushToMapValueArray(conditionMap, myName, conditionObj);\r\n                } else {\r\n                    console.error(conditionStr, conditionMap, exclusionMap, exclusion);\r\n                }\r\n            } catch (error) {\r\n                console.error(error);\r\n                console.error(conditionStr, conditionMap, exclusionMap, exclusion);\r\n            }\r\n        } else if (myCondStrArr[1].indexOf(',') != -1) {\r\n            const re = new RegExp('([^0-9]*?)([\\\\+\\\\-0-9\\\\.,]+)(.*)');  // 表現可能:-10,+60%\r\n            const reRet = re.exec(myCondStrArr[1]);\r\n            if (reRet) {\r\n                const prefix = reRet[1];\r\n                const condValueArr = reRet[2].split(',');\r\n                const postfix = reRet[3];\r\n                condValueArr.forEach(value => {\r\n                    pushToMapValueArray(conditionMap, myName, prefix + value + postfix);\r\n                });\r\n            }\r\n        } else if (myCondStrArr[1].indexOf('-') != -1) {\r\n            const re = new RegExp('([^0-9\\\\.]*)(-?[0-9\\\\.]+)-(-?[0-9\\\\.]+)(.*)');   // 数値部に+は含められない。prefixには含められる。\r\n            const re2 = new RegExp('/([0-9\\\\.]+)(.*)');\r\n            const reRet = re.exec(myCondStrArr[1]);\r\n            if (reRet) {\r\n                const prefix = reRet[1];\r\n                const rangeStart = Number(reRet[2]);\r\n                const rangeEnd = Number(reRet[3]);\r\n                let step = rangeStart;\r\n                let postfix = reRet[4];\r\n                if (postfix) {\r\n                    const re2Ret = re2.exec(postfix);\r\n                    if (re2Ret) {\r\n                        step = Number(re2Ret[1]);\r\n                        postfix = re2Ret[2];\r\n                    }\r\n                }\r\n                step = step ? step : 1;\r\n                for (let i = rangeStart; i < rangeEnd; i = addDecimal(i, step, rangeEnd)) {\r\n                    pushToMapValueArray(conditionMap, myName, prefix + String(i) + postfix);\r\n                }\r\n                pushToMapValueArray(conditionMap, myName, prefix + String(rangeEnd) + postfix);\r\n            } else {\r\n                pushToMapValueArray(conditionMap, myName, myCondStrArr[1]);\r\n            }\r\n        } else {\r\n            pushToMapValueArray(conditionMap, myName, myCondStrArr[1]);\r\n        }\r\n    } else {\r\n        console.error(conditionStr, conditionMap, exclusionMap, exclusion);\r\n    }\r\n    if (exclusion) {\r\n        exclusion.split(',').forEach(e => {\r\n            pushToMapValueArray(exclusionMap, myName, e);\r\n        });\r\n    }\r\n}\r\n\r\nexport function setupConditionValues(\r\n    conditionInput: TConditionInput,\r\n    characterInput: TCharacterInput,\r\n    optionInput: TOptionInput,\r\n) {\r\n    try {\r\n        const conditionValues = conditionInput.conditionValues;\r\n        const checkboxList = conditionInput.checkboxList as TCheckboxEntry[];\r\n        const selectList = conditionInput.selectList as TSelectEntry[];\r\n        const numberList = conditionInput.numberList as TNumberEntry[];\r\n\r\n        checkboxList.splice(0, checkboxList.length);\r\n        selectList.splice(0, selectList.length);\r\n\r\n        const masters = [characterInput.characterMaster, characterInput.weaponMaster, ...characterInput.artifactSetMasters];\r\n        for (const master of masters.filter(s => s)) {\r\n            if ('オプション初期値' in master) {\r\n                for (const key of Object.keys((master as any)['オプション初期値'])) {\r\n                    if (!(key in conditionValues)) {\r\n                        conditionValues[key] = (master as any)['オプション初期値'][key];\r\n                    }\r\n                }\r\n            }\r\n            // 聖遺物セット効果のオプション初期値は変な位置にあります\r\n            if ('4セット効果' in master && 'オプション初期値' in (master as any)['4セット効果']) {\r\n                for (const key of Object.keys((master as any)['4セット効果']['オプション初期値'])) {\r\n                    if (!(key in conditionValues)) {\r\n                        conditionValues[key] = (master as any)['4セット効果']['オプション初期値'][key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        for (const myDamageDetail of [characterInput.damageDetailMyCharacter, characterInput.damageDetailMyWeapon, characterInput.damageDetailMyArtifactSets]) {\r\n            if (myDamageDetail) {\r\n                const conditionMap: Map<string, string[] | null | object> = myDamageDetail.条件;\r\n                const exclusionMap: Map<string, string[] | null> = myDamageDetail.排他;\r\n\r\n                conditionMap.forEach((value: string[] | null | object, key: string) => {\r\n                    if (value == null) {\r\n                        if (checkboxList.filter(s => s.name == key).length == 0) {\r\n                            checkboxList.push({ name: key });\r\n                        }\r\n                    } else if (Array.isArray(value)) {\r\n                        if (selectList.filter(s => s.name == key).length == 0) {\r\n                            const required = value[0].startsWith(\"required_\");\r\n                            selectList.push({\r\n                                name: key,\r\n                                options: value,\r\n                                required: required,\r\n                            });\r\n                        }\r\n                    } else if (_.isPlainObject(value)) {\r\n                        if (numberList.filter(s => s.name == key).length == 0) {\r\n                            const entry = {\r\n                                name: key,\r\n                                min: (value as any).min,\r\n                                max: (value as any).max,\r\n                                step: (value as any).step,\r\n                            };\r\n                            numberList.push(entry);\r\n                        }\r\n                    }\r\n                    if (key in conditionValues && conditionValues[key] != null) {\r\n                        const exclusions = exclusionMap.get(key);\r\n                        if (exclusions) {\r\n                            for (const exclusion of exclusions) {\r\n                                if (exclusion in conditionValues) {\r\n                                    const conditionValue = conditionMap.get(exclusion);\r\n                                    if (conditionValue === null) {  // checkbox\r\n                                        conditionValues[exclusion] = false;\r\n                                    } else if (Array.isArray(value)) {    // select\r\n                                        conditionValues[exclusion] = 0;\r\n                                    } else if (_.isPlainObject(value)) {    // number\r\n                                        const minValue = (value as any).min;\r\n                                        if (isNumber(minValue)) {\r\n                                            conditionValues[exclusion] = minValue;\r\n                                        } else {\r\n                                            conditionValues[exclusion] = 0;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (value === null) {   // checkbox\r\n                            let checked = true;\r\n                            const arr = exclusionMap.get(key);\r\n                            if (arr && arr.filter(s => conditionValues[s]).length > 0) {\r\n                                checked = false;\r\n                            }\r\n                            conditionValues[key] = checked;\r\n                        } else if (Array.isArray(value)) {   // select\r\n                            let selectedIndex = value.length - 1;\r\n                            const arr = exclusionMap.get(key);\r\n                            if (arr && arr.filter(s => conditionValues[s]).length > 0) {\r\n                                selectedIndex = 0;\r\n                            }\r\n                            conditionValues[key] = selectedIndex;\r\n                        } else if (_.isPlainObject(value)) {    // number\r\n                            const minValue = (value as any).min;\r\n                            if (isNumber(minValue)) {\r\n                                conditionValues[key] = minValue;\r\n                            } else {\r\n                                conditionValues[key] = 0;\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        if (optionInput.elementalResonance) {\r\n            const conditionMap: Map<string, any[] | null | object> = new Map();\r\n            const exclusionMap: Map<string, string[] | null> = new Map();\r\n            for (const key of Object.keys(ELEMENTAL_RESONANCE_MASTER)) {\r\n                if (!optionInput.elementalResonance.conditionValues[key]) continue;\r\n                const master = (ELEMENTAL_RESONANCE_MASTER as any)[key];\r\n                if (!master.詳細) continue;\r\n                for (const detailObj of master.詳細) {\r\n                    if (!detailObj.条件) continue;\r\n                    makeConditionExclusionMapFromStr(detailObj.条件, conditionMap, exclusionMap);\r\n                }\r\n            }\r\n            conditionMap.forEach((value: string[] | null | object, key: string) => {\r\n                if (value == null) {\r\n                    if (checkboxList.filter(s => s.name == key).length == 0) {\r\n                        checkboxList.push({ name: key });\r\n                    }\r\n                } else if (Array.isArray(value)) {\r\n                    if (selectList.filter(s => s.name == key).length == 0) {\r\n                        const required = value[0].startsWith(\"required_\");\r\n                        selectList.push({\r\n                            name: key,\r\n                            options: value,\r\n                            required: required,\r\n                        });\r\n                    }\r\n                }\r\n\r\n                if (key in conditionValues && conditionValues[key] != null) {\r\n                    const exclusions = exclusionMap.get(key);\r\n                    if (exclusions) {\r\n                        for (const exclusion of exclusions) {\r\n                            if (exclusion in conditionValues) {\r\n                                const conditionValue = conditionMap.get(exclusion);\r\n                                if (conditionValue === null) {  // checkbox\r\n                                    conditionValues[exclusion] = false;\r\n                                } else if (Array.isArray(value)) {    // select\r\n                                    conditionValues[exclusion] = 0;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (value === null) {   // checkbox\r\n                        let checked = true;\r\n                        const arr = exclusionMap.get(key);\r\n                        if (arr && arr.filter(s => conditionValues[s]).length > 0) {\r\n                            checked = false;\r\n                        }\r\n                        conditionValues[key] = checked;\r\n                    } else if (Array.isArray(value)) {   // select\r\n                        let selectedIndex = value.length - 1;\r\n                        const arr = exclusionMap.get(key);\r\n                        if (arr && arr.filter(s => conditionValues[s]).length > 0) {\r\n                            selectedIndex = 0;\r\n                        }\r\n                        conditionValues[key] = selectedIndex;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    } catch (error) {\r\n        console.error(conditionInput, characterInput);\r\n        // throw error;\r\n    }\r\n}\r\n\r\nexport function getStatValue(stat: string, statsObj: TStats) {\r\n    let result;\r\n    if (stat in statsObj) {\r\n        result = statsObj[stat];\r\n    } else {\r\n        const re = /(.+)X([0-7])$/;\r\n        const reRet = re.exec(stat);\r\n        if (reRet) {\r\n            if (reRet[1] in statsObj) {\r\n                result = statsObj[reRet[1]];\r\n                let n = Number(reRet[2]);\r\n                for (let i = 1; i <= 3; i++) {\r\n                    if ((n % 2) == 1) {\r\n                        const vStat: string = reRet[1] + 'V' + i;\r\n                        if (vStat in statsObj) {\r\n                            result -= statsObj[vStat];\r\n                        }\r\n                    }\r\n                    n = Math.trunc(n / 2);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (result === undefined) {\r\n        console.warn(stat, statsObj); // キャラクターが切り替わったときとかによく引っ掛かる\r\n        result = 0; // fixed\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function updateNumberConditionValues(\r\n    conditionInput: TConditionInput,\r\n    characterInput: TCharacterInput,\r\n    statsObj: TStats,\r\n) {\r\n    for (const myDamageDetail of [characterInput.damageDetailMyCharacter, characterInput.damageDetailMyWeapon, characterInput.damageDetailMyArtifactSets]) {\r\n        if (myDamageDetail) {\r\n            const conditionMap: Map<string, string[] | null | object> = myDamageDetail.条件;\r\n            conditionMap.forEach((value: string[] | null | object, key: string) => {\r\n                if (_.isPlainObject(value)) {\r\n                    const numberEntryArr = conditionInput.numberList.filter(s => s.name == key);\r\n                    if (numberEntryArr.length > 0) {\r\n                        let minValue = (value as any).min;\r\n                        let maxValue = (value as any).max;\r\n                        if (_.isString(minValue) || _.isString(maxValue)) {\r\n                            if (_.isString(minValue)) {\r\n                                minValue = getStatValue(minValue, statsObj);\r\n                            }\r\n                            if (_.isString(maxValue)) {\r\n                                maxValue = getStatValue(maxValue, statsObj);\r\n                            }\r\n                            numberEntryArr[0].min = minValue;\r\n                            numberEntryArr[0].max = maxValue;\r\n                            if (key in conditionInput.conditionValues) {\r\n                                const value = conditionInput.conditionValues[key];\r\n                                if (_.isNumber(value)) {\r\n                                    if (value < minValue) {\r\n                                        conditionInput.conditionValues[key] = minValue;\r\n                                    } else if (maxValue !== undefined && value > maxValue) {\r\n                                        conditionInput.conditionValues[key] = maxValue;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nfunction pushToMapValueArray(map: Map<any, any>, key: any, value: any) {\r\n    if (value == null) {    // checkbox\r\n        if (!map.has(key)) {\r\n            map.set(key, null);\r\n        }\r\n    } else if (_.isString(value)) { // select\r\n        if (map.has(key)) {\r\n            const oldValue = map.get(key);\r\n            if (oldValue == null) {\r\n                map.set(key, [value]);\r\n            } else if (Array.isArray(oldValue)) {\r\n                if (!oldValue.includes(value)) {\r\n                    map.get(key).push(value);\r\n                }\r\n            } else {\r\n                console.error(map, key, value);\r\n            }\r\n        } else {\r\n            map.set(key, [value]);\r\n        }\r\n    } else if (_.isPlainObject(value)) {    // number\r\n        map.set(key, value);\r\n    }\r\n}\r\n\r\nfunction getDecimalLength(value: number): number {\r\n    const arr = ('' + value).split('.');\r\n    return arr.length > 1 ? arr[1].length : 0;\r\n}\r\n\r\nexport function multiplyDecimal(value1: number, value2: number): number {\r\n    const decimalLength = getDecimalLength(value1) + getDecimalLength(value2);\r\n    const intValue1 = Number(('' + value1).replace('.', ''));\r\n    const intValue2 = Number(('' + value2).replace('.', ''));\r\n    const result = (intValue1 * intValue2) / Math.pow(10, decimalLength);\r\n    return Number(result);\r\n}\r\n\r\nexport function addDecimal(value1: number, value2: number, opt_max?: number): number {\r\n    const k = Math.pow(10, Math.max(getDecimalLength(value1), getDecimalLength(value2)));\r\n    let result = (multiplyDecimal(value1, k) + multiplyDecimal(value2, k)) / k;\r\n    if (opt_max != undefined) {\r\n        result = Math.min(result, opt_max);\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction analyzeFormulaStr(\r\n    formulaStr: number | string,\r\n    opt_defaultItem: string | null = null\r\n) {\r\n    const resultArr = [] as any[];\r\n    const re = new RegExp('([\\\\+\\\\-\\\\*/]?)([^\\\\+\\\\-\\\\*/]+)(.*)');\r\n    let workStr = String(formulaStr);\r\n    // eslint-disable-next-line no-constant-condition\r\n    while (true) {\r\n        const reRet = re.exec(workStr);\r\n        if (!reRet) {\r\n            resultArr.push(workStr);\r\n            break;\r\n        }\r\n        if (reRet[1]) { // + - * /\r\n            resultArr.push(reRet[1]);\r\n        }\r\n        resultArr.push(analyzeFormulaStrSub(reRet[2], opt_defaultItem));\r\n        if (!reRet[3]) {\r\n            break;\r\n        }\r\n        workStr = reRet[3];\r\n    }\r\n    return resultArr;\r\n}\r\n\r\nfunction analyzeFormulaStrSub(\r\n    formulaStr: string,\r\n    opt_defaultItem: string | null = null\r\n) {\r\n    const resultArr = [] as any;\r\n    if (isNumber(formulaStr)) {\r\n        resultArr.push(Number(formulaStr));\r\n    } else {\r\n        const strArr = (formulaStr as string).split('%');\r\n        if (strArr.length == 1) {\r\n            resultArr.push(strArr[0]);\r\n        } else {\r\n            resultArr.push(Number(strArr[0]) / 100);\r\n            resultArr.push('*');\r\n            if (strArr[1].length > 0) {\r\n                resultArr.push(strArr[1]);\r\n            } else if (opt_defaultItem != null) {\r\n                resultArr.push(opt_defaultItem);\r\n            }\r\n        }\r\n    }\r\n    return resultArr;\r\n}\r\n\r\nexport function makeSharedata(savedata: TAnyObject) {\r\n    const sharedataArr = [] as any[];\r\n\r\n    let character: TCharacterKey;\r\n    let weaponType: TWeaponTypeKey;\r\n\r\n    キャラクター構成PROPERTY_MAP.forEach((value, key) => {\r\n        let newValue = savedata[key];\r\n        let myBasename;\r\n        switch (key) {\r\n            case 'キャラクター':\r\n                character = newValue as TCharacterKey;\r\n                myBasename = basename(CHARACTER_MASTER[character]['import']);\r\n                newValue = myBasename.split('_')[myBasename.split('_').length - 1];\r\n                break;\r\n            case '武器':\r\n                weaponType = CHARACTER_MASTER[character]['武器'] as TWeaponTypeKey;\r\n                myBasename = basename((WEAPON_MASTER as any)[weaponType][newValue]['import']);\r\n                newValue = myBasename.split('_')[myBasename.split('_').length - 1];\r\n                break;\r\n            case '聖遺物セット効果1':\r\n            case '聖遺物セット効果2':\r\n                if (newValue == 'NONE') {\r\n                    newValue = '';  // 聖遺物セット効果なし\r\n                } else {\r\n                    myBasename = basename(ARTIFACT_SET_MASTER[newValue as TArtifactSetKey]['image']);\r\n                    newValue = myBasename.split('_')[myBasename.split('_').length - 1];\r\n                }\r\n                break;\r\n            case '聖遺物メイン効果1':\r\n            case '聖遺物メイン効果2':\r\n            case '聖遺物メイン効果3':\r\n            case '聖遺物メイン効果4':\r\n            case '聖遺物メイン効果5':\r\n                if (newValue) {\r\n                    newValue = newValue.split('_')[0] + '_' + ARTIFACT_STAT_JA_EN_ABBREV_MAP.get(newValue.split('_')[1]);\r\n                }\r\n                break;\r\n        }\r\n        if (key.match(/^聖遺物優先するサブ効果\\d$/)) {\r\n            if (newValue) {\r\n                newValue = ARTIFACT_STAT_JA_EN_ABBREV_MAP.get(newValue);\r\n            }\r\n        }\r\n        sharedataArr.push(newValue);\r\n    });\r\n    Object.keys(savedata).forEach(key => {\r\n        if (!キャラクター構成PROPERTY_MAP.has(key)) {\r\n            sharedataArr.push(key + '=' + savedata[key]);\r\n        }\r\n    });\r\n\r\n    return sharedataArr.join(',');\r\n}\r\n\r\nfunction openTwitter(text: string, url: string, opt_hashtags?: string, opt_via?: string) {\r\n    const baseUrl = 'https://twitter.com/intent/tweet?';\r\n    const params = new URLSearchParams();\r\n    params.append('text', text);\r\n    params.append('url', url);\r\n    if (opt_hashtags) {\r\n        params.append('hashtags', opt_hashtags);\r\n    }\r\n    if (opt_via) {\r\n        params.append('via', opt_via);\r\n    }\r\n    const query = params.toString();\r\n    const shareUrl = `${baseUrl}${query}`;\r\n    console.log(params);\r\n    console.log(shareUrl);\r\n    window.open(shareUrl);\r\n}\r\n\r\nexport function shareByTwitter(\r\n    characterInput: TCharacterInput,\r\n    artifactDetailInput: TArtifactDetailInput,\r\n    conditionInput: TConditionInput\r\n) {\r\n    const savedata = makeSavedata(characterInput, artifactDetailInput, conditionInput);\r\n    const sharedata = makeSharedata(savedata);\r\n\r\n    const text = characterInput.buildname;\r\n    const encoded = encodeURI(sharedata);\r\n    const url = 'https://asagume.github.io/gencalc/' + '?allin=' + encoded;\r\n\r\n    openTwitter(text, url);\r\n}\r\n\r\nexport function getMaxConstellation(characterMaster: TCharacterDetail) {\r\n    let max = 0;\r\n    if ('命ノ星座' in characterMaster) {\r\n        max = Object.keys(characterMaster.命ノ星座).length;\r\n    }\r\n    return max;\r\n}\r\n\r\nexport function getMaxTalentLevel(characterMaster: TCharacterDetail, key: string) {\r\n    let max = 10;\r\n    if (key in characterMaster) {\r\n        const talentObj = (characterMaster as any)[key];\r\n        if (\"詳細\" in talentObj) {\r\n            for (const detailObj of talentObj.詳細) {\r\n                if (\"数値\" in detailObj && _.isPlainObject(detailObj.数値)) {\r\n                    const work = Object.keys(detailObj.数値).length;\r\n                    if (max < work) max = work;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return max;\r\n}\r\n\r\nexport function pushBuildinfoToSession(character: TCharacterKey | string, buildname?: string, builddata?: any, teammembers?: string[]) {\r\n    sessionStorage.setItem('character', character);\r\n    if (buildname) {\r\n        sessionStorage.setItem('buildname', buildname);\r\n    }\r\n    if (builddata) {\r\n        sessionStorage.setItem('builddata', JSON.stringify(builddata));\r\n    }\r\n    if (teammembers) {\r\n        sessionStorage.setItem('teammembers', JSON.stringify(teammembers));\r\n    }\r\n}\r\n\r\nexport function popBuildinfoFromSession() {\r\n    const result: [string | undefined, string | undefined, TAnyObject | undefined, string[] | undefined] = [undefined, undefined, undefined, undefined];\r\n    const character = sessionStorage.getItem('character');\r\n    if (character) {\r\n        result[0] = character;\r\n        const buildname = sessionStorage.getItem('buildname');\r\n        if (buildname) {\r\n            result[1] = buildname;\r\n        }\r\n        const builddata = sessionStorage.getItem('builddata');\r\n        if (builddata) {\r\n            result[2] = JSON.parse(builddata);\r\n        }\r\n        const teammembers = sessionStorage.getItem('teammembers');\r\n        if (teammembers) {\r\n            result[3] = JSON.parse(teammembers);\r\n        }\r\n        console.log(character, buildname, builddata, teammembers);\r\n    }\r\n    sessionStorage.removeItem('character');\r\n    sessionStorage.removeItem('builddata');\r\n    sessionStorage.removeItem('buildname');\r\n    sessionStorage.removeItem('teammembers');\r\n    return result;\r\n}\r\n\r\nexport async function updateConditionsByTeam(\r\n    characterInput: TCharacterInput,\r\n    conditionInput: TConditionInput,\r\n    optionInput: TOptionInput,\r\n) {\r\n    const character = characterInput.character;\r\n    const teamMembers: string[] = [character];\r\n    if (optionInput?.teamMembers) {\r\n        teamMembers.push(...optionInput.teamMembers.filter(s => s && s != character));\r\n    }\r\n    const myVision = CHARACTER_MASTER[character as TCharacterKey].元素;\r\n\r\n    // [チーム]*出身キャラクター, [チーム]*以外出身キャラクター\r\n    const regionCountMap = new Map<string, number>();\r\n    // [チーム]元素エネルギー上限の合計\r\n    let totalEnergyCost = 0;\r\n    // Map<元素, キャラクターの数>\r\n    const visionCountMap = new Map<string, number>();\r\n    for (const entry of teamMembers) {\r\n        const characterDetail = await getCharacterMasterDetail(entry as TCharacterKey);\r\n        if (characterDetail.region) {\r\n            const count = regionCountMap.get(characterDetail.region);\r\n            if (count) {\r\n                regionCountMap.set(characterDetail.region, count + 1);\r\n            } else {\r\n                regionCountMap.set(characterDetail.region, 1);\r\n            }\r\n        }\r\n        if ('元素エネルギー' in characterDetail.元素爆発) {\r\n            totalEnergyCost += characterDetail.元素爆発.元素エネルギー;\r\n        }\r\n        if (characterDetail.元素) {\r\n            const count = visionCountMap.get(characterDetail.元素);\r\n            if (count) {\r\n                visionCountMap.set(characterDetail.元素, count + 1);\r\n            } else {\r\n                visionCountMap.set(characterDetail.元素, 1);\r\n            }\r\n        }\r\n    }\r\n    regionCountMap.forEach((value, key) => {\r\n        conditionInput.conditionValues['[チーム]' + key + '出身キャラクター'] = value;\r\n        conditionInput.conditionValues['[チーム]' + key + '以外出身キャラクター'] = teamMembers.length - value;\r\n    })\r\n    if (totalEnergyCost) {\r\n        conditionInput.conditionValues['[チーム]元素エネルギー上限の合計'] = totalEnergyCost;\r\n    }\r\n    visionCountMap.forEach((value, key) => {\r\n        conditionInput.conditionValues['[チーム]' + key + '元素キャラクター'] = value;\r\n        conditionInput.conditionValues['[チーム]' + key + '元素以外キャラクター'] = teamMembers.length - value;\r\n        if (key == myVision) {\r\n            conditionInput.conditionValues['[チーム]同じ元素のキャラクター'] = value - 1;\r\n            conditionInput.conditionValues['[チーム]異なる元素のキャラクター'] = teamMembers.length - value;\r\n        }\r\n    })\r\n    conditionInput.conditionValues['[チーム]キャラクターの元素タイプ'] = visionCountMap.size - 1; // requiredなので1減らします\r\n}\r\n\r\nexport async function updateOptionsElementalResonanceByTeam(\r\n    characterInput: TCharacterInput,\r\n    optionInput: TOptionInput,\r\n) {\r\n    const character = characterInput.character;\r\n    const teamMembers: string[] = [character];\r\n    if (optionInput?.teamMembers) {\r\n        teamMembers.push(...optionInput.teamMembers.filter(s => s && s != character));\r\n    }\r\n\r\n    const visionCountMap = new Map<string, number>();\r\n    for (const entry of teamMembers) {\r\n        const characterDetail = await getCharacterMasterDetail(entry as TCharacterKey);\r\n        if (characterDetail.元素) {\r\n            const count = visionCountMap.get(characterDetail.元素);\r\n            if (count) {\r\n                visionCountMap.set(characterDetail.元素, count + 1);\r\n            } else {\r\n                visionCountMap.set(characterDetail.元素, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    // 元素共鳴を調整します\r\n    const newElementResonance: TConditionValues = {};\r\n    const resonanceElementArr: string[] = [];\r\n    const restMemberElementArr: string[] = [];\r\n    visionCountMap.forEach((value, key) => {\r\n        if (value >= 2) {\r\n            resonanceElementArr.push(key);\r\n        } else if (value == 1) {\r\n            restMemberElementArr.push(key);\r\n        }\r\n    })\r\n    if (optionInput.teamMembers.length == 3) {\r\n        if (resonanceElementArr.length > 1) {\r\n            newElementResonance[resonanceElementArr[0] + '元素共鳴'] = true;\r\n            newElementResonance[resonanceElementArr[1] + '元素共鳴'] = true;\r\n        } else if (resonanceElementArr.length > 0) {\r\n            newElementResonance[resonanceElementArr[0] + '元素共鳴'] = true;\r\n        } else {\r\n            newElementResonance['元素共鳴なし'] = true;\r\n        }\r\n    } else if (resonanceElementArr.length > 0) {\r\n        const tempArr: string[] = [resonanceElementArr[0] + '元素共鳴'];\r\n        const currentElementArr = Object.keys(optionInput.elementalResonance.conditionValues).filter(s => optionInput.elementalResonance.conditionValues[s] && s != '元素共鳴なし').map(s => s.replace(/元素共鳴$/, ''));\r\n        currentElementArr.forEach(element => {\r\n            if (restMemberElementArr.includes(element)) {\r\n                tempArr.push(element + '元素共鳴');\r\n            }\r\n        });\r\n        if (tempArr.length < 2) {\r\n            ALL_ELEMENTS.forEach(element => {\r\n                const resonance = element + '元素共鳴';\r\n                if (optionInput.elementalResonance.conditionValues[resonance]) {\r\n                    if (!tempArr.includes(resonance)) {\r\n                        tempArr.push(resonance);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        tempArr.forEach(resonance => {\r\n            newElementResonance[resonance] = true;\r\n        })\r\n    }\r\n    if (!_.isEqual(newElementResonance, optionInput.elementalResonance.conditionValues)) {\r\n        overwriteObject(optionInput.elementalResonance.conditionValues, newElementResonance);\r\n        return true;\r\n    }\r\n    return false;\r\n}","export type TAnyObject = {\r\n    [key: string]: any\r\n}\r\n\r\nimport CHARACTER_MASTER from '../public/data/CharacterMaster.json'// assert {type: 'json'}\r\n\r\nimport SWORD_MASTER from '../public/data/SwordMaster.json'// assert {type: 'json'}\r\nimport CLAYMORE_MASTER from '../public/data/ClaymoreMaster.json'// assert {type: 'json'}\r\nimport POLEARM_MASTER from '../public/data/PolearmMaster.json'// assert {type: 'json'}\r\nimport BOW_MASTER from '../public/data/BowMaster.json'// assert {type: 'json'}\r\nimport CATALYST_MASTER from '../public/data/CatalystMaster.json'// assert {type: 'json'}\r\n\r\nimport ARTIFACT_SET_MASTER from '../public/data/ArtifactSetMaster.json'// assert {type: 'json'}\r\nimport ARTIFACT_MAIN_MASTER from '../public/data/ArtifactMainMaster.json'// assert {type: 'json'}\r\nimport ARTIFACT_SUB_MASTER from '../public/data/ArtifactSubMaster.json'// assert {type: 'json'}\r\n\r\nimport ENEMY_MASTER from '../public/data/EnemyMaster.json'// assert {type: 'json'}\r\n\r\nimport ELEMENTAL_RESONANCE_MASTER from '../public/data/ElementalResonanceMaster.json'// assert {type: 'json'}\r\nimport TEAM_OPTION_MASTER from '../public/data/TeamOptionMaster.json'// assert {type: 'json'}\r\nimport OPTION1_MASTER from '../public/data/OptionMaster1.json'// assert {type: 'json'}\r\nimport OPTION2_MASTER from '../public/data/OptionMaster2.json'// assert {type: 'json'}\r\n\r\nimport ELEMENTAL_REACTION_MASTER from '../public/data/ElementalReactionMaster.json'// assert {type: 'json'}\r\n\r\n// import HOYO_DICTIONARY2 from '../public/data/HoYoDictionary2.json'// assert {type: 'json'}\r\n// import HOYO_DICTIONARY4 from '../public/data/HoYoDictionary4.json'// assert {type: 'json'}\r\n// import HOYO_DICTIONARY5 from '../public/data/HoYoDictionary5.json'// assert {type: 'json'}\r\n// import LOCAL_DICTIONARY from '../public/data/LocalDictionary.json'// assert {type: 'json'}\r\n// import { isPlainObject, isString } from './common'\r\n\r\nexport {\r\n    CHARACTER_MASTER,\r\n    ARTIFACT_SET_MASTER,\r\n    ARTIFACT_MAIN_MASTER,\r\n    ARTIFACT_SUB_MASTER,\r\n    ENEMY_MASTER,\r\n    ELEMENTAL_RESONANCE_MASTER,\r\n    TEAM_OPTION_MASTER,\r\n    OPTION1_MASTER,\r\n    OPTION2_MASTER,\r\n    ELEMENTAL_REACTION_MASTER\r\n};\r\n\r\n// function removeStrFromUrl(obj: any, str: string) {\r\n//     if (isPlainObject(obj)) {\r\n//         for (const key of Object.keys(obj)) {\r\n//             if (isString(obj[key])) {\r\n//                 obj[key] = obj[key].replace(str, '');\r\n//             } else if (isPlainObject(obj[key])) {\r\n//                 removeStrFromUrl(obj[key], str);\r\n//             } else if (Array.isArray(obj[key])) {\r\n//                 for (const entry of obj[key]) {\r\n//                     removeStrFromUrl(entry, str);\r\n//                 }\r\n//             }\r\n//         }\r\n//     }\r\n// }\r\n\r\n// for (const master of [\r\n//     CHARACTER_MASTER,\r\n//     SWORD_MASTER,\r\n//     CLAYMORE_MASTER,\r\n//     POLEARM_MASTER,\r\n//     BOW_MASTER,\r\n//     CATALYST_MASTER,\r\n//     ARTIFACT_SET_MASTER\r\n// ]) {\r\n//     for (const key of Object.keys(master)) {\r\n//         removeStrFromUrl((master as any)[key], '');\r\n//     }\r\n// }\r\n\r\nexport const IMG_SRC_DUMMY = \"data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7\";\r\n\r\nexport type TVisionKey = '炎' | '水' | '風' | '雷' | '草' | '氷' | '岩';\r\nexport type TWeaponTypeKey = '片手剣' | '両手剣' | '長柄武器' | '弓' | '法器';\r\n\r\nexport type TCharacterMaster = typeof CHARACTER_MASTER;\r\nexport type TCharacter = {\r\n    レアリティ: 4 | 5,\r\n    元素: TVisionKey,\r\n    武器: TWeaponTypeKey,\r\n    誕生日?: string,\r\n    import: string,\r\n}\r\nexport type TCharacterKey = keyof typeof CHARACTER_MASTER\r\nexport type TCharacterEntry = TCharacter & {\r\n    key: TCharacterKey,\r\n    icon_url: string,\r\n}\r\n\r\nexport type TCharacterDetail = {\r\n    名前: TCharacterKey,\r\n    説明: string,\r\n    icon_url: string,\r\n    レアリティ: 4 | 5,\r\n    武器: TWeaponTypeKey,\r\n    元素: TVisionKey,\r\n    baseInfo: any,\r\n    region?: string,\r\n    ステータス: TCharacterStats,\r\n    通常攻撃: any,\r\n    重撃: any,\r\n    落下攻撃: any,\r\n    元素スキル: any,\r\n    元素爆発: any,\r\n    固有天賦: any[],\r\n    命ノ星座?: any,\r\n    特殊通常攻撃?: any,\r\n    特殊重撃?: any,\r\n    特殊落下攻撃?: any,\r\n    その他天賦?: any,\r\n    チームバフ?: any[],\r\n    オプション初期値?: any,\r\n    固有変数?: any,\r\n    おすすめセット: any[],\r\n    'NEXT STEP'?: string,\r\n}\r\nexport type TCharacterStats = {\r\n    基礎HP: {\r\n        [key: string]: number,\r\n    },\r\n    基礎攻撃力: {\r\n        [key: string]: number,\r\n    },\r\n    基礎防御力: {\r\n        [key: string]: number,\r\n    },\r\n    [key: string]: {\r\n        [key: string]: number,\r\n    }\r\n};\r\nexport type TLeveldValue = {\r\n    [key: number | string]: number,\r\n};\r\nexport type TTalentFormula = number | string | TLeveldValue;\r\nexport type TCharacterTalent = {\r\n    名前?: string,\r\n    詳細?: {\r\n        名前?: string,\r\n        種類?: string,\r\n        対象?: string,\r\n        条件?: string,\r\n    }[],\r\n    [key: string]: string | number | any[] | undefined,\r\n};\r\n\r\nexport type TWeaponRarity = 1 | 2 | 3 | 4 | 5;\r\nexport type TWeaponStats = {\r\n    基礎攻撃力: any,\r\n    [key: string]: any,\r\n}\r\nexport type TWeapon = {\r\n    レアリティ: TWeaponRarity,\r\n    import: string,\r\n}\r\nexport type TSwordKey = keyof typeof SWORD_MASTER;\r\nexport type TClaymoreKey = keyof typeof CLAYMORE_MASTER;\r\nexport type TPolearmKey = keyof typeof POLEARM_MASTER;\r\nexport type TBowKey = keyof typeof BOW_MASTER;\r\nexport type TCatalystKey = keyof typeof CATALYST_MASTER;\r\nexport type TWeaponKey = TSwordKey | TClaymoreKey | TPolearmKey | TBowKey | TCatalystKey;\r\nexport type TWeaponEntry = TWeapon & {\r\n    key: TWeaponKey,\r\n    icon_url: string,\r\n};\r\nexport const WEAPON_DETAIL_TEMPLATE = {\r\n    名前: '西風猟弓',\r\n    説明: '',\r\n    icon_url: IMG_SRC_DUMMY,\r\n    レアリティ: 4,\r\n    種類: '弓',\r\n    ステータス: {\r\n        基礎攻撃力: {}\r\n    },\r\n};\r\nexport type TWeaponDetail = {\r\n    名前: TWeaponKey,\r\n    説明: string,\r\n    icon_url: string,\r\n    レアリティ: TWeaponRarity,\r\n    種類: TWeaponTypeKey,\r\n    ステータス: TWeaponStats,\r\n    武器スキル?: any,\r\n    チームバフ?: any[],\r\n    オプション初期値?: any,\r\n    固有変数?: any,\r\n};\r\n\r\nexport type TArtifactSetEffect = {\r\n    説明: string,\r\n    詳細?: any[]\r\n};\r\nexport type TArtifactSetRarity = 1 | 2 | 3 | 4 | 5;\r\nexport type TArtifactSet = {\r\n    レアリティ: TArtifactSetRarity,\r\n    image: string,\r\n    '2セット効果'?: TArtifactSetEffect,\r\n    '4セット効果'?: TArtifactSetEffect,\r\n    オプション初期値?: { [key: string]: boolean | number },\r\n    artifact_list?: string[],\r\n};\r\nexport type TArtifactSetKey = keyof typeof ARTIFACT_SET_MASTER;\r\nexport type TArtifactSetEntry = TArtifactSet & {\r\n    key: TArtifactSetKey,\r\n    icon_url: string,\r\n};\r\n\r\nexport type TArtifactMainStat = keyof typeof ARTIFACT_MAIN_MASTER[5]\r\nexport type TArtifactMainRarity = 4 | 5;\r\nexport type TArtifactMain = {\r\n    5: TArtifactMainStat,\r\n    4: TArtifactMainStat,\r\n};\r\n\r\nfunction getIconUrl(master: TAnyObject) {\r\n    let result = null;\r\n    if (master.icon_url) {\r\n        result = master.icon_url;\r\n    } else if (master.image) {\r\n        result = master.image;\r\n    } else if (master.import) {\r\n        result = master.import.replace('data/', 'images/');\r\n        if (result.indexOf('characters/') != -1) {\r\n            result = result.replace('characters/', 'characters/face/');\r\n        }\r\n        result = result.replace(/json$/, 'png');\r\n    }\r\n    return result;\r\n}\r\n\r\nexport const CHARACTER_MASTER_LIST: TCharacterEntry[] = [];\r\n(Object.keys(CHARACTER_MASTER) as TCharacterKey[]).forEach(key => {\r\n    const master: any = CHARACTER_MASTER[key];\r\n    master.key = key;\r\n    master.icon_url = getIconUrl(master);\r\n    CHARACTER_MASTER_LIST.push(master);\r\n});\r\n\r\nexport const WEAPON_MASTER = {\r\n    片手剣: SWORD_MASTER,\r\n    両手剣: CLAYMORE_MASTER,\r\n    長柄武器: POLEARM_MASTER,\r\n    弓: BOW_MASTER,\r\n    法器: CATALYST_MASTER,\r\n};\r\n(Object.keys(WEAPON_MASTER) as TWeaponTypeKey[]).forEach(key2 => {\r\n    const typedMaster = WEAPON_MASTER[key2] as any; // お手上げ\r\n    Object.keys(typedMaster).forEach(key => {\r\n        const master = typedMaster[key];\r\n        master.key = key;\r\n        master.icon_url = getIconUrl(master);\r\n    });\r\n})\r\nconst SWORD_MASTER_LIST = (Object.keys(SWORD_MASTER) as TSwordKey[]).map(key => SWORD_MASTER[key]);\r\nconst CLAYMORE_MASTER_LIST = (Object.keys(CLAYMORE_MASTER) as TClaymoreKey[]).map(key => CLAYMORE_MASTER[key]);\r\nconst POLEARM_MASTER_LIST = (Object.keys(POLEARM_MASTER) as TPolearmKey[]).map(key => POLEARM_MASTER[key]);\r\nconst BOW_MASTER_LIST = (Object.keys(BOW_MASTER) as TBowKey[]).map(key => BOW_MASTER[key]);\r\nconst CATALYST_MASTER_LIST = (Object.keys(CATALYST_MASTER) as TCatalystKey[]).map(key => CATALYST_MASTER[key]);\r\nexport const WEAPON_MASTER_LIST = {\r\n    片手剣: SWORD_MASTER_LIST,\r\n    両手剣: CLAYMORE_MASTER_LIST,\r\n    長柄武器: POLEARM_MASTER_LIST,\r\n    弓: BOW_MASTER_LIST,\r\n    法器: CATALYST_MASTER_LIST,\r\n};\r\n\r\nexport const ARTIFACT_SET_MASTER_LIST: TArtifactSetEntry[] = [];\r\n(Object.keys(ARTIFACT_SET_MASTER) as TArtifactSetKey[]).forEach(key => {\r\n    const master = ARTIFACT_SET_MASTER[key] as any;\r\n    master.key = key;\r\n    master.icon_url = getIconUrl(master);\r\n    ARTIFACT_SET_MASTER_LIST.push(master);\r\n});\r\n\r\nexport const ARTIFACT_MAIN_MASTER_STATLIST: string[] = Object.keys(ARTIFACT_MAIN_MASTER[5]);\r\n\r\nexport const ARTIFACT_SUB_MASTER_STATLIST = Object.keys(ARTIFACT_SUB_MASTER);\r\nexport type TArtifactSubKey = keyof typeof ARTIFACT_SUB_MASTER;\r\n\r\nexport type TEnemy = {\r\n    炎元素耐性: number,\r\n    水元素耐性: number,\r\n    風元素耐性: number,\r\n    雷元素耐性: number,\r\n    草元素耐性: number,\r\n    氷元素耐性: number,\r\n    岩元素耐性: number,\r\n    物理耐性: number,\r\n    [key: string]: number,\r\n};\r\nexport type TEnemyKey = keyof typeof ENEMY_MASTER;\r\nexport type TEnemyEntry = TEnemy & {\r\n    key: TEnemyKey,\r\n};\r\nfor (const key of Object.keys(ENEMY_MASTER)) {\r\n    for (const stat of Object.keys((ENEMY_MASTER as any)[key])) {\r\n        if ((ENEMY_MASTER as any)[key][stat] >= 1000) { // 完全耐性\r\n            (ENEMY_MASTER as any)[key][stat] = Infinity;\r\n        }\r\n    }\r\n}\r\nexport const ENEMY_MASTER_LIST = (Object.keys(ENEMY_MASTER) as TEnemyKey[])\r\n    .map(key => ({ key: key, ...ENEMY_MASTER[key] }));\r\n\r\nexport type TElementalResonanceKey = keyof typeof ELEMENTAL_RESONANCE_MASTER;\r\nexport const ELEMENTAL_RESONANCE_MASTER_LIST = (Object.keys(ELEMENTAL_RESONANCE_MASTER) as TElementalResonanceKey[])\r\n    .map(key => ({ key: key, ...ELEMENTAL_RESONANCE_MASTER[key] }));\r\n\r\nexport type TTeamOptionKey = keyof typeof TEAM_OPTION_MASTER;\r\nexport const TEAM_OPTION_MASTER_LIST = (Object.keys(TEAM_OPTION_MASTER) as TTeamOptionKey[])\r\n    .map(key => ({ key: key, ...TEAM_OPTION_MASTER[key] }));\r\n\r\nexport type TOption1Key = keyof typeof OPTION1_MASTER;\r\nexport const OPTION1_MASTER_LIST = (Object.keys(OPTION1_MASTER) as TOption1Key[])\r\n    .map(key => ({ key: key, ...OPTION1_MASTER[key] }));\r\n\r\nexport type TOption2Key = keyof typeof OPTION2_MASTER;\r\nexport const OPTION2_MASTER_LIST = (Object.keys(OPTION2_MASTER) as TOption2Key[])\r\n    .map(key => ({ key: key, ...OPTION2_MASTER[key] }));\r\n\r\nexport type TElementalReactionKey = keyof typeof ELEMENTAL_REACTION_MASTER;\r\nexport const ELEMENTAL_REACTION_MASTER_LIST = (Object.keys(ELEMENTAL_REACTION_MASTER) as TElementalReactionKey[])\r\n    .map(key => ({ key: key, ...ELEMENTAL_REACTION_MASTER[key] }));\r\n\r\n// export const DICTIONARY_MASTER = { ...HOYO_DICTIONARY2, ...HOYO_DICTIONARY4, ...HOYO_DICTIONARY5, ...LOCAL_DICTIONARY };\r\n\r\n////////////////\r\n////////////////\r\nconst CHARACTER_MASTER_DETAIL_MAP = new Map();\r\n/**\r\n * \r\n * @param {string} character \r\n * @returns {Promise<any>}\r\n */\r\nexport async function getCharacterMasterDetail(character: TCharacterKey): Promise<TCharacterDetail> {\r\n    try {\r\n        if (!CHARACTER_MASTER_DETAIL_MAP.has(character)) {\r\n            const url = CHARACTER_MASTER[character]['import'].replace(/^\\//, '');\r\n            const characterMaster = await fetch(url).then(resp => resp.json());\r\n            // 通常攻撃の画像URLを共用のURLに差し替えます\r\n            const weaponType = CHARACTER_MASTER[character].武器 as TWeaponTypeKey;\r\n            characterMaster.通常攻撃.icon_url = WEAPON_IMG_SRC[weaponType];\r\n            CHARACTER_MASTER_DETAIL_MAP.set(character, characterMaster);\r\n        }\r\n        return CHARACTER_MASTER_DETAIL_MAP.get(character);\r\n    } catch (error) {\r\n        console.error(character);\r\n        throw error;\r\n    }\r\n}\r\n\r\nconst WEAPON_MASTER_DETAIL_MAP = new Map();\r\n/**\r\n * \r\n * @param weapon \r\n * @param opt_weaponType \r\n * @returns \r\n */\r\nexport async function getWeaponMasterDetail(weapon: TWeaponKey, opt_weaponType?: TWeaponTypeKey): Promise<TWeaponDetail> {\r\n    try {\r\n        if (!WEAPON_MASTER_DETAIL_MAP.has(weapon)) {\r\n            let weaponTypeArr;\r\n            if (opt_weaponType) weaponTypeArr = [opt_weaponType];\r\n            else weaponTypeArr = Object.keys(WEAPON_MASTER);\r\n            for (const weaponType of weaponTypeArr) {\r\n                if (weapon in WEAPON_MASTER[weaponType as TWeaponTypeKey]) {\r\n                    const typedMaster: any = WEAPON_MASTER[weaponType as TWeaponTypeKey];\r\n                    const url = typedMaster[weapon]['import'];\r\n                    const weaponMaster: any = await fetch(url).then(resp => resp.json());\r\n                    weaponMaster.種類 = weaponType; // 上書き\r\n                    WEAPON_MASTER_DETAIL_MAP.set(weapon, weaponMaster);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return WEAPON_MASTER_DETAIL_MAP.get(weapon);\r\n    } catch (error) {\r\n        console.error(weapon, opt_weaponType);\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport const ALL_ELEMENTS = ['炎', '水', '風', '雷', '草', '氷', '岩'];\r\n\r\nexport const ELEMENT_COLOR_CLASS = {\r\n    炎: 'pyro',\r\n    水: 'hydro',\r\n    風: 'anemo',\r\n    雷: 'electro',\r\n    草: 'dendro',\r\n    氷: 'cryo',\r\n    岩: 'geo'\r\n};\r\nexport type TElementColorClassKey = keyof typeof ELEMENT_COLOR_CLASS;\r\n\r\nexport const ELEMENT_BG_COLOR_CLASS = {\r\n    炎: 'pyro-bg',\r\n    水: 'hydro-bg',\r\n    風: 'anemo-bg',\r\n    雷: 'electro-bg',\r\n    草: 'dendro-bg',\r\n    氷: 'cryo-bg',\r\n    岩: 'geo-bg'\r\n};\r\n\r\nexport const ELEMENT_IMG_SRC = {\r\n    炎: 'images/element_pyro.png',\r\n    水: 'images/element_hydro.png',\r\n    風: 'images/element_anemo.png',\r\n    雷: 'images/element_electro.png',\r\n    草: 'images/element_dendro.png',\r\n    氷: 'images/element_cryo.png',\r\n    岩: 'images/element_geo.png'\r\n};\r\nexport type TElementImgSrcKey = keyof typeof ELEMENT_IMG_SRC;\r\n\r\nexport const WEAPON_IMG_SRC = {\r\n    片手剣: 'images/characters/NormalAttack_sword.png',\r\n    両手剣: 'images/characters/NormalAttack_claymore.png',\r\n    長柄武器: 'images/characters/NormalAttack_polearm.png',\r\n    弓: 'images/characters/NormalAttack_bow.png',\r\n    法器: 'images/characters/NormalAttack_catalyst.png',\r\n};\r\n\r\nexport const STAR_BACKGROUND_IMAGE_CLASS = {\r\n    1: 'star1-bg',\r\n    2: 'star2-bg',\r\n    3: 'star3-bg',\r\n    4: 'star4-bg',\r\n    5: 'star5-bg'\r\n}\r\n\r\nexport const キャラクター構成PROPERTY_MAP = new Map([\r\n    ['キャラクター', null],\r\n    ['レベル', null],\r\n    ['命ノ星座', 0],\r\n    ['通常攻撃レベル', 0],\r\n    ['元素スキルレベル', 0],\r\n    ['元素爆発レベル', 0],\r\n    ['武器', null],\r\n    ['武器レベル', 0],\r\n    ['精錬ランク', 0],\r\n    ['聖遺物セット効果1', null],\r\n    ['聖遺物セット効果2', null],\r\n    ['聖遺物メイン効果1', null],\r\n    ['聖遺物メイン効果2', null],\r\n    ['聖遺物メイン効果3', null],\r\n    ['聖遺物メイン効果4', null],\r\n    ['聖遺物メイン効果5', null],\r\n    ['聖遺物サブ効果HP', 0],\r\n    ['聖遺物サブ効果攻撃力', 0],\r\n    ['聖遺物サブ効果防御力', 0],\r\n    ['聖遺物サブ効果元素熟知', 0],\r\n    ['聖遺物サブ効果会心率', 0],\r\n    ['聖遺物サブ効果会心ダメージ', 0],\r\n    ['聖遺物サブ効果元素チャージ効率', 0],\r\n    ['聖遺物サブ効果HPP', 0],\r\n    ['聖遺物サブ効果攻撃力P', 0],\r\n    ['聖遺物サブ効果防御力P', 0],\r\n    ['聖遺物優先するサブ効果1', null],\r\n    ['聖遺物優先するサブ効果1上昇値', -1],\r\n    ['聖遺物優先するサブ効果1上昇回数', -1],\r\n    ['聖遺物優先するサブ効果2', null],\r\n    ['聖遺物優先するサブ効果2上昇値', -1],\r\n    ['聖遺物優先するサブ効果2上昇回数', -1],\r\n    ['聖遺物優先するサブ効果3', null],\r\n    ['聖遺物優先するサブ効果3上昇値', -1],\r\n    ['聖遺物優先するサブ効果3上昇回数', -1],\r\n    ['聖遺物優先するサブ効果4', null],\r\n    ['聖遺物優先するサブ効果4上昇値', -1],\r\n    ['聖遺物優先するサブ効果4上昇回数', -1],\r\n]);\r\n\r\nexport const NUMBER_OF_PRIORITY_SUBSTATS = Array.from(キャラクター構成PROPERTY_MAP.keys()).filter(s => s.match(/^聖遺物優先するサブ効果\\d$/)).length;\r\n\r\nexport const DAMAGE_CATEGORY_ARRAY = ['通常攻撃ダメージ', '重撃ダメージ', '落下攻撃ダメージ', '元素スキルダメージ', '元素爆発ダメージ'];\r\n\r\nexport const RECOMMEND_ABBREV_MAP = new Map([\r\n    ['HP%', 'HP'], ['元素熟知', '熟'], ['元素チャージ効率', 'ﾁｬ'], ['会心率', '率'], ['会心ダメージ', 'ダ'], ['与える治療効果', '治']\r\n]);\r\n\r\nexport const RECOMMEND_ABBREV_EN_MAP = new Map([\r\n    ['HP%', 'HP'], ['攻撃力%', 'AT'], ['防御力%', 'DF'], ['元素熟知', 'EM'],\r\n    ['会心率', 'CR'], ['会心ダメージ', 'CD'], ['元素チャージ効率', 'ER'], ['与える治療効果', 'HE'],\r\n    ['炎元素ダメージバフ', 'Py'], ['水元素ダメージバフ', 'Hy'], ['風元素ダメージバフ', 'An'], ['雷元素ダメージバフ', 'El'], ['草元素ダメージバフ', 'De'], ['氷元素ダメージバフ', 'Cr'], ['岩元素ダメージバフ', 'Ge'], ['物理ダメージバフ', 'Ph'],\r\n]);\r\n\r\nexport const ARTIFACT_STAT_JA_EN_ABBREV_MAP = new Map([\r\n    ['HP', 'HP'],\r\n    ['攻撃力', 'ATK'],\r\n    ['防御力', 'DEF'],\r\n    ['元素熟知', 'ElementalMastery'],\r\n    ['会心率', 'CritRate'],\r\n    ['会心ダメージ', 'CritDMG'],\r\n    ['元素チャージ効率', 'EnergyRecharge'],\r\n    ['炎元素ダメージバフ', 'Pyro'],\r\n    ['水元素ダメージバフ', 'Hydro'],\r\n    ['風元素ダメージバフ', 'Anemo'],\r\n    ['雷元素ダメージバフ', 'Electro'],\r\n    ['草元素ダメージバフ', 'Dendro'],\r\n    ['氷元素ダメージバフ', 'Cryo'],\r\n    ['岩元素ダメージバフ', 'Geo'],\r\n    ['物理ダメージバフ', 'Physical'],\r\n    ['与える治療効果', 'Healing'],\r\n    ['HP%', 'HPp'],\r\n    ['攻撃力%', 'ATKp'],\r\n    ['防御力%', 'DEFp']\r\n]);\r\n\r\nexport const ARTIFACT_STAT_JA_EN_ABBREV_REVERSE_MAP = new Map();\r\nARTIFACT_STAT_JA_EN_ABBREV_MAP.forEach((value, key) => {\r\n    ARTIFACT_STAT_JA_EN_ABBREV_REVERSE_MAP.set(value, key);\r\n});\r\n\r\nexport const GENSEN_MASTER_LIST = [\r\n    {\r\n        key: '',\r\n        values: [7, 7, 7, 7],\r\n        counts: [0, 0, 0, 0],\r\n    },\r\n    {\r\n        key: '厳選初心者',\r\n        values: [3, 3, 3, 3],\r\n        counts: [7, 4, 4, 4],\r\n    },\r\n    {\r\n        key: '厳選1ヶ月',\r\n        values: [3, 3, 3, 3],\r\n        counts: [8, 5, 5, 4],\r\n    },\r\n    {\r\n        key: '厳選3ヶ月',\r\n        values: [3, 3, 3, 3],\r\n        counts: [11, 8, 7, 4],\r\n    },\r\n    {\r\n        key: '日々石割り',\r\n        values: [1, 1, 1, 1],\r\n        counts: [14, 11, 10, 4],\r\n    },\r\n];\r\nfor (const gensen of GENSEN_MASTER_LIST) {\r\n    for (let i = gensen.values.length; i < NUMBER_OF_PRIORITY_SUBSTATS; i++) {\r\n        gensen.values.push(gensen.values[0]);\r\n    }\r\n    for (let i = gensen.counts.length; i < NUMBER_OF_PRIORITY_SUBSTATS; i++) {\r\n        gensen.counts.push(0);\r\n    }\r\n}\r\nexport type TGensen = { key: string; values: number[]; counts: number[] };\r\n\r\nexport const ARTIFACT_CAT_NAMES = {\r\n    '1': 'flower_of_life',\r\n    '2': 'plume_of_death',\r\n    '3': 'sands_of_eon',\r\n    '4': 'goblet_of_eonothem',\r\n    '5': 'circlet_of_logos',\r\n};\r\n\r\nexport function getArtifactIconUrl(setname: string, opt_cat_id: any = '1') {\r\n    let result = IMG_SRC_DUMMY;\r\n    if (setname in ARTIFACT_SET_MASTER) {\r\n        result = (ARTIFACT_SET_MASTER as any)[setname].icon_url;\r\n        if (!result.startsWith('data:image/gif;')) {\r\n            result = result.replace(/.png$/, '');\r\n            result += '/' + (ARTIFACT_CAT_NAMES as any)[String(opt_cat_id)] + '.png';\r\n        }\r\n    }\r\n    return result;\r\n}\r\n","import _ from \"lodash\";\r\n\r\n// 継続時間が存在かつ2以上の場合、元素粒子数は1秒あたりの元素粒子数とみなす\r\nexport type TParticleInfo = number | number[];\r\nexport type TParticleEntry = {\r\n    [key: string]: TParticleInfo,\r\n};\r\nexport type TParticleMaster = {\r\n    [key: string]: TParticleEntry,\r\n};\r\n\r\nexport const SP_SELF = 0;      // 元素粒子数=[0]       アクション実行者\r\nexport const SP_NEXT = 1;      // 元素粒子数=[0]       次のアクション実行者\r\nexport const SP_LONG = -1;     // 元素粒子数=[0]*[2]   出場時間で分配\r\nexport const SP_SHRT = -2;     // 元素粒子数=[0]       出場時間で分配\r\nconst C1 = 1;\r\nconst C2 = 2;\r\n// const C4 = 4;\r\nconst C6 = 6;\r\nexport const PARTICLE_MASTER: TParticleMaster = {\r\n    'シャルロット': {\r\n        'E.Press': 3,\r\n        'E.Hold': 5,\r\n    },\r\n    'フリーナ': {\r\n        'E': [1 / 2.5, SP_LONG, 30, 20],     // CT2.5s\r\n    },\r\n    'リオセスリ': {\r\n        'E': [3, SP_SELF, 10, 16, C1, 3, SP_SELF, 14, 16],  // CT2s\r\n    },\r\n    'ヌヴィレット': {\r\n        'E': [4, SP_NEXT, 0, 12],\r\n    },\r\n    'リネ': {\r\n        'E': 5,\r\n    },\r\n    '白朮': {\r\n        'E': 3.5,\r\n    },\r\n    'ディシア': {\r\n        'E': [1 / 2.5, SP_LONG, 12, 20, C2, 1 / 2.5, SP_LONG, 18, 20],  // フィールドダメージ CT2.5s\r\n    },\r\n    'アルハイゼン': {\r\n        'E.Press': [6, SP_SELF],    // 光幕攻撃1回あたり1個 CT1.6s\r\n        'E.Hold': [6, SP_SELF],     // 光幕攻撃1回あたり1個 CT1.6s\r\n    },\r\n    '放浪者': {\r\n        'E': [5, SP_SELF, 10, 16, C6, 5, SP_SELF, 12, 18],\r\n    },\r\n    'ナヒーダ': {\r\n        'E.Press': [3 / 7, SP_LONG, 25, 5],     // CT7s\r\n        'E.Hold': [3 / 7, SP_LONG, 25, 6],      // CT7s\r\n    },\r\n    'ニィロウ': {\r\n        'E': [1.5 + 1 + 1 + 1, SP_SELF]\r\n    },\r\n    'セノ': {\r\n        'E': 3,\r\n        'E(burst)': 1 + 1 / 3,\r\n    },\r\n    'ティナリ': {\r\n        'E': 3.5,\r\n    },\r\n    '夜蘭': {\r\n        'E.Press': [4, SP_NEXT, 0, 10],\r\n        'E.Hold': [4, SP_NEXT, 0, 10],\r\n    },\r\n    '神里綾人': {\r\n        'E': [4, SP_SELF, 6, 12],\r\n    },\r\n    '八重神子': {\r\n        'E': [1 / 2.5, SP_LONG, 14, 4],     // CT2.5s\r\n    },\r\n    '申鶴': {\r\n        'E.Press': [3, SP_NEXT, 10, 10],\r\n        'E.Hold': [4, SP_NEXT, 15, 15],\r\n    },\r\n    '荒瀧一斗': {\r\n        'E': 3.5,\r\n    },\r\n    '珊瑚宮心海': {\r\n        'E': [2 / 3 / 2, SP_LONG, 12, 20],   // per damage CT2s\r\n    },\r\n    '雷電将軍': {\r\n        'E': [0.5 / 0.9, SP_LONG, 25, 10],  // per damage CT0.9s\r\n    },\r\n    'アーロイ': {\r\n        'E': 5,\r\n    },\r\n    '宵宮': {\r\n        'E': [4, SP_SELF, 10, 18],          // CT2s\r\n    },\r\n    '神里綾華': {\r\n        'E': 4.5,\r\n    },\r\n    '楓原万葉': {\r\n        'E.Press': 3,\r\n        'E.Hold': 4,\r\n    },\r\n    'エウルア': {\r\n        'E.Press': 1.5,\r\n        'E.Hold': 2.5,\r\n    },\r\n    '胡桃': {\r\n        'E': [2.5 * 2, SP_SELF, 9, 16],\r\n    },\r\n    '魈': {\r\n        'E': 3,\r\n        'E(burst)': 0,\r\n    },\r\n    '甘雨': {\r\n        'E': [2 * 2, SP_SHRT, 6, 10]\r\n    },\r\n    'アルベド': {\r\n        'E.Press': [2 / 3 / 2, SP_LONG, 30, 4],     // 刹那の花ダメージ1回あたり0.67個 CT2s\r\n        'E.Hold': [2 / 3 / 2, SP_LONG, 30, 4],      // 刹那の花ダメージ1回あたり0.67個 CT2s\r\n    },\r\n    '鍾離': {\r\n        'E.Press': [0.5 / 1.5, SP_LONG, 20, 4],     // CT1.5s\r\n        'E.Hold': [0.5 / 1.5, SP_LONG, 20, 12],     // CT1.5s\r\n    },\r\n    'タルタリヤ': {\r\n        'E': [1 / 3 * 9, SP_SELF],                  // とりあえず居座り時間9sとする。運用次第すぎて計算できない\r\n    },\r\n    'クレー': {\r\n        'E': 3.5,\r\n    },\r\n    'ウェンティ': {\r\n        'E.Press': 3,\r\n        'E.Hold': 4,\r\n    },\r\n    '刻晴': {\r\n        'E.Press': 2.5,\r\n        'E.Hold': 2.5,\r\n    },\r\n    'モナ': {\r\n        'E.Press': [1 + 1 / 3, SP_SHRT, 5, 12],\r\n        'E.Hold': [1 + 1 / 3, SP_SHRT, 5, 12],\r\n    },\r\n    '七七': {\r\n        'E': 0,\r\n    },\r\n    'ディルック': {\r\n        'E': 4,\r\n    },\r\n    'ジン': {\r\n        'E': 2.67,\r\n    },\r\n    'フレミネ': {\r\n        'E': 2,\r\n        'E(burst)': 1,\r\n    },\r\n    'リネット': {\r\n        'E.Press': 4,\r\n        'E.Hold': 4,\r\n    },\r\n    '綺良々': {\r\n        'E.Press': 3,\r\n        'E.Hold': 3 + 1,\r\n    },\r\n    'カーヴェ': {\r\n        'E': 2,\r\n    },\r\n    'ミカ': {\r\n        'E.Press': 4,\r\n        'E.Hold': 4,\r\n    },\r\n    'ヨォーヨ': {\r\n        'E.Press': [1 / 1.5, SP_LONG, 10, 15],\r\n        'E.Hold': [1 / 1.5, SP_LONG, 10, 15]\r\n    },\r\n    'ファルザン': {\r\n        'E': [2, SP_NEXT, 18, 6],   // CT5.5s\r\n    },\r\n    'レイラ': {\r\n        'E': [(1 + 1 / 3) / 3, SP_LONG, 12, 12]    // CT3s\r\n    },\r\n    'キャンディス': {\r\n        'E.Press': 2,\r\n        'E.Hold': 3\r\n    },\r\n    'ドリー': {\r\n        'E': 2,\r\n    },\r\n    'コレイ': {\r\n        'E': 3,\r\n    },\r\n    '鹿野院平蔵': {\r\n        'E': 4,     // 2:変格0-1/2.5:変格2-3/3:変格4=正論\r\n    },\r\n    '久岐忍': {\r\n        'E': [0.45 / 1.5, SP_LONG, 12, 15, C2, 0.45 / 1.5, SP_LONG, 15, 15],    // CT1.5s\r\n    },\r\n    '雲菫': {\r\n        'E.Press': 2,\r\n        'E.Hold': 3,\r\n    },\r\n    'ゴロー': {\r\n        'E.Press': 2,\r\n        'E.Hold': 2,\r\n    },\r\n    'トーマ': {\r\n        'E': 3.5,\r\n    },\r\n    '九条裟羅': {\r\n        'E': 3,\r\n    },\r\n    '早柚': {\r\n        'E.Press': 2,\r\n        'E.Hold': 3,\r\n    },\r\n    '煙緋': {\r\n        'E': 3,\r\n    },\r\n    'ロサリア': {\r\n        'E': 3,\r\n    },\r\n    '辛炎': {\r\n        'E': 4,\r\n    },\r\n    'ディオナ': {\r\n        'E.Press': 0.8 * 2,\r\n        'E.Hold': 0.8 * 5,\r\n    },\r\n    'スクロース': {\r\n        'E': 4,\r\n    },\r\n    '重雲': {\r\n        'E': 4,\r\n    },\r\n    'ノエル': {\r\n        'E': 0,\r\n    },\r\n    'ベネット': {\r\n        'E.Press': 2.25,\r\n        'E.Hold': 3,\r\n    },\r\n    'フィッシュル': {\r\n        'E': [2 / 3, SP_LONG, 10, 25, C6, 0.67, SP_LONG, 12, 25],\r\n    },\r\n    '凝光': {\r\n        'E': 3.33,\r\n    },\r\n    '行秋': {\r\n        'E': [4.5, SP_NEXT, 15, 21],\r\n    },\r\n    '北斗': {\r\n        'E.Press': 2,\r\n        'E.Hold': 4,\r\n    },\r\n    '香菱': {\r\n        'E': [4, SP_SHRT, 8, 12],\r\n    },\r\n    'レザー': {\r\n        'E.Press': 3,\r\n        'E.Hold': 4,\r\n        'E.Press(burst)': 0,\r\n    },\r\n    'バーバラ': {\r\n        'E': [0, SP_NEXT, 15, 32, C2, 0, SP_NEXT, 15, 27.2],\r\n    },\r\n    'リサ': {\r\n        'E.Press': 0,\r\n        'E.Hold': 5,\r\n    },\r\n    'ガイア': {\r\n        'E': 2.67,\r\n    },\r\n    'アンバー': {\r\n        'E.Press': [4, SP_SHRT, 8, 15],\r\n        'E.Hold': [4, SP_SHRT, 8, 15],\r\n    },\r\n    '旅人(水)': {\r\n        'E.Press': 3 + 1 / 3,\r\n        'E.Hold': 3 + 1 / 3,\r\n    },\r\n    '旅人(草)': {\r\n        'E': 2.5,\r\n    },\r\n    '旅人(雷)': {\r\n        'E': 1,\r\n    },\r\n    '旅人(岩)': {\r\n        'E.Press': 3 + 1 / 3,\r\n        'E.Hold': 3 + 1 / 3,\r\n    },\r\n    '旅人(風)': {\r\n        'E.Press': 2,\r\n        'E.Hold': 3 + 1 / 3,\r\n    },\r\n}\r\n\r\nObject.keys(PARTICLE_MASTER).forEach(key => {\r\n    const pentry = PARTICLE_MASTER[key];\r\n    Object.keys(pentry).forEach(key2 => {\r\n        const pinfo = pentry[key2];\r\n        if (_.isNumber(pinfo)) {\r\n            return;\r\n        }\r\n        if (_.isArray(pinfo)) {\r\n            if (pinfo.length == 2 || pinfo.length == 4 || pinfo.length == 9) {\r\n                if (pinfo.filter(s => !_.isNumber(s)).length == 0) {\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        console.error(key, key2, pinfo);\r\n    })\r\n})\r\n\r\n/** 元素爆発で元素スキル再発動 または 継続時間延長するキャラクターたち */\r\nexport const CHARACTER_Q_TO_E_ARR = ['フィッシュル', '珊瑚宮心海'];\r\n\r\n/** 元素スキル後に特定のアクションを実行するキャラクターとそのアクションと回数 */\r\nexport const CHARACTER_E_UNTIL_MAP = new Map<string, Map<string[], number>>();\r\nCHARACTER_E_UNTIL_MAP.set('ディルック', new Map([[['E'], 2],]));            // EEE\r\nCHARACTER_E_UNTIL_MAP.set('刻晴', new Map([[['E', 'C'], 1],]));             // E(E|C)\r\nCHARACTER_E_UNTIL_MAP.set('ニィロウ', new Map([[['E', 'N'], 3],]));         // E(E|N){3}\r\nCHARACTER_E_UNTIL_MAP.set('フレミネ', new Map([[['E'], 1], [['N'], 4],]));  // E(E|N{4})\r\n\r\n/** 元素スキルのあとに特定のアクションを実行した時に元素粒子が発生するキャラクターとそのアクション */\r\nexport const CHARACTER_E_DELAY_MAP = new Map<string, string[]>();\r\nCHARACTER_E_DELAY_MAP.set('九条裟羅', ['C']);\r\nCHARACTER_E_DELAY_MAP.set('ファルザン', ['C']);\r\n\r\n/** 元素爆発カットイン中に元素粒子を受け取らないキャラクターたち */\r\nexport const CHARACTER_Q_NOT_RECHARGEABLE = ['ウェンティ', 'エウルア'];\r\n\r\nexport function getElementalSkillActions(character: string) {\r\n    const particleMaster = PARTICLE_MASTER[character];\r\n    return particleMaster ? Object.keys(particleMaster).filter(action => action.startsWith('E') && action.indexOf('(burst)') == -1) : ['E'];\r\n}\r\n\r\nexport function getParticleInfo(character: string, action: string, constellation = 0, isBursting = false) {\r\n    let result: TParticleInfo = 0;\r\n    const particleMaster = PARTICLE_MASTER[character];\r\n    if (particleMaster) {\r\n        const keyArr: string[] = [];\r\n        if (isBursting) {\r\n            keyArr.push(action + '(burst)');\r\n        }\r\n        keyArr.push(action);\r\n        for (const key of keyArr) {\r\n            if (key in particleMaster) {\r\n                result = particleMaster[key];\r\n                if (_.isArray(result) && result.length > 4) {\r\n                    if (result[4] >= constellation) {\r\n                        result = result.slice(5);       // 5,6,7,8\r\n                    } else {\r\n                        result = result.slice(0, 4);    // 1,2,3,4\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getParticleNumFromInfo(particleInfo: TParticleInfo, leftTime?: number) {\r\n    let result = 0;\r\n    if (_.isNumber(particleInfo)) {\r\n        result = particleInfo;\r\n    } else {\r\n        result = particleInfo[0];\r\n        const receiveType = getReceiveTypeFromInfo(particleInfo);\r\n        if ([SP_LONG].includes(receiveType)) {\r\n            let duration = getDurationFromInfo(particleInfo);\r\n            if (duration > 0) {\r\n                if (leftTime !== undefined && duration > leftTime) {\r\n                    duration = Math.max(0, leftTime);\r\n                }\r\n                result *= duration;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getReceiveTypeFromInfo(particleInfo: TParticleInfo) {\r\n    return (_.isArray(particleInfo) && particleInfo.length > 1) ? particleInfo[1] : SP_NEXT;\r\n}\r\n\r\nexport function getDurationFromInfo(particleInfo: TParticleInfo) {\r\n    return (_.isArray(particleInfo) && particleInfo.length > 2) ? particleInfo[2] : 0;\r\n}\r\n\r\nexport function getCooltimeFromInfo(particleInfo: TParticleInfo) {\r\n    return (_.isArray(particleInfo) && particleInfo.length > 3) ? particleInfo[3] : undefined;\r\n}","import { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vModelText as _vModelText, resolveComponent as _resolveComponent, createVNode as _createVNode, vShow as _vShow, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-fe60a4d2\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"artifact\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"artifact\"\n}\nconst _hoisted_3 = {\n  class: \"left-column\",\n  style: {\"width\":\"45%\"}\n}\nconst _hoisted_4 = { class: \"control\" }\nconst _hoisted_5 = {\n  key: 0,\n  class: \"material-symbols-outlined\"\n}\nconst _hoisted_6 = {\n  key: 1,\n  class: \"material-symbols-outlined\"\n}\nconst _hoisted_7 = { class: \"with-tooltip\" }\nconst _hoisted_8 = [\"src\", \"alt\"]\nconst _hoisted_9 = { class: \"tooltip\" }\nconst _hoisted_10 = {\n  key: 0,\n  class: \"edit-mainstat\"\n}\nconst _hoisted_11 = [\"value\"]\nconst _hoisted_12 = [\"step\"]\nconst _hoisted_13 = {\n  key: 1,\n  class: \"mainstat\",\n  style: {\"margin\":\"1px 0\"}\n}\nconst _hoisted_14 = { key: 2 }\nconst _hoisted_15 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", { value: \"5\" }, \" ★5 \", -1))\nconst _hoisted_16 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", { value: \"4\" }, \" ★4 \", -1))\nconst _hoisted_17 = [\n  _hoisted_15,\n  _hoisted_16\n]\nconst _hoisted_18 = { key: 3 }\nconst _hoisted_19 = { style: {\"width\":\"55%\"} }\nconst _hoisted_20 = { class: \"artifact-substat\" }\nconst _hoisted_21 = { class: \"right\" }\nconst _hoisted_22 = [\"onUpdate:modelValue\"]\nconst _hoisted_23 = [\"value\", \"disabled\"]\nconst _hoisted_24 = { class: \"right\" }\nconst _hoisted_25 = [\"onUpdate:modelValue\", \"step\"]\nconst _hoisted_26 = { key: 1 }\nconst _hoisted_27 = {\n  class: \"left-column\",\n  style: {\"width\":\"45%\"}\n}\nconst _hoisted_28 = {\n  key: 0,\n  class: \"score\"\n}\nconst _hoisted_29 = { class: \"control\" }\nconst _hoisted_30 = {\n  key: 0,\n  type: \"button\"\n}\nconst _hoisted_31 = {\n  key: 0,\n  class: \"material-symbols-outlined\",\n  style: {\"color\":\"yellow\"}\n}\nconst _hoisted_32 = {\n  key: 1,\n  class: \"material-symbols-outlined\"\n}\nconst _hoisted_33 = { class: \"with-tooltip\" }\nconst _hoisted_34 = [\"src\", \"alt\"]\nconst _hoisted_35 = { class: \"tooltip\" }\nconst _hoisted_36 = {\n  class: \"mainstat\",\n  style: {\"margin\":\"1px 0\"}\n}\nconst _hoisted_37 = { style: {\"width\":\"55%\"} }\nconst _hoisted_38 = { class: \"artifact-substat\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_ArtifactSetSelect = _resolveComponent(\"ArtifactSetSelect\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (_ctx.control == 'editable')\n      ? (_openBlock(), _createElementBlock(\"table\", _hoisted_2, [\n          _createElementVNode(\"tr\", null, [\n            _createElementVNode(\"td\", _hoisted_3, [\n              _createElementVNode(\"div\", _hoisted_4, [\n                _createElementVNode(\"button\", {\n                  type: \"button\",\n                  onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.isEditing = !_ctx.isEditing))\n                }, [\n                  (_ctx.isEditing)\n                    ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, \" edit_off \"))\n                    : (_openBlock(), _createElementBlock(\"span\", _hoisted_6, \" edit \"))\n                ])\n              ]),\n              _createElementVNode(\"div\", _hoisted_7, [\n                _createElementVNode(\"img\", {\n                  class: \"artifact-icon\",\n                  src: _ctx.artifactImgSrc,\n                  alt: _ctx.displayName(_ctx.copiedArtifact.name),\n                  onClick: _cache[1] || (_cache[1] = ($event: any) => (_ctx.artifactIconOnClick()))\n                }, null, 8, _hoisted_8),\n                _createElementVNode(\"div\", _hoisted_9, _toDisplayString(_ctx.displayName(_ctx.copiedArtifact.name)), 1)\n              ]),\n              (_ctx.isEditing)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                    _withDirectives(_createElementVNode(\"select\", {\n                      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.copiedArtifact.mainStat) = $event)),\n                      onChange: _cache[3] || (_cache[3] = \n//@ts-ignore\n(...args) => (_ctx.onChange && _ctx.onChange(...args)))\n                    }, [\n                      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.mainStatOptions, (option) => {\n                        return (_openBlock(), _createElementBlock(\"option\", {\n                          key: option,\n                          value: option\n                        }, _toDisplayString(_ctx.displayName(option)), 9, _hoisted_11))\n                      }), 128))\n                    ], 544), [\n                      [_vModelSelect, _ctx.copiedArtifact.mainStat]\n                    ]),\n                    _withDirectives(_createElementVNode(\"input\", {\n                      type: \"number\",\n                      \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((_ctx.copiedArtifact.mainStatValue) = $event)),\n                      step: _ctx.statStep(_ctx.copiedArtifact.mainStat),\n                      min: \"0\",\n                      onChange: _cache[5] || (_cache[5] = \n//@ts-ignore\n(...args) => (_ctx.onChange && _ctx.onChange(...args)))\n                    }, null, 40, _hoisted_12), [\n                      [_vModelText, _ctx.copiedArtifact.mainStatValue]\n                    ])\n                  ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, _toDisplayString(_ctx.displayName(_ctx.copiedArtifact.mainStat).replace(/%$/, '') + '+' + _ctx.displayStatValue(_ctx.copiedArtifact.mainStat,\r\n                _ctx.copiedArtifact.mainStatValue)), 1)),\n              (_ctx.isEditing)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                    _withDirectives(_createElementVNode(\"select\", {\n                      class: \"star\",\n                      \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event: any) => ((_ctx.copiedArtifact.rarity) = $event)),\n                      onChange: _cache[7] || (_cache[7] = \n//@ts-ignore\n(...args) => (_ctx.starOnChange && _ctx.starOnChange(...args)))\n                    }, _hoisted_17, 544), [\n                      [_vModelSelect, _ctx.copiedArtifact.rarity]\n                    ])\n                  ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(new Array(_ctx.copiedArtifact.rarity), (dummy) => {\n                      return (_openBlock(), _createElementBlock(\"img\", {\n                        class: \"star\",\n                        src: \"images/star.png\",\n                        key: dummy\n                      }))\n                    }), 128))\n                  ]))\n            ]),\n            _createElementVNode(\"td\", _hoisted_19, [\n              _createElementVNode(\"table\", _hoisted_20, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.copiedArtifact.subStats, (subStat, index) => {\n                  return (_openBlock(), _createElementBlock(\"tr\", { key: index }, [\n                    (_ctx.isEditing)\n                      ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                          _createElementVNode(\"td\", _hoisted_21, [\n                            _withDirectives(_createElementVNode(\"select\", {\n                              \"onUpdate:modelValue\": ($event: any) => ((subStat.name) = $event),\n                              onChange: _cache[8] || (_cache[8] = \n//@ts-ignore\n(...args) => (_ctx.onChange && _ctx.onChange(...args)))\n                            }, [\n                              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.subStatOptions, (option) => {\n                                return (_openBlock(), _createElementBlock(\"option\", {\n                                  key: option,\n                                  value: option,\n                                  disabled: _ctx.subStatOptionDisabled(option, subStat.name)\n                                }, _toDisplayString(_ctx.displayName(option)), 9, _hoisted_23))\n                              }), 128))\n                            ], 40, _hoisted_22), [\n                              [_vModelSelect, subStat.name]\n                            ])\n                          ]),\n                          _createElementVNode(\"td\", _hoisted_24, [\n                            _withDirectives(_createElementVNode(\"input\", {\n                              type: \"number\",\n                              \"onUpdate:modelValue\": ($event: any) => ((subStat.value) = $event),\n                              step: _ctx.statStep(subStat.name),\n                              min: \"0\",\n                              onChange: _cache[9] || (_cache[9] = \n//@ts-ignore\n(...args) => (_ctx.onChange && _ctx.onChange(...args)))\n                            }, null, 40, _hoisted_25), [\n                              [_vModelText, subStat.value]\n                            ])\n                          ])\n                        ], 64))\n                      : (_openBlock(), _createElementBlock(\"td\", _hoisted_26, _toDisplayString(_ctx.displayName(subStat.name).replace(/%$/, '') + '+' + _ctx.displayStatValue(subStat.name, subStat.value)), 1))\n                  ]))\n                }), 128))\n              ])\n            ])\n          ])\n        ]))\n      : (_openBlock(), _createElementBlock(\"table\", {\n          key: 1,\n          class: \"artifact\",\n          onClick: _cache[10] || (_cache[10] = ($event: any) => (_ctx.selectOnClick()))\n        }, [\n          _createElementVNode(\"tr\", null, [\n            _createElementVNode(\"td\", _hoisted_27, [\n              (_ctx.score)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_28, _toDisplayString(Math.round(_ctx.score * 10) / 10), 1))\n                : _createCommentVNode(\"\", true),\n              _createElementVNode(\"div\", _hoisted_29, [\n                (_ctx.control == 'selectable')\n                  ? (_openBlock(), _createElementBlock(\"button\", _hoisted_30, [\n                      (_ctx.selected)\n                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_31, \" select_check_box \"))\n                        : (_openBlock(), _createElementBlock(\"span\", _hoisted_32, \" check_box_outline_blank \"))\n                    ]))\n                  : _createCommentVNode(\"\", true)\n              ]),\n              _createElementVNode(\"div\", _hoisted_33, [\n                _createElementVNode(\"img\", {\n                  class: \"artifact-icon\",\n                  src: _ctx.artifactImgSrc,\n                  alt: _ctx.displayName(_ctx.copiedArtifact.name)\n                }, null, 8, _hoisted_34),\n                _createElementVNode(\"div\", _hoisted_35, _toDisplayString(_ctx.displayName(_ctx.copiedArtifact.name)), 1)\n              ]),\n              _createElementVNode(\"div\", _hoisted_36, _toDisplayString(_ctx.displayName(_ctx.copiedArtifact.mainStat).replace(/%$/, '') + '+' + _ctx.displayStatValue(_ctx.copiedArtifact.mainStat,\r\n                _ctx.copiedArtifact.mainStatValue)), 1),\n              _createElementVNode(\"div\", null, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(new Array(_ctx.copiedArtifact.rarity), (dummy) => {\n                  return (_openBlock(), _createElementBlock(\"img\", {\n                    class: \"star\",\n                    src: \"images/star.png\",\n                    key: dummy\n                  }))\n                }), 128))\n              ])\n            ]),\n            _createElementVNode(\"td\", _hoisted_37, [\n              _createElementVNode(\"table\", _hoisted_38, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.copiedArtifact.subStats, (subStat, index) => {\n                  return (_openBlock(), _createElementBlock(\"tr\", { key: index }, [\n                    _createElementVNode(\"td\", null, _toDisplayString(_ctx.displayName(subStat.name).replace(/%$/, '') + '+' + _ctx.displayStatValue(subStat.name, subStat.value)), 1)\n                  ]))\n                }), 128))\n              ])\n            ])\n          ])\n        ])),\n    _withDirectives(_createElementVNode(\"div\", null, [\n      _createVNode(_component_ArtifactSetSelect, {\n        visible: true,\n        index: 1,\n        \"artifact-set\": _ctx.artifact.setname,\n        \"artifact-set-masters\": _ctx.artifactSetMasters,\n        cat_id: _ctx.artifact.cat_id,\n        \"onUpdate:artifactSet\": _ctx.updateArtifactSet\n      }, null, 8, [\"artifact-set\", \"artifact-set-masters\", \"cat_id\", \"onUpdate:artifactSet\"])\n    ], 512), [\n      [_vShow, _ctx.isListShow]\n    ])\n  ]))\n}","\r\nimport _ from 'lodash';\r\nimport { overwriteObject } from \"@/common\";\r\nimport { ARTIFACT_SET_MASTER_DUMMY, TArtifact, 聖遺物サブ効果ARRAY, 聖遺物メイン効果_時の砂ARRAY, 聖遺物メイン効果_死の羽ARRAY, 聖遺物メイン効果_理の冠ARRAY, 聖遺物メイン効果_生の花ARRAY, 聖遺物メイン効果_空の杯ARRAY } from \"@/input\";\r\nimport { ARTIFACT_SET_MASTER, TArtifactSetEntry, TArtifactSetKey, getArtifactIconUrl } from \"@/master\";\r\nimport { computed, defineComponent, PropType, reactive, ref, watch } from \"vue\";\r\nimport CompositionFunction from \"./CompositionFunction.vue\";\r\nimport ArtifactSetSelect from \"./ArtifactSetSelect.vue\";\r\n\r\nexport default defineComponent({\r\n  name: 'ArtifactItem',\r\n  props: {\r\n    artifact: { type: Object as PropType<TArtifact>, required: true },\r\n    id: { type: Number },\r\n    control: String,\r\n    initial: Boolean,\r\n    selected: Boolean,\r\n    score: Number,\r\n  },\r\n  components: {\r\n    ArtifactSetSelect,\r\n  },\r\n  emits: ['update:artifact', 'select:artifact'],\r\n  setup(props, context) {\r\n    const { displayName, displayStatValue, percent } = CompositionFunction();\r\n\r\n    const copiedArtifact = reactive(_.cloneDeep(props.artifact));\r\n    const artifactSetMasters = reactive([ARTIFACT_SET_MASTER_DUMMY, ARTIFACT_SET_MASTER_DUMMY] as TArtifactSetEntry[]);\r\n    const isEditing = ref(false);\r\n    const isSelected = ref(false);\r\n    const isListShow = ref(false);\r\n\r\n    const artifactImgSrc = computed(() => {\r\n      return getArtifactIconUrl(copiedArtifact.setname, copiedArtifact.cat_id);\r\n    });\r\n\r\n    const MAINSTAT_CAT_ARR = {\r\n      '1': Array.from(new Set(聖遺物メイン効果_生の花ARRAY.map(s => s.replace(/^\\d_/, '')))),\r\n      '2': Array.from(new Set(聖遺物メイン効果_死の羽ARRAY.map(s => s.replace(/^\\d_/, '')))),\r\n      '3': Array.from(new Set(聖遺物メイン効果_時の砂ARRAY.map(s => s.replace(/^\\d_/, '')))),\r\n      '4': Array.from(new Set(聖遺物メイン効果_空の杯ARRAY.map(s => s.replace(/^\\d_/, '')))),\r\n      '5': Array.from(new Set(聖遺物メイン効果_理の冠ARRAY.map(s => s.replace(/^\\d_/, '')))),\r\n    };\r\n\r\n    const mainStatOptions = computed(() => {\r\n      return (MAINSTAT_CAT_ARR as any)[copiedArtifact.cat_id];\r\n    });\r\n\r\n    const subStatOptions = computed(() => {\r\n      return 聖遺物サブ効果ARRAY;\r\n    });\r\n\r\n    const statStep = (stat: string) => {\r\n      return percent(stat) ? 0.1 : 1;\r\n    };\r\n\r\n    const subStatOptionDisabled = ((value: string, selected: string) => {\r\n      if (value == selected) return false;\r\n      const work = copiedArtifact.subStats.map(s => s.name);\r\n      return work.includes(value);\r\n    });\r\n\r\n    const onChange = () => {\r\n      context.emit('update:artifact', props.id, copiedArtifact);\r\n    };\r\n\r\n    const starOnChange = () => {\r\n      copiedArtifact.rarity = Number(copiedArtifact.rarity);\r\n    }\r\n\r\n    const artifactIconOnClick = () => {\r\n      if (isEditing.value) {\r\n        isListShow.value = !isListShow.value;\r\n      } else {\r\n        isListShow.value = false;\r\n      }\r\n    };\r\n\r\n    const selectOnClick = () => {\r\n      if (props.control === 'selectable') {\r\n        context.emit('select:artifact', props.id);\r\n      }\r\n    };\r\n\r\n    const updateArtifactSet = (artifactSet: TArtifactSetKey) => {\r\n      copiedArtifact.setname = artifactSet;\r\n      const master = ARTIFACT_SET_MASTER[artifactSet];\r\n      copiedArtifact.rarity = master.レアリティ;\r\n      if ('artifact_list' in master) {\r\n        copiedArtifact.name = master.artifact_list[copiedArtifact.cat_id - 1];\r\n      }\r\n      isListShow.value = false;\r\n      onChange();\r\n    };\r\n\r\n    function onLoad() {\r\n      if (props.initial !== undefined) {\r\n        if (props.control === 'editable') {\r\n          isEditing.value = props.initial;\r\n        } else if (props.control === 'selectable') {\r\n          isSelected.value = props.initial;\r\n        }\r\n      }\r\n    }\r\n    onLoad();\r\n\r\n    watch(props, (newVal, oldVal) => {\r\n      overwriteObject(copiedArtifact, newVal.artifact);\r\n      if (newVal.initial != oldVal.initial) {\r\n        onLoad();\r\n      }\r\n    });\r\n\r\n    return {\r\n      displayName, displayStatValue,\r\n\r\n      copiedArtifact,\r\n      artifactSetMasters,\r\n      isEditing,\r\n      isSelected,\r\n      isListShow,\r\n\r\n      artifactImgSrc,\r\n      mainStatOptions,\r\n      subStatOptions,\r\n      subStatOptionDisabled,\r\n      statStep,\r\n\r\n      onChange,\r\n      starOnChange,\r\n      artifactIconOnClick,\r\n      updateArtifactSet,\r\n      selectOnClick,\r\n    }\r\n  }\r\n});\r\n","import { render } from \"./ArtifactItem.vue?vue&type=template&id=fe60a4d2&scoped=true&ts=true\"\nimport script from \"./ArtifactItem.vue?vue&type=script&lang=ts\"\nexport * from \"./ArtifactItem.vue?vue&type=script&lang=ts\"\n\nimport \"./ArtifactItem.vue?vue&type=style&index=0&id=fe60a4d2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-fe60a4d2\"]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-91b28a50\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { key: 0 }\nconst _hoisted_2 = { class: \"title\" }\nconst _hoisted_3 = { class: \"description\" }\nconst _hoisted_4 = { class: \"select-list\" }\nconst _hoisted_5 = [\"src\", \"alt\", \"onClick\"]\nconst _hoisted_6 = { class: \"tooltip\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_ctx.visible)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"table\", null, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.artifactSetEffects, (item) => {\n            return (_openBlock(), _createElementBlock(_Fragment, { key: item }, [\n              _createElementVNode(\"tr\", null, [\n                _createElementVNode(\"th\", _hoisted_2, _toDisplayString(_ctx.displayName(item.key)), 1)\n              ]),\n              _createElementVNode(\"tr\", null, [\n                _createElementVNode(\"td\", _hoisted_3, _toDisplayString(item.value), 1)\n              ])\n            ], 64))\n          }), 128))\n        ]),\n        _createElementVNode(\"ul\", _hoisted_4, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.filteredList, (item) => {\n            return (_openBlock(), _createElementBlock(\"li\", {\n              class: \"with-tooltip\",\n              key: item.key\n            }, [\n              _createElementVNode(\"img\", {\n                class: _normalizeClass('artifact-set' + _ctx.bgImageClass(item) + _ctx.selectedClass(item)),\n                src: _ctx.getArtifactIconUrl(item.key, _ctx.cat_id),\n                alt: item.key,\n                onClick: ($event: any) => (_ctx.$emit('update:artifact-set', item.key))\n              }, null, 10, _hoisted_5),\n              _createElementVNode(\"div\", _hoisted_6, _toDisplayString(_ctx.displayName(item.key)), 1)\n            ]))\n          }), 128))\n        ])\n      ]))\n    : _createCommentVNode(\"\", true)\n}","\r\nimport {\r\n  ARTIFACT_SET_MASTER_LIST,\r\n  getArtifactIconUrl,\r\n  STAR_BACKGROUND_IMAGE_CLASS,\r\n  TArtifactSetEntry,\r\n} from \"@/master\";\r\nimport { computed, defineComponent, PropType, reactive } from \"vue\";\r\nimport CompositionFunction from './CompositionFunction.vue';\r\n\r\nexport default defineComponent({\r\n  name: \"ArtifactSetSelect\",\r\n  props: {\r\n    visible: { type: Boolean, required: true },\r\n    index: { type: Number, required: true },\r\n    artifactSet: { type: String, required: true },\r\n    artifactSetMasters: { type: Array as PropType<TArtifactSetEntry[]>, required: true },\r\n    cat_id: { type: Number },\r\n  },\r\n  emits: [\"update:artifact-set\"],\r\n  setup(props) {\r\n    const { displayName } = CompositionFunction();\r\n\r\n    const bgImageClass = (item: TArtifactSetEntry) =>\r\n      (\" \" + STAR_BACKGROUND_IMAGE_CLASS[item.レアリティ]) as string;\r\n    const selectedClass = (item: TArtifactSetEntry) => {\r\n      return item.key == props.artifactSet ? \" selected\" : \"\";\r\n    };\r\n    const artifactSetMastersRea = reactive(props.artifactSetMasters);\r\n\r\n    const filteredList = computed(() => {\r\n      return ARTIFACT_SET_MASTER_LIST as TArtifactSetEntry[];\r\n    });\r\n\r\n    const artifactSetEffects = computed(() => {\r\n      const result = [] as any;\r\n      if (artifactSetMastersRea.length > 0) {\r\n        if (\"2セット効果\" in artifactSetMastersRea[0]) {\r\n          result.push({\r\n            key: artifactSetMastersRea[0].key + \" \" + \"2セット効果\",\r\n            value: artifactSetMastersRea[0][\"2セット効果\"]?.説明,\r\n          });\r\n        }\r\n        if (artifactSetMastersRea.length > 1) {\r\n          if (artifactSetMastersRea[0].key == artifactSetMastersRea[1].key) {\r\n            if (\"4セット効果\" in artifactSetMastersRea[0]) {\r\n              result.push({\r\n                key: artifactSetMastersRea[0].key + \" \" + \"4セット効果\",\r\n                value: artifactSetMastersRea[0][\"4セット効果\"]?.説明,\r\n              });\r\n            }\r\n          } else {\r\n            if (\"2セット効果\" in artifactSetMastersRea[1]) {\r\n              result.push({\r\n                key: artifactSetMastersRea[1].key + \" \" + \"2セット効果\",\r\n                value: artifactSetMastersRea[1][\"2セット効果\"]?.説明,\r\n              });\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return result;\r\n    });\r\n\r\n    return {\r\n      displayName,\r\n      getArtifactIconUrl,\r\n\r\n      bgImageClass,\r\n      selectedClass,\r\n      filteredList,\r\n      artifactSetEffects,\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./ArtifactSetSelect.vue?vue&type=template&id=91b28a50&scoped=true&ts=true\"\nimport script from \"./ArtifactSetSelect.vue?vue&type=script&lang=ts\"\nexport * from \"./ArtifactSetSelect.vue?vue&type=script&lang=ts\"\n\nimport \"./ArtifactSetSelect.vue?vue&type=style&index=0&id=91b28a50&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-91b28a50\"]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelCheckbox as _vModelCheckbox, createElementVNode as _createElementVNode, withDirectives as _withDirectives, normalizeClass as _normalizeClass, toDisplayString as _toDisplayString, vShow as _vShow, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-6b0e72ca\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { key: 0 }\nconst _hoisted_2 = { class: \"select-list\" }\nconst _hoisted_3 = [\"onUpdate:modelValue\", \"onChange\"]\nconst _hoisted_4 = [\"src\", \"alt\"]\nconst _hoisted_5 = { class: \"select-list\" }\nconst _hoisted_6 = [\"onUpdate:modelValue\", \"onChange\"]\nconst _hoisted_7 = [\"src\", \"alt\"]\nconst _hoisted_8 = { class: \"select-list\" }\nconst _hoisted_9 = [\"src\", \"alt\", \"onClick\"]\nconst _hoisted_10 = { class: \"tooltip\" }\nconst _hoisted_11 = [\"src\", \"alt\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_ctx.visible)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"ul\", _hoisted_2, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.elementList, (item) => {\n            return (_openBlock(), _createElementBlock(\"li\", { key: item }, [\n              _createElementVNode(\"label\", null, [\n                _withDirectives(_createElementVNode(\"input\", {\n                  class: \"hidden\",\n                  type: \"checkbox\",\n                  \"onUpdate:modelValue\": ($event: any) => ((_ctx.elementCheckList[item]) = $event),\n                  onChange: ($event: any) => (_ctx.checkListOnChange(item, _ctx.elementCheckList))\n                }, null, 40, _hoisted_3), [\n                  [_vModelCheckbox, _ctx.elementCheckList[item]]\n                ]),\n                _createElementVNode(\"img\", {\n                  class: \"filter\",\n                  src: _ctx.elementSrc(item),\n                  alt: item\n                }, null, 8, _hoisted_4)\n              ])\n            ]))\n          }), 128))\n        ]),\n        _createElementVNode(\"ul\", _hoisted_5, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.weaponList, (item) => {\n            return (_openBlock(), _createElementBlock(\"li\", { key: item }, [\n              _createElementVNode(\"label\", null, [\n                _withDirectives(_createElementVNode(\"input\", {\n                  class: \"hidden\",\n                  type: \"checkbox\",\n                  \"onUpdate:modelValue\": ($event: any) => ((_ctx.weaponCheckList[item]) = $event),\n                  onChange: ($event: any) => (_ctx.checkListOnChange(item, _ctx.weaponCheckList))\n                }, null, 40, _hoisted_6), [\n                  [_vModelCheckbox, _ctx.weaponCheckList[item]]\n                ]),\n                _createElementVNode(\"img\", {\n                  class: \"filter\",\n                  src: _ctx.weaponSrc(item),\n                  alt: item\n                }, null, 8, _hoisted_7)\n              ])\n            ]))\n          }), 128))\n        ]),\n        _createElementVNode(\"ul\", _hoisted_8, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.filteredList, (item) => {\n            return (_openBlock(), _createElementBlock(\"li\", {\n              class: \"with-tooltip\",\n              key: item.key\n            }, [\n              _createElementVNode(\"img\", {\n                class: _normalizeClass('character' + _ctx.bgImageClass(item) + _ctx.selectedClass(item)),\n                src: item.icon_url,\n                alt: item.key,\n                onClick: ($event: any) => (_ctx.characterOnClick(item.key))\n              }, null, 10, _hoisted_9),\n              _createElementVNode(\"div\", _hoisted_10, _toDisplayString(_ctx.displayName(item.key)), 1),\n              _createElementVNode(\"img\", {\n                class: \"vision\",\n                src: _ctx.visionSrc(item),\n                alt: item.元素\n              }, null, 8, _hoisted_11),\n              _withDirectives(_createElementVNode(\"div\", { class: \"selection-number\" }, _toDisplayString(_ctx.selectionNumber(item.key)), 513), [\n                [_vShow, _ctx.selectionNumber(item.key)]\n              ])\n            ]))\n          }), 128))\n        ])\n      ]))\n    : _createCommentVNode(\"\", true)\n}","\r\nimport {\r\n  TCharacterEntry,\r\n  ELEMENT_IMG_SRC,\r\n  TVisionKey,\r\n  WEAPON_IMG_SRC,\r\n  TWeaponTypeKey,\r\n  CHARACTER_MASTER_LIST,\r\n  STAR_BACKGROUND_IMAGE_CLASS,\r\n} from \"@/master\";\r\nimport { defineComponent, reactive, computed, PropType } from \"vue\";\r\nimport CompositionFunction from \"./CompositionFunction.vue\";\r\n\r\ninterface ICheckList {\r\n  [key: string]: boolean;\r\n}\r\n\r\nexport default defineComponent({\r\n  name: \"CharacterSelect\",\r\n  props: {\r\n    character: { type: String },\r\n    characters: { type: Array as PropType<string[]> },\r\n    visible: { type: Boolean, required: true },\r\n  },\r\n  emits: [\"update:character\", \"update:characters\"],\r\n  setup(props, context) {\r\n    const { displayName } = CompositionFunction();\r\n\r\n    const visionSrc = (item: TCharacterEntry) => ELEMENT_IMG_SRC[item.元素];\r\n    const bgImageClass = (item: TCharacterEntry) =>\r\n      (\" \" + STAR_BACKGROUND_IMAGE_CLASS[item.レアリティ]) as string;\r\n    const selectedClass = (item: TCharacterEntry) => {\r\n      if (props.character && props.character == item.key) {\r\n        return \" selected\";\r\n      }\r\n      if (props.characters && props.characters.includes(item.key)) {\r\n        return \" selected\";\r\n      }\r\n      return \"\";\r\n    };\r\n\r\n    const elementList = Object.keys(ELEMENT_IMG_SRC) as TVisionKey[];\r\n    const elementSrc = (element: TVisionKey) => ELEMENT_IMG_SRC[element] as string;\r\n    const elementCheckList = reactive({}) as ICheckList;\r\n    for (let key of elementList) {\r\n      elementCheckList[key] = false;\r\n    }\r\n\r\n    const weaponList = Object.keys(WEAPON_IMG_SRC) as TWeaponTypeKey[];\r\n    const weaponSrc = (weapon: TWeaponTypeKey) => WEAPON_IMG_SRC[weapon] as string;\r\n    const weaponCheckList = reactive({}) as ICheckList;\r\n    for (let key of weaponList) {\r\n      weaponCheckList[key] = false;\r\n    }\r\n\r\n    const checkListOnChange = function (item: string, checkList: ICheckList) {\r\n      if (!checkList[item]) return;\r\n      Object.keys(checkList)\r\n        .filter((s) => s != item)\r\n        .forEach((key) => {\r\n          checkList[key] = false;\r\n        });\r\n    };\r\n\r\n    const filteredList = computed(() => {\r\n      const result = [];\r\n      const elementChecked =\r\n        Object.keys(elementCheckList).filter((s) => elementCheckList[s]).length > 0;\r\n      const weaponChecked =\r\n        Object.keys(weaponCheckList).filter((s) => weaponCheckList[s]).length > 0;\r\n      for (let entry of CHARACTER_MASTER_LIST as TCharacterEntry[]) {\r\n        if (elementChecked && !elementCheckList[entry.元素]) continue;\r\n        if (weaponChecked && !weaponCheckList[entry.武器]) continue;\r\n        result.push(entry);\r\n      }\r\n      return result;\r\n    });\r\n\r\n    const selectionNumber = (character: string) => {\r\n      let result = \"\";\r\n      if (props.characters) {\r\n        const index = props.characters.indexOf(character);\r\n        if (index != -1) {\r\n          result = String(index + 1);\r\n        }\r\n      }\r\n      return result;\r\n    };\r\n\r\n    const characterOnClick = (character: string) => {\r\n      if (props.character) {\r\n        context.emit(\"update:character\", character);\r\n      }\r\n      if (props.characters) {\r\n        const characters: string[] = props.characters.map((s) => s);\r\n        const index = props.characters.indexOf(character);\r\n        if (index != -1) {\r\n          characters[index] = \"\";\r\n        } else {\r\n          const blankIndex = props.characters.indexOf(\"\");\r\n          if (blankIndex != -1) {\r\n            characters[blankIndex] = character;\r\n          }\r\n        }\r\n        context.emit(\"update:characters\", characters);\r\n      }\r\n    };\r\n\r\n    return {\r\n      displayName,\r\n\r\n      visionSrc,\r\n      bgImageClass,\r\n      selectedClass,\r\n      elementList,\r\n      elementSrc,\r\n      elementCheckList,\r\n      weaponList,\r\n      weaponSrc,\r\n      weaponCheckList,\r\n      checkListOnChange,\r\n      filteredList,\r\n\r\n      selectionNumber,\r\n      characterOnClick,\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./CharacterSelect.vue?vue&type=template&id=6b0e72ca&scoped=true&ts=true\"\nimport script from \"./CharacterSelect.vue?vue&type=script&lang=ts\"\nexport * from \"./CharacterSelect.vue?vue&type=script&lang=ts\"\n\nimport \"./CharacterSelect.vue?vue&type=style&index=0&id=6b0e72ca&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6b0e72ca\"]])\n\nexport default __exports__","\r\nimport i18n from \"@/i18n\";\r\nimport { STAT_PERCENT_LIST } from \"@/input\";\r\nimport { nextTick } from \"vue\";\r\nimport { useI18n } from \"vue-i18n\";\r\n\r\nexport default function CompositionFunction() {\r\n    const { t, te } = useI18n({\r\n        useScope: \"global\",\r\n    });\r\n\r\n    const localeList = [\r\n        { name: \"日本語\", value: \"ja-jp\" },\r\n        { name: \"English\", value: \"en-us\" },\r\n        { name: \"简体中文\", value: \"zh-cn\" },\r\n        { name: \"繁體中文\", value: \"zh-tw\" },\r\n        { name: \"한국어\", value: \"ko-kr\" },\r\n        { name: \"Deutsch\", value: \"de-de\" },\r\n        { name: \"Español\", value: \"es-es\" },\r\n        { name: \"Français\", value: \"fr-fr\" },\r\n        { name: \"Indonesia\", value: \"id-id\" },\r\n        { name: \"Português\", value: \"pt-pt\" },\r\n        { name: \"Pусский\", value: \"ru-ru\" },\r\n        { name: 'ภาษาไทย', value: 'th-th' },\r\n        { name: \"Tiếng Việt\", value: \"vi-vn\" },\r\n    ];\r\n\r\n    const setI18nLanguage = function (locale: string) {\r\n        i18n.global.locale.value = locale;\r\n        loadLocaleMessages(locale);\r\n        document.querySelector('html')?.setAttribute('lang', locale)\r\n    }\r\n\r\n    const loadLocaleMessages = async function (locale: string) {\r\n        if (locale != 'ja-jp') {\r\n            const messages = await fetch(`./locales/${locale}.json`).then(resp => resp.json());\r\n            i18n.global.setLocaleMessage(locale, messages);\r\n        }\r\n        return nextTick();\r\n    }\r\n\r\n    const displayName = function (key: any): string {\r\n        if (!key) return key;\r\n        if (i18n.global.locale.value === 'ja-jp') { // 日本語はtranslateしません\r\n            let result = String(key);\r\n            if (['ダメージバフ', 'ダメージアップ', '反応ボーナス', '敵'].includes(result)) {\r\n                return result;\r\n            }\r\n            result = result.replace(/ダメージバフ$/, 'ダメージ');\r\n            result = result.replace(/ダメージアップ$/, 'ダメージ');\r\n            result = result.replace('凍結反応ボーナス', '凍結反応の継続時間');\r\n            result = result.replace(/反応ボーナス$/, '反応ダメージ');\r\n            result = result.replace(/^敵/, '敵の');\r\n            return result;\r\n        }\r\n        if (te(key)) return t(key);\r\n        const re = new RegExp('(.*?)([\\\\s_\\\\(\\\\)/]+)(.*)');\r\n        let result = '';\r\n        let work = key;\r\n        while (work) {\r\n            const reRet = re.exec(work);\r\n            if (!reRet) {\r\n                result += t(work);\r\n                break;\r\n            }\r\n            if (reRet[1]) result += t(reRet[1]);\r\n            result += reRet[2];\r\n            work = reRet[3];\r\n        }\r\n        return result;\r\n    }\r\n\r\n    const percent = function (stat: string) {\r\n        const tempArr = stat.split('.');\r\n        let work = tempArr[0].replace(/V[1-3]$/, '');\r\n        let hasPercent = work.endsWith(\"%\") || STAT_PERCENT_LIST.includes(work);\r\n        if (!hasPercent) {\r\n            ['会心率', '会心ダメージ', 'クールタイム', '攻撃速度'].forEach(postfix => {\r\n                if (work.endsWith(postfix)) hasPercent = true;\r\n            })\r\n        }\r\n        return hasPercent ? '%' : '';\r\n    }\r\n\r\n    const displayStatName = function (stat: string) {\r\n        let result = stat.replace(/V[1-3]$/, '');\r\n        const tempArr = result.split('.');\r\n        if (tempArr.length == 1) {\r\n            result = displayName(result);\r\n            result = result.replace('ダメージ会心', 'ダメージの会心')\r\n        } else if (i18n.global.locale.value === 'ja-jp') {\r\n            result = tempArr[tempArr.length - 1] + 'の' + displayName(tempArr[0]);\r\n        } else {\r\n            result = displayName(tempArr[tempArr.length - 1]) + ' ' + displayName(tempArr[0]);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    const displayStatValue = function (stat: string, value: number, opt_s?: number): string {\r\n        const myPercent = percent(stat);\r\n        let p = myPercent ? 10 : 1;\r\n        if (opt_s) p = Math.pow(10, opt_s);\r\n        return String(Math.round(value * p) / p) + myPercent;\r\n    }\r\n\r\n    const displayStatAbbrev = function (stat: string) {\r\n        let result = stat;\r\n        const tempArr = stat.split('.');\r\n        if (tempArr.length == 1) {\r\n            stat = stat.replace(/V\\d$/, '');\r\n            stat = stat.replace(/TOP$/, '');\r\n            if (stat.startsWith('敵')) stat = stat.replace(/^敵/, '');\r\n            if (stat.endsWith('ダメージバフ')) stat = stat.replace(/ダメージバフ$/, '');\r\n            else if (stat.endsWith('ダメージアップ')) stat = stat.replace(/ダメージアップ$/, '');\r\n            else if (stat.endsWith('元素ダメージ')) stat = stat.replace(/元素ダメージ$/, '');\r\n            else if (stat.endsWith('物理ダメージ')) stat = stat.replace(/ダメージ$/, '');\r\n            else if (stat.endsWith('反応ボーナス')) stat = stat.replace(/反応ボーナス$/, '');\r\n            else if (stat.endsWith('耐性')) stat = stat.replace(/耐性$/, '');\r\n            result = displayName(stat);\r\n        } else {\r\n            result = displayStatName(stat);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /** $event.target.valueでのtypescriptエラー回避のために */\r\n    const targetValue = function (event: Event) {\r\n        if (event.target instanceof HTMLInputElement) return event.target.value;\r\n        if (event.target instanceof HTMLSelectElement) return event.target.value;\r\n        return undefined;\r\n    }\r\n\r\n    const displayOptionName = function (name: string) {\r\n        return displayName(name.replace(/^required_/, \"\"));\r\n    }\r\n\r\n    return {\r\n        localeList,\r\n        setI18nLanguage,\r\n        loadLocaleMessages,\r\n        displayName,\r\n        displayStatName,\r\n        displayStatValue,\r\n        displayStatAbbrev,\r\n        targetValue,\r\n        displayOptionName,\r\n        percent,\r\n    }\r\n}\r\n","import script from \"./CompositionFunction.vue?vue&type=script&lang=ts\"\nexport * from \"./CompositionFunction.vue?vue&type=script&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vShow as _vShow, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"member\" }\nconst _hoisted_2 = { class: \"with-tooltip\" }\nconst _hoisted_3 = [\"src\", \"alt\"]\nconst _hoisted_4 = { class: \"tooltip\" }\nconst _hoisted_5 = [\"src\"]\nconst _hoisted_6 = [\"src\", \"alt\"]\nconst _hoisted_7 = [\"src\", \"alt\"]\nconst _hoisted_8 = {\n  key: 0,\n  class: \"stat-value\"\n}\nconst _hoisted_9 = { key: 1 }\nconst _hoisted_10 = [\"src\"]\nconst _hoisted_11 = [\"src\"]\nconst _hoisted_12 = [\"src\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", {\n      class: \"member-img\",\n      onDblclick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.characterOnDblclick && _ctx.characterOnDblclick(...args)))\n    }, [\n      _createElementVNode(\"div\", _hoisted_2, [\n        _createElementVNode(\"img\", {\n          class: _normalizeClass('character' + _ctx.characterImgClass),\n          src: _ctx.characterImgSrc,\n          alt: _ctx.displayName(_ctx.member.name)\n        }, null, 10, _hoisted_3),\n        _createElementVNode(\"span\", _hoisted_4, _toDisplayString(_ctx.displayName(_ctx.member.name)), 1)\n      ]),\n      _createElementVNode(\"img\", {\n        class: \"vision\",\n        src: _ctx.visionImgSrc,\n        alt: \"vision\"\n      }, null, 8, _hoisted_5),\n      _withDirectives(_createElementVNode(\"div\", { class: \"constellation\" }, _toDisplayString(_ctx.constellation), 513), [\n        [_vShow, _ctx.constellation]\n      ]),\n      (_ctx.member.tags[3])\n        ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 0,\n            class: _normalizeClass('tag tag-3' + _ctx.tagColorClass(3))\n          }, _toDisplayString(_ctx.member.tags[3]), 3))\n        : _createCommentVNode(\"\", true),\n      (_ctx.member.tags[2])\n        ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 1,\n            class: _normalizeClass('tag tag-2' + _ctx.tagColorClass(2))\n          }, _toDisplayString(_ctx.member.tags[2]), 3))\n        : _createCommentVNode(\"\", true),\n      (_ctx.member.tags[1])\n        ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 2,\n            class: _normalizeClass('tag tag-1' + _ctx.tagColorClass(1))\n          }, _toDisplayString(_ctx.member.tags[1]), 3))\n        : _createCommentVNode(\"\", true),\n      (_ctx.member.tags[0])\n        ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 3,\n            class: _normalizeClass('tag tag-0' + _ctx.tagColorClass(0))\n          }, _toDisplayString(_ctx.member.tags[0]), 3))\n        : _createCommentVNode(\"\", true),\n      (_ctx.member.replacements[0])\n        ? (_openBlock(), _createElementBlock(\"img\", {\n            key: 4,\n            class: \"replacement replacement-0\",\n            src: _ctx.replaceImgSrc(0),\n            alt: _ctx.member.replacements[0]\n          }, null, 8, _hoisted_6))\n        : _createCommentVNode(\"\", true),\n      (_ctx.member.replacements[1])\n        ? (_openBlock(), _createElementBlock(\"img\", {\n            key: 5,\n            class: \"replacement replacement-1\",\n            src: _ctx.replaceImgSrc(1),\n            alt: _ctx.member.replacements[1]\n          }, null, 8, _hoisted_7))\n        : _createCommentVNode(\"\", true)\n    ], 32),\n    (_ctx.displayStat)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, _toDisplayString(_ctx.statValue), 1))\n      : _createCommentVNode(\"\", true),\n    (_ctx.showEquipment)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n          _createElementVNode(\"img\", {\n            class: \"weapon\",\n            src: _ctx.imgWeaponSrc,\n            alt: \"weapon\"\n          }, null, 8, _hoisted_10),\n          _createElementVNode(\"img\", {\n            class: \"artifact-set\",\n            src: _ctx.imgArtifactSetSrc(0),\n            alt: \"artifact-set\"\n          }, null, 8, _hoisted_11),\n          _createElementVNode(\"img\", {\n            class: \"artifact-set\",\n            src: _ctx.imgArtifactSetSrc(1),\n            alt: \"artifact-set\"\n          }, null, 8, _hoisted_12)\n        ]))\n      : _createCommentVNode(\"\", true)\n  ]))\n}","\r\nimport { computed, defineComponent, PropType, ref, watch } from \"vue\";\r\nimport { pushBuildinfoToSession, TStats } from \"@/input\";\r\nimport CompositionFunction from \"@/components/CompositionFunction.vue\";\r\nimport { ARTIFACT_SET_MASTER, CHARACTER_MASTER, ELEMENT_COLOR_CLASS, ELEMENT_IMG_SRC, IMG_SRC_DUMMY, STAR_BACKGROUND_IMAGE_CLASS, TArtifactSetEntry, TCharacterEntry, TCharacterKey, TElementColorClassKey, TWeaponEntry, WEAPON_MASTER } from \"@/master\";\r\nimport { getBuilddataFromStorage, TMember } from \"./team\";\r\n\r\nexport default defineComponent({\r\n  name: 'MemberItem',\r\n  props: {\r\n    member: { type: Object as PropType<TMember>, required: true },\r\n    displayStat: { type: String },\r\n    showEquipment: { type: Boolean },\r\n    statsObj: { type: Object as PropType<TStats> },\r\n    viewable: { type: Boolean },\r\n    tags: { type: Array as PropType<any[]> },\r\n    members: { type: Array as PropType<string[]> },\r\n    elementalResonance: { type: Array as PropType<string[]> },\r\n  },\r\n  setup(props) {\r\n    const { displayName, displayStatValue } = CompositionFunction();\r\n\r\n    const watchCount = ref(0);\r\n    watch(props, () => {\r\n      watchCount.value++;\r\n    });\r\n\r\n    const characterMaster = computed(() => props.member.name ? (CHARACTER_MASTER[props.member.name as TCharacterKey] as TCharacterEntry) ?? undefined : undefined);\r\n    const characterImgSrc = computed(() => characterMaster.value?.icon_url ?? IMG_SRC_DUMMY);\r\n    const characterImgClass = computed(() => characterMaster.value?.レアリティ ? (' ' + (STAR_BACKGROUND_IMAGE_CLASS as any)[String(characterMaster.value.レアリティ)]) : '');\r\n    const visionImgSrc = computed(() => characterMaster.value?.元素 ? (ELEMENT_IMG_SRC as any)[characterMaster.value.元素] : IMG_SRC_DUMMY);\r\n    const constellation = computed(() => (builddata.value ? builddata.value.命ノ星座 : ''));\r\n    const builddata = computed(() => (props.member.name && props.member.buildname) ? getBuilddataFromStorage(props.member.name, props.member.buildname) : undefined);\r\n    const weaponMaster = computed((): TWeaponEntry => {\r\n      let result = undefined;\r\n      if (builddata.value) {\r\n        const weapon = builddata.value.武器;\r\n        if (weapon && characterMaster.value) {\r\n          result = (WEAPON_MASTER as any)[characterMaster.value.武器][weapon];\r\n        }\r\n      }\r\n      return result;\r\n    });\r\n    const imgWeaponSrc = computed(() => weaponMaster.value?.icon_url ?? IMG_SRC_DUMMY);\r\n    const weaponName = computed(() => weaponMaster.value?.key ?? '');\r\n    const statValue = computed(() => {\r\n      watchCount.value;\r\n      let result = '-';\r\n      if (builddata.value) {\r\n        let stat = props.displayStat;\r\n        if (props.statsObj && stat) {\r\n          if (stat === '会心率/ダメージ') {\r\n            result = displayStatValue('会心率', props.statsObj['会心率']);\r\n            result += '/';\r\n            result += displayStatValue('会心ダメージ', props.statsObj['会心ダメージ']);\r\n          } else {\r\n            result = displayStatValue(stat, props.statsObj[stat]);\r\n          }\r\n        }\r\n      }\r\n      return result;\r\n    });\r\n    const artifactSetMasters = computed((): TArtifactSetEntry[] => {\r\n      const result: TArtifactSetEntry[] = [];\r\n      if (builddata.value) {\r\n        for (let i = 0; i < 2; i++) {\r\n          const key = '聖遺物セット効果' + (i + 1);\r\n          let value = builddata.value[key] ?? 'NONE';\r\n          result.push((ARTIFACT_SET_MASTER as any)[value]);\r\n        }\r\n      }\r\n      return result;\r\n    });\r\n\r\n    const replaceImgSrc = (replIndex: number) => {\r\n      const name = replIndex < props.member.replacements.length ? props.member.replacements[replIndex] : undefined;\r\n      return name ? (CHARACTER_MASTER[name as TCharacterKey] as TCharacterEntry).icon_url : IMG_SRC_DUMMY;\r\n    };\r\n    const imgArtifactSetSrc = (index: number) => artifactSetMasters.value[index]?.image ?? IMG_SRC_DUMMY;\r\n    const artifactSetName = (index: number) => artifactSetMasters.value[index]?.key ?? '';\r\n    const tagColorClass = (index: number) =>\r\n      Object.keys(ELEMENT_COLOR_CLASS).map(key => ELEMENT_COLOR_CLASS[(key as TElementColorClassKey)]).includes(props.member.tags[index].toLowerCase()) ? ' ' + props.member.tags[index].toLowerCase() : '';\r\n\r\n    const characterOnDblclick = () => {\r\n      if (props.viewable) {\r\n        locate();\r\n      }\r\n    };\r\n\r\n    const locate = () => {\r\n      const member = props.member;\r\n      if (member?.name) {\r\n        if (confirm('げんかるくで' + member.name + 'を開きます。よろしいですか？')) {\r\n          const teammembers = props.members?.filter(s => s != member.name);\r\n          pushBuildinfoToSession(member.name, member.buildname, undefined, teammembers);\r\n          window.open('./', '_blank');\r\n        }\r\n      }\r\n    };\r\n\r\n    return {\r\n      displayName,\r\n\r\n      characterImgSrc,\r\n      characterImgClass,\r\n      visionImgSrc,\r\n      constellation,\r\n      replaceImgSrc,\r\n      imgWeaponSrc,\r\n      weaponName,\r\n      imgArtifactSetSrc,\r\n      artifactSetName,\r\n      tagColorClass,\r\n      statValue,\r\n\r\n      characterOnDblclick,\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./MemberItem.vue?vue&type=template&id=0f8e14be&ts=true\"\nimport script from \"./MemberItem.vue?vue&type=script&lang=ts\"\nexport * from \"./MemberItem.vue?vue&type=script&lang=ts\"\n\nimport \"./MemberItem.vue?vue&type=style&index=0&id=0f8e14be&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, createVNode as _createVNode, vShow as _vShow, vModelSelect as _vModelSelect, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-7c066fb2\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1))\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"th\", null, \"Team Name\", -1))\nconst _hoisted_3 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"th\", null, \"Character Select Mode\", -1))\nconst _hoisted_4 = {\n  colspan: \"2\",\n  class: \"character-select-mode\"\n}\nconst _hoisted_5 = { key: 0 }\nconst _hoisted_6 = { key: 1 }\nconst _hoisted_7 = { class: \"member-tags\" }\nconst _hoisted_8 = { colspan: \"2\" }\nconst _hoisted_9 = [\"onClick\"]\nconst _hoisted_10 = { class: \"members\" }\nconst _hoisted_11 = { colspan: \"2\" }\nconst _hoisted_12 = { class: \"buildname-select\" }\nconst _hoisted_13 = [\"value\"]\nconst _hoisted_14 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"th\", null, \"Short Note\", -1))\nconst _hoisted_15 = { class: \"team-tags\" }\nconst _hoisted_16 = { colspan: \"2\" }\nconst _hoisted_17 = [\"onClick\"]\nconst _hoisted_18 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"th\", null, \"Tags\", -1))\nconst _hoisted_19 = { class: \"buttons\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_CharacterSelect = _resolveComponent(\"CharacterSelect\")!\n  const _component_MemberItem = _resolveComponent(\"MemberItem\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    (!_ctx.characterSelectMode)\n      ? (_openBlock(), _createBlock(_component_CharacterSelect, {\n          key: 0,\n          visible: true,\n          characters: _ctx.characters,\n          \"onUpdate:characters\": _ctx.updateCharacters\n        }, null, 8, [\"characters\", \"onUpdate:characters\"]))\n      : (_openBlock(), _createBlock(_component_CharacterSelect, {\n          key: 1,\n          visible: true,\n          characters: _ctx.replacements,\n          \"onUpdate:characters\": _ctx.updateReplacements\n        }, null, 8, [\"characters\", \"onUpdate:characters\"])),\n    _hoisted_1,\n    _createElementVNode(\"table\", null, [\n      _createElementVNode(\"tr\", null, [\n        _hoisted_2,\n        _createElementVNode(\"td\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.workTeam.name) = $event)),\n            type: \"text\",\n            minlength: \"1\",\n            maxlength: \"16\",\n            placeholder: \"INPUT TEAM NAME\"\n          }, null, 512), [\n            [_vModelText, _ctx.workTeam.name]\n          ])\n        ])\n      ]),\n      _createElementVNode(\"tr\", null, [\n        _hoisted_3,\n        _createElementVNode(\"td\", null, [\n          _createElementVNode(\"button\", {\n            class: \"character-select-mode\",\n            onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.characterSelectModeOnClick && _ctx.characterSelectModeOnClick(...args)))\n          }, _toDisplayString(_ctx.characterSelectMode ? 'REPLACEMENTS' : 'MEMBERS'), 1)\n        ])\n      ]),\n      _createElementVNode(\"tr\", null, [\n        _createElementVNode(\"td\", _hoisted_4, [\n          (!_ctx.characterSelectMode)\n            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, \" チームメンバーを選択して下さい \"))\n            : (_openBlock(), _createElementBlock(\"span\", _hoisted_6, _toDisplayString(_ctx.selectedMemberName() + 'の代替キャラクターを選択して下さい'), 1))\n        ])\n      ]),\n      _createElementVNode(\"tr\", _hoisted_7, [\n        _createElementVNode(\"td\", _hoisted_8, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.MEMBER_TAG_LIST, (tag) => {\n            return (_openBlock(), _createElementBlock(\"span\", {\n              class: _normalizeClass('tag' + _ctx.tagSelectedClass(tag)),\n              key: tag,\n              onClick: ($event: any) => (_ctx.tagOnClick(tag))\n            }, _toDisplayString(tag), 11, _hoisted_9))\n          }), 128))\n        ])\n      ]),\n      _createElementVNode(\"tr\", _hoisted_10, [\n        _createElementVNode(\"td\", _hoisted_11, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.workTeam.members, (member) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n              class: _normalizeClass('member' + _ctx.memberSelectedClass(member.id)),\n              key: member.id\n            }, [\n              _createVNode(_component_MemberItem, {\n                member: member,\n                onClick: ($event: any) => (_ctx.memberOnClick(member.id))\n              }, null, 8, [\"member\", \"onClick\"])\n            ], 2))\n          }), 128)),\n          _createElementVNode(\"div\", _hoisted_12, [\n            _withDirectives(_createElementVNode(\"select\", {\n              \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.selectedMemberBuildname) = $event)),\n              onChange: _cache[3] || (_cache[3] = \n//@ts-ignore\n(...args) => (_ctx.buildnameOnChange && _ctx.buildnameOnChange(...args)))\n            }, [\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.buildnames, (value) => {\n                return (_openBlock(), _createElementBlock(\"option\", {\n                  key: value,\n                  value: value\n                }, _toDisplayString(value), 9, _hoisted_13))\n              }), 128))\n            ], 544), [\n              [_vShow, _ctx.buildnames.length],\n              [_vModelSelect, _ctx.selectedMemberBuildname]\n            ])\n          ])\n        ])\n      ]),\n      _createElementVNode(\"tr\", null, [\n        _hoisted_14,\n        _createElementVNode(\"td\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            class: \"description\",\n            \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((_ctx.workTeam.description) = $event)),\n            type: \"text\",\n            maxlength: \"40\",\n            placeholder: \"INPUT NOTE\"\n          }, null, 512), [\n            [_vModelText, _ctx.workTeam.description]\n          ])\n        ])\n      ]),\n      _createElementVNode(\"tr\", _hoisted_15, [\n        _createElementVNode(\"td\", _hoisted_16, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.workTeamTags, (tag) => {\n            return (_openBlock(), _createElementBlock(\"span\", {\n              class: _normalizeClass(_ctx.teamTagSelected(tag) ? 'tag selected' : 'tag'),\n              key: tag,\n              onClick: ($event: any) => (_ctx.teamTagOnClick(tag))\n            }, _toDisplayString(tag), 11, _hoisted_17))\n          }), 128))\n        ])\n      ]),\n      _createElementVNode(\"tr\", null, [\n        _hoisted_18,\n        _createElementVNode(\"td\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            class: \"team-tags\",\n            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.txtTeamTags) = $event)),\n            type: \"text\",\n            maxlength: \"40\",\n            placeholder: \"INPUT TAGS\",\n            onChange: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.txtTeamTagsOnChange && _ctx.txtTeamTagsOnChange(...args)))\n          }, null, 544), [\n            [_vModelText, _ctx.txtTeamTags]\n          ])\n        ])\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_19, [\n      _createElementVNode(\"button\", {\n        type: \"button\",\n        onClick: _cache[7] || (_cache[7] = \n//@ts-ignore\n(...args) => (_ctx.cancelOnClick && _ctx.cancelOnClick(...args)))\n      }, \"cancel\"),\n      _createElementVNode(\"button\", {\n        type: \"button\",\n        onClick: _cache[8] || (_cache[8] = \n//@ts-ignore\n(...args) => (_ctx.okOnClick && _ctx.okOnClick(...args)))\n      }, \"ok\")\n    ])\n  ], 64))\n}","\r\nimport _ from 'lodash';\r\nimport { computed, defineComponent, PropType, reactive, ref, watch } from 'vue';\r\nimport { makeDefaultBuildname } from '@/input';\r\nimport CharacterSelect from '@/components/CharacterSelect.vue';\r\nimport { getBuildnameFromStorageKey, getBuildStorageKeys, TMember, TTeam } from './team';\r\nimport MemberItem from './MemberItem.vue';\r\n\r\nexport default defineComponent({\r\n  name: 'TeamEditorModal',\r\n  components: {\r\n    CharacterSelect,\r\n    MemberItem,\r\n  },\r\n  props: {\r\n    visible: { type: Boolean, required: true },\r\n    team: { type: Object as PropType<TTeam>, required: true },\r\n    teamTags: { type: Array as PropType<string[]> },\r\n  },\r\n  emits: ['click:cancel', 'click:ok'],\r\n  setup(props, context) {\r\n    const characterSelectMode = ref(false); // キャラクター選択モード=メンバー選択\r\n    const workTeam = reactive({\r\n      id: -1,\r\n      name: '',\r\n      members: [],\r\n      description: '',\r\n      rotation: [],\r\n      rotationDescription: '',\r\n      tags: [],\r\n    } as TTeam);\r\n    const selectedMemberId = ref(-1);\r\n    const MEMBER_TAG_LIST = ['Main-DPS', 'Sub-DPS', 'Support', 'Carry', 'Driver', 'Enabler', 'Healer', 'Shielder', 'Battery', 'Free', 'Flex'];\r\n    const selectedMemberBuildname = ref('' as string | undefined);\r\n    const replacementIndex = ref(-1);\r\n    const txtTeamTags = ref('');\r\n    const workTeamTags = reactive([] as string[]);\r\n\r\n    function duplicateTeam() {\r\n      workTeam.id = props.team.id;\r\n      workTeam.name = props.team.name;\r\n      const work: TMember[] = [];\r\n      for (let i = 0; i < props.team.members.length; i++) {\r\n        work.push({\r\n          id: i,\r\n          name: props.team.members[i].name,\r\n          buildname: props.team.members[i].buildname,\r\n          builddata: props.team.members[i].builddata,\r\n          tags: _.cloneDeep(props.team.members[i].tags.filter(s => MEMBER_TAG_LIST.includes(s))),\r\n          replacements: props.team.members[i].replacements ? [...props.team.members[i].replacements] : [],\r\n        });\r\n      }\r\n      workTeam.members.splice(0, workTeam.members.length, ...work);\r\n      workTeam.description = props.team.description;\r\n      workTeam.rotation = _.cloneDeep(props.team.rotation);\r\n      workTeam.tags = _.clone(props.team.tags);\r\n    }\r\n    duplicateTeam();\r\n    setupTxtTeamTags();\r\n\r\n    watch(props, (newVal) => {\r\n      if (newVal.team.members) {\r\n        duplicateTeam();\r\n        if (selectedMemberId.value >= 0 && selectedMemberId.value < workTeam.members.length) {\r\n          selectedMemberBuildname.value = workTeam.members[selectedMemberId.value].buildname;\r\n        }\r\n      }\r\n      if (newVal.teamTags) {\r\n        workTeamTags.splice(0, workTeamTags.length, ...newVal.teamTags);\r\n      }\r\n      setupTxtTeamTags();\r\n      characterSelectMode.value = false;\r\n    });\r\n\r\n    const characters = computed(() => workTeam.members.map((s) => s.name));\r\n\r\n    const replacements = computed(() => {\r\n      let result = [] as string[];\r\n      if (selectedMemberId.value >= 0 && selectedMemberId.value < workTeam.members.length) {\r\n        const member = workTeam.members[selectedMemberId.value];\r\n        result = [...member.replacements];\r\n        for (let i = result.length; i < 2; i++) {\r\n          result.push('');\r\n        }\r\n      }\r\n      return result;\r\n    });\r\n\r\n    const updateCharacters = (newCharacters: string[]) => {\r\n      for (let i = 0; i < newCharacters.length; i++) {\r\n        if (workTeam.members[i].name != newCharacters[i]) {\r\n          workTeam.members[i].tags = [];\r\n          workTeam.members[i].replacements = [];\r\n        }\r\n        workTeam.members[i].name = newCharacters[i];\r\n        if (workTeam.members[i].name) {\r\n          const workBuildnames = getBuildStorageKeys(workTeam.members[i].name).map(s => getBuildnameFromStorageKey(s));\r\n          if (workBuildnames.length) {\r\n            if (!workTeam.members[i].buildname || !workBuildnames.includes(workTeam.members[i].buildname as string)) {\r\n              workTeam.members[i].buildname = makeDefaultBuildname(workTeam.members[i].name);\r\n            }\r\n            if (i == selectedMemberId.value) {\r\n              selectedMemberBuildname.value = workTeam.members[i].buildname;\r\n            }\r\n          } else {\r\n            workTeam.members[i].buildname = undefined;\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    const characterSelectModeOnClick = () => {\r\n      if (selectedMemberId.value >= 0 && selectedMemberId.value < workTeam.members.length && workTeam.members[selectedMemberId.value].name) {\r\n        characterSelectMode.value = !characterSelectMode.value;\r\n      }\r\n    };\r\n\r\n    const memberOnClick = (id: number) => {\r\n      selectedMemberId.value = id;\r\n      if (selectedMemberId.value >= 0 && selectedMemberId.value < workTeam.members.length) {\r\n        const member = workTeam.members[selectedMemberId.value];\r\n        selectedMemberBuildname.value = member.buildname;\r\n        replacementIndex.value = -1;\r\n      }\r\n      characterSelectMode.value = false;  // メンバー選択\r\n    };\r\n    const memberSelectedClass = (id: number) =>\r\n      id == selectedMemberId.value ? ' selected' : '';\r\n    const selectedMemberName = () => {\r\n      if (selectedMemberId.value >= 0 && selectedMemberId.value < workTeam.members.length) {\r\n        return workTeam.members[selectedMemberId.value].name;\r\n      }\r\n      return '';\r\n    };\r\n\r\n    const tagOnClick = (tag: string) => {\r\n      if (selectedMemberId.value < 0 || selectedMemberId.value >= workTeam.members.length)\r\n        return;\r\n      const member = workTeam.members[selectedMemberId.value];\r\n      if (member && member.name) {\r\n        const tags = member.tags;\r\n        if (tags) {\r\n          if (tags.includes(tag)) {\r\n            tags.splice(0, tags.length, ...tags.filter((s) => s != tag));\r\n          } else {\r\n            tags.push(tag);\r\n          }\r\n        }\r\n      }\r\n    };\r\n    const tagSelectedClass = (tag: string) => {\r\n      let result = false;\r\n      if (selectedMemberId.value >= 0 || selectedMemberId.value < workTeam.members.length) {\r\n        const member = workTeam.members[selectedMemberId.value];\r\n        if (member && member.name) {\r\n          result = member.tags.includes(tag);\r\n        }\r\n      }\r\n      return result ? ' selected' : '';\r\n    };\r\n\r\n    const buildnames = computed(() => {\r\n      let result: string[] = [];\r\n      if (selectedMemberId.value >= 0 && selectedMemberId.value < workTeam.members.length) {\r\n        const member = workTeam.members[selectedMemberId.value];\r\n        const character = member.name;\r\n        if (character) {\r\n          result = getBuildStorageKeys(character).map((s) =>\r\n            getBuildnameFromStorageKey(s)\r\n          );\r\n          const defaultBuildname = makeDefaultBuildname(character);\r\n          if (result.includes(defaultBuildname)) {\r\n            const others = result.filter((s) => s != defaultBuildname).sort();\r\n            if (others.length) {\r\n              result = [defaultBuildname, ...others];\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return result;\r\n    });\r\n\r\n    const buildnameOnChange = () => {\r\n      if (selectedMemberId.value < 0 || selectedMemberId.value >= workTeam.members.length) return;\r\n      const member = workTeam.members[selectedMemberId.value];\r\n      member.buildname = selectedMemberBuildname.value;\r\n    };\r\n\r\n    const updateReplacements = (newCharacters: string[]) => {\r\n      const member = workTeam.members[selectedMemberId.value];\r\n      member.replacements = [...newCharacters];\r\n    };\r\n\r\n    function setupTxtTeamTags() {\r\n      txtTeamTags.value = workTeam.tags.join(' ');\r\n    }\r\n\r\n    const txtTeamTagsOnChange = () => {\r\n      let result: string[] = [];\r\n      if (txtTeamTags.value) {\r\n        result = txtTeamTags.value.split(/\\s+/).filter(tag => tag);\r\n      }\r\n      workTeam.tags = result;\r\n    }\r\n\r\n    const teamTagSelected = (tag: string) => workTeam.tags.includes(tag);\r\n\r\n    const teamTagOnClick = (tag: string) => {\r\n      if (teamTagSelected(tag)) {\r\n        workTeam.tags.splice(0, workTeam.tags.length, ...workTeam.tags.filter(s => s != tag));\r\n      } else {\r\n        workTeam.tags.push(tag);\r\n      }\r\n      setupTxtTeamTags();\r\n    }\r\n\r\n    const cancelOnClick = () => {\r\n      context.emit('click:cancel');\r\n    };\r\n\r\n    const okOnClick = () => {\r\n      context.emit('click:ok', workTeam);\r\n    };\r\n\r\n    return {\r\n      characterSelectMode,\r\n      characters,\r\n      replacements,\r\n      MEMBER_TAG_LIST,\r\n\r\n      characterSelectModeOnClick,\r\n      selectedMemberId,\r\n      selectedMemberName,\r\n\r\n      tagOnClick,\r\n      tagSelectedClass,\r\n\r\n      workTeam,\r\n      workTeamTags,\r\n      txtTeamTags,\r\n      txtTeamTagsOnChange,\r\n      teamTagSelected,\r\n      teamTagOnClick,\r\n      memberOnClick,\r\n      memberSelectedClass,\r\n      selectedMemberBuildname,\r\n      buildnames,\r\n      buildnameOnChange,\r\n      updateReplacements,\r\n\r\n      updateCharacters,\r\n      cancelOnClick,\r\n      okOnClick,\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./TeamEditorModal.vue?vue&type=template&id=7c066fb2&scoped=true&ts=true\"\nimport script from \"./TeamEditorModal.vue?vue&type=script&lang=ts\"\nexport * from \"./TeamEditorModal.vue?vue&type=script&lang=ts\"\n\nimport \"./TeamEditorModal.vue?vue&type=style&index=0&id=7c066fb2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7c066fb2\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, resolveComponent as _resolveComponent, createVNode as _createVNode, normalizeClass as _normalizeClass } from \"vue\"\n\nconst _hoisted_1 = { class: \"title\" }\nconst _hoisted_2 = { class: \"name\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"handle\" }, \"◆\", -1)\nconst _hoisted_4 = { class: \"elemental-resonance\" }\nconst _hoisted_5 = [\"src\"]\nconst _hoisted_6 = { class: \"members\" }\nconst _hoisted_7 = {\n  key: 0,\n  class: \"res\"\n}\nconst _hoisted_8 = {\n  key: 1,\n  class: \"team-tags\"\n}\nconst _hoisted_9 = { style: {\"text-align\":\"left\"} }\nconst _hoisted_10 = { class: \"description\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MemberItem = _resolveComponent(\"MemberItem\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass('team' + _ctx.selectedClass)\n  }, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createElementVNode(\"label\", _hoisted_2, [\n        _hoisted_3,\n        _createElementVNode(\"span\", null, _toDisplayString(_ctx.team.name), 1),\n        (_ctx.editable && _ctx.selected)\n          ? (_openBlock(), _createElementBlock(\"span\", {\n              key: 0,\n              class: \"button material-symbols-outlined\",\n              onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.editOnClick && _ctx.editOnClick(...args)))\n            }, \" edit_square \"))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _createElementVNode(\"div\", _hoisted_4, [\n        (_openBlock(), _createElementBlock(_Fragment, null, _renderList([0, 1, 2, 3], (index) => {\n          return (_openBlock(), _createElementBlock(_Fragment, { key: index }, [\n            (_ctx.resonanceElementImgSrcs[index])\n              ? (_openBlock(), _createElementBlock(\"img\", {\n                  key: 0,\n                  class: \"elemental-resonance\",\n                  src: _ctx.resonanceElementImgSrcs[index],\n                  alt: \"resonance\"\n                }, null, 8, _hoisted_5))\n              : _createCommentVNode(\"\", true)\n          ], 64))\n        }), 64))\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_6, [\n      _createElementVNode(\"table\", null, [\n        _createElementVNode(\"tr\", null, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.team.members, (member) => {\n            return (_openBlock(), _createElementBlock(\"td\", {\n              key: member.id\n            }, [\n              _createVNode(_component_MemberItem, {\n                member: member,\n                statsObj: _ctx.memberStats[member.id],\n                displayStat: _ctx.displayStat,\n                showEquipment: _ctx.showEquipment,\n                viewable: true,\n                members: _ctx.team.members.map(s => s.name),\n                elementalResonance: _ctx.elementalResonance\n              }, null, 8, [\"member\", \"statsObj\", \"displayStat\", \"showEquipment\", \"members\", \"elementalResonance\"])\n            ]))\n          }), 128))\n        ])\n      ])\n    ]),\n    (_ctx.displayRes)\n      ? (_openBlock(), _createElementBlock(\"table\", _hoisted_7, [\n          _createElementVNode(\"tr\", null, [\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.resKey, (key) => {\n              return (_openBlock(), _createElementBlock(\"td\", {\n                key: key,\n                class: _normalizeClass(_ctx.resBgClass(key))\n              }, _toDisplayString(_ctx.res[key]), 3))\n            }), 128))\n          ])\n        ]))\n      : _createCommentVNode(\"\", true),\n    (_ctx.displayTags)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.team.tags, (tag) => {\n            return (_openBlock(), _createElementBlock(\"span\", {\n              class: \"tag\",\n              key: tag\n            }, _toDisplayString(tag), 1))\n          }), 128))\n        ]))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"div\", _hoisted_9, [\n      _createElementVNode(\"span\", {\n        class: \"material-symbols-outlined control-button\",\n        onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.jumpToRotation && _ctx.jumpToRotation(...args)))\n      }, \"stat_minus_2\"),\n      _createElementVNode(\"div\", _hoisted_10, _toDisplayString(_ctx.description), 1)\n    ])\n  ], 2))\n}","\r\nimport _ from 'lodash';\r\nimport { computed, defineComponent, onMounted, PropType, reactive, ref, watch } from \"vue\";\r\nimport { calculateFormulaArray } from \"@/calculate\";\r\nimport { TStats } from \"@/input\";\r\nimport { CHARACTER_MASTER, ELEMENT_IMG_SRC, TAnyObject, TCharacterKey, ELEMENT_BG_COLOR_CLASS } from \"@/master\";\r\nimport CompositionFunction from \"@/components/CompositionFunction.vue\";\r\nimport { calculateMemberResult, getElementalResonance, TConstellation, TTeam, TTeamMemberResult } from \"./team\";\r\nimport MemberItem from \"./MemberItem.vue\";\r\n\r\nexport default defineComponent({\r\n  name: 'TeamItem',\r\n  props: {\r\n    team: { type: Object as PropType<TTeam>, required: true },\r\n    selected: { type: Boolean, requied: true },\r\n    editable: { type: Boolean },\r\n    showEquipment: { type: Boolean },\r\n    displayStat: { type: String },\r\n    displayRes: { type: Boolean },\r\n    displayTags: { type: Boolean },\r\n    constellations: { type: Object as PropType<TConstellation> },\r\n  },\r\n  emits: ['click:edit', 'click:jump-to-rotation', 'update:member-result'],\r\n  components: {\r\n    MemberItem,\r\n  },\r\n  setup(props, context) {\r\n    const { displayName } = CompositionFunction();\r\n\r\n    const memberStats = reactive({} as TAnyObject);\r\n    const memberResults = reactive({} as TTeamMemberResult);\r\n    const res = reactive({} as TAnyObject);\r\n    const resKey = ['炎', '水', '風', '雷', '草', '氷', '岩', '物理'];\r\n    function initializeRes() {\r\n      resKey.forEach(key => {\r\n        res[key] = 0;\r\n      });\r\n    }\r\n    initializeRes();\r\n\r\n    const watchCount = ref(0);\r\n    watch(props, async (newVal) => {\r\n      watchFunc(newVal.team);\r\n      watchCount.value++;\r\n    });\r\n\r\n    onMounted(() => {\r\n      watchFunc(props.team);\r\n    })\r\n\r\n    const elementalResonance = computed(() => getElementalResonance(props.team));\r\n    const resonanceElementImgSrcs = computed(() => {\r\n      const result: string[] = [];\r\n      elementalResonance.value.forEach((entry) => {\r\n        if (entry == \"元素共鳴なし\") {\r\n          const members = props.team.members.filter((s) => s.name);\r\n          if (members.length == 4) {\r\n            members.forEach((member) => {\r\n              const master = CHARACTER_MASTER[member.name as TCharacterKey];\r\n              const src = (ELEMENT_IMG_SRC as any)[master.元素];\r\n              result.push(src);\r\n            });\r\n          }\r\n        } else {\r\n          const src = (ELEMENT_IMG_SRC as any)[entry.replace(\"元素共鳴\", \"\")];\r\n          result.push(src);\r\n          result.push(src);\r\n        }\r\n      });\r\n      return result;\r\n    })\r\n    const description = computed(() => props.team.description ?? '')\r\n    const selectedClass = computed(() => (props.selected ? ' selected' : ''));\r\n\r\n    async function watchFunc(team: TTeam) {\r\n      const list = [];\r\n      for (const member of team.members) {\r\n        list.push({\r\n          key: member.id,\r\n          value: await calculateMemberResult(member, team),\r\n        });\r\n      }\r\n      await Promise.all(list).then(results => {\r\n        results.forEach(entry => {\r\n          memberStats[entry.key] = entry.value?.statsInput?.statsObj;\r\n          memberResults[entry.key] = entry.value;\r\n        });\r\n      });\r\n      calculateStat();\r\n      calculateRes();\r\n      context.emit('update:member-result', team.id, memberResults);\r\n    }\r\n\r\n    function calculateStat() {\r\n      const teamAdjustments: { [key: string]: TStats } = {};\r\n      Object.keys(memberStats).forEach(key => {\r\n        teamAdjustments[key] = {};\r\n      })\r\n      Object.keys(memberStats).forEach(key => {\r\n        const memberResult = memberResults[key];\r\n        const characterMaster = memberResult?.characterInput?.characterMaster;\r\n        const weaponMaster = memberResult?.characterInput?.weaponMaster;\r\n        if (characterMaster && characterMaster.チームバフ) {\r\n          for (const damageDetail of characterMaster.チームバフ) {\r\n            if (damageDetail.条件) continue;\r\n            const value = calculateFormulaArray(damageDetail.数値, memberResult.statsInput.statsObj, memberResult.damageResult, damageDetail.最大値, damageDetail.最小値);\r\n            const toStat = damageDetail.種類.replace(/V[1-3]$/, '');\r\n            Object.keys(memberResults).forEach(key2 => {\r\n              if (key2 != key) { // チームバフは本人対象外とします\r\n                if (toStat in teamAdjustments) {\r\n                  teamAdjustments[key2][toStat] += value;\r\n                } else {\r\n                  teamAdjustments[key2][toStat] = value;\r\n                }\r\n              }\r\n            })\r\n          }\r\n        }\r\n        if (weaponMaster && weaponMaster.チームバフ) {\r\n          for (const damageDetail of weaponMaster.チームバフ) {\r\n            if (damageDetail.条件) continue;\r\n            const value = calculateFormulaArray(damageDetail.数値, memberResult.statsInput.statsObj, memberResult.damageResult, damageDetail.最大値, damageDetail.最小値);\r\n            const toStat = damageDetail.種類.replace(/V[1-3]$/, '');\r\n            Object.keys(memberResults).forEach(key2 => {\r\n              if (key2 != key) { // チームバフは本人対象外とします\r\n                if (toStat in teamAdjustments) {\r\n                  teamAdjustments[key2][toStat] += value;\r\n                } else {\r\n                  teamAdjustments[key2][toStat] = value;\r\n                }\r\n              }\r\n            })\r\n          }\r\n        }\r\n      })\r\n      for (const key of Object.keys(memberStats)) {\r\n        if (key in teamAdjustments) {\r\n          for (const stat of Object.keys(teamAdjustments[key])) {\r\n            if (!memberStats[key]) continue;\r\n            if (stat in memberStats[key]) {\r\n              memberStats[key][stat] += teamAdjustments[key][stat];\r\n            } else {\r\n              memberStats[key][stat] = teamAdjustments[key][stat];\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // 元素耐性\r\n    function calculateRes() {\r\n      initializeRes();\r\n      const dmgElements: string[] = [];\r\n      const artifactSet4s: string[] = [];\r\n      Object.keys(memberResults).forEach(key => {\r\n        const memberResult = memberResults[key];\r\n        const characterMaster = memberResult?.characterInput?.characterMaster;\r\n        const artifactSetMasters = memberResult?.characterInput?.artifactSetMasters;\r\n        if (characterMaster) {\r\n          if (characterMaster) {\r\n            dmgElements.push(characterMaster.元素);\r\n          }\r\n          if (characterMaster.元素スキル?.詳細) {\r\n            for (const damageDetail of characterMaster.元素スキル?.詳細) {\r\n              if (damageDetail.種類 && damageDetail.種類.startsWith('敵') && damageDetail.種類.endsWith('耐性') && damageDetail.数値) {\r\n                const element = damageDetail.種類.replace(/^敵/, '').replace(/元素耐性$/, '').replace(/耐性$/, '');\r\n                let value = 0;\r\n                if (_.isNumber(damageDetail.数値)) {\r\n                  value = damageDetail.数値;\r\n                } else if (_.isPlainObject(damageDetail.数値)) {\r\n                  const level = memberResult.characterInput?.元素スキルレベル;\r\n                  if (level && level in damageDetail.数値) {\r\n                    value = damageDetail.数値[level];\r\n                  }\r\n                }\r\n                if (element === '全') {\r\n                  resKey.filter(s => s !== '物理').forEach(key => {\r\n                    res[key] -= value;\r\n                  })\r\n                } else {\r\n                  res[element] -= value;\r\n                }\r\n              }\r\n            }\r\n          }\r\n          if (characterMaster.元素爆発?.詳細) {\r\n            for (const damageDetail of characterMaster.元素爆発?.詳細) {\r\n              if (damageDetail.種類 && damageDetail.種類.startsWith('敵') && damageDetail.種類.endsWith('耐性') && damageDetail.数値) {\r\n                const element = damageDetail.種類.replace(/^敵/, '').replace(/元素耐性$/, '').replace(/耐性$/, '');\r\n                let value = 0;\r\n                if (_.isNumber(damageDetail.数値)) {\r\n                  value = damageDetail.数値;\r\n                } else if (_.isPlainObject(damageDetail.数値)) {\r\n                  const level = memberResult.characterInput?.元素爆発レベル;\r\n                  if (level && level in damageDetail.数値) {\r\n                    value = damageDetail.数値[level];\r\n                  }\r\n                }\r\n                if (element === '全') {\r\n                  resKey.filter(s => s !== '物理').forEach(key => {\r\n                    res[key] -= value;\r\n                  })\r\n                } else {\r\n                  res[element] -= value;\r\n                }\r\n              }\r\n            }\r\n          }\r\n          if (characterMaster.固有天賦) {\r\n            for (const damageDetail of characterMaster.固有天賦) {\r\n              if (damageDetail.種類 && damageDetail.種類.startsWith('敵') && damageDetail.種類.endsWith('耐性') && damageDetail.数値) {\r\n                const element = damageDetail.種類.replace(/^敵/, '').replace(/元素耐性$/, '').replace(/耐性$/, '');\r\n                let value = 0;\r\n                if (_.isNumber(damageDetail.数値)) {\r\n                  value = damageDetail.数値;\r\n                }\r\n                if (element === '全') {\r\n                  resKey.filter(s => s !== '物理').forEach(key => {\r\n                    res[key] -= value;\r\n                  })\r\n                } else {\r\n                  res[element] -= value;\r\n                }\r\n              }\r\n            }\r\n          }\r\n          const constellation = memberResult.characterInput?.命ノ星座 ?? (props.constellations ? props.constellations[characterMaster.名前] ?? 0 : 0);\r\n          if (characterMaster.命ノ星座) {\r\n            for (let i = 1; i <= constellation; i++) {\r\n              const constellationObj = characterMaster.命ノ星座[String(i)];\r\n              if (constellationObj.詳細) {\r\n                for (const damageDetail of constellationObj.詳細) {\r\n                  if (damageDetail.種類 && damageDetail.種類.startsWith('敵') && damageDetail.種類.endsWith('耐性') && damageDetail.数値) {\r\n                    const element = damageDetail.種類.replace(/^敵/, '').replace(/元素耐性$/, '').replace(/耐性$/, '');\r\n                    if (_.isNumber(damageDetail.数値)) {\r\n                      if (element === '全') {\r\n                        resKey.filter(s => s !== '物理').forEach(key => {\r\n                          res[key] -= damageDetail.数値;\r\n                        })\r\n                      } else {\r\n                        res[element] -= damageDetail.数値;\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        if (artifactSetMasters && artifactSetMasters.length == 2) {\r\n          if (artifactSetMasters[0].key == artifactSetMasters[1].key) {\r\n            if (!artifactSet4s.includes(artifactSetMasters[0].key)) {\r\n              artifactSet4s.push(artifactSetMasters[0].key);\r\n              if (artifactSetMasters[0]['4セット効果']?.詳細) {\r\n                artifactSetMasters[0]['4セット効果']?.詳細.forEach(damageDetail => {\r\n                  if (damageDetail.種類.startsWith('敵') && damageDetail.種類.endsWith('耐性') && damageDetail.数値) {\r\n                    const element = damageDetail.種類.replace(/^敵/, '').replace(/元素耐性$/, '').replace(/耐性$/, '');\r\n                    res[element] -= Number(damageDetail.数値);\r\n                  }\r\n                })\r\n              }\r\n            }\r\n          }\r\n        }\r\n      })\r\n      if (dmgElements.filter(s => s === '岩').length >= 2) { // 岩元素共鳴\r\n        res['岩'] -= -20;\r\n      }\r\n      if (dmgElements.includes('雷') && dmgElements.includes('氷')) { // 超電導\r\n        res['物理'] -= -40;\r\n      }\r\n      resKey.forEach(key => {\r\n        if (key !== '物理' && !dmgElements.includes(key)) {\r\n          res[key] = 0;\r\n        }\r\n      })\r\n    }\r\n\r\n    const resBgClass = (key: string) => {\r\n      if (res[key] !== 0) {\r\n        return key in ELEMENT_BG_COLOR_CLASS ? (ELEMENT_BG_COLOR_CLASS as any)[key] : 'physical';\r\n      } else {\r\n        return '';\r\n      }\r\n    }\r\n\r\n    const editOnClick = () => {\r\n      context.emit('click:edit', props.team.id);\r\n    }\r\n\r\n    const jumpToRotation = () => {\r\n      context.emit('click:jump-to-rotation');\r\n    }\r\n\r\n    return {\r\n      displayName,\r\n\r\n      selectedClass,\r\n      memberStats,\r\n      elementalResonance,\r\n      resonanceElementImgSrcs,\r\n      description,\r\n      res,\r\n      resKey,\r\n      resBgClass,\r\n\r\n      editOnClick,\r\n      jumpToRotation,\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./TeamItem.vue?vue&type=template&id=0d8ebcb3&ts=true\"\nimport script from \"./TeamItem.vue?vue&type=script&lang=ts\"\nexport * from \"./TeamItem.vue?vue&type=script&lang=ts\"\n\nimport \"./TeamItem.vue?vue&type=style&index=0&id=0d8ebcb3&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, vModelText as _vModelText, createTextVNode as _createTextVNode, createStaticVNode as _createStaticVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-37a78f4d\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = {\n  key: 0,\n  class: \"rotation-box\"\n}\nconst _hoisted_2 = { class: \"pane1\" }\nconst _hoisted_3 = { class: \"icon-list\" }\nconst _hoisted_4 = { key: 0 }\nconst _hoisted_5 = { class: \"action with-tooltip\" }\nconst _hoisted_6 = [\"src\", \"alt\", \"onClick\"]\nconst _hoisted_7 = { class: \"tooltip\" }\nconst _hoisted_8 = { class: \"action with-tooltip\" }\nconst _hoisted_9 = [\"src\", \"alt\", \"onClick\"]\nconst _hoisted_10 = { class: \"tooltip\" }\nconst _hoisted_11 = { class: \"action with-tooltip\" }\nconst _hoisted_12 = [\"src\", \"alt\", \"onClick\"]\nconst _hoisted_13 = { class: \"tooltip\" }\nconst _hoisted_14 = { class: \"control-button\" }\nconst _hoisted_15 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { class: \"material-symbols-outlined\" }, \"delete\", -1))\nconst _hoisted_16 = { key: 0 }\nconst _hoisted_17 = [\"src\", \"alt\"]\nconst _hoisted_18 = {\n  key: 1,\n  class: \"action-attribute\"\n}\nconst _hoisted_19 = { class: \"rotation-list\" }\nconst _hoisted_20 = { class: \"rotation-item\" }\nconst _hoisted_21 = [\"src\", \"alt\"]\nconst _hoisted_22 = { class: \"with-tooltip handle\" }\nconst _hoisted_23 = [\"src\", \"alt\", \"onClick\"]\nconst _hoisted_24 = [\"onClick\"]\nconst _hoisted_25 = { class: \"action-attribute\" }\nconst _hoisted_26 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\nconst _hoisted_27 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\nconst _hoisted_28 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\nconst _hoisted_29 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\nconst _hoisted_30 = /*#__PURE__*/_createStaticVNode(\"<br data-v-37a78f4d><table class=\\\"guide\\\" data-v-37a78f4d><tr data-v-37a78f4d><th data-v-37a78f4d>N</th><td data-v-37a78f4d>通常攻撃1段</td><th data-v-37a78f4d>N2</th><td data-v-37a78f4d>通常攻撃2段</td><th data-v-37a78f4d>NX</th><td data-v-37a78f4d>通常攻撃X段</td></tr><tr data-v-37a78f4d><th data-v-37a78f4d>N1C</th><td data-v-37a78f4d>通常攻撃1段+重撃</td><th data-v-37a78f4d>N2C</th><td data-v-37a78f4d>通常攻撃2段+重撃</td><th data-v-37a78f4d>NXC</th><td data-v-37a78f4d>通常攻撃X段+重撃</td></tr><tr data-v-37a78f4d><th data-v-37a78f4d>C</th><td data-v-37a78f4d>重撃</td><td colspan=\\\"4\\\" data-v-37a78f4d></td></tr><tr data-v-37a78f4d><th data-v-37a78f4d>P</th><td data-v-37a78f4d>落下攻撃</td><td colspan=\\\"4\\\" data-v-37a78f4d></td></tr><tr data-v-37a78f4d><th data-v-37a78f4d>E</th><td data-v-37a78f4d>元素スキル</td><th data-v-37a78f4d>E.Press</th><td data-v-37a78f4d>元素スキル(一回押し)</td><th data-v-37a78f4d>E.Hold</th><td data-v-37a78f4d>元素スキル(長押し)</td></tr><tr data-v-37a78f4d><th data-v-37a78f4d>Q</th><td data-v-37a78f4d>元素爆発</td><td colspan=\\\"4\\\" data-v-37a78f4d></td></tr></table>\", 2)\nconst _hoisted_32 = {\n  key: 0,\n  class: \"pane2\"\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_draggable = _resolveComponent(\"draggable\")!\n  const _component_ERCalculator = _resolveComponent(\"ERCalculator\")!\n\n  return (_ctx.watchCount)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _createElementVNode(\"fieldset\", _hoisted_3, [\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.team.members, (member) => {\n              return (_openBlock(), _createElementBlock(_Fragment, {\n                key: member.id\n              }, [\n                (member.name)\n                  ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, [\n                      _createElementVNode(\"div\", _hoisted_5, [\n                        _createElementVNode(\"img\", {\n                          class: _normalizeClass('action-icon' + _ctx.bgColorClass(member.name)),\n                          src: _ctx.normalAttackIconSrc(member.name),\n                          alt: _ctx.displayName(member.name) + ' ' + _ctx.displayName('通常攻撃'),\n                          onClick: ($event: any) => (_ctx.listActionOnClick(member, 'N'))\n                        }, null, 10, _hoisted_6),\n                        _createElementVNode(\"span\", _hoisted_7, _toDisplayString(_ctx.displayName(member.name) + ' ' + _ctx.displayName('通常攻撃')), 1)\n                      ]),\n                      _createElementVNode(\"div\", _hoisted_8, [\n                        _createElementVNode(\"img\", {\n                          class: _normalizeClass('action-icon' + _ctx.bgColorClass(member.name)),\n                          src: _ctx.elementalSkillIconSrc(member.name),\n                          alt: _ctx.displayName(member.name) + ' ' + _ctx.displayName('元素スキル'),\n                          onClick: ($event: any) => (_ctx.listActionOnClick(member, 'E'))\n                        }, null, 10, _hoisted_9),\n                        _createElementVNode(\"span\", _hoisted_10, _toDisplayString(_ctx.displayName(member.name) + ' ' + _ctx.displayName(\"元素スキル\")), 1)\n                      ]),\n                      _createElementVNode(\"div\", _hoisted_11, [\n                        _createElementVNode(\"img\", {\n                          class: _normalizeClass('action-icon' + _ctx.bgColorClass(member.name)),\n                          src: _ctx.elementalBurstIconSrc(member.name),\n                          alt: _ctx.displayName(member.name) + ' ' + _ctx.displayName('元素爆発'),\n                          onClick: ($event: any) => (_ctx.listActionOnClick(member, 'Q'))\n                        }, null, 10, _hoisted_12),\n                        _createElementVNode(\"span\", _hoisted_13, _toDisplayString(_ctx.displayName(member.name) + ' ' + _ctx.displayName('元素爆発')), 1)\n                      ])\n                    ]))\n                  : _createCommentVNode(\"\", true)\n              ], 64))\n            }), 128)),\n            _createElementVNode(\"table\", _hoisted_14, [\n              _createElementVNode(\"tr\", null, [\n                _createElementVNode(\"td\", null, [\n                  _createElementVNode(\"span\", {\n                    class: \"material-symbols-outlined control-button\",\n                    onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.$emit('click:jump-to-team')))\n                  }, \"stat_2\")\n                ]),\n                _createElementVNode(\"td\", null, [\n                  _createElementVNode(\"label\", {\n                    class: _normalizeClass(_ctx.removeMode ? 'checked' : '')\n                  }, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                      type: \"checkbox\",\n                      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.removeMode) = $event))\n                    }, null, 512), [\n                      [_vModelCheckbox, _ctx.removeMode]\n                    ]),\n                    _hoisted_15\n                  ], 2)\n                ]),\n                _createElementVNode(\"td\", null, [\n                  (_ctx.selectedAction)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_16, [\n                        _createElementVNode(\"img\", {\n                          class: _normalizeClass('action-icon handle' + _ctx.bgColorClass(_ctx.selectedAction.member)),\n                          src: _ctx.getActionDetail(_ctx.selectedAction).icon_url,\n                          alt: _ctx.displayName(_ctx.getActionDetail(_ctx.selectedAction).名前),\n                          onClick: _cache[2] || (_cache[2] = ($event: any) => (_ctx.selectedActionOnClick(_ctx.selectedAction)))\n                        }, null, 10, _hoisted_17)\n                      ]))\n                    : _createCommentVNode(\"\", true),\n                  (_ctx.selectedAction)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, _toDisplayString(_ctx.actionDisplay(_ctx.selectedAction)), 1))\n                    : _createCommentVNode(\"\", true)\n                ])\n              ])\n            ])\n          ]),\n          _createElementVNode(\"fieldset\", _hoisted_19, [\n            _createVNode(_component_draggable, {\n              list: _ctx.rotationList,\n              \"item-key\": \"id\",\n              sort: true,\n              handle: \".handle\",\n              delay: 100,\n              animation: 200,\n              onChange: _ctx.rotationListOnChange\n            }, {\n              item: _withCtx(({ element }) => [\n                _createElementVNode(\"div\", _hoisted_20, [\n                  (_ctx.previousRotation(element)?.member != element.member)\n                    ? (_openBlock(), _createElementBlock(\"img\", {\n                        key: 0,\n                        class: \"character-icon\",\n                        src: _ctx.getCharacterMaster(element.member)?.icon_url ?? _ctx.IMG_SRC_DUMMY,\n                        alt: _ctx.displayName(element.member)\n                      }, null, 8, _hoisted_21))\n                    : _createCommentVNode(\"\", true),\n                  (_ctx.getActionDetail(element))\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        class: _normalizeClass('action-item ' + _ctx.colorClass(element.member))\n                      }, [\n                        _createElementVNode(\"div\", _hoisted_22, [\n                          _createElementVNode(\"img\", {\n                            class: _normalizeClass('action-icon' + _ctx.bgColorClass(element.member) + _ctx.selectedActionClass(element)),\n                            src: _ctx.getActionDetail(element).icon_url,\n                            alt: _ctx.displayName(_ctx.getActionDetail(element).名前),\n                            onClick: ($event: any) => (_ctx.rotationActionOnClick(element))\n                          }, null, 10, _hoisted_23),\n                          (_ctx.removeMode)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"remove-mark\",\n                                onClick: ($event: any) => (_ctx.removeItemOnClick(element))\n                              }, null, 8, _hoisted_24))\n                            : _createCommentVNode(\"\", true)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_25, _toDisplayString(_ctx.actionDisplay(element)), 1)\n                      ], 2))\n                    : _createCommentVNode(\"\", true)\n                ])\n              ]),\n              _: 1\n            }, 8, [\"list\", \"onChange\"]),\n            _hoisted_26,\n            _withDirectives(_createElementVNode(\"textarea\", {\n              class: \"rotation-description\",\n              \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((_ctx.rotationDescription) = $event)),\n              rows: \"10\",\n              maxlength: \"400\",\n              onChange: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.updateRotation && _ctx.updateRotation(...args)))\n            }, null, 544), [\n              [_vModelText, _ctx.rotationDescription]\n            ])\n          ]),\n          _hoisted_27,\n          _createTextVNode(),\n          _hoisted_28,\n          _hoisted_29,\n          _createTextVNode(),\n          _hoisted_30\n        ]),\n        true\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_32, [\n              _createVNode(_component_ERCalculator, {\n                team: _ctx.team,\n                rotationList: _ctx.rotationList,\n                teamMemberResult: _ctx.teamMemberResult,\n                constellations: _ctx.constellations\n              }, null, 8, [\"team\", \"rotationList\", \"teamMemberResult\", \"constellations\"])\n            ]))\n          : _createCommentVNode(\"\", true)\n      ]))\n    : _createCommentVNode(\"\", true)\n}","import { toDisplayString as _toDisplayString, vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, vModelSelect as _vModelSelect, createCommentVNode as _createCommentVNode, vShow as _vShow, vModelCheckbox as _vModelCheckbox, createStaticVNode as _createStaticVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-5fb1177e\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"er-calculator\" }\nconst _hoisted_2 = { class: \"er-calculator\" }\nconst _hoisted_3 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"th\", { colspan: \"2\" }, null, -1))\nconst _hoisted_4 = { class: \"with-tooltip\" }\nconst _hoisted_5 = [\"src\", \"alt\"]\nconst _hoisted_6 = { class: \"tooltip\" }\nconst _hoisted_7 = { colspan: \"2\" }\nconst _hoisted_8 = [\"onUpdate:modelValue\"]\nconst _hoisted_9 = { colspan: \"2\" }\nconst _hoisted_10 = [\"onUpdate:modelValue\"]\nconst _hoisted_11 = [\"value\"]\nconst _hoisted_12 = { colspan: \"2\" }\nconst _hoisted_13 = [\"src\", \"alt\"]\nconst _hoisted_14 = [\"onUpdate:modelValue\"]\nconst _hoisted_15 = [\"value\"]\nconst _hoisted_16 = { class: \"result-row\" }\nconst _hoisted_17 = { colspan: \"2\" }\nconst _hoisted_18 = { colspan: \"2\" }\nconst _hoisted_19 = [\"onUpdate:modelValue\"]\nconst _hoisted_20 = { class: \"label-row\" }\nconst _hoisted_21 = { colspan: \"2\" }\nconst _hoisted_22 = { colspan: \"4\" }\nconst _hoisted_23 = [\"onUpdate:modelValue\"]\nconst _hoisted_24 = { class: \"with-tooltip\" }\nconst _hoisted_25 = [\"src\", \"alt\"]\nconst _hoisted_26 = [\"src\", \"alt\"]\nconst _hoisted_27 = { class: \"tooltip\" }\nconst _hoisted_28 = [\"onUpdate:modelValue\"]\nconst _hoisted_29 = { colspan: \"2\" }\nconst _hoisted_30 = {\n  key: 0,\n  class: \"label-row\"\n}\nconst _hoisted_31 = { colspan: \"2\" }\nconst _hoisted_32 = { colspan: \"4\" }\nconst _hoisted_33 = {\n  colspan: \"2\",\n  class: \"with-tooltip\"\n}\nconst _hoisted_34 = [\"src\", \"alt\"]\nconst _hoisted_35 = [\"src\", \"alt\"]\nconst _hoisted_36 = { class: \"tooltip\" }\nconst _hoisted_37 = [\"onUpdate:modelValue\"]\nconst _hoisted_38 = { colspan: \"2\" }\nconst _hoisted_39 = [\"onUpdate:modelValue\"]\nconst _hoisted_40 = { colspan: \"2\" }\nconst _hoisted_41 = [\"src\", \"alt\", \"onClick\"]\nconst _hoisted_42 = { class: \"tooltip\" }\nconst _hoisted_43 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\nconst _hoisted_44 = { class: \"supply-from-enemy\" }\nconst _hoisted_45 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"th\", null, null, -1))\nconst _hoisted_46 = [\"onUpdate:modelValue\"]\nconst _hoisted_47 = [\"onUpdate:modelValue\"]\nconst _hoisted_48 = { class: \"message-area\" }\nconst _hoisted_49 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1))\nconst _hoisted_50 = { class: \"character\" }\nconst _hoisted_51 = { key: 0 }\nconst _hoisted_52 = { class: \"message-area\" }\nconst _hoisted_53 = {\n  class: \"toggle-switch\",\n  for: \"show-usage-toggle\"\n}\nconst _hoisted_54 = { style: {\"text-align\":\"left\"} }\nconst _hoisted_55 = { style: {\"text-align\":\"center\"} }\nconst _hoisted_56 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"ol\", null, [\n  /*#__PURE__*/_createElementVNode(\"li\", null, \"元素チャージ効率が変動するタイプの天賦や命ノ星座は考慮しません。 \"),\n  /*#__PURE__*/_createElementVNode(\"li\", null, \"HP等ステータスの現在値を条件にして発動するタイプの天賦や命ノ星座は無視するか、最小の発動回数で計算します。\"),\n  /*#__PURE__*/_createElementVNode(\"li\", null, \"敵の数は1。\"),\n  /*#__PURE__*/_createElementVNode(\"li\", null, [\n    /*#__PURE__*/_createTextVNode(\"天賦および命ノ星座によって獲得できる元素エネルギーを計算する際に、キャラクターの天賦レベルやステータスを参照する場合、キャラクターのステータス、天賦レベル、武器、聖遺物はげんかるくのセーブデータを使用します。 セーブデータが存在しない場合は、天賦レベル8、武器と聖遺物なしのステータスで計算します。\"),\n    /*#__PURE__*/_createElementVNode(\"br\")\n  ])\n], -1))\nconst _hoisted_57 = { style: {\"text-align\":\"center\"} }\nconst _hoisted_58 = /*#__PURE__*/_createStaticVNode(\"<li data-v-5fb1177e>ローテーションの長さ<br data-v-5fb1177e> ローテーションに存在する元素スキルのクールタイムまたは元素爆発のクールタイムから決定します。 元素スキルの発動回数は考慮しませんが、元素爆発の方は発動回数に応じて加算します。 初期値は20秒。 </li><li data-v-5fb1177e>出場時間<br data-v-5fb1177e> ローテーションの内容から大雑把に計算して割り当てます。 キャラクター毎アクション毎の所要時間のデータを持たないため、正確ではありません。 </li><li data-v-5fb1177e>大部分のキャラクターの元素スキル<br data-v-5fb1177e> 元素スキル命中時に元素粒子が発生するタイプの元素スキルは、直後のアクション実行者が元素粒子を獲得します。 </li><li data-v-5fb1177e>胡桃、宵宮、神里綾人、放浪者 等の元素スキル<br data-v-5fb1177e> 元素スキル使用時に元素粒子が発生せず、その後の通常攻撃または重撃命中時に元素粒子が発生するタイプの元素スキルは、継続時間一杯攻撃した場合に発生するであろう数の元素粒子を実行者自身が獲得します。 </li><li data-v-5fb1177e>フィッシュル、鍾離、アルベド、八重神子 等の元素スキル<br data-v-5fb1177e> 存在時間の長い設置物からの攻撃命中時に元素粒子が発生するタイプの元素スキルは、ローテーションまたは継続時間の間ずっと攻撃し続けた場合に発生するであろう数の元素粒子を出場時間を基準に全員に按分します。 また、設置系でない雷電将軍とナヒーダも同様の扱いとします。 </li><li data-v-5fb1177e>アンバー、香菱、モナ、甘雨 等の元素スキル<br data-v-5fb1177e> 存在時間の短い設置物からの攻撃命中または設置物が破壊された時に元素粒子が発生するタイプの元素スキルについても同様に出場時間を基準に全員に按分するが、存在時間の短さから実戦との乖離が大きくなります。(妥協) </li><li data-v-5fb1177e>雷元素共鳴が生成する元素粒子<br data-v-5fb1177e> ローテーションの間クールタイムの5秒間隔で雷元素関連反応が起き続けた場合に発生するであろう数の元素粒子を出場時間を基準に全員に按分します。 チーム内に対象となる元素反応を起こせる元素のキャラクターが存在しない場合は0。 </li><li data-v-5fb1177e>西風武器が生成する元素粒子<br data-v-5fb1177e> 使用者の出場回数および出場時間(%)、ローテーションの長さから武器効果をトリガーする回数を決定します。 トリガー回数はローテーションの長さを武器効果のクールタイムで割った数までとします。 元素粒子は基本的に装備者が獲得するが、装備者が1アクションだけで退場する場合は次のアクション実行者が獲得します。 </li><li data-v-5fb1177e>通常攻撃、重撃命中時に獲得する元素エネルギー<br data-v-5fb1177e> 通常攻撃または重撃の回数に応じて元素エネルギーを獲得します。 元素エネルギーを獲得する攻撃回数は武器タイプ毎に異なります。 </li>\", 9)\nconst _hoisted_67 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"li\", null, [\n  /*#__PURE__*/_createTextVNode(\"以下、それぞれの条件で元素粒子の生成数を固定しています。 \"),\n  /*#__PURE__*/_createElementVNode(\"ul\", null, [\n    /*#__PURE__*/_createElementVNode(\"li\", null, \"タルタリヤ : 双剣モード9秒程度\"),\n    /*#__PURE__*/_createElementVNode(\"li\", null, \"鹿野院平蔵 : 変格4(正論)\"),\n    /*#__PURE__*/_createElementVNode(\"li\", null, \"アルハイゼン : 光幕攻撃6回\"),\n    /*#__PURE__*/_createElementVNode(\"li\", null, \"フレミネ : 圧力ランク3以下\")\n  ])\n], -1))\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", null, [\n      _createElementVNode(\"label\", null, [\n        _createTextVNode(_toDisplayString(_ctx.displayName('ローテーションの長さ(秒)')) + \" \", 1),\n        _withDirectives(_createElementVNode(\"input\", {\n          type: \"number\",\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.rotationLength) = $event)),\n          min: \"10\",\n          max: \"180\",\n          onChange: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.inputOnChange && _ctx.inputOnChange(...args)))\n        }, null, 544), [\n          [_vModelText, _ctx.rotationLength]\n        ])\n      ])\n    ]),\n    _createElementVNode(\"table\", _hoisted_2, [\n      _createElementVNode(\"tr\", null, [\n        _hoisted_3,\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.calculatorInput, (element, index) => {\n          return (_openBlock(), _createElementBlock(\"td\", {\n            key: index,\n            class: _normalizeClass(_ctx.bgColorClass(index))\n          }, [\n            _createElementVNode(\"div\", _hoisted_4, [\n              _createElementVNode(\"img\", {\n                src: _ctx.characterImgSrc(element.character),\n                alt: _ctx.displayName(element.character),\n                class: \"character\"\n              }, null, 8, _hoisted_5),\n              _createElementVNode(\"span\", _hoisted_6, _toDisplayString(_ctx.displayName(element.character)), 1)\n            ])\n          ], 2))\n        }), 128))\n      ]),\n      _createElementVNode(\"tr\", null, [\n        _createElementVNode(\"th\", _hoisted_7, _toDisplayString(_ctx.displayName('元素爆発')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.calculatorInput, (element, index) => {\n          return (_openBlock(), _createElementBlock(\"td\", {\n            key: index,\n            class: _normalizeClass(_ctx.bgColorClass(index))\n          }, [\n            _withDirectives(_createElementVNode(\"input\", {\n              type: \"number\",\n              \"onUpdate:modelValue\": ($event: any) => ((element.energyCost) = $event)\n            }, null, 8, _hoisted_8), [\n              [_vModelText, element.energyCost]\n            ])\n          ], 2))\n        }), 128))\n      ]),\n      _createElementVNode(\"tr\", null, [\n        _createElementVNode(\"th\", _hoisted_9, _toDisplayString(_ctx.displayName('命ノ星座')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.calculatorInput, (element, index) => {\n          return (_openBlock(), _createElementBlock(\"td\", {\n            key: index,\n            class: _normalizeClass(_ctx.bgColorClass(index))\n          }, [\n            _withDirectives(_createElementVNode(\"select\", {\n              \"onUpdate:modelValue\": ($event: any) => ((element.constellation) = $event),\n              onChange: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.inputOnChange && _ctx.inputOnChange(...args)))\n            }, [\n              (_openBlock(), _createElementBlock(_Fragment, null, _renderList([0, 1, 2, 3, 4, 5, 6], (constellation) => {\n                return _createElementVNode(\"option\", {\n                  key: constellation,\n                  value: constellation\n                }, _toDisplayString('C' + constellation), 9, _hoisted_11)\n              }), 64))\n            ], 40, _hoisted_10), [\n              [_vModelSelect, element.constellation]\n            ])\n          ], 2))\n        }), 128))\n      ]),\n      _createElementVNode(\"tr\", null, [\n        _createElementVNode(\"th\", _hoisted_12, _toDisplayString(_ctx.displayName('武器')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.calculatorInput, (element, index) => {\n          return (_openBlock(), _createElementBlock(\"td\", {\n            key: index,\n            class: _normalizeClass('weapon' + _ctx.bgColorClass(index))\n          }, [\n            _createElementVNode(\"img\", {\n              src: _ctx.weaponImgSrc(element.character, element.currentWeapon),\n              alt: _ctx.displayName(element.currentWeapon),\n              class: \"input-item-weapon\"\n            }, null, 8, _hoisted_13),\n            _withDirectives(_createElementVNode(\"select\", {\n              \"onUpdate:modelValue\": ($event: any) => ((element.weaponRefine) = $event),\n              onChange: _cache[3] || (_cache[3] = \n//@ts-ignore\n(...args) => (_ctx.inputOnChange && _ctx.inputOnChange(...args)))\n            }, [\n              (_openBlock(), _createElementBlock(_Fragment, null, _renderList([1, 2, 3, 4, 5], (refine) => {\n                return _createElementVNode(\"option\", {\n                  key: refine,\n                  value: refine\n                }, _toDisplayString('R' + refine), 9, _hoisted_15)\n              }), 64))\n            ], 40, _hoisted_14), [\n              [_vModelSelect, element.weaponRefine]\n            ])\n          ], 2))\n        }), 128))\n      ]),\n      _createElementVNode(\"tr\", _hoisted_16, [\n        _createElementVNode(\"th\", _hoisted_17, _toDisplayString(_ctx.displayName('元素チャージ効率')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.energyRechargeGls, (value, index) => {\n          return (_openBlock(), _createElementBlock(\"td\", {\n            key: index,\n            class: _normalizeClass(_ctx.bgColorClass(index))\n          }, _toDisplayString(value + '%'), 3))\n        }), 128))\n      ]),\n      _createElementVNode(\"tr\", null, [\n        _createElementVNode(\"th\", _hoisted_18, _toDisplayString(_ctx.displayName('出場時間(%)')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.calculatorInput, (element, index) => {\n          return (_openBlock(), _createElementBlock(\"td\", {\n            key: index,\n            class: _normalizeClass(_ctx.bgColorClass(index))\n          }, [\n            _withDirectives(_createElementVNode(\"input\", {\n              type: \"number\",\n              \"onUpdate:modelValue\": ($event: any) => ((element.onField) = $event),\n              min: \"0\",\n              max: \"100\",\n              onChange: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.inputOnChange && _ctx.inputOnChange(...args)))\n            }, null, 40, _hoisted_19), [\n              [_vModelText, element.onField]\n            ])\n          ], 2))\n        }), 128))\n      ]),\n      _createElementVNode(\"tr\", _hoisted_20, [\n        _createElementVNode(\"th\", _hoisted_21, _toDisplayString(_ctx.displayName('元素粒子')), 1),\n        _createElementVNode(\"th\", _hoisted_22, _toDisplayString(_ctx.displayName('獲得数')), 1)\n      ]),\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.inputRowParticleEnemy, (row, rowIndex) => {\n        return (_openBlock(), _createElementBlock(\"tr\", {\n          key: rowIndex,\n          class: _normalizeClass(_ctx.bgColorClass2(row))\n        }, [\n          _createElementVNode(\"th\", null, _toDisplayString(_ctx.displayName('敵')), 1),\n          _createElementVNode(\"td\", null, _toDisplayString(Math.round(row.currentValues.reduce((p, c) => p + c, 0) * 10) / 10), 1),\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Array.from({ length: row.currentValues.length }, (_, i) => i), (columnIndex) => {\n            return (_openBlock(), _createElementBlock(\"td\", { key: columnIndex }, [\n              _withDirectives(_createElementVNode(\"input\", {\n                type: \"number\",\n                \"onUpdate:modelValue\": ($event: any) => ((row.currentValues[columnIndex]) = $event),\n                min: \"0\"\n              }, null, 8, _hoisted_23), [\n                [_vModelText, row.currentValues[columnIndex]]\n              ])\n            ]))\n          }), 128))\n        ], 2))\n      }), 128)),\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.inputRowParticle, (row, rowIndex) => {\n        return (_openBlock(), _createElementBlock(\"tr\", {\n          key: rowIndex,\n          class: _normalizeClass(_ctx.bgColorClass2(row))\n        }, [\n          _createElementVNode(\"th\", _hoisted_24, [\n            _createElementVNode(\"span\", null, [\n              _createElementVNode(\"img\", {\n                src: _ctx.rowImgSrc1(row),\n                alt: _ctx.displayName(row.character),\n                class: _normalizeClass(_ctx.rowImgSrc1Class(row))\n              }, null, 10, _hoisted_25),\n              _createElementVNode(\"img\", {\n                src: _ctx.rowImgSrc2(row),\n                alt: _ctx.displayName(row.triggerName),\n                class: \"input-item\"\n              }, null, 8, _hoisted_26)\n            ]),\n            _createElementVNode(\"span\", _hoisted_27, _toDisplayString(_ctx.displayName(row.character) + ' ' + _ctx.displayName(_ctx.triggerName(row))), 1)\n          ]),\n          _createElementVNode(\"td\", null, _toDisplayString(Math.round(row.currentValues.reduce((p, c) => p + c, 0) * 100) / 100), 1),\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Array.from({ length: row.currentValues.length }, (_, i) => i), (columnIndex) => {\n            return (_openBlock(), _createElementBlock(\"td\", { key: columnIndex }, [\n              _withDirectives(_createElementVNode(\"input\", {\n                type: \"number\",\n                \"onUpdate:modelValue\": ($event: any) => ((row.currentValues[columnIndex]) = $event),\n                min: \"0\"\n              }, null, 8, _hoisted_28), [\n                [_vModelText, row.currentValues[columnIndex]]\n              ])\n            ]))\n          }), 128))\n        ], 2))\n      }), 128)),\n      _createElementVNode(\"tr\", null, [\n        _createElementVNode(\"th\", _hoisted_29, _toDisplayString(_ctx.displayName('元素チャージ')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.particleRecharges, (value, index) => {\n          return (_openBlock(), _createElementBlock(\"td\", {\n            key: index,\n            class: \"result\"\n          }, _toDisplayString(value), 1))\n        }), 128))\n      ]),\n      (_ctx.inputRowEnergy.length)\n        ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_30, [\n            _createElementVNode(\"th\", _hoisted_31, _toDisplayString(_ctx.displayName('元素エネルギー')), 1),\n            _createElementVNode(\"th\", _hoisted_32, _toDisplayString(_ctx.displayName('獲得量')), 1)\n          ]))\n        : _createCommentVNode(\"\", true),\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.inputRowEnergy, (row, rowIndex) => {\n        return (_openBlock(), _createElementBlock(\"tr\", {\n          key: rowIndex,\n          class: _normalizeClass(_ctx.bgColorClass2(row))\n        }, [\n          _createElementVNode(\"th\", _hoisted_33, [\n            _createElementVNode(\"span\", null, [\n              _createElementVNode(\"img\", {\n                src: _ctx.rowImgSrc1(row),\n                alt: _ctx.displayName(row.character),\n                class: _normalizeClass(_ctx.rowImgSrc1Class(row))\n              }, null, 10, _hoisted_34),\n              _createElementVNode(\"img\", {\n                src: _ctx.rowImgSrc2(row),\n                alt: _ctx.displayName(row.triggerName),\n                class: \"input-item\"\n              }, null, 8, _hoisted_35)\n            ]),\n            _createElementVNode(\"span\", _hoisted_36, _toDisplayString(_ctx.displayName(row.character) + ' ' + _ctx.displayName(_ctx.triggerName(row))), 1)\n          ]),\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Array.from({ length: row.currentValues.length }, (_, i) => i), (columnIndex) => {\n            return (_openBlock(), _createElementBlock(\"td\", { key: columnIndex }, [\n              _withDirectives(_createElementVNode(\"input\", {\n                type: \"number\",\n                \"onUpdate:modelValue\": ($event: any) => ((row.currentValues[columnIndex]) = $event),\n                min: \"0\"\n              }, null, 8, _hoisted_37), [\n                [_vModelText, row.currentValues[columnIndex]]\n              ])\n            ]))\n          }), 128))\n        ], 2))\n      }), 128)),\n      _createElementVNode(\"tr\", null, [\n        _createElementVNode(\"th\", _hoisted_38, _toDisplayString(_ctx.displayName('元素爆発(回数)')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Array.from({ length: _ctx.calculatorInput.length }, (_, i) => i), (index) => {\n          return (_openBlock(), _createElementBlock(\"td\", {\n            key: index,\n            class: _normalizeClass(_ctx.bgColorClass(index))\n          }, [\n            _withDirectives(_createElementVNode(\"input\", {\n              type: \"number\",\n              \"onUpdate:modelValue\": ($event: any) => ((_ctx.burstCounts[index]) = $event),\n              min: \"0\"\n            }, null, 8, _hoisted_39), [\n              [_vModelText, _ctx.burstCounts[index]]\n            ])\n          ], 2))\n        }), 128))\n      ]),\n      _createElementVNode(\"tr\", null, [\n        _createElementVNode(\"th\", _hoisted_40, _toDisplayString(_ctx.displayName('武器変更')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.calculatorInput, (element, index) => {\n          return (_openBlock(), _createElementBlock(\"td\", {\n            key: index,\n            class: _normalizeClass(_ctx.bgColorClass(index))\n          }, [\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(element.replaceWeapons, (weapon, weaponIndex) => {\n              return (_openBlock(), _createElementBlock(\"span\", {\n                key: weaponIndex,\n                class: \"with-tooltip\"\n              }, [\n                _createElementVNode(\"img\", {\n                  src: _ctx.replaceWeaponImgSrc(element, weapon),\n                  alt: _ctx.displayName(weapon),\n                  class: _normalizeClass('input-item-weapon' + _ctx.replaceWeaponClass(element, weapon)),\n                  onClick: ($event: any) => (_ctx.replaceWeaponOnClick(element, weapon))\n                }, null, 10, _hoisted_41),\n                _createElementVNode(\"span\", _hoisted_42, _toDisplayString(_ctx.displayName(weapon)), 1)\n              ]))\n            }), 128))\n          ], 2))\n        }), 128))\n      ])\n    ]),\n    _hoisted_43,\n    _createElementVNode(\"div\", null, [\n      _createElementVNode(\"label\", null, [\n        _createTextVNode(_toDisplayString(_ctx.displayName('戦闘の長さ(秒)')) + \" \", 1),\n        _withDirectives(_createElementVNode(\"input\", {\n          type: \"number\",\n          \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.combatLength) = $event)),\n          min: \"1\",\n          onChange: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.inputOnChange && _ctx.inputOnChange(...args)))\n        }, null, 544), [\n          [_vModelText, _ctx.combatLength]\n        ])\n      ]),\n      _createElementVNode(\"table\", _hoisted_44, [\n        _createElementVNode(\"caption\", {\n          onClick: _cache[7] || (_cache[7] = ($event: any) => (_ctx.isOpenSupplyFromEnemy = !_ctx.isOpenSupplyFromEnemy))\n        }, _toDisplayString(_ctx.isOpenSupplyFromEnemy ? '-' : '+') + \" \" + _toDisplayString(_ctx.displayName('敵')) + \" \" + _toDisplayString(_ctx.isOpenSupplyFromEnemy ? '-' : '+'), 1),\n        _createElementVNode(\"tr\", null, [\n          _hoisted_45,\n          _createElementVNode(\"th\", null, _toDisplayString(_ctx.displayName('元素オーブ')), 1),\n          _createElementVNode(\"th\", null, _toDisplayString(_ctx.displayName('元素粒子')), 1)\n        ]),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.supplyFromEnemy, (element, index) => {\n          return _withDirectives((_openBlock(), _createElementBlock(\"tr\", { key: index }, [\n            _createElementVNode(\"th\", null, _toDisplayString(_ctx.displayName(element[0])), 1),\n            _createElementVNode(\"td\", null, [\n              _withDirectives(_createElementVNode(\"input\", {\n                type: \"number\",\n                \"onUpdate:modelValue\": ($event: any) => ((element[1]) = $event),\n                min: \"0\"\n              }, null, 8, _hoisted_46), [\n                [_vModelText, element[1]]\n              ])\n            ]),\n            _createElementVNode(\"td\", null, [\n              _withDirectives(_createElementVNode(\"input\", {\n                type: \"number\",\n                \"onUpdate:modelValue\": ($event: any) => ((element[2]) = $event),\n                min: \"0\"\n              }, null, 8, _hoisted_47), [\n                [_vModelText, element[2]]\n              ])\n            ])\n          ])), [\n            [_vShow, _ctx.isOpenSupplyFromEnemy || element[1] || element[2]]\n          ])\n        }), 128))\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_48, [\n      _hoisted_49,\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.messages, (message, index) => {\n        return (_openBlock(), _createElementBlock(\"p\", { key: index }, [\n          _createElementVNode(\"span\", _hoisted_50, _toDisplayString(message[0]), 1),\n          _createTextVNode(\"   \"),\n          _createElementVNode(\"span\", null, _toDisplayString(message[1]), 1),\n          (message[0] || message[1])\n            ? (_openBlock(), _createElementBlock(\"br\", _hoisted_51))\n            : _createCommentVNode(\"\", true),\n          _createTextVNode(\"   \" + _toDisplayString(message[2]), 1)\n        ]))\n      }), 128))\n    ]),\n    _createElementVNode(\"div\", _hoisted_52, [\n      _createElementVNode(\"fieldset\", null, [\n        _createElementVNode(\"legend\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            class: \"hidden\",\n            type: \"checkbox\",\n            \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((_ctx.isShowUsage) = $event)),\n            id: \"show-usage-toggle\"\n          }, null, 512), [\n            [_vModelCheckbox, _ctx.isShowUsage]\n          ]),\n          _createElementVNode(\"label\", _hoisted_53, _toDisplayString(_ctx.displayName('元素チャージ効率計算機能について')), 1)\n        ]),\n        _withDirectives(_createElementVNode(\"div\", _hoisted_54, [\n          _createElementVNode(\"div\", _hoisted_55, _toDisplayString(_ctx.displayName('前提')), 1),\n          _hoisted_56,\n          _createElementVNode(\"div\", _hoisted_57, _toDisplayString(_ctx.displayName('ローテーションの読み方')), 1),\n          _createElementVNode(\"ol\", null, [\n            _hoisted_58,\n            _createElementVNode(\"li\", null, [\n              _createTextVNode(\"以下、元素爆発の実行から退場するまでの間、元素スキルの元素粒子生成数を変更します。 再出場時に元の生成数に戻ります。 \"),\n              _createElementVNode(\"ul\", null, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.CHARACTER_E_DECREMENT_IN_BURST, (character, index) => {\n                  return (_openBlock(), _createElementBlock(\"li\", { key: index }, _toDisplayString(_ctx.displayName(character)), 1))\n                }), 128))\n              ])\n            ]),\n            _createElementVNode(\"li\", null, [\n              _createTextVNode(\"以下、元素スキルの実行から特定のアクションを実行するまでを1回の元素スキルとみなします。 \"),\n              _createElementVNode(\"ul\", null, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.CHARACTER_E_UNTIL_MAP.entries(), ([character, untilMap], index) => {\n                  return (_openBlock(), _createElementBlock(\"li\", { key: index }, _toDisplayString(_ctx.displayName(character) + ' : ' + _ctx.actionName('E') + '⇒' +\r\n                                        Array.from(untilMap.entries())\r\n                                            .map(value => value[0]\r\n                                                .map(action => _ctx.actionName(action)).join(_ctx.displayName('または'))\r\n                                                + '×' + value[1] + _ctx.displayName('回')).join(_ctx.displayName('または'))), 1))\n                }), 128))\n              ])\n            ]),\n            _createElementVNode(\"li\", null, [\n              _createTextVNode(\"以下、元素スキルの実行後に特定のアクションを実行すると元素粒子を生成したとみなします。 \"),\n              _createElementVNode(\"ul\", null, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.CHARACTER_E_DELAY_MAP.entries(), ([character, delayArr], index) => {\n                  return (_openBlock(), _createElementBlock(\"li\", { key: index }, _toDisplayString(_ctx.displayName(character) + ' : ' + _ctx.actionName('E') + '⇒' +\r\n                                        delayArr.map(action => _ctx.actionName(action)).join(_ctx.displayName('または'))), 1))\n                }), 128))\n              ])\n            ]),\n            _createElementVNode(\"li\", null, [\n              _createTextVNode(\"以下、元素爆発の直前の元素スキルの元素粒子生成数を0に変更します。 \"),\n              _createElementVNode(\"ul\", null, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.CHARACTER_Q_NOT_RECHARGEABLE, (character, index) => {\n                  return (_openBlock(), _createElementBlock(\"li\", { key: index }, _toDisplayString(_ctx.displayName(character)), 1))\n                }), 128))\n              ])\n            ]),\n            _hoisted_67\n          ])\n        ], 512), [\n          [_vShow, _ctx.isShowUsage]\n        ])\n      ])\n    ])\n  ]))\n}","import { CHARACTER_E_UNTIL_MAP, getParticleInfo, getDurationFromInfo, getReceiveTypeFromInfo, SP_SELF } from \"@/particlemaster\";\r\nimport _ from \"lodash\";\r\nimport { TActionItem, TTeam, NUMBER_OF_MEMBERS, getCharacterMaster, TTeamMemberResult, TMember, getDefaultMemberResult, getCharacterDetail, getNormalAttackDan } from \"./team\";\r\n\r\nexport const RECHARGE_ENERGY_SKILL = \"01\";              // 元素スキルによる元素エネルギー回復\r\nexport const RECHARGE_ENERGY_BURST = \"02\";              // 元素爆発による元素エネルギー回復\r\nexport const RECHARGE_ENERGY_PASSIVE = \"03\";            // 固有天賦による元素エネルギー回復\r\nexport const RECHARGE_ENERGY_CONSTELLATION = \"04\";      // 命ノ星座による元素エネルギー回復\r\nexport const RECHARGE_ENERGY_ATTACK = \"05\";             // 通常攻撃、重撃による元素エネルギー回復\r\nexport const RECHARGE_ENERGY_WEAPON = \"06\";             // 武器効果による元素エネルギー回復\r\nexport const RECHARGE_ENERGY_ARTIFACT = \"07\";           // 聖遺物セット効果による元素エネルギー回復\r\nexport const RECHARGE_PARTICLE_SKILL = \"11\";            // 元素スキルによる元素粒子生成\r\nexport const RECHARGE_PARTICLE_PASSIVE = \"13\";          // 固有天賦による元素粒子生成\r\nexport const RECHARGE_PARTICLE_CONSTELLATION = \"14\";    // 命ノ星座による元素粒子生成\r\nexport const RECHARGE_PARTICLE_FAVONIUS = \"16\";         // 武器効果（西風）による元素粒子生成\r\nexport const RECHARGE_PARTICLE_RESONANCE = \"18\";        // 元素共鳴による元素粒子生成\r\nexport const RECHARGE_PARTICLE_ENEMY = \"19\";            // 敵による元素粒子生成\r\n\r\nexport const ATTACK_ENERGY_COUNT_OBJ = {\r\n    '片手剣': 4.52,     // 10% + 5% * n\r\n    '両手剣': 4.66,     // 0% + 10% * n\r\n    '長柄武器': 6.95,   // 0% + 4% * n\r\n    '弓': 6.29,         // 0% + 5% * n\r\n    '法器': 4.66,       // 0% + 10% * n\r\n}\r\n\r\nconst NORMAL_ATTACK_LENGTH_OBJ = {\r\n    '片手剣': 0.4,\r\n    '両手剣': 0.8,\r\n    '長柄武器': 0.4,\r\n    '弓': 0.6,\r\n    '法器': 0.6,\r\n}\r\n\r\nconst ACTION_LENGTH_MAP = new Map<string, Map<string, number>>();\r\nACTION_LENGTH_MAP.set('楓原万葉', new Map<string, number>([['E.Press', 1.5], ['E.Hold', 2]]));\r\nACTION_LENGTH_MAP.set('荒瀧一斗', new Map<string, number>([['C', 0.8]]));\r\nACTION_LENGTH_MAP.set('ヌヴィレット', new Map<string, number>([['C', 3]]));\r\nACTION_LENGTH_MAP.set('シャルロット', new Map<string, number>([['E.Hold', 2]]));\r\n\r\n// rechargeKind, triggerName, energies[], messages[]\r\nexport type TEREnergy = [string, string, number[], string[]];\r\n// rechargeKind, triggerName, element, particles[], messages[]\r\nexport type TERParticle = [string, string, string, number[], string[]];\r\n\r\nexport function isRechargeKindEnergy(rechargeKind: string) {\r\n    return rechargeKind ? rechargeKind.startsWith('0') : false;\r\n}\r\n\r\nexport function isRechargeKindParticle(rechargeKind: string) {\r\n    return rechargeKind ? rechargeKind.startsWith('1') : false;\r\n}\r\n\r\n/** 通常攻撃使用回数 */\r\nexport function countN(character?: string, rotationList?: TActionItem[], isBursting?: boolean) {\r\n    let result = 0;\r\n    if (rotationList?.length) {\r\n        if (character && isBursting !== undefined) {\r\n            let isQing = false;\r\n            for (let i = 0; i < rotationList.length; i++) {\r\n                const rotation = rotationList[i];\r\n                if (rotation.member == character) {\r\n                    if (rotation.action === 'Q') {\r\n                        isQing = true;\r\n                    } else if (rotation.action.startsWith('N') && isBursting == isQing) {\r\n                        result += rotation.action.length === 1 ? 1 : Number(rotation.action.substring(1, 2));\r\n                    }\r\n                } else {\r\n                    isQing = false;\r\n                }\r\n            }\r\n        } else {\r\n            result = rotationList.filter(rotation => (!character || rotation.member == character) && rotation.action.startsWith('N')).map(rotation => rotation.action.length === 1 ? 1 : Number(rotation.action.substring(1, 2))).reduce((p, c) => p + c, 0);\r\n        }\r\n    } else {\r\n        return 1;\r\n    }\r\n    return result;\r\n}\r\n/** 重撃使用回数 */\r\nexport function countC(character?: string, rotationList?: TActionItem[], isBursting?: boolean) {\r\n    let result = 0;\r\n    if (rotationList?.length) {\r\n        if (character && isBursting !== undefined) {\r\n            let isQing = false;\r\n            for (let i = 0; i < rotationList.length; i++) {\r\n                const rotation = rotationList[i];\r\n                if (rotation.action === 'Q') {\r\n                    isQing = true;\r\n                } else if (rotation.action.includes('C') && isBursting == isQing) {\r\n                    result++;\r\n                }\r\n            }\r\n        } else {\r\n            result = rotationList.filter(rotation => (!character || rotation.member == character) && rotation.action.includes('C')).length;\r\n        }\r\n    } else {\r\n        return 1;\r\n    }\r\n    return result;\r\n}\r\n/** 元素スキル使用回数 */\r\nexport function countE(character?: string, rotationList?: TActionItem[], action = 'E', isBursting?: boolean) {\r\n    let result = 0;\r\n    if (rotationList?.length) {\r\n        if (character) {\r\n            let isQing = false;\r\n            let untilMap: Map<string[], number> | undefined;\r\n            for (let i = 0; i < rotationList.length; i++) {\r\n                const rotation = rotationList[i];\r\n                if (rotation.member == character) {\r\n                    if (untilMap && untilMap.size > 0) {\r\n                        for (const [key, value] of untilMap.entries()) {\r\n                            if (key.filter(untilAction => rotation.action.indexOf(untilAction) != -1).length) {\r\n                                let untilCount = value;\r\n                                if (untilCount) {\r\n                                    untilCount -= rotation.action.startsWith('N') ? rotation.action.length === 1 ? 1 : Number(rotation.action.substring(1, 2)) : 1;\r\n                                    if (untilCount > 0) {\r\n                                        untilMap.set(key, untilCount);\r\n                                    } else {\r\n                                        untilMap.clear();\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    } else if (rotation.action === 'Q') {\r\n                        isQing = true;\r\n                    } else if (rotation.action.startsWith(action)) {\r\n                        const workMap = CHARACTER_E_UNTIL_MAP.get(character);\r\n                        if (workMap && workMap.size > 0) {\r\n                            untilMap = _.cloneDeep(workMap);\r\n                        }\r\n                        result += (isBursting === undefined || isBursting == isQing) ? 1 : 0;\r\n                    }\r\n                } else {\r\n                    isQing = false;\r\n                }\r\n            }\r\n        } else {\r\n            result = rotationList.filter(rotation => (!character || rotation.member == character) && rotation.action.startsWith(action)).length;\r\n        }\r\n    } else {\r\n        result = 1;\r\n    }\r\n    return result;\r\n}\r\n/** 元素爆発使用回数 */\r\nexport function countQ(character?: string, rotationList?: TActionItem[]) {\r\n    return rotationList?.length ?\r\n        rotationList.filter(rotation => (!character || rotation.member == character) && rotation.action === 'Q').length\r\n        : 1;\r\n}\r\n/** 出場時間(%) */\r\nexport function getOnFieldRate(team: TTeam, rotationLength: number, rotationList: TActionItem[], constellations: number[]) {\r\n    const result = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n    const memberNameArr = team.members.map(member => member.name);\r\n    const danArr = team.members.map(member => member.name ? getNormalAttackDan(member.name) : 0);\r\n    if (rotationList?.length) {\r\n        const lengthList = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        let length = 0;\r\n        let isNCPIgnoring = false;\r\n        let preRotation = undefined;\r\n        for (let i = 0; i < rotationList.length; i++) {\r\n            const rotation = rotationList[i];\r\n            if (preRotation && rotation.member != preRotation.member) {\r\n                lengthList[memberNameArr.indexOf(preRotation.member)] += (length > 1 ? length : 1);\r\n                length = 0;\r\n                isNCPIgnoring = false;\r\n            }\r\n            preRotation = rotation;\r\n            const actionLength1 = ACTION_LENGTH_MAP.get(rotation.member);\r\n            if (actionLength1) {\r\n                const actionLength2 = actionLength1.get(rotation.action);\r\n                if (actionLength2 !== undefined) {\r\n                    length += actionLength2;\r\n                    continue;\r\n                }\r\n            }\r\n            const characterMaster = getCharacterMaster(rotation.member);\r\n            if (rotation.action === 'Q') {\r\n                length += 0.8;\r\n                if (characterMaster?.レアリティ && characterMaster.レアリティ === 5) {\r\n                    length += 0.4;\r\n                }\r\n            } else if (rotation.action === 'E.Hold') {\r\n                length += 1;\r\n            } else if (['E', 'E.Press'].includes(rotation.action)) {\r\n                length += 0.5;\r\n                const particleInfo = getParticleInfo(rotation.member, rotation.action, constellations[memberNameArr.indexOf(rotation.member)]);\r\n                const duration = getDurationFromInfo(particleInfo);\r\n                if (getReceiveTypeFromInfo(particleInfo) === SP_SELF && duration) {\r\n                    // 特定の元素スキル発動後は一定時間を加算して、キャラチェンまで通常攻撃、重撃、落下攻撃を無視する\r\n                    length += duration;\r\n                    isNCPIgnoring = true;\r\n                }\r\n            } else if (!isNCPIgnoring) {\r\n                if (rotation.action.startsWith('N')) {\r\n                    const maxDan = danArr[memberNameArr.indexOf(preRotation.member)];\r\n                    const dan = rotation.action.length === 1 ? 1 : Number(rotation.action.substring(1, 2));\r\n                    if (characterMaster?.武器) {\r\n                        const unitLength = NORMAL_ATTACK_LENGTH_OBJ[characterMaster.武器];\r\n                        for (let j = 0; j < dan; j++) {\r\n                            if ((j / maxDan) < (2 / 3)) {\r\n                                length += unitLength * 0.8;\r\n                            } else {\r\n                                length += unitLength * 1.2;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        length += 0.6 * dan;\r\n                    }\r\n                    if (rotation.action.endsWith('C')) {\r\n                        length += 0.5;\r\n                    }\r\n                    length += 0.3;\r\n                } else if (rotation.action == 'C') {\r\n                    if (characterMaster?.武器 === '両手剣') {   // ぐるぐる or ぶんぶん\r\n                        length += 3;\r\n                    } else if (characterMaster?.武器 === '弓') {    // 狙い撃ち\r\n                        length += 1.5;  // 甘雨 1段チャージ/2段チャージ=1s/1.5s\r\n                    } else if (characterMaster?.武器 === '法器') {\r\n                        length += 1;\r\n                    } else {    // for フリーナ\r\n                        length += 1;\r\n                    }\r\n                } else if (rotation.action == 'P') {\r\n                    length += 1.5;\r\n                }\r\n            }\r\n        }\r\n        if (preRotation && length > 0) {\r\n            lengthList[memberNameArr.indexOf(preRotation.member)] += (length > 1 ? length : 1);\r\n        }\r\n        const multiple = Math.ceil(100 / rotationLength);\r\n        const lengthSum = _.sum(lengthList);\r\n        for (let i = 0; i < result.length; i++) {\r\n            if (lengthSum && i < lengthList.length) {\r\n                result[i] = Math.ceil(lengthList[i] / lengthSum * 100 / multiple) * multiple;\r\n            } else {\r\n                result[i] = 25;\r\n            }\r\n        }\r\n        const sumVal = _.sum(result);\r\n        if (sumVal > 100) {\r\n            const maxVal = _.max(result);\r\n            for (let i = 0; i < result.length; i++) {\r\n                if (result[i] == maxVal) {\r\n                    result[i] -= sumVal - 100;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        const memberNum = memberNameArr.filter(name => name).length;\r\n        if (memberNum) {\r\n            const rate = 100 / memberNum;\r\n            for (let i = 0; i < result.length; i++) {\r\n                if (memberNameArr[i]) {\r\n                    result[i] = rate;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getMemberResult(character: string, members: TMember[], teamMemberResult?: TTeamMemberResult) {\r\n    let result = getDefaultMemberResult();\r\n    if (teamMemberResult) {\r\n        const memberArr = members.filter(member => member.name == character);\r\n        if (memberArr.length) {\r\n            result = teamMemberResult[memberArr[0].id];\r\n        }\r\n    } else {\r\n        const characterDetail = getCharacterDetail(character);\r\n        if (characterDetail?.ステータス) {\r\n            Object.keys(characterDetail.ステータス).forEach(key => {\r\n                result.statsInput.statsObj[key] += characterDetail.ステータス[key]['90'];\r\n            })\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getCharacterInputValue(character: string, members: TMember[], item: string, teamMemberResult?: TTeamMemberResult) {\r\n    return (getMemberResult(character, members, teamMemberResult).characterInput as any)[item];\r\n}\r\n\r\nexport function getStatsInputValue(character: string, members: TMember[], item: string, teamMemberResult?: TTeamMemberResult) {\r\n    return (getMemberResult(character, members, teamMemberResult).statsInput.statsObj as any)[item];\r\n}\r\n","import _ from \"lodash\";\r\nimport { TActionItem, TTeamMemberResult, NUMBER_OF_MEMBERS, getCharacterMaster, getCharacterDetail, TMember } from \"./team\";\r\nimport { countQ, RECHARGE_ENERGY_CONSTELLATION, RECHARGE_ENERGY_SKILL, RECHARGE_ENERGY_BURST, countE, countC, RECHARGE_ENERGY_PASSIVE, countN, getCharacterInputValue, getStatsInputValue, RECHARGE_PARTICLE_CONSTELLATION, RECHARGE_PARTICLE_PASSIVE, getMemberResult } from \"./ERCalculatorCommon\";\r\n\r\nexport type TCharacterEnergyRet = [string, string, number, number, number, number[], string[]];\r\nexport type TCharacterParticleRet = [string, string, string, number, number, number[], string[]];\r\n\r\nexport const CHARACTER_ENERGY_FUNC: {\r\n    [key: string]: (\r\n        character: string,\r\n        constellation: number,\r\n        members: TMember[],\r\n        rotationLength: number,\r\n        rotationList: TActionItem[] | undefined,\r\n        teamMemberResult?: TTeamMemberResult,\r\n    ) => TCharacterEnergyRet[]\r\n} = {\r\n    '旅人(岩)': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '岩潮幾重が引き起こす振動波が敵に命中する度に、元素エネルギーが5回復する。この方法で一回で最大25まで回復可能。',\r\n            ];\r\n            const myEnergy = 5 * countQ(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '旅人(雷)': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            '豊穰の勾玉 ・元素エネルギーが回復する。',\r\n            '旅人自身の元素チャージ効率の10%を基準に、雷影剣が生成した豊穰の勾玉による元素チャージ効率をアップする。',\r\n        ];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            messages.push('キャラクターが雷影剣で生成した豊穰の勾玉を獲得した時、該当キャラクターの元素エネルギーが35%未満の場合、豊穰の勾玉で回復できる元素エネルギー+100%。');\r\n        }\r\n        const skillLevel = getCharacterInputValue(character, members, '元素スキルレベル', teamMemberResult);\r\n        const er = getStatsInputValue(character, members, '元素チャージ効率', teamMemberResult);\r\n        const myEnergy = [3, 3, 3, 3.5, 3.5, 3.5, 4, 4, 4, 4, 4, 4, 4, 4, 4][skillLevel - 1] * (100 + (er / 10)) / 100;\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_SKILL, '', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        const messages2 = [\r\n            '身に纏う雷霆 出場している自身のキャラクターの通常攻撃または重撃が敵に命中すると、威光の落雷が発動し、敵に雷元素ダメージを与える。威光の落雷が敵に命中すると、該当キャラクターの元素エネルギーを回復する。威光の落雷の発生は0.5秒毎に1回のみ可能。'\r\n        ];\r\n        const burstLevel = getCharacterInputValue(character, members, '元素爆発レベル', teamMemberResult);\r\n        const somebodyEnergy = [0.8, 0.8, 0.8, 0.9, 0.9, 0.9, 1, 1, 1, 1, 1, 1, 1, 1, 1][burstLevel - 1];\r\n        result.push([RECHARGE_ENERGY_BURST, '', somebodyEnergy, allEnergy, otherEnergy, herEnergies, messages2]);\r\n        return result;\r\n    },\r\n    '旅人(草)': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 1;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '草縁剣が敵に命中すると、旅人の元素エネルギーが3.5回復する。',\r\n            ];\r\n            const myEnergy = 3.5 * countE(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ガイア': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 6;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '凛冽なる輪舞の氷柱が1本追加され、発動時に元素エネルギーが15回復する。',\r\n            ];\r\n            const myEnergy = 15 * countQ(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'リサ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 1;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '蒼雷を長押しで発動した後、敵に命中する度にリサの元素エネルギーが2回復する。一回で最大10まで回復可能。',\r\n            ];\r\n            const myEnergy = 2 * countE(character, rotationList, 'E.Hold');\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'バーバラ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        let constellationLevel = 1;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '10秒毎に元素エネルギーを1回復する。',\r\n            ];\r\n            const myEnergy = 1 * Math.trunc(rotationLength / 10);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '重撃が敵に命中する度に、バーバラの元素エネルギーが1回復する。一回で最大元素エネルギーが5まで回復できる。',\r\n            ];\r\n            const myEnergy = 1 * countC(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'レザー': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            '無形の雷狼を召喚して自身を守り、周囲の敵に雷元素ダメージを与える。同時に、雷の印を消耗して自身の元素エネルギーを回復する。退場時、残り時間を基準に、元素エネルギーを最大10まで回復する。',\r\n        ];\r\n        const myEnergy = 0;\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_BURST, '', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        return result;\r\n    },\r\n    '行秋': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 6;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '古華剣·裁雨留虹が剣雨攻撃を2回発動する度に、次の剣雨攻撃が大幅に強化され、敵に命中する時行秋の元素エネルギーを3回復する。',\r\n            ];\r\n            const nCount = rotationList?.length ? Math.trunc(rotationList.filter(rotation => rotation.action.startsWith('N')).length / 3) : 1;\r\n            const myEnergy = 3 * nCount;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '重雲': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '重雲の攻撃が氷元素の影響を受けた敵に命中した時、自身の元素エネルギーを1回復する。この効果は2秒毎に1回のみ発動可能。',\r\n            ];\r\n            const myEnergy = 1;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ディオナ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 1;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '特製スピリッツの効果終了時、ディオナの元素エネルギーを15回復する。',\r\n            ];\r\n            const myEnergy = 15 * countQ(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ロサリア': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '罪喰いの懺悔で会心が発生すると、ロサリア自身の元素エネルギーが5回復する。この効果は、1回の罪喰いの懺悔で1度のみ発動可能。',\r\n            ];\r\n            const myEnergy = 5;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '早柚': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '早柚がフィールド上で拡散反応を起こした時、元素エネルギーを1.2ポイント回復する。この効果は2秒毎に1回のみ発動可能。',\r\n            ];\r\n            const myEnergy = 1.2;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '九条裟羅': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            '天狗呪雷·伏は敵に命中すると、九条裟羅の元素チャージ効率を基準にし、その100%の元素チャージ効率毎に、チーム全員の元素エネルギーを1.2回復する。この効果は3秒毎に1回のみ発動可能。',\r\n        ];\r\n        const er = getStatsInputValue(character, members, '元素チャージ効率', teamMemberResult);\r\n        const myEnergy = 0;\r\n        const allEnergy = 1.2 * er / 100 * countE(character, rotationList);\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_PASSIVE, '御公儀', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        return result;\r\n    },\r\n    'トーマ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '真紅熾炎の大鎧を発動すると、トーマの元素エネルギーを15ポイント回復する。',\r\n            ];\r\n            const myEnergy = 15 * countQ(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '鹿野院平蔵': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '一回の廻風蹴で発生した「廻風真眼」が初めて爆発する時、鹿野院平蔵自身の元素エネルギーを9回復する。その後、爆発するたびに追加で元素エネルギーを1.5回復する。この方法により一回の廻風蹴で回復できる元素エネルギーは、最大13.5まで。',\r\n            ];\r\n            const myEnergy = 9 * countQ(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ドリー': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            'ジンニーランプ·トラブルシューターのトラブルシューター砲またはアフターサービス弾が敵に命中すると、ドリーの元素チャージ効率を基準にし、その100%の元素チャージ効率毎にドリーの元素エネルギーを5回復する。ジンニーランプ·トラブルシューター1回につき、この方式で回復できる元素エネルギーは15まで。',\r\n        ];\r\n        const er = getStatsInputValue(character, members, '元素チャージ効率', teamMemberResult);\r\n        const myEnergy = Math.min(15, 5 * er / 100) * countE(character, rotationList);\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_PASSIVE, '砂だるま式利子', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        const burstLevel = getCharacterInputValue(character, members, '元素爆発レベル', teamMemberResult);\r\n        const somebodyEnergy = [1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5][burstLevel - 1];\r\n        const messages2 = [\r\n            'ランプの精 近くにいるキャラクターとリンクする。ランプの精とリンクしたキャラクターに下記効果を与える。・持続的に元素エネルギーを回復する。'\r\n        ];\r\n        result.push([RECHARGE_ENERGY_BURST, '', somebodyEnergy, allEnergy, otherEnergy, herEnergies, messages2]);\r\n        return result;\r\n    },\r\n    'レイラ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 2;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '垂裳凛然の夜が発射した飛星が敵に命中すると、レイラの元素エネルギーを1ポイント回復させる。この方法を通して、各飛星はレイラの元素エネルギーを最大で1回のみ回復できる。',\r\n            ];\r\n            const myEnergy = 1;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ファルザン': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '命中した敵の数に基づき、風圧崩潰のサイクロンはファルザンの元素エネルギーを回復する。1体の敵に命中した場合、ファルザンの元素エネルギーを2ポイント回復する。また、追加で1体の敵に命中するたびに、ファルザンの元素エネルギーが0.5ポイント回復する。この方法により1回のサイクロンで回復できる元素エネルギーは最大4ポイントまで。',\r\n            ];\r\n            const myEnergy = 2 * (constellation >= 6 ? Math.trunc(rotationLength / 3) : Math.min(countE(character, rotationList) * 2, countC(character, rotationList)));\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ヨォーヨ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 2;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '玉颗珊々月中落の桂子仙機状態にある時、白玉大根の爆発が敵に命中すると、ヨォーヨの元素エネルギーを3ポイント回復する。この方法による元素エネルギーの回復は、0.8秒毎に1回のみ可能。',\r\n            ];\r\n            const myEnergy = 3;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ミカ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                'ミカ自身によるスカイフェザーソングの鷹の羽状態がチームにいるキャラクターのHPを回復した時、ミカの元素エネルギーを3回復する。1回のスカイフェザーソングの鷹の羽状態で、元素エネルギーは最大5回まで回復できる。',\r\n            ];\r\n            const myEnergy = 3 * 5 * countQ(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'フレミネ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 2;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                'プレッシャー·フロウ·高圧粉砕を発動すると、フレミネの元素エネルギーが2ポイント回復する。ランク4の高圧粉砕を発動すると、元素エネルギーの回復量が3ポイントに変わる。',\r\n            ];\r\n            const myEnergy = 2 * countE(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ジン': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            '蒲公英の風発動後、元素エネルギーが20%回復する。',\r\n        ];\r\n        const myEnergy = 80 * 0.2 * countQ(character, rotationList);\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_PASSIVE, '風の導くままに', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        return result;\r\n    },\r\n    '七七': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 1;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '度厄のお札マークがついている敵に寒病鬼差が命中した時、七七の元素エネルギーを2回復する。',\r\n            ];\r\n            const myEnergy = 1;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ウェンティ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            '風神の詩効果終了後、ウェンティの元素エネルギーを15回復する。元素変化があった場合、該当元素のチームメンバーの元素エネルギーを15回復する。',\r\n        ];\r\n        const qCount = countQ(character, rotationList);\r\n        const myEnergy = 15 * qCount;\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        for (const element of ['炎', '水', '雷', '氷']) {\r\n            let doBreak = false;\r\n            for (let herIndex = 0; herIndex < members.length; herIndex++) {\r\n                const herCm = getCharacterMaster(members[herIndex].name);\r\n                if (herCm?.元素 == element) {\r\n                    herEnergies[herIndex] = myEnergy;\r\n                    doBreak = true;\r\n                }\r\n            }\r\n            if (doBreak) break;\r\n        }\r\n        result.push([RECHARGE_ENERGY_PASSIVE, '暴風の目', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        return result;\r\n    },\r\n    'クレー': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            'クレーの重撃が会心を発生すると、チーム全員の元素エネルギーが2回復する。',\r\n        ];\r\n        const myEnergy = 2;\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_PASSIVE, '無限花火', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        const constellationLevel = 6;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                'ドッカン花火状態中、クレーは3秒毎にチーム全員（クレー自身を除く）の元素エネルギーを3回復する。',\r\n            ];\r\n            const myEnergy = 0;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 3;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'アルベド': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 1;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                'アルベドの創生術·擬似陽華の刹那の花が放たれた時、アルベド自身の元素エネルギーが1.2回復する。',\r\n            ];\r\n            const myEnergy = 1.2 * (countE(character, rotationList) ? Math.trunc(rotationLength / 2) : 1);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '甘雨': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 1;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '二段チャージ重撃の霜華の矢または霜華満開が命中した時、敵の氷元素耐性-15%、継続時間6秒。命中時に甘雨の元素エネルギーを2回復。二段チャージの重撃による元素エネルギーの回復効果は、1回の重撃で1度のみ発動可能。',\r\n            ];\r\n            const myEnergy = 2 * countC(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '楓原万葉': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '楓原万葉の元素エネルギーが45以下の時、下記の効果を獲得する。・一回押し/長押しで千早振るを発動した時、元素エネルギーを3/4回復する。・滑翔状態の時、1秒毎に元素エネルギーを2回復する。',\r\n            ];\r\n            const myEnergy = 3;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '雷電将軍': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            '攻撃が敵に命中すると、周囲のチーム全員の元素エネルギーを回復する。この方式での元素エネルギー回復は1秒毎に1回のみ可能で、継続時間内に最大5回まで発動可能。',\r\n            '元素チャージ効率が100%を超えている場合、超えた分1%につき、雷電将軍は下記の効果を獲得する。・夢想の一心状態で提供する元素エネルギー回復+0.6%。',\r\n        ];\r\n        const er = getStatsInputValue(character, members, '元素チャージ効率', teamMemberResult);\r\n        let unit = 2.3 * (1 + (er - 100) * 0.006);\r\n        let unit2 = 0;\r\n        const memberResult = getMemberResult(character, members, teamMemberResult);\r\n        memberResult.damageResult.元素爆発.forEach(entry => {\r\n            if (entry[0] === '夢想の一心エネルギー回復') {\r\n                unit = entry[2];\r\n            } else if (entry[0] === '非表示_夢想の一心エネルギー回復') {\r\n                unit2 = entry[2];\r\n            }\r\n        })\r\n        if (memberResult.characterInput.weapon === '草薙の稲光') {\r\n            unit2 *= [30, 35, 40, 45, 50][memberResult.characterInput.武器精錬ランク - 1] * 0.006;\r\n        }\r\n        const myEnergy = 0;\r\n        const allEnergy = (unit + unit2) * 5 * countQ(character, rotationList);\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_BURST, '', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        return result;\r\n    },\r\n    '珊瑚宮心海': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '海人の羽衣による儀来羽衣状態の時、珊瑚宮心海の通常攻撃の攻撃速度+10%。そして通常攻撃が敵に命中すると、元素エネルギーを0.8ポイント回復する。この効果は0.2秒毎に1回のみ発動可能。',\r\n            ];\r\n            const myEnergy = 0.8 * countN(character, rotationList, true);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '荒瀧一斗': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 2;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '最凶鬼王·一斗轟臨！！を発動した後、チーム内に岩元素タイプキャラクターが1人いる毎に、クールタイム-1.5秒、荒瀧一斗の元素エネルギーを6ポイント回復する。この方式で短縮できるクールタイムは4.5秒までとなり、回復できる元素エネルギーは18ポイントまでとなる。',\r\n            ];\r\n            const geoCount = members.filter(member => getCharacterMaster(member.name)?.元素 === '岩').length;\r\n            const myEnergy = Math.min(18, 6 * geoCount) * countQ(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '八重神子': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 1;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '大密法·天狐顕現で天狐雷霆を1回発生させるたびに、八重神子自身の元素エネルギーを8ポイント回復する。',\r\n            ];\r\n            const myEnergy = 3 * 8 * countQ(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '神里綾人': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            '神里綾人が待機中の時、元素エネルギーが40未満の場合、1秒毎に元素エネルギーを2回復する。',\r\n        ];\r\n        const myEnergy = 2;\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_PASSIVE, '神里流·満ちゆく破月', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        return result;\r\n    },\r\n    'セノ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '聖儀·狼駆憑走の啓途誓使状態の時、感電、超電導、過負荷、原激化、超激化、超開花または雷元素拡散反応を起こすと、周囲のチーム全員（セノ自身を除く）の元素エネルギーを3回復する。この効果は一回の聖儀·狼駆憑走で、最大5回まで発動できる。',\r\n            ];\r\n            const myEnergy = 0;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 3 * 5 * countQ(character, rotationList);\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'ニィロウ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '七域のダンスのピルエット状態の3段目のステップが敵に命中すると、ニィロウの元素エネルギーが15回復する。',\r\n            ];\r\n            const myEnergy = 15 * countE(character, rotationList);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    '放浪者': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            '拾玉得花(雷元素)：通常攻撃および重撃が敵に命中した後、元素エネルギーが0.8ポイント回復する。この方式による元素エネルギー回復は、0.2秒毎に1回のみ可能。',\r\n        ];\r\n        const electroCount = members.filter(member => getCharacterDetail(member.name)?.元素 === '雷').length;\r\n        const myEnergy = electroCount > 0 ? 0.8 * (countN(character, rotationList) + countC(character, rotationList)) : 0;\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_PASSIVE, '拾玉得花', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        return result;\r\n    },\r\n    'ディシア': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '炎哮獅子咬の熾鬣拳、または残火蹴が敵に命中した時、ディシアの元素エネルギーを1.5回復。この効果は0.2秒毎に1回のみ発動可能。',\r\n            ];\r\n            const myEnergy = 1.5;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'リネ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const messages: string[] = [\r\n            'リネがプロップアローを発射することでHPを消費した時、そのプロップアローによって召喚されたファニーキャット·ハットが敵に命中すると、リネの元素エネルギーが3ポイント回復',\r\n        ];\r\n        const myEnergy = 3;\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        result.push([RECHARGE_ENERGY_PASSIVE, '息を呑むパフォーマンス', myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        return result;\r\n    },\r\n    'フリーナ': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                'サロン·ソリティアの「サロンメンバー」が攻撃を敵に命中させたり、「衆の水の歌い手」が周囲のフィールド上にいるキャラクターのHPを回復したりすると、フリーナは元素エネルギーを4ポイント獲得する。この効果は5秒毎に1回のみ発動可能。',\r\n            ];\r\n            const myEnergy = 4 * Math.trunc(rotationLength / 5);\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n    'シャルロット': (character, constellation, members, rotationLength, rotationList, teamMemberResult) => { // eslint-disable-line\r\n        const result: TCharacterEnergyRet[] = [];\r\n        const constellationLevel = 4;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                'スチルフォト·多角的立証が「スナップシルエット」、または「フォーカスインプレッション」マークが付いている敵に命中したとき、与えるダメージ+10%。また、シャルロットが元素エネルギーを2ポイント回復する。この方法での元素エネルギー回復は20秒毎に5回のみ可能。',\r\n            ];\r\n            const myEnergy = 2;\r\n            const allEnergy = 0;\r\n            const otherEnergy = 0;\r\n            const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            result.push([RECHARGE_ENERGY_CONSTELLATION, String(constellationLevel), myEnergy, allEnergy, otherEnergy, herEnergies, messages]);\r\n        }\r\n        return result;\r\n    },\r\n}\r\n\r\nexport const CHARACTER_PARTICLE_EXTRA_FUNC: {\r\n    [key: string]: (\r\n        character: string,\r\n        constellation: number,\r\n        members: TMember[],\r\n        rotationLength: number,\r\n        rotationList: TActionItem[] | undefined,\r\n        onFields: number[],\r\n    ) => TCharacterParticleRet | undefined\r\n} = {\r\n    'ガイア': (character, constellation, members, rotationLength, rotationList, onFields) => { // eslint-disable-line\r\n        let result: TCharacterParticleRet | undefined = undefined;\r\n        const messages: string[] = [\r\n            '霜の襲撃が敵を凍結状態にした場合、凍結された敵から追加の元素粒子が落ちる。1回の霜襲は2つの元素粒子が追加で発生する。',\r\n        ];\r\n        const hydroCount = members.filter(member => getCharacterMaster(member.name)?.元素 === '水').length;\r\n        const myParticle = hydroCount > 0 ? 2 * countE(character, rotationList) : 2;\r\n        const allParticle = 0;\r\n        result = [RECHARGE_PARTICLE_PASSIVE, '', '氷', myParticle, allParticle, [], messages];\r\n        return result;\r\n    },\r\n    'フィッシュル': (character, constellation, members, rotationLength, rotationList, onFields) => { // eslint-disable-line\r\n        let result: TCharacterParticleRet | undefined = undefined;\r\n        const constellationLevel = 6;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                'オズは出場している自身のキャラクターと共に攻撃し、攻撃力30%分の雷元素ダメージを与える。',\r\n            ];\r\n            const myParticle = 0;\r\n            const allParticle = rotationList?.length ? (2 / 3) * countN(undefined, rotationList) : 1;\r\n            result = [RECHARGE_PARTICLE_CONSTELLATION, String(constellationLevel), '雷', myParticle, allParticle, [], messages];\r\n        }\r\n        return result;\r\n    },\r\n    '刻晴': (character, constellation, members, rotationLength, rotationList, onFields) => { // eslint-disable-line\r\n        let result: TCharacterParticleRet | undefined = undefined;\r\n        const constellationLevel = 2;\r\n        if (constellation >= constellationLevel) {\r\n            const messages: string[] = [\r\n                '刻晴の通常攻撃と重撃が雷元素の影響を受けた敵に命中した時、50%の確率で元素粒子を1個生成する。5秒毎に1回のみ発動可能。',\r\n            ];\r\n            const myParticle = 0;\r\n            const allParticle = 0;\r\n            const herParticles = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            let triggerCnt = 1;\r\n            if (rotationList?.length) {\r\n                const ct = 5;\r\n                const rindexArr: number[] = [];\r\n                let isRecorded = false;\r\n                for (let i = 0; i < rotationList.length; i++) {\r\n                    const rotation = rotationList[i];\r\n                    if (rotation.member == character) {\r\n                        if (rotation.action.startsWith('N') && !isRecorded) {\r\n                            rindexArr.push(i);\r\n                            isRecorded = true;\r\n                        }\r\n                    } else {\r\n                        isRecorded = false;\r\n                    }\r\n                }\r\n                const memberNameArr = members.map(member => member.name);\r\n                const onField = onFields[memberNameArr.indexOf(character)];\r\n                triggerCnt = Math.min(Math.trunc(rotationLength / ct), rindexArr.length + Math.max(0, Math.trunc(rotationLength * onField / 100 / ct) - 1));\r\n                for (let i = 0; i < triggerCnt; i++) {\r\n                    let nxtCharacter = character;\r\n                    if (i < rindexArr.length && (rindexArr[i] + 1) < rotationList.length) {\r\n                        nxtCharacter = rotationList[rindexArr[i] + 1].member;\r\n                    }\r\n                    const toIndex = memberNameArr.indexOf(nxtCharacter);\r\n                    herParticles[toIndex] += 1;\r\n                }\r\n            }\r\n            result = [RECHARGE_PARTICLE_CONSTELLATION, String(constellationLevel), '雷', myParticle, allParticle, herParticles, messages];\r\n        }\r\n        return result;\r\n    },\r\n}\r\n","import _ from \"lodash\";\r\nimport { NUMBER_OF_MEMBERS, TActionItem } from \"./team\";\r\nimport { RECHARGE_ENERGY_WEAPON, countC, countE, countN, countQ } from \"./ERCalculatorCommon\";\r\n\r\nexport type TWeaponEnergyRet = [string, string, number, number, number, number[], string[]];\r\n\r\nexport const WEAPON_ENERGY_FUNC: {\r\n    [key: string]: (\r\n        character: string,\r\n        weapon: string,\r\n        weaponRefine: number,\r\n        members: string[],\r\n        rotationLength: number,\r\n        rotationList: TActionItem[] | undefined,\r\n    ) => TWeaponEnergyRet\r\n} = {\r\n    '金珀·試作': (character, weapon, weaponRefine, members, rotationLength, rotationList) => { // eslint-disable-line\r\n        const messages = [\r\n            '元素爆発を発動した後の6秒間、2秒毎に元素エネルギーを4/4.5/5/5.5/6回復し、チーム全員のHPを2秒毎に4%/4.5%/5%/5.5%/6%回復する。',\r\n        ];\r\n        const myEnergy = [4, 4.5, 5, 5.5, 6][weaponRefine - 1] * 3 * countQ(character, rotationList);\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        return [RECHARGE_ENERGY_WEAPON, weapon, myEnergy, allEnergy, otherEnergy, herEnergies, messages];\r\n    },\r\n    '天目影打': (character, weapon, weaponRefine, members, rotationLength, rotationList) => { // eslint-disable-line\r\n        const messages = [\r\n            '元素スキルを発動した後、継続時間30秒の継承の印を1つ獲得する。この効果は5秒毎に1回のみ発動可能で、継承の印は同時に最大3つまで存在可能。元素爆発を発動すると、所持している継承の印を全て消費し、消費した継承の印1つにつき、2秒後に該当キャラクターの元素エネルギーを6/7.5/9/10.5/12ポイント回復する。',\r\n        ];\r\n        const myEnergy = [6, 7.5, 9, 10.5, 12][weaponRefine - 1] * Math.min(countE(character, rotationList), countQ(character, rotationList) * 3, rotationLength / 5);\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        return [RECHARGE_ENERGY_WEAPON, weapon, myEnergy, allEnergy, otherEnergy, herEnergies, messages];\r\n    },\r\n    '桂木斬長正': (character, weapon, weaponRefine, members, rotationLength, rotationList) => {\r\n        return weaponEnergySub_名士の振舞(character, weapon, weaponRefine, members, rotationLength, rotationList);\r\n    },\r\n    '喜多院十文字槍': (character, weapon, weaponRefine, members, rotationLength, rotationList) => {\r\n        return weaponEnergySub_名士の振舞(character, weapon, weaponRefine, members, rotationLength, rotationList);\r\n    },\r\n    '不滅の月華': (character, weapon, weaponRefine, members, rotationLength, rotationList) => { // eslint-disable-line\r\n        const messages = [\r\n            '元素爆発を発動した後の12秒間、通常攻撃が敵に命中すると元素エネルギーが0.6ポイント回復する。この方式での元素エネルギー回復は、0.1秒毎に1回のみ可能。',\r\n        ];\r\n        const myEnergy = 0.6 * countN(character, rotationList, true);\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        return [RECHARGE_ENERGY_WEAPON, weapon, myEnergy, allEnergy, otherEnergy, herEnergies, messages];\r\n    },\r\n    '碧落の瓏': (character, weapon, weaponRefine, members, rotationLength, rotationList) => { // eslint-disable-line\r\n        const messages = [\r\n            '元素爆発を起動、またはシールドを生成した後の3秒間、「定土玉圭」効果を発動する。2.5秒毎に元素エネルギーを4.5/5/5.5/6/6.5回復',\r\n        ];\r\n        const myEnergy = [4.5, 5, 5.5, 6, 6.5][weaponRefine - 1];\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        return [RECHARGE_ENERGY_WEAPON, weapon, myEnergy, allEnergy, otherEnergy, herEnergies, messages];\r\n    },\r\n    '正義の報酬': (character, weapon, weaponRefine, members, rotationLength, rotationList) => { // eslint-disable-line\r\n        const messages = [\r\n            '治療を受けた時、元素エネルギーを8/10/12/14/16ポイント回復する。この効果は10秒毎に1回のみ発動可能。キャラクターが待機中でも発動できる。',\r\n        ];\r\n        const myEnergy = [8, 10, 12, 14, 16][weaponRefine - 1] * Math.trunc(rotationLength / 10);\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        return [RECHARGE_ENERGY_WEAPON, weapon, myEnergy, allEnergy, otherEnergy, herEnergies, messages];\r\n    },\r\n    '久遠流転の大典': (character, weapon, weaponRefine, members, rotationLength, rotationList) => { // eslint-disable-line\r\n        const messages = [\r\n            '現在のHPが増える、または減る時、継続時間4秒、最大3層まで。0.3秒毎に1回のみ発動可能。3層まで重ねた時、または3層の継続時間がリセットされた時、元素エネルギーを8/9/10/11/12ポイント回復する。この方法による元素エネルギーの回復は、12秒に1回のみ。',\r\n        ];\r\n        const myEnergy = [8, 9, 10, 11, 12][weaponRefine - 1];\r\n        const allEnergy = 0;\r\n        const otherEnergy = 0;\r\n        const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        return [RECHARGE_ENERGY_WEAPON, weapon, myEnergy, allEnergy, otherEnergy, herEnergies, messages];\r\n    },\r\n    '船渠剣': (character, weapon, weaponRefine, members, rotationLength, rotationList) => {\r\n        return weaponEnergySub_船工の唄(character, weapon, weaponRefine, members, rotationLength, rotationList);\r\n    },\r\n    '携帯型チェーンソー': (character, weapon, weaponRefine, members, rotationLength, rotationList) => {\r\n        return weaponEnergySub_船工の唄(character, weapon, weaponRefine, members, rotationLength, rotationList);\r\n    },\r\n}\r\n\r\nfunction weaponEnergySub_名士の振舞(\r\n    character: string,\r\n    weapon: string,\r\n    weaponRefine: number,\r\n    members: string[],  // eslint-disable-line\r\n    rotationLength: number,  // eslint-disable-line\r\n    rotationList: TActionItem[] | undefined,\r\n): TWeaponEnergyRet {\r\n    const messages = [\r\n        '元素スキルが命中した時、キャラクターは元素エネルギーを3失う。その後の6秒間、2秒毎に元素エネルギーを3/3.5/4/4.5/5獲得する。この効果は10秒毎に1回のみ発動でき、待機中のキャラクターも発動できる。',\r\n    ];\r\n    let myEnergy = 0;\r\n    const unit = [3, 3.5, 4, 4.5, 5][weaponRefine - 1];\r\n    if (rotationList?.length) {\r\n        let isInCt = false;\r\n        for (let i = 0; i < rotationList.length; i++) {\r\n            const rotation = rotationList[i];\r\n            if (rotation.member == character) {\r\n                if (rotation.action.startsWith('E')) {\r\n                    if (!isInCt) {\r\n                        myEnergy += unit * 3;\r\n                        if (i === 0 || rotationList[i - 1].member != character || rotationList[i - 1].action !== 'Q') {\r\n                            myEnergy -= 3;\r\n                        }\r\n                    }\r\n                    isInCt = true;\r\n                }\r\n            } else {\r\n                isInCt = false;\r\n            }\r\n        }\r\n    } else {\r\n        myEnergy = unit * 3 - 3;\r\n    }\r\n    const allEnergy = 0;\r\n    const otherEnergy = 0;\r\n    const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n    return [RECHARGE_ENERGY_WEAPON, weapon, myEnergy, allEnergy, otherEnergy, herEnergies, messages];\r\n}\r\n\r\nfunction weaponEnergySub_船工の唄(\r\n    character: string,  // eslint-disable-line\r\n    weapon: string,\r\n    weaponRefine: number,\r\n    members: string[],  // eslint-disable-line\r\n    rotationLength: number,\r\n    rotationList: TActionItem[] | undefined,  // eslint-disable-line\r\n): TWeaponEnergyRet {\r\n    const messages = [\r\n        '治療効果を受ける、または治療効果を与える時、強靭マークが1枚付与される。継続時間30秒、最大3枚まで。元素スキル、または元素爆発を発動する時、すべての強靭マークを消費し、継続時間10秒の「奮起」効果を獲得する。「奮起」効果を獲得した2秒後、消費した強靭マーク1枚につき、装備者の元素エネルギーを2/2.5/3/3.5/4ポイント回復する。「奮起」効果は15秒に1回のみ発動可能。キャラクターが待機中でも強靭マークを獲得できる。',\r\n    ];\r\n    const myEnergy = [2, 2.5, 3, 3.5, 4][weaponRefine - 1] * 3 * Math.min(countE(character, rotationList) + countC(character, rotationList), Math.trunc(rotationLength / 15));\r\n    const allEnergy = 0;\r\n    const otherEnergy = 0;\r\n    const herEnergies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n    return [RECHARGE_ENERGY_WEAPON, weapon, myEnergy, allEnergy, otherEnergy, herEnergies, messages];\r\n}\r\n","import _ from \"lodash\";\r\nimport { NUMBER_OF_MEMBERS, TActionItem, TTeam, TTeamMemberResult, getCharacterDetail, getCharacterMaster } from \"./team\";\r\nimport { CHARACTER_E_DELAY_MAP, CHARACTER_E_UNTIL_MAP, CHARACTER_Q_NOT_RECHARGEABLE, CHARACTER_Q_TO_E_ARR, SP_LONG, SP_NEXT, SP_SELF, SP_SHRT, getDurationFromInfo, getElementalSkillActions, getParticleInfo, getParticleNumFromInfo, getReceiveTypeFromInfo } from \"@/particlemaster\";\r\nimport { TERParticle, RECHARGE_PARTICLE_SKILL, countE, countC, countQ, RECHARGE_PARTICLE_FAVONIUS, RECHARGE_PARTICLE_RESONANCE, TEREnergy, RECHARGE_ENERGY_ARTIFACT, RECHARGE_ENERGY_ATTACK, ATTACK_ENERGY_COUNT_OBJ } from \"./ERCalculatorCommon\";\r\nimport { CHARACTER_ENERGY_FUNC, CHARACTER_PARTICLE_EXTRA_FUNC } from \"./ERCalculatorFuncCharacter\";\r\nimport { WEAPON_ENERGY_FUNC } from \"./ERCalculatorFuncWeapon\";\r\n\r\nexport function getParticleByCharacter(\r\n    character: string,\r\n    constellation: number,\r\n    team: TTeam,\r\n    rotationLength: number,\r\n    rotationList: TActionItem[] | undefined,\r\n    onFields: number[],\r\n): TERParticle[] | undefined {\r\n    const kind = RECHARGE_PARTICLE_SKILL;\r\n    const resultMap = new Map<string, number[]>();\r\n    if (!character) return undefined;\r\n    if (!rotationList?.length) {\r\n        rotationList = [{\r\n            id: 0,\r\n            member: character,\r\n            action: getElementalSkillActions(character)[0],\r\n        }];\r\n    }\r\n    const memberNameArr = team.members.map(member => member.name);\r\n    const myIndex = memberNameArr.indexOf(character);\r\n    if (character === 'ファルザン' && constellation >= 6) {\r\n        const eCount = countE(character, rotationList);\r\n        const cCount = countC(character, rotationList);\r\n        const qCount = countQ(character, rotationList);\r\n        const action = 'E';\r\n        const particleInfo = getParticleInfo(character, action);\r\n        const num = getParticleNumFromInfo(particleInfo) * Math.trunc(Math.min(rotationLength, Math.min(eCount, cCount) * 5.5 + qCount * 18) / 5.5);\r\n        const resultVal = resultMap.get(action) ?? _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        splitNumToArrByOnFieldRate(resultVal, num, team, onFields);\r\n        resultMap.set(action, resultVal);\r\n    } else if (character === 'フリーナ') {\r\n        let ousiaLength = 0;\r\n        let isOusia = true; // はじめはウーシア\r\n        rotationList.forEach(rotation => {\r\n            if (rotation.member == character && rotation.action.includes('C')) {    // 重撃でアルケー切り替え\r\n                isOusia = !isOusia;\r\n            }\r\n            if (isOusia) {\r\n                ousiaLength++;\r\n            }\r\n        })\r\n        const action = 'E';\r\n        const particleInfo = getParticleInfo(character, action);\r\n        const num = getParticleNumFromInfo(particleInfo, rotationLength) * Math.trunc(ousiaLength / rotationList.length);\r\n        const resultVal = resultMap.get(action) ?? _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        splitNumToArrByOnFieldRate(resultVal, num, team, onFields);\r\n        resultMap.set(action, resultVal);\r\n    } else {\r\n        const timeArr = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        let curCharacter;\r\n        let isBursting = false;\r\n        let untilMap = new Map<string[], number>();\r\n        let delayActions: string[] | undefined;    // delayActionsの実行まで元素粒子生成を遅らせる\r\n        for (let i = 0; i < rotationList.length; i++) {\r\n            const rotation = rotationList[i];\r\n            if (rotation.member != curCharacter) {\r\n                isBursting = false;\r\n            }\r\n            if (rotation.member == character) {\r\n                let action = rotation.action;\r\n                if (action === 'Q') {\r\n                    isBursting = true; // キャラチェンするまでずっと元素爆発中判定とする\r\n                    if (CHARACTER_Q_TO_E_ARR.includes(character)) {\r\n                        action = 'E';\r\n                    }\r\n                }\r\n                if (untilMap && untilMap.size > 0) {\r\n                    for (const [key, value] of untilMap.entries()) {\r\n                        if (key.filter(untilAction => action.indexOf(untilAction) != -1).length > 0) {\r\n                            let untilCount = value;\r\n                            if (untilCount) {\r\n                                untilCount -= action.startsWith('N') ? action.length === 1 ? 1 : Number(action.substring(1, 2)) : 1;\r\n                                if (untilCount > 0) {\r\n                                    untilMap.set(key, untilCount);\r\n                                } else {\r\n                                    untilMap.clear();\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (action.startsWith('E') || delayActions && delayActions.filter(delayAction => action.indexOf(delayAction) != -1).length) {\r\n                    const workMap = CHARACTER_E_UNTIL_MAP.get(character);\r\n                    if (workMap && workMap.size > 0) {\r\n                        untilMap = _.cloneDeep(workMap);\r\n                    } else if (CHARACTER_E_DELAY_MAP.has(character)) {\r\n                        if (action.startsWith('E')) {\r\n                            delayActions = _.cloneDeep(CHARACTER_E_DELAY_MAP.get(character));\r\n                            continue;\r\n                        }\r\n                        delayActions = undefined;\r\n                        action = 'E';\r\n                    }\r\n                    const resultVal = resultMap.get(action) ?? _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n                    timeArr[myIndex] = setSkillParticleNumToArr(resultVal, character, action, constellation, team, rotationLength, rotationList, i, onFields, timeArr[myIndex], isBursting);\r\n                    resultMap.set(action, resultVal);\r\n                }\r\n            }\r\n            curCharacter = rotation.member;\r\n        }\r\n    }\r\n    const result: TERParticle[] = [];\r\n    const characterMaster = getCharacterMaster(character);\r\n    const element = characterMaster?.元素 ?? '無色';\r\n    resultMap.forEach((value, key) => {\r\n        result.push([kind, key, element, value, []]);\r\n    })\r\n    return result;\r\n}\r\n\r\nexport function getParticleByCharacterExtra(\r\n    character: string,\r\n    constellation: number,\r\n    team: TTeam,\r\n    rotationLength: number,\r\n    rotationList: TActionItem[] | undefined,\r\n    onFields: number[],\r\n): TERParticle[] | undefined {\r\n    const func = CHARACTER_PARTICLE_EXTRA_FUNC[character];\r\n    if (func === undefined) return undefined;\r\n    const ret = func(character, constellation, team.members, rotationLength, rotationList, onFields);\r\n    if (ret === undefined) return undefined;\r\n    const memberNameArr = team.members.map(member => member.name);\r\n    const myIndex = memberNameArr.indexOf(character);\r\n    if (myIndex === -1) return undefined;\r\n    const particles = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n    const result: TERParticle = [ret[0], ret[1], ret[2], particles, ret[6]];\r\n    if (ret[3]) {   // 本人\r\n        particles[myIndex] += ret[3];\r\n    }\r\n    if (ret[4]) {   // 全員\r\n        splitNumToArrByOnFieldRate(particles, ret[4], team, onFields);\r\n    }\r\n    if (ret[5].length) {   // 誰か\r\n        for (let i = 0; i < ret[5].length && i < particles.length; i++) {\r\n            particles[i] += ret[5][i];\r\n        }\r\n    }\r\n    return [result];\r\n}\r\n\r\nexport function getParticleByWeapon(\r\n    character: string,\r\n    weapon: string,\r\n    weaponRefine: number,\r\n    team: TTeam,\r\n    rotationLength: number,\r\n    rotationList: TActionItem[] | undefined,\r\n    onFields: number[],\r\n): TERParticle | undefined {\r\n    let result: TERParticle | undefined;\r\n    const memberNameArr = team.members.map(member => member.name);\r\n    if (['西風剣', '西風大剣', '西風長槍', '西風猟弓', '西風秘典'].includes(weapon)) {\r\n        const particles = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        const ct = [12, 10.5, 9, 7.5, 6][weaponRefine - 1];\r\n        let triggerCnt = 1;\r\n        if (rotationList?.length) {\r\n            const rindexArr: number[] = [];\r\n            for (let i = 0; i < rotationList.length; i++) {\r\n                const rotation = rotationList[i];\r\n                if (rotation.member == character && (i === 0 || rotationList[i - 1].member != character)) {\r\n                    rindexArr.push(i);\r\n                }\r\n            }\r\n            const onField = onFields[memberNameArr.indexOf(character)];\r\n            triggerCnt = Math.min(Math.trunc(rotationLength / ct), rindexArr.length + Math.max(0, Math.trunc(rotationLength * onField / 100 / ct) - 1));\r\n            for (let i = 0; i < triggerCnt; i++) {\r\n                let nxtCharacter = character;\r\n                if (i < rindexArr.length && (rindexArr[i] + 1) < rotationList.length) {\r\n                    nxtCharacter = rotationList[rindexArr[i] + 1].member;\r\n                }\r\n                const toIndex = memberNameArr.indexOf(nxtCharacter);\r\n                particles[toIndex] += 3;\r\n            }\r\n        } else {\r\n            const toIndex = memberNameArr.indexOf(character);\r\n            particles[toIndex] = 3 * triggerCnt;\r\n        }\r\n        result = [RECHARGE_PARTICLE_FAVONIUS, weapon, '無色', particles, []];\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getParticleByResonance(\r\n    team: TTeam,\r\n    rotationLength: number,\r\n    rotationList: TActionItem[] | undefined,\r\n    onFields: number[],\r\n): TERParticle | undefined {\r\n    let result: TERParticle | undefined = undefined;\r\n    if (team.members.filter(member => member.name).length < 4) return result;\r\n    const electroCount = team.members.filter(member => getCharacterMaster(member.name)?.元素 === '雷').length;\r\n    if (electroCount >= 2) { // 雷元素共鳴\r\n        const messages = [\r\n            '超電導、過負荷、感電、原激化、超激化または超開花反応を起こした時、100%の確率で雷元素粒子を生成する。クールタイム5秒。',\r\n        ];\r\n        let allParticle = 0; // 分配\r\n        if (team.members.filter(member => ['氷', '炎', '水', '草'].includes(getCharacterMaster(member.name)?.元素 ?? '--')).length) {\r\n            const ct = 5;\r\n            allParticle = 1 * Math.trunc(rotationLength / ct);\r\n        }\r\n        const particles = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        splitNumToArrByOnFieldRate(particles, allParticle, team, onFields);\r\n        result = [RECHARGE_PARTICLE_RESONANCE, '雷元素共鳴', '雷', particles, messages];\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getEnergyByCharacter(\r\n    character: string,\r\n    constellation: number,\r\n    team: TTeam,\r\n    rotationLength: number,\r\n    rotationList: TActionItem[],\r\n    teamMemberResult?: TTeamMemberResult,\r\n): TEREnergy[] {\r\n    const result: TEREnergy[] = [];\r\n    const func = CHARACTER_ENERGY_FUNC[character];\r\n    if (func === undefined) return result;\r\n    const ret = func(character, constellation, team.members, rotationLength, rotationList, teamMemberResult);\r\n    if (!ret?.length) return result;\r\n    const myIndex = team.members.map(member => member.name).indexOf(character);\r\n    if (myIndex === -1) return result;\r\n    ret.forEach(entry => {\r\n        const energies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n        const workResult: TEREnergy = [entry[0], entry[1], energies, entry[6]];\r\n        if (entry[2]) {   // 本人\r\n            energies[myIndex] += entry[2];\r\n        }\r\n        if (entry[3]) {   // 全員\r\n            for (let i = 0; i < energies.length; i++) {\r\n                energies[i] += entry[3];\r\n            }\r\n        }\r\n        if (entry[4]) {   // 本人以外\r\n            for (let i = 0; i < energies.length; i++) {\r\n                if (i != myIndex) {\r\n                    energies[i] += entry[4];\r\n                }\r\n            }\r\n        }\r\n        if (entry[5]?.length) {   // 誰か\r\n            for (let i = 0; i < energies.length; i++) {\r\n                energies[i] += entry[5][i];\r\n            }\r\n        }\r\n        result.push(workResult);\r\n    })\r\n    return result;\r\n}\r\n\r\nexport function getEnergyByWeapon(\r\n    character: string,\r\n    weapon: string,\r\n    weaponRefine: number,\r\n    team: TTeam,\r\n    rotationLength: number,\r\n    rotationList: TActionItem[] | undefined,\r\n): TEREnergy | undefined {\r\n    let result: TEREnergy | undefined = undefined;\r\n    const func = WEAPON_ENERGY_FUNC[weapon];\r\n    if (func === undefined) return result;\r\n    const members = team.members.map(member => member.name);\r\n    const ret = func(character, weapon, weaponRefine, members, rotationLength, rotationList);\r\n    if (!ret?.length) return result;\r\n    const myIndex = members.indexOf(character);\r\n    if (myIndex === -1) return result;\r\n    const entry = ret;\r\n    const energies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n    result = [entry[0], entry[1], energies, entry[6]];\r\n    if (entry[2]) {   // 本人\r\n        energies[myIndex] += entry[2];\r\n    }\r\n    if (entry[3]) {   // 全員\r\n        for (let i = 0; i < energies.length; i++) {\r\n            energies[i] += entry[3];\r\n        }\r\n    }\r\n    if (entry[4]) {   // 本人以外\r\n        for (let i = 0; i < energies.length; i++) {\r\n            if (i != myIndex) {\r\n                energies[i] += entry[4];\r\n            }\r\n        }\r\n    }\r\n    if (entry[5]?.length) {   // 誰か\r\n        for (let i = 0; i < energies.length; i++) {\r\n            energies[i] += entry[5][i];\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getEnergyByArtifact(\r\n    character: string,\r\n    artifactSet4: string,\r\n    team: TTeam,\r\n    rotationLength: number,\r\n    rotationList: TActionItem[] | undefined,\r\n): TEREnergy | undefined {\r\n    const rechargeKind = RECHARGE_ENERGY_ARTIFACT;\r\n    const energies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n    const messages: string[] = [];\r\n    const memberNameArr = team.members.map(member => member.name);\r\n    const qCount = countQ(character, rotationList);\r\n    const myIndex = memberNameArr.indexOf(character);\r\n    let otherEnergy = 0;\r\n    if (artifactSet4 === '亡命者') {\r\n        otherEnergy = 6 * qCount;\r\n    }\r\n    if (otherEnergy) {\r\n        messages.push('元素爆発を発動すると、2秒毎にチーム全員（自分を除く）の元素エネルギーを2回復する、継続時間6秒。重ね掛け不可。');\r\n        for (let i = 0; i < energies.length; i++) {\r\n            if (i != myIndex) {\r\n                energies[i] += otherEnergy;\r\n            }\r\n        }\r\n    }\r\n    if (energies.filter(e => e > 0).length || messages.length) {\r\n        return [rechargeKind, artifactSet4, energies, messages];\r\n    }\r\n    return undefined;\r\n}\r\n\r\nexport function getEnergyByAttack(\r\n    character: string,\r\n    team: TTeam,\r\n    rotationLength: number,\r\n    rotationList: TActionItem[],\r\n): TEREnergy | undefined {\r\n    let result: TEREnergy | undefined = undefined;\r\n    const memberNameArr = team.members.map(member => member.name);\r\n    const myIndex = memberNameArr.indexOf(character);\r\n    const characterDetail = getCharacterDetail(character);\r\n    if (characterDetail) {\r\n        const denominator = ATTACK_ENERGY_COUNT_OBJ[characterDetail.武器];\r\n        if (denominator) {\r\n            let hitCount = 0;\r\n            if (rotationList?.length) {\r\n                rotationList.filter(rotation => rotation.member == character).forEach(rotation => {\r\n                    let withC = false;\r\n                    if (rotation.action.startsWith('N')) {\r\n                        let workHitCount = 0;\r\n                        let dans = 1;\r\n                        if (rotation.action.length > 1) {\r\n                            dans = Number(rotation.action.substring(1, 2));\r\n                        }\r\n                        characterDetail.通常攻撃.詳細.forEach((obj: any) => {\r\n                            if (obj.名前 && obj.名前.endsWith('段ダメージ')) {\r\n                                const workDan = obj.名前.substring(0, 1);\r\n                                if (!isNaN(workDan) && dans <= Number(workDan)) {\r\n                                    if (obj.HIT数) {\r\n                                        workHitCount += obj.HIT数;\r\n                                    }\r\n                                }\r\n                            }\r\n                        })\r\n                        if (workHitCount < dans) {\r\n                            workHitCount = dans;\r\n                        }\r\n                        hitCount += workHitCount;\r\n                        if (rotation.action.endsWith('C')) {\r\n                            withC = true;\r\n                        }\r\n                    }\r\n                    if (rotation.action === 'C' || withC) {\r\n                        let workHitCount = 1;\r\n                        characterDetail.重撃.詳細.forEach((obj: any) => {\r\n                            if (obj.名前 && obj.名前 === '重撃ダメージ') {\r\n                                if (obj.HIT数) {\r\n                                    workHitCount = obj.HIT数;\r\n                                }\r\n                            }\r\n                        })\r\n                        hitCount += workHitCount;\r\n                    }\r\n                })\r\n            }\r\n            const energy = Math.trunc(hitCount / denominator);\r\n            if (energy) {\r\n                const rechargeKind = RECHARGE_ENERGY_ATTACK;\r\n                const energies = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n                const messages: string[] = [];\r\n                result = [rechargeKind, '', energies, messages];\r\n                energies[myIndex] += energy;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction setSkillParticleNumToArr(\r\n    arr: number[],\r\n    character: string,\r\n    action: string,\r\n    constellation: number,\r\n    team: TTeam,\r\n    rotationLength: number,\r\n    rotationList: TActionItem[],\r\n    index: number,\r\n    onFields: number[],\r\n    time: number,\r\n    isBursting = false,\r\n) {\r\n    const particleInfo = getParticleInfo(character, action, constellation, isBursting);\r\n    if (particleInfo) {\r\n        const rotation = rotationList[index];\r\n        if (rotation) {\r\n            const num = getParticleNumFromInfo(particleInfo, rotationLength - time);\r\n            const receiveType = getReceiveTypeFromInfo(particleInfo);\r\n            const duration = getDurationFromInfo(particleInfo);\r\n            if ([SP_SELF, SP_NEXT].includes(receiveType)) {\r\n                addNumToArr(arr, num, team, rotationList, index, receiveType);\r\n            } else if ([SP_LONG, SP_SHRT].includes(receiveType)) {\r\n                splitNumToArrByOnFieldRate(arr, num, team, onFields);\r\n            }\r\n            time += duration;\r\n        }\r\n    }\r\n    return time;\r\n}\r\n\r\nfunction addNumToArr(\r\n    arr: number[],\r\n    num: number,\r\n    team: TTeam,\r\n    rotationList: TActionItem[],\r\n    index: number,\r\n    receiveType = SP_NEXT,\r\n) {\r\n    const memberNameArr = team.members.map(member => member.name);\r\n    const nxtRotation = (index + receiveType) < rotationList.length ? rotationList[index + receiveType] : rotationList[0];\r\n    if (nxtRotation.action === 'Q' && CHARACTER_Q_NOT_RECHARGEABLE.includes(nxtRotation.member)) {\r\n        num = 0;\r\n    }\r\n    arr[memberNameArr.indexOf(nxtRotation.member)] += num;\r\n}\r\n\r\nexport function splitNumToArrByOnFieldRate(\r\n    arr: number[],\r\n    num: number,\r\n    team: TTeam,\r\n    onFields: number[],\r\n) {\r\n    const denominator = onFields.map(v => Math.pow(v / 100, 2)).reduce((p, c) => p + c, 0);\r\n    for (let i = 0; i < arr.length; i++) {\r\n        if (team.members[i].name) {\r\n            const onField = onFields[i];\r\n            arr[i] += num * Math.pow(onField / 100, 2) / denominator;\r\n        }\r\n    }\r\n}\r\n","\r\nimport _ from \"lodash\";\r\nimport { computed, defineComponent, onMounted, PropType, reactive, ref, watch } from \"vue\";\r\nimport CompositionFunction from \"@/components/CompositionFunction.vue\";\r\nimport { ARTIFACT_SET_MASTER, ELEMENT_BG_COLOR_CLASS, ELEMENT_IMG_SRC, IMG_SRC_DUMMY, TArtifactSetKey, WEAPON_IMG_SRC } from \"@/master\";\r\nimport { CHARACTER_E_DELAY_MAP, CHARACTER_E_UNTIL_MAP, CHARACTER_Q_NOT_RECHARGEABLE, getCooltimeFromInfo, getDurationFromInfo, getParticleInfo, PARTICLE_MASTER } from \"@/particlemaster\";\r\nimport { getCharacterDetail, getCharacterMaster, getWeaponMaster, NUMBER_OF_MEMBERS, setupCharacterDetailMap, TConstellation, TTeam, TTeamMemberResult } from \"./team\";\r\nimport { getOnFieldRate, TERParticle, RECHARGE_PARTICLE_SKILL, RECHARGE_PARTICLE_PASSIVE, RECHARGE_PARTICLE_CONSTELLATION, TEREnergy, RECHARGE_ENERGY_SKILL, RECHARGE_ENERGY_BURST, RECHARGE_ENERGY_PASSIVE, RECHARGE_ENERGY_CONSTELLATION, RECHARGE_PARTICLE_ENEMY, countQ, isRechargeKindParticle, isRechargeKindEnergy, RECHARGE_PARTICLE_RESONANCE, RECHARGE_PARTICLE_FAVONIUS, RECHARGE_ENERGY_WEAPON, RECHARGE_ENERGY_ARTIFACT, RECHARGE_ENERGY_ATTACK } from \"./ERCalculatorCommon\";\r\nimport { getEnergyByArtifact, getEnergyByAttack, getEnergyByCharacter, getEnergyByWeapon, getParticleByCharacter, getParticleByCharacterExtra, getParticleByResonance, getParticleByWeapon, splitNumToArrByOnFieldRate } from \"./ERCalculatorFunc\";\r\n\r\ntype TCalculatorInput = {\r\n    character: string,                  // キャラクター名\r\n    energyCost: number,                 // 元素爆発 元素エネルギー 40-90\r\n    constellation: number,              // 命ノ星座 0-6\r\n    initialWeapon: string | undefined,  // 初期武器名\r\n    currentWeapon: string | undefined,  // 現在武器名\r\n    weaponRefine: number,               // 武器精錬ランク 1-5\r\n    artifactSet4: string | undefined,   // 聖遺物4セット効果\r\n    onField: number,                    // 出場率\r\n    replaceWeapons: string[],           // 置き換え武器名    \r\n}\r\n\r\ntype TCalculatorInputRow = {\r\n    character: string,          // キャラクター名\r\n    rechargeKind: string,       // リチャージ種別\r\n    triggerName: string,        // アクション識別子,武器名,固有天賦名,命ノ星座\r\n    element: string,            // 元素粒子の元素\r\n    initialValues: number[],    // 初期値\r\n    currentValues: number[],    // 現在値\r\n    unit: number,               // 単位\r\n}\r\n\r\nexport default defineComponent({\r\n    name: \"ERCalculator\",\r\n    props: {\r\n        team: { type: Object as PropType<TTeam>, required: true },\r\n        teamMemberResult: { type: Object as PropType<TTeamMemberResult> },\r\n        constellations: { type: Object as PropType<TConstellation> },\r\n    },\r\n    setup(props) {\r\n        const { displayName } = CompositionFunction();\r\n        const calculatorInput = reactive([] as TCalculatorInput[]);\r\n        const inputRowParticle = reactive([] as TCalculatorInputRow[]);\r\n        const inputRowEnergy = reactive([] as TCalculatorInputRow[]);\r\n        const inputRowParticleEnemy = reactive([] as TCalculatorInputRow[]);\r\n        const messages = reactive([] as string[][]);\r\n        const DEFAULT_ROTATION_LENGTH = 20;\r\n        const DEFAULT_COMBAT_LENGTH = 90;\r\n        const rotationLength = ref(DEFAULT_ROTATION_LENGTH); // ローテーション長\r\n        const combatLength = ref(DEFAULT_COMBAT_LENGTH);   // 戦闘時間\r\n        const supplyFromEnemy = reactive([\r\n            ['無色', 3, 0],\r\n            ['炎', 0, 0],\r\n            ['水', 0, 0],\r\n            ['雷', 0, 0],\r\n            ['草', 0, 0],\r\n            ['氷', 0, 0],\r\n            ['岩', 0, 0],\r\n        ] as [string, number, number][]);\r\n        const isOpenSupplyFromEnemy = ref(false);\r\n        const REPLACE_WEAPON_MAP = {\r\n            '片手剣': ['西風剣', '天目影打'],\r\n            '両手剣': ['西風大剣', '桂木斬長正'],\r\n            '長柄武器': ['西風長槍', '喜多院十文字槍', '正義の報酬'],\r\n            '弓': ['西風猟弓'],\r\n            '法器': ['西風秘典', '金珀·試作'],\r\n        };\r\n        const isShowUsage = ref(false);\r\n\r\n        onMounted(() => {\r\n            setupCharacterDetailMap().then(() => {\r\n                updateRotationLength(props.team);\r\n                setupInput(props.team, props.teamMemberResult);\r\n            });\r\n        })\r\n\r\n        const watchCount = ref(0);\r\n        watch(() => _.cloneDeep(props), (newVal, oldVal) => {\r\n            updateRotationLength(newVal.team);\r\n            if (!_.isEqual(newVal.team.members, oldVal.team.members) || !_.isEqual(newVal.teamMemberResult, oldVal.teamMemberResult)) {\r\n                setupInput(newVal.team, newVal.teamMemberResult);\r\n                watchCount.value++;\r\n            } else {\r\n                setupInputRows(newVal.team, newVal.teamMemberResult);\r\n                watchCount.value++;\r\n            }\r\n        }, { deep: true })\r\n\r\n        function getConstellation(character: string, team: TTeam, teamMemberResult?: TTeamMemberResult) {\r\n            if (teamMemberResult) {\r\n                const workArr = team.members.filter(member => member.name == character);\r\n                if (workArr.length) {\r\n                    return teamMemberResult[workArr[0].id]?.characterInput.命ノ星座 ?? (props.constellations ? props.constellations[character] ?? 0 : 0);\r\n                }\r\n            }\r\n            return props.constellations ? props.constellations[character] ?? 0 : 0;\r\n        }\r\n\r\n        function updateRotationLength(team: TTeam) {\r\n            const memberNameArr = team.members.map(member => member.name);\r\n            const eLength = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            const qLength = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            if (team.rotation.length) {\r\n                for (let i = 0; i < team.rotation.length; i++) {\r\n                    const rotation = team.rotation[i];\r\n                    const memberIndex = memberNameArr.indexOf(rotation.member);\r\n                    if (memberIndex == -1) continue;\r\n                    if (rotation.action === 'Q' || rotation.action.startsWith('E')) {\r\n                        const characterDetail = getCharacterDetail(rotation.member);\r\n                        if (rotation.action === 'Q') {\r\n                            let ct = characterDetail?.元素爆発.クールタイム ?? 0;\r\n                            if (memberNameArr.includes('重雲') && rotation.member != '重雲') {\r\n                                const constellation = getConstellation('重雲', props.team, props.teamMemberResult);\r\n                                if (constellation >= 2) {\r\n                                    ct *= 0.85;\r\n                                }\r\n                            } else if (memberNameArr.includes('雷電将軍') && rotation.member != '雷電将軍') {\r\n                                const constellation = getConstellation('雷電将軍', props.team, props.teamMemberResult);\r\n                                if (constellation >= 6) {\r\n                                    ct -= 5;\r\n                                }\r\n                            }\r\n                            qLength[memberIndex] += ct;\r\n                        } else {\r\n                            const constellation = getConstellation(rotation.member, props.team, props.teamMemberResult);\r\n                            const particleInfo = getParticleInfo(rotation.member, rotation.action, constellation);\r\n                            let ct = 0;\r\n                            let duration = 0;\r\n                            if (particleInfo) {\r\n                                ct = getCooltimeFromInfo(particleInfo) ?? 0;\r\n                                duration = getDurationFromInfo(particleInfo);\r\n                                if (memberNameArr.includes('重雲') && rotation.member != '重雲') {\r\n                                    const constellation = getConstellation('重雲', props.team, props.teamMemberResult);\r\n                                    if (constellation >= 2) {\r\n                                        ct *= 0.85;\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (ct > eLength[memberIndex] && ct > duration) {\r\n                                eLength[memberIndex] = ct;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            let newLength = Math.max(...eLength, ...qLength);\r\n            if (newLength == 0) {\r\n                newLength = DEFAULT_ROTATION_LENGTH;\r\n            }\r\n            rotationLength.value = newLength;\r\n        }\r\n\r\n        function updateOnFields(team: TTeam, teamMemberResult?: TTeamMemberResult) {\r\n            const constellations = team.members.map(member => getConstellation(member.name, team, teamMemberResult));\r\n            const onFields = getOnFieldRate(team, rotationLength.value, team.rotation, constellations);\r\n            for (let i = 0; i < calculatorInput.length; i++) {\r\n                calculatorInput[i].onField = onFields[i];\r\n            }\r\n        }\r\n\r\n        const setupInput = (team: TTeam, teamMemberResult?: TTeamMemberResult) => {\r\n            const newInput: TCalculatorInput[] = [];\r\n            const constellations = team.members.map(member => getConstellation(member.name, team, teamMemberResult));\r\n            const onFields = getOnFieldRate(team, rotationLength.value, team.rotation, constellations);\r\n            for (let i = 0; i < team.members.length; i++) {\r\n                const member = team.members[i];\r\n                const characterDetail = getCharacterDetail(member.name);\r\n                const constellation = constellations[i];\r\n                const memberResult = teamMemberResult ? teamMemberResult[member.id] : undefined;\r\n                const weapon = memberResult?.characterInput.weapon;\r\n                const weaponRefine = memberResult?.characterInput.武器精錬ランク ?? 1;\r\n                let artifactSet4 = undefined;\r\n                if (memberResult && memberResult.characterInput.artifactSets.length == 2) {\r\n                    artifactSet4 = memberResult.characterInput.artifactSets[0] == memberResult.characterInput.artifactSets[1] ? memberResult.characterInput.artifactSets[0] : undefined;\r\n                }\r\n                let replaceWeapons: string[] = [];\r\n                if (characterDetail) {\r\n                    replaceWeapons = REPLACE_WEAPON_MAP[characterDetail.武器];\r\n                }\r\n                newInput.push({\r\n                    character: member.name,\r\n                    energyCost: characterDetail?.元素爆発.元素エネルギー ?? 0,\r\n                    constellation: constellation,\r\n                    initialWeapon: weapon,\r\n                    currentWeapon: weapon,\r\n                    weaponRefine: weaponRefine,\r\n                    artifactSet4: artifactSet4,\r\n                    onField: onFields[i],\r\n                    replaceWeapons: replaceWeapons,\r\n                });\r\n            }\r\n            calculatorInput.splice(0, calculatorInput.length, ...newInput);\r\n\r\n            setupInputRows(team, teamMemberResult);\r\n        }\r\n\r\n        function pushInputRowParticle(inputRows: TCalculatorInputRow[], newMessages: string[][], character: string, particle: TERParticle) {\r\n            const initialValues = _.cloneDeep(particle[3]);\r\n            for (let i = 0; i < initialValues.length; i++) {\r\n                initialValues[i] = Math.round(initialValues[i] * 100) / 100;\r\n            }\r\n            inputRows.push({\r\n                character: character,\r\n                rechargeKind: particle[0],\r\n                triggerName: particle[1],\r\n                element: particle[2],\r\n                initialValues: initialValues,\r\n                currentValues: _.cloneDeep(initialValues),\r\n                unit: 1,\r\n            })\r\n            if (particle[4].length) {\r\n                particle[4].forEach(message => {\r\n                    let work = '';\r\n                    if (particle[0] === RECHARGE_PARTICLE_SKILL) {\r\n                        work = '元素スキル';\r\n                    } else if (particle[0] === RECHARGE_PARTICLE_PASSIVE) {\r\n                        work = '固有天賦';\r\n                    } else if (particle[0] === RECHARGE_PARTICLE_CONSTELLATION) {\r\n                        work = '命ノ星座';\r\n                        if (particle[1]) {\r\n                            work += ' 第' + particle[1] + '重';\r\n                        }\r\n                    } else {\r\n                        work = particle[1];\r\n                    }\r\n                    newMessages.push([character, work, message]);\r\n                })\r\n            }\r\n        }\r\n        function pushInputRowEnergy(inputRows: TCalculatorInputRow[], newMessages: string[][], character: string, energy: TEREnergy) {\r\n            const initialValues = _.cloneDeep(energy[2]);\r\n            for (let i = 0; i < initialValues.length; i++) {\r\n                initialValues[i] = Math.round(initialValues[i] * 100) / 100;\r\n            }\r\n            inputRows.push({\r\n                character: character,\r\n                rechargeKind: energy[0],\r\n                triggerName: energy[1],\r\n                element: '',\r\n                initialValues: initialValues,\r\n                currentValues: _.cloneDeep(initialValues),\r\n                unit: 0.1,\r\n            })\r\n            if (energy[3].length) {\r\n                energy[3].forEach(message => {\r\n                    let work = '';\r\n                    if (energy[0] === RECHARGE_ENERGY_SKILL) {\r\n                        work = '元素スキル';\r\n                    } else if (energy[0] === RECHARGE_ENERGY_BURST) {\r\n                        work = '元素爆発';\r\n                    } else if (energy[0] === RECHARGE_ENERGY_PASSIVE) {\r\n                        work = '固有天賦';\r\n                    } else if (energy[0] === RECHARGE_ENERGY_CONSTELLATION) {\r\n                        work = '命ノ星座';\r\n                        if (energy[1]) {\r\n                            work += ' 第' + energy[1] + '重';\r\n                        }\r\n                    } else {\r\n                        work = energy[1];\r\n                    }\r\n                    newMessages.push([character, work, message]);\r\n                })\r\n            }\r\n        }\r\n\r\n        const setupInputRows = (team: TTeam, teamMemberResult?: TTeamMemberResult) => {\r\n            updateOnFields(team, teamMemberResult);\r\n            const newInputRowPacticle1: TCalculatorInputRow[] = [];\r\n            const newInputRowPacticle2: TCalculatorInputRow[] = [];\r\n            const newInputRowEnergy: TCalculatorInputRow[] = [];\r\n            const newInputRowResonance: TCalculatorInputRow[] = [];\r\n            const newinputRowParticleEnemy: TCalculatorInputRow[] = [];\r\n            const newMessages: string[][] = [];\r\n            const onFields = calculatorInput.map(s => s.onField);\r\n            for (let i = 0; i < calculatorInput.length; i++) {\r\n                const character = calculatorInput[i].character;\r\n                if (!character) continue;\r\n                const constellation = calculatorInput[i].constellation;\r\n                const weapon = calculatorInput[i].currentWeapon;\r\n                const weaponRefine = calculatorInput[i].weaponRefine;\r\n                const artifactSet4 = calculatorInput[i].artifactSet4;\r\n                // キャラクターの元素粒子\r\n                [\r\n                    getParticleByCharacter(character, constellation, team, rotationLength.value, team.rotation, onFields),\r\n                    getParticleByCharacterExtra(character, constellation, team, rotationLength.value, team.rotation, onFields),\r\n                ].forEach(result => {\r\n                    if (result) {\r\n                        result.forEach(entry => {\r\n                            pushInputRowParticle(newInputRowPacticle1, newMessages, character, entry);\r\n                        })\r\n                    }\r\n                })\r\n                // キャラクターの元素エネルギー\r\n                const energyByCharacter = getEnergyByCharacter(character, constellation, team, rotationLength.value, team.rotation, teamMemberResult);\r\n                energyByCharacter.forEach(entry => {\r\n                    pushInputRowEnergy(newInputRowEnergy, newMessages, character, entry);\r\n                })\r\n                // 武器\r\n                if (weapon) {\r\n                    // 西風武器の元素粒子\r\n                    const particleByWeapon = getParticleByWeapon(character, weapon, weaponRefine, team, rotationLength.value, team.rotation, onFields);\r\n                    if (particleByWeapon) {\r\n                        pushInputRowParticle(newInputRowPacticle2, newMessages, character, particleByWeapon);\r\n                    }\r\n                    // 武器の元素エネルギー\r\n                    const energyByWeapon = getEnergyByWeapon(character, weapon, weaponRefine, team, rotationLength.value, team.rotation);\r\n                    if (energyByWeapon) {\r\n                        pushInputRowEnergy(newInputRowEnergy, newMessages, character, energyByWeapon);\r\n                    }\r\n                }\r\n                if (artifactSet4) {\r\n                    const energyByArtifact = getEnergyByArtifact(character, artifactSet4, team, rotationLength.value, team.rotation);\r\n                    if (energyByArtifact) {\r\n                        pushInputRowEnergy(newInputRowEnergy, newMessages, character, energyByArtifact);\r\n                    }\r\n                }\r\n                // 通常攻撃の元素エネルギー\r\n                const energyByAttack = getEnergyByAttack(character, team, rotationLength.value, team.rotation);\r\n                if (energyByAttack) {\r\n                    pushInputRowEnergy(newInputRowEnergy, newMessages, character, energyByAttack);\r\n                }\r\n            }\r\n            // 元素共鳴の元素粒子\r\n            const particleByResonance = getParticleByResonance(team, rotationLength.value, team.rotation, onFields);\r\n            if (particleByResonance) {\r\n                pushInputRowParticle(newInputRowResonance, newMessages, '', particleByResonance);\r\n            }\r\n            // 敵の元素粒子\r\n            supplyFromEnemy.filter(s => s[1] || s[2]).forEach(entry => {\r\n                const num = (entry[1] * 3 + entry[2]) * rotationLength.value / combatLength.value; // 元素オーブは元素粒子3個に相当\r\n                const initialValues = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n                splitNumToArrByOnFieldRate(initialValues, num, team, onFields);\r\n                pushInputRowParticle(newinputRowParticleEnemy, newMessages, '', [RECHARGE_PARTICLE_ENEMY, '', entry[0], initialValues, []]);\r\n            })\r\n            inputRowParticle.splice(0, inputRowParticle.length, ...newInputRowPacticle1, ...newInputRowPacticle2, ...newInputRowResonance);\r\n            inputRowEnergy.splice(0, inputRowEnergy.length, ...newInputRowEnergy);\r\n            inputRowParticleEnemy.splice(0, inputRowParticleEnemy.length, ...newinputRowParticleEnemy);\r\n            messages.splice(0, messages.length, ...newMessages);\r\n        }\r\n\r\n        /** 元素爆発(回数) */\r\n        const burstCounts = computed(() => {\r\n            const result: { [key: number]: number } = { 0: 1, 1: 1, 2: 1, 3: 1 };\r\n            if (props.team.rotation?.length) {\r\n                for (let i = 0; i < props.team.members.length; i++) {\r\n                    const member = props.team.members[i];\r\n                    if (member.name) {\r\n                        result[i] = countQ(member.name, props.team.rotation);\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        })\r\n\r\n        /** 元素粒子による獲得元素エネルギー量(元素チャージ効率未反映) */\r\n        const particleRecharges = computed(() => {\r\n            const result: number[] = _.fill(Array(NUMBER_OF_MEMBERS), 0);\r\n            for (let i = 0; i < props.team.members.length; i++) {\r\n                const member = props.team.members[i];\r\n                if (!member.name) continue;\r\n                const characterMaster = getCharacterMaster(member.name);\r\n                const myElement = characterMaster?.元素;\r\n                if (!myElement) continue;\r\n                [inputRowParticle, inputRowParticleEnemy].forEach(input => {\r\n                    input.filter(s => isRechargeKindParticle(s.rechargeKind)).forEach(entry => {\r\n                        let energy = 0;\r\n                        for (let j = 0; j < entry.currentValues.length; j++) {\r\n                            if (j == i) {\r\n                                energy += entry.currentValues[j];\r\n                            } else {\r\n                                energy += entry.currentValues[j] * 0.6;\r\n                            }\r\n                        }\r\n                        if (entry.element == myElement) {\r\n                            energy *= 3;\r\n                        } else if (entry.element == '無色') {\r\n                            energy *= 2;\r\n                        }\r\n                        result[i] = Math.round((result[i] + energy) * 10) / 10;\r\n                    })\r\n                })\r\n            }\r\n            return result;\r\n        })\r\n\r\n        /** 元素チャージ効率の目安 */\r\n        const energyRechargeGls = computed(() => {\r\n            const result = _.fill(Array(NUMBER_OF_MEMBERS), 100);\r\n            for (let i = 0; i < props.team.members.length; i++) {\r\n                if (!props.team.members[i].name) continue;\r\n                let energyCost = calculatorInput[i]?.energyCost;\r\n                if (!energyCost) continue;\r\n                inputRowEnergy.filter(s => isRechargeKindEnergy(s.rechargeKind)).forEach(entry => {\r\n                    energyCost -= entry.currentValues[i];\r\n                })\r\n                const burstCount = burstCounts.value[i] > 0 ? burstCounts.value[i] : 1;\r\n                const particleEnergy = particleRecharges.value[i] / burstCount;\r\n                if (energyCost > 0 && particleEnergy > 0) {\r\n                    const er = Math.ceil(energyCost * 100 / particleEnergy);\r\n                    result[i] = Math.max(100, er);\r\n                }\r\n            }\r\n            return result;\r\n        })\r\n        const CHARACTER_E_DECREMENT_IN_BURST = computed(() =>\r\n            Object.keys(PARTICLE_MASTER).filter(key => Object.keys(PARTICLE_MASTER[key]).filter(action => action.indexOf('burst') != -1).length > 0).sort());\r\n\r\n        const characterImgSrc = (character: string) => getCharacterMaster(character)?.icon_url ?? IMG_SRC_DUMMY;\r\n        const weaponImgSrc = (character: string, weapon?: string) => {\r\n            const characterMater = getCharacterMaster(character);\r\n            return weapon ? characterMater ? getWeaponMaster(characterMater.武器, weapon)?.icon_url ?? IMG_SRC_DUMMY : IMG_SRC_DUMMY : IMG_SRC_DUMMY;\r\n        }\r\n        const replaceWeaponImgSrc = (input: TCalculatorInput, weapon: string) => {\r\n            let result = IMG_SRC_DUMMY;\r\n            if (input.character && input.replaceWeapons.length && input.replaceWeapons.includes(weapon)) {\r\n                const characterMaster = getCharacterMaster(input.character);\r\n                if (characterMaster) {\r\n                    result = getWeaponMaster(characterMaster.武器, weapon)?.icon_url ?? IMG_SRC_DUMMY;\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        const rowImgSrc1 = (row: TCalculatorInputRow) => {\r\n            let result = IMG_SRC_DUMMY;\r\n            if (row.rechargeKind) {\r\n                if ([RECHARGE_PARTICLE_RESONANCE].includes(row.rechargeKind)) { // 元素共鳴\r\n                    result = (ELEMENT_IMG_SRC as any)[row.element] ?? IMG_SRC_DUMMY\r\n                } else {\r\n                    result = getCharacterMaster(row.character)?.icon_url ?? IMG_SRC_DUMMY;\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        const rowImgSrc1Class = (row: TCalculatorInputRow) =>\r\n            (row.rechargeKind && row.rechargeKind == RECHARGE_PARTICLE_RESONANCE) ? 'input-item' : 'input-item-character';\r\n        const rowImgSrc2 = (row: TCalculatorInputRow) => {\r\n            let result = IMG_SRC_DUMMY;\r\n            if (row.rechargeKind) {\r\n                if ([RECHARGE_PARTICLE_RESONANCE].includes(row.rechargeKind)) { // 元素共鳴\r\n                    result = (ELEMENT_IMG_SRC as any)[row.element] ?? IMG_SRC_DUMMY\r\n                } else if ([RECHARGE_ENERGY_SKILL, RECHARGE_PARTICLE_SKILL].includes(row.rechargeKind)) { // 元素スキル\r\n                    const characterDetail = getCharacterDetail(row.character);\r\n                    result = characterDetail?.元素スキル.icon_url ?? IMG_SRC_DUMMY;\r\n                } else if ([RECHARGE_ENERGY_BURST].includes(row.rechargeKind)) { // 元素爆発\r\n                    const characterDetail = getCharacterDetail(row.character);\r\n                    result = characterDetail?.元素爆発.icon_url ?? IMG_SRC_DUMMY;\r\n                } else if ([RECHARGE_ENERGY_PASSIVE, RECHARGE_PARTICLE_PASSIVE].includes(row.rechargeKind)) { // 固有天賦\r\n                    if (row.triggerName) {\r\n                        const characterDetail = getCharacterDetail(row.character);\r\n                        const workArr = characterDetail?.固有天賦.filter(obj => obj.名前 == row.triggerName);\r\n                        result = workArr?.length ? workArr[0].icon_url ?? IMG_SRC_DUMMY : IMG_SRC_DUMMY;\r\n                    }\r\n                } else if ([RECHARGE_ENERGY_CONSTELLATION, RECHARGE_PARTICLE_CONSTELLATION].includes(row.rechargeKind)) { // 命ノ星座\r\n                    if (row.triggerName) {\r\n                        const characterDetail = getCharacterDetail(row.character);\r\n                        const constellationObj = characterDetail?.命ノ星座[row.triggerName];\r\n                        result = constellationObj?.icon_url ?? IMG_SRC_DUMMY;\r\n                    }\r\n                } else if ([RECHARGE_PARTICLE_FAVONIUS, RECHARGE_ENERGY_WEAPON].includes(row.rechargeKind) && row.triggerName) { // 武器\r\n                    const characterMater = getCharacterMaster(row.character);\r\n                    if (characterMater) {\r\n                        const weaponType = characterMater.武器;\r\n                        const weaponMaster = getWeaponMaster(weaponType, row.triggerName);\r\n                        if (weaponMaster) {\r\n                            result = weaponMaster.icon_url;\r\n                        }\r\n                    }\r\n                } else if ([RECHARGE_ENERGY_ARTIFACT].includes(row.rechargeKind) && row.triggerName) { // 聖遺物\r\n                    const artifactSetMater = ARTIFACT_SET_MASTER[(row.triggerName as TArtifactSetKey)];\r\n                    if (artifactSetMater) {\r\n                        result = artifactSetMater.image;\r\n                    }\r\n                } else if ([RECHARGE_ENERGY_ATTACK].includes(row.rechargeKind)) { // 通常攻撃、重撃\r\n                    const characterMaster = getCharacterMaster(row.character);\r\n                    if (characterMaster) {\r\n                        result = WEAPON_IMG_SRC[characterMaster.武器];\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        const bgColorClass = (index: number) => {\r\n            const master = index < props.team.members.length ? getCharacterMaster(props.team.members[index].name) : undefined;\r\n            return ' ' + (master ? (ELEMENT_BG_COLOR_CLASS as any)[master.元素] : 'white');\r\n        }\r\n        const bgColorClass2 = (row: TCalculatorInputRow) =>\r\n            ' ' + (row.element ? (ELEMENT_BG_COLOR_CLASS as any)[row.element] : 'white');\r\n        const replaceWeaponClass = (input: TCalculatorInput, weapon: string) =>\r\n            input.currentWeapon == weapon ? ' disabled' : '';\r\n        const triggerName = (row: TCalculatorInputRow) => {\r\n            let result = '';\r\n            if (row.rechargeKind) {\r\n                if ([RECHARGE_ENERGY_SKILL, RECHARGE_PARTICLE_SKILL].includes(row.rechargeKind)) {\r\n                    result = '元素スキル';\r\n                } else if ([RECHARGE_ENERGY_BURST].includes(row.rechargeKind)) {\r\n                    result = '元素爆発';\r\n                } else if ([RECHARGE_ENERGY_PASSIVE, RECHARGE_PARTICLE_PASSIVE].includes(row.rechargeKind)) {\r\n                    result = '固有天賦';\r\n                } else if ([RECHARGE_ENERGY_CONSTELLATION, RECHARGE_PARTICLE_CONSTELLATION].includes(row.rechargeKind)) {\r\n                    result = '命ノ星座 第' + row.triggerName + '重';\r\n                } else if ([RECHARGE_ENERGY_WEAPON, RECHARGE_PARTICLE_FAVONIUS].includes(row.rechargeKind)) {\r\n                    result = row.triggerName;\r\n                } else if ([RECHARGE_PARTICLE_RESONANCE].includes(row.rechargeKind)) {\r\n                    result = row.triggerName;\r\n                } else if ([RECHARGE_ENERGY_ATTACK].includes(row.rechargeKind)) {\r\n                    result = '通常攻撃';\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        const actionName = (action: string) => {\r\n            let result = '';\r\n            if (action.startsWith('N')) {\r\n                result = '通常攻撃';\r\n            } else if (action === 'C') {\r\n                result = '重撃';\r\n            } else if (action === 'P') {\r\n                result = '落下攻撃';\r\n            } else if (action.startsWith('E')) {\r\n                result = '元素スキル';\r\n            } else if (action === 'Q') {\r\n                result = '元素爆発';\r\n            }\r\n            return result;\r\n        }\r\n\r\n        const inputOnChange = () => {\r\n            setupInputRows(props.team, props.teamMemberResult);\r\n        }\r\n\r\n        const replaceWeaponOnClick = (input: TCalculatorInput, weapon: string) => {\r\n            if (input.replaceWeapons.length && input.replaceWeapons.includes(weapon)) {\r\n                if (input.currentWeapon == weapon) {\r\n                    input.currentWeapon = input.initialWeapon;\r\n                } else {\r\n                    input.currentWeapon = weapon;\r\n                }\r\n                inputOnChange();\r\n            }\r\n        }\r\n\r\n        const resetInput = () => {\r\n            inputRowParticleEnemy.forEach(inputRow => {\r\n                inputRow.currentValues.splice(0, inputRow.currentValues.length, ...inputRow.initialValues);\r\n            })\r\n            inputRowParticle.forEach(inputRow => {\r\n                inputRow.currentValues.splice(0, inputRow.currentValues.length, ...inputRow.initialValues);\r\n            })\r\n            inputRowEnergy.forEach(inputRow => {\r\n                inputRow.currentValues.splice(0, inputRow.currentValues.length, ...inputRow.initialValues);\r\n            })\r\n        }\r\n\r\n        return {\r\n            displayName,\r\n\r\n            rotationLength,\r\n            combatLength,\r\n            supplyFromEnemy,\r\n            isOpenSupplyFromEnemy,\r\n            calculatorInput,\r\n            inputRowParticle,\r\n            inputRowEnergy,\r\n            inputRowParticleEnemy,\r\n            burstCounts,\r\n            messages,\r\n            CHARACTER_E_DECREMENT_IN_BURST,\r\n            CHARACTER_E_UNTIL_MAP,\r\n            CHARACTER_E_DELAY_MAP,\r\n            CHARACTER_Q_NOT_RECHARGEABLE,\r\n            actionName,\r\n            characterImgSrc,\r\n            weaponImgSrc,\r\n            replaceWeaponImgSrc,\r\n            rowImgSrc1,\r\n            rowImgSrc1Class,\r\n            rowImgSrc2,\r\n            bgColorClass,\r\n            bgColorClass2,\r\n            replaceWeaponClass,\r\n            particleRecharges,\r\n            energyRechargeGls,\r\n            triggerName,\r\n            isShowUsage,\r\n\r\n            inputOnChange,\r\n            replaceWeaponOnClick,\r\n            resetInput,\r\n        }\r\n    }\r\n});\r\n","import { render } from \"./ERCalculator.vue?vue&type=template&id=5fb1177e&scoped=true&ts=true\"\nimport script from \"./ERCalculator.vue?vue&type=script&lang=ts\"\nexport * from \"./ERCalculator.vue?vue&type=script&lang=ts\"\n\nimport \"./ERCalculator.vue?vue&type=style&index=0&id=5fb1177e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5fb1177e\"]])\n\nexport default __exports__","\r\nimport _ from \"lodash\";\r\nimport draggable from \"vuedraggable\";\r\nimport { computed, defineComponent, onMounted, PropType, reactive, ref, watch } from \"vue\";\r\nimport { ELEMENT_BG_COLOR_CLASS, ELEMENT_COLOR_CLASS, IMG_SRC_DUMMY } from \"@/master\";\r\nimport { getElementalSkillActions } from \"@/particlemaster\";\r\nimport CompositionFunction from \"@/components/CompositionFunction.vue\";\r\nimport { CHARGED_ONLY_CHARACTER, CHARGED_WITH_NORMAL_CHARACTER, CHARGED_WITH_NORMAL_WEAPON, getCharacterDetail, getCharacterMaster, getNormalAttackDan, setupCharacterDetailMap, TActionItem, TConstellation, TMember, TTeam, TTeamMemberResult } from \"./team\";\r\nimport ERCalculator from './ERCalculator.vue';\r\n\r\nexport default defineComponent({\r\n  name: \"TeamRotation\",\r\n  components: {\r\n    draggable,\r\n    ERCalculator,\r\n  },\r\n  props: {\r\n    team: { type: Object as PropType<TTeam>, required: true },\r\n    teamMemberResult: { type: Object as PropType<TTeamMemberResult> },\r\n    constellations: { type: Object as PropType<TConstellation> },\r\n  },\r\n  emit: ['update:rotation', 'click:jump-to-team'],\r\n  setup(props, context) {\r\n    const { displayName } = CompositionFunction();\r\n    const removeMode = ref(false);\r\n    const normalAttackActions = reactive({} as { [key: string]: string[] }); // 通常攻撃/重撃/落下攻撃\r\n    const elementalSkillActions = reactive({} as { [key: string]: string[] }); // 元素スキル\r\n    const rotationList = reactive([] as TActionItem[]);\r\n    const actionId = ref(0);\r\n    const rotationDescription = ref('');\r\n    const selectedActionId = ref(-1);\r\n\r\n    const watchCount = ref(0);\r\n    watch(props, async () => {\r\n      await watchFunc(props.team);\r\n    });\r\n\r\n    async function watchFunc(team: TTeam) {\r\n      await setupCharacterDetailMap();\r\n      for (const member of team.members) {\r\n        if (member.name) {\r\n          const characterMaster = getCharacterMaster(member.name);\r\n          if (characterMaster) {\r\n            const isCWith = (CHARGED_WITH_NORMAL_WEAPON.includes(characterMaster?.武器) || CHARGED_WITH_NORMAL_CHARACTER.includes(member.name)) && !CHARGED_ONLY_CHARACTER.includes(member.name);\r\n            const workArr: string[] = [];\r\n            for (let i = 0; i < getNormalAttackDan(member.name); i++) {\r\n              const work = 'N' + (i > 0 ? String(i + 1) : '');\r\n              workArr.push(work);\r\n              if (isCWith) {\r\n                workArr.push(work + (work === 'N' ? '1C' : 'C'));\r\n              }\r\n            }\r\n            if (!isCWith) {\r\n              workArr.push('C');\r\n            }\r\n            workArr.push('P');\r\n            normalAttackActions[member.name] = workArr;\r\n          }\r\n          elementalSkillActions[member.name] = getElementalSkillActions(member.name);\r\n        }\r\n      }\r\n      const isSameMember = team.rotation.filter(rotation => !team.members.filter(member => member.name).map(member => member.name).includes(rotation.member)).length == 0;\r\n      if (isSameMember) {\r\n        if (team.rotation.length) {\r\n          const workArr = _.cloneDeep(team.rotation);\r\n          workArr.forEach(rotation => {\r\n            if (rotation.action === 'NC') {\r\n              rotation.action = 'N1C';\r\n            } else if (rotation.action.startsWith('E')) {\r\n              const actions = elementalSkillActions[rotation.member];\r\n              if (actions && actions.length > 0 && !actions.includes(rotation.action)) {\r\n                rotation.action = actions[0];\r\n              }\r\n            }\r\n          })\r\n          rotationList.splice(0, rotationList.length, ...workArr);\r\n          actionId.value = Math.max(...rotationList.map(s => s.id)) ?? rotationList.length;\r\n        } else {\r\n          rotationList.splice(0, rotationList.length);\r\n          actionId.value = 0;\r\n        }\r\n      } else {\r\n        rotationList.splice(0, rotationList.length);\r\n        actionId.value = 0;\r\n        updateRotation();\r\n      }\r\n      rotationDescription.value = team.rotationDescription;\r\n      watchCount.value++;\r\n    }\r\n\r\n    onMounted(() => {\r\n      watchFunc(props.team);\r\n      props.team.members.forEach(member => {\r\n        normalAttackIconSrc(member.name);\r\n      })\r\n    })\r\n\r\n    const selectedAction = computed((): TActionItem | undefined => {\r\n      const actionArr = rotationList.filter(rotation => rotation.id == selectedActionId.value);\r\n      return actionArr.length > 0 ? actionArr[0] : undefined;\r\n    })\r\n\r\n    const getActionDetail = (item: TActionItem) => {\r\n      let result;\r\n      const master = getCharacterDetail(item.member);\r\n      if (master) {\r\n        if (normalAttackActions[item.member].includes(item.action)) { // 通常攻撃, 重撃, 落下攻撃\r\n          result = master.通常攻撃;\r\n        } else if (elementalSkillActions[item.member].includes(item.action)) { // 元素スキル\r\n          result = master.元素スキル;\r\n        } else if (item.action == 'Q') { // 元素爆発\r\n          result = master.元素爆発;\r\n        }\r\n      }\r\n      return result;\r\n    };\r\n\r\n    const previousRotation = (item: TActionItem) => {\r\n      let result;\r\n      for (const rotation of rotationList) {\r\n        if (item.id == rotation.id) {\r\n          break;\r\n        }\r\n        result = rotation;\r\n      }\r\n      return result;\r\n    }\r\n\r\n    const normalAttackIconSrc = (character: string) => getCharacterDetail(character)?.通常攻撃.icon_url ?? IMG_SRC_DUMMY;\r\n    const elementalSkillIconSrc = (character: string) => getCharacterDetail(character)?.元素スキル.icon_url ?? IMG_SRC_DUMMY;\r\n    const elementalBurstIconSrc = (character: string) => getCharacterDetail(character)?.元素爆発.icon_url ?? IMG_SRC_DUMMY;\r\n    const colorClass = (character: string) => {\r\n      const master = getCharacterMaster(character);\r\n      return master ? ' ' + (ELEMENT_COLOR_CLASS as any)[master.元素] : '';\r\n    }\r\n    const bgColorClass = (character: string) => {\r\n      const master = getCharacterMaster(character);\r\n      return master ? ' ' + (ELEMENT_BG_COLOR_CLASS as any)[master.元素] : '';\r\n    }\r\n\r\n    const actionDisplay = (item: TActionItem) =>\r\n      item.action.startsWith('E') ? item.action.replace(/^E\\./, '') : item.action;\r\n\r\n    const selectedActionClass = (item: TActionItem) =>\r\n      selectedActionId.value == item.id ? ' selected' : '';\r\n\r\n    const updateRotation = () => {\r\n      context.emit('update:rotation', rotationList, rotationDescription.value);\r\n    }\r\n\r\n    const rotationListOnChange = () => {\r\n      updateRotation();\r\n    }\r\n\r\n    const listActionOnClick = (member: TMember, actionKey: string) => {\r\n      let action = actionKey;\r\n      if (normalAttackActions[member.name].includes(action)) {\r\n        const workArr = rotationList.filter(s => s.member == member.name && normalAttackActions[member.name].includes(s.action));\r\n        if (workArr.length > 0) {\r\n          action = workArr[workArr.length - 1].action;\r\n        }\r\n      } else if (action.startsWith('E')) {\r\n        const workArr = rotationList.filter(s => s.member == member.name && elementalSkillActions[member.name].includes(s.action));\r\n        if (workArr.length > 0) {\r\n          action = workArr[workArr.length - 1].action;\r\n        } else {\r\n          const actions = elementalSkillActions[member.name];\r\n          if (actions && actions.length > 0) {\r\n            action = actions[0];\r\n          }\r\n        }\r\n      }\r\n      rotationList.push({\r\n        id: ++actionId.value,\r\n        member: member.name,\r\n        action: action,\r\n      });\r\n      updateRotation();\r\n    }\r\n\r\n    const rotationActionOnClick = (item: TActionItem) => {\r\n      if (removeMode.value) {\r\n        removeItemOnClick(item);\r\n      } else if (selectedActionId.value == item.id) {\r\n        selectedActionId.value = -1;\r\n      } else if (normalAttackActions[item.member].includes(item.action)) {\r\n        selectedActionId.value = item.id;\r\n      } else if (item.action.startsWith('E') && elementalSkillActions[item.member].length > 1) {\r\n        selectedActionId.value = item.id;\r\n      } else {\r\n        selectedActionId.value = -1;\r\n      }\r\n    }\r\n\r\n    const selectedActionOnClick = (item: TActionItem) => {\r\n      for (const actionArr of [normalAttackActions[item.member], elementalSkillActions[item.member]]) {\r\n        if (actionArr?.length) {\r\n          const index = actionArr.indexOf(item.action);\r\n          if (index != -1) {\r\n            item.action = (index + 1) < actionArr.length ? actionArr[index + 1] : actionArr[0];\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      updateRotation();\r\n    }\r\n\r\n    const removeItemOnClick = (item: TActionItem) => {\r\n      rotationList.splice(0, rotationList.length, ...rotationList.filter(s => s != item));\r\n      updateRotation();\r\n    }\r\n\r\n    return {\r\n      displayName,\r\n      IMG_SRC_DUMMY,\r\n      removeMode,\r\n\r\n      watchCount,\r\n      normalAttackIconSrc,\r\n      elementalSkillIconSrc,\r\n      elementalBurstIconSrc,\r\n      colorClass,\r\n      bgColorClass,\r\n\r\n      getCharacterMaster,\r\n\r\n      rotationList,\r\n      rotationDescription,\r\n      previousRotation,\r\n      getCharacterDetail,\r\n      getActionDetail,\r\n      actionDisplay,\r\n      selectedAction,\r\n      selectedActionClass,\r\n\r\n      rotationListOnChange,\r\n      listActionOnClick,\r\n      rotationActionOnClick,\r\n      removeItemOnClick,\r\n      selectedActionOnClick,\r\n      updateRotation,\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./TeamRotation.vue?vue&type=template&id=37a78f4d&scoped=true&ts=true\"\nimport script from \"./TeamRotation.vue?vue&type=script&lang=ts\"\nexport * from \"./TeamRotation.vue?vue&type=script&lang=ts\"\n\nimport \"./TeamRotation.vue?vue&type=style&index=0&id=37a78f4d&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-37a78f4d\"]])\n\nexport default __exports__"],"names":["getLevelStr","ascension","level","突破レベルレベルARRAY","getStatValueByLevel","statObj","myLevelStr","lowLevel","highLevel","length","lowValue","highValue","getPropertyValueByLevel","getValueByLevel","valueObj","Number","levelArr","Object","keys","map","s","i","calculateArtifactStatsMain","artifactStatsMain","mainstats","forEach","key","statWithRarity","stat","split","ARTIFACT_MAIN_MASTER","calculateArtifactSubStatByPriority","artifactStatsSub","prioritySubstats","priotritySubstatIndices","priotritySubstatValues","prioritySubstatCounts","totalCount","undefined","noPrioritySubstatArr","聖遺物サブ効果ARRAY","filter","includes","noPriorityCount","Math","min","floor","max","substat","ARTIFACT_SUB_MASTER","star4Count","startsWith","multiplier","round","calculateArtifactStats","artifactDetailInput","artifactStats","聖遺物ステータス","聖遺物ステータスメイン効果","聖遺物ステータスサブ効果","calculateStats","statsInput","characterInput","conditionInput","optionInput","characterMaster","突破レベル","レベル","constellation","命ノ星座","weaponMaster","weaponAscension","武器突破レベル","weaponLevel","武器レベル","workStatsObj","_","ステータスTEMPLATE","元素","name","conditionValues","enemyMaster","toStat","statAdjustments","ステータスチーム内最高ARRAY","statAdjustmentsEx","基礎ステータスARRAY","通常攻撃_元素Var","武器","重撃_元素Var","落下攻撃_元素Var","elementalResonance","teamOption","miscOption","optionObj","conditionAdjustments","workValue","Infinity","endsWith","my付与元素","replace","validConditionValueArr","makeValidConditionValueArr","calculateStatsTop","updateStatsWithCondition","myDamageDetail","damageDetailMyCharacter","damageDetailMyWeapon","damageDetailMyArtifactSets","CHANGE_KIND_TALENT","myDetailObj","number","checkConditionMatches","my元素","攻撃元素","overwriteObject","statsObj","error","console","workConditionAdjustments","statFormulaMap","Map","CHANGE_KIND_STATUS","hasCondition","myNew数値","条件","concat","myNew種類","has","set","get","push","上限","下限","hpStatArr","defStatArr","atkStatArr","otherStatArr","元素ステータス_ダメージARRAY","元素ステータス_耐性ARRAY","ダメージバフARRAY","実数ダメージ加算ARRAY","元素反応バフARRAY","Array","from","indexOf","formulaStatArr","Set","sort","compareFunction","oldStatsObj","postfix","workStat","updateStatsWithConditionSub","fromStat","formulaKey","formulaArr","formula","diffStats","updateStats","statValue","getStatValue","topValue","a","b","arr","lowestArr","aIndex","bIndex","calculateElementalResonance","result","ELEMENTAL_RESONANCE_MASTER","master","詳細","detailObj","matchRet","種類","数値","dendroOption","calculateFormulaArray","damageResult","opt_max","opt_min","isArray","operator","entry","subResult","isNumber","nameArr","damageArrArr","damage","damageArr","temp","maxValue","minValue","calculateDamageResult","vision","reactionResult","元素反応TEMPLATE","reactionMasterArr","dmgElementSet","add","selectList","selectEntry","selectedIndex","dmgElement","options","ELEMENTAL_REACTION_MASTER","has氷砕き","characterArr","破砕","氷砕き","キャラクター","名前","element","reactionMaster","reaction","reactionObj","resultValue","calculate結晶シールド吸収量","optionValue","calculate固定値系元素反応ダメージ","calculate乗算系元素反応倍率","calculate加算系元素反応ダメージ","suffix","dmg","元素反応","debug","splice","category","talentDetailArr","workObj","talentDetail","resultArr","calculateDamageFromDetail","n","sum","damageTakenArr","damageTaken","calculateDamageTaken","value","resScoreArr","checkboxList","required","numberList","conditionStr","myCondStr","myCondStrArr","resultSub","checkConditionMatchesSub","myCondArr","work","NUMBER_CONDITION_VALUE_RE","test","workArr","re","RegExp","workCondArr","reRet","exec","elementalMastery","dmgBuff","opt_dmgElement","calculateEnemyRes","calculateEnemyDef","opt_ignoreDef","enemyLevel","calcIgnoreDef","calcDef","calculateRes","res","statName","opt_element","myバフArr","is会心Calc","is防御補正Calc","is耐性補正Calc","my防御無視","my別枠乗算","myHIT数","myステータス補正","talentChangeDetailObjArr","getChangeDetailObjArr","myConditionValuesAfter","delCondition","addCondition","newValue","String","説明","desc","myConditionInputAfter","validConditionValueArrAfter","damageDetail","ステータス変更系詳細","damageDetailObj","valueBefore","valueAfter","matchesBefore","matchesAfter","new数値","diff","new種類","対象","myTalentChangeDetailObjArr","myダメージ種類","my対象カテゴリArr","myValue","myNewValueObj","JSON","parse","stringify","tempStatsObj","entryObj","tempArr","isValid","HIT数","artifactSets","my種類","my条件","description","ダメージバフ","DAMAGE_CATEGORY_ARRAY","my計算Result","calculateDamageFromDetailSub","myResultWork","dmgUpStatArr","dmgUpStat","buffArr","防御無視","別枠乗算","myダメージ基礎値","myダメージ","isUseReference","myダメージバフ補正","buff","my防御補正","my耐性補正","my会心率","my会心ダメージ","my会心Result","my期待値Result","changeKind","DAMAGE_RESULT_TEMPLATE","ALL_ELEMENTS","def","dmgReduction","ARTIFACT_SCORE_FORMULA_TEMPLATE","calculateArtifactScore","scoringStats","scoringStat","magnification","srcStat","srcStatValue","member","teamMembers","calculatedSupporter","supporters","async","calculateSupporter","supporter","build","character","getDefaultCharacterInput","getDefaultArtifactDetailInput","getDefaultConditionInput","getDefaultStatsInput","getDefaultDamageResultInput","getCharacterMasterDetail","builddata","loadRecommendation","makeDamageDetailObjArrObjCharacter","makeDamageDetailObjArrObjWeapon","makeDamageDetailObjArrObjArtifactSets","setupConditionValues","聖遺物メイン効果","updateNumberConditionValues","myCharacterMaster","getCritFromResultEntry","critRate","critDmg","REACTION_DMG_ARR","REACTION_DMG_ELEMENT_MAP","setupReactionDmgElementMap","reactionDmg","getDamageResultArr","rotationDamageEntry","calculateRotationDamageEntry","index","list","reactions","dmgResultEntry","count","counts","plainDmg","calculateReactedDamage","workDmg","calculateRotationTotalDamage","rotationDamageArr","dmgIndex","elementalReaction","reactionTimes","reactionKey","getAmplifyingReactionElement","reactionElement","isFinite","dst","src","srcKeys","basename","path","pop","shift","i18n","createI18n","legacy","locale","fallbackLocale","isGlobal","基本ステータスARRAY","高級ステータスARRAY","ステータスその他ARRAY","ステータス連動ARRAY","敵ステータス_元素耐性ARRAY","敵ステータス_その他ARRAY","ステータスARRAY_MAP","STAT_PERCENT_LIST","makeStatusTenmplate","makeEnemyStatusTemplate","聖遺物メイン効果_生の花ARRAY","聖遺物メイン効果_死の羽ARRAY","聖遺物メイン効果_時の砂ARRAY","聖遺物メイン効果_空の杯ARRAY","聖遺物メイン効果_理の冠ARRAY","聖遺物優先するサブ効果ARRAY","聖遺物ステータスTEMPLATE","蒸発倍率_炎","蒸発倍率_水","溶解倍率_氷","溶解倍率_炎","過負荷ダメージ","感電ダメージ","超電導ダメージ","拡散ダメージ","拡散元素","結晶吸収量","氷砕きダメージ","燃焼ダメージ","開花ダメージ","烈開花ダメージ","超開花ダメージ","超激化ダメージ","草激化ダメージ","燃焼ダメージ会心率","燃焼ダメージ会心ダメージ","開花ダメージ会心率","開花ダメージ会心ダメージ","烈開花ダメージ会心率","烈開花ダメージ会心ダメージ","超開花ダメージ会心率","超開花ダメージ会心ダメージ","通常攻撃","重撃","落下攻撃","元素スキル","元素爆発","その他","キャラクター注釈","ARTIFACT_SET_MASTER_DUMMY","レアリティ","image","IMG_SRC_DUMMY","CHARACTER_INPUT_TEMPLATE","通常攻撃レベル","元素スキルレベル","元素爆発レベル","weapon","武器精錬ランク","artifactSetMasters","damageDetailElementalResonance","buildname","recommendationSelectedIndex","saveDisabled","removeDisabled","ARTIFACT_TEMPLATE","rarity","setname","cat_id","mainStat","mainStatValue","subStats","ARTIFACT_DETAIL_INPUT_TEMPLATE","聖遺物優先するサブ効果","NUMBER_OF_PRIORITY_SUBSTATS","聖遺物優先するサブ効果上昇値","GENSEN_MASTER_LIST","values","聖遺物優先するサブ効果上昇回数","聖遺物優先するサブ効果Disabled","artifact_list","CONDITION_INPUT_TEMPLATE","STATS_INPUT_TEMPLATE","ENEMY_MASTER_LIST","getDefaultOptionInput","OPTION_INPUT_TEMPLATE","SUPPORTER_INPUT_TEMPLATE","supporterBuildname","parseLevelStr","levelStr","makeDefaultBuildname","makeBuildStorageKey","makeOptionStorageKey","makeArtifactScoringStorageKey","makeRecommendationList","opt_buildData","isSavable","overwrite","log","storageKeyArr","localStorage","buildObj","key2","optionsObj","key3","artifactScoringObj","artifactScoring","key4","supporterBuildnameObj","obj","myRecommendation","subkey","artifactRarerityArrArr","artifactRarerity4Num","artifactSet1","artifactSet2","ARTIFACT_SET_MASTER","makeArtifactSetAbbrev","statusName","RECOMMEND_ABBREV_MAP","substring","abbrRe","abbr","makePrioritySubstatValueList","opt_substat","valueArr","makeEasyInputSubstatValueList","weaponType","WEAPON_MASTER","getWeaponMasterDetail","prioritySubstatsDisabled","toKey","artifactSet","mainstat","subkey1","subkey2","subkey3","substatValue","substatCount","prioritySubstatValueList","キャラクター構成PROPERTY_MAP","astarIndex","workCharacter","CHARACTER_MASTER","ARTIFACT_KEYS","newList","makeSavedata","resultObj","makeOptionsSavedata","myTalentDetail","myTalentLevel","myDefaultKind","myDefaultElement","myInputCategory","myStatusChangeDetailObjArr","makeDamageDetailObjArr","workCategory","cond","元素付与無効","除外条件","適用条件","拡散","conditionMap","exclusionMap","makeConditionExclusionMapFromStr","myLevel","condition","damageDetailObjArr","makeDamageDetailObjArrObjElementalResonance","ELEMENTAL_RESONANCE_MASTER_LIST","makeDetailObj","defaultKind","defaultElement","inputCategory","opt_condition","my対象","my数値","analyzeFormulaStr","my上限","my下限","getChangeKind","kind","talentDataObj","statusChangeDetailObjArr","makeTeamOptionDetailObjArr","detailObjArr","exclusionCond","makeConditionExclusionMapFromStrSub","exclusion","myName","pushToMapValueArray","conditionObj","step","prefix","condValueArr","re2","rangeStart","rangeEnd","re2Ret","addDecimal","e","masters","排他","exclusions","conditionValue","checked","vStat","trunc","warn","numberEntryArr","oldValue","getDecimalLength","multiplyDecimal","value1","value2","decimalLength","intValue1","intValue2","pow","k","formulaStr","opt_defaultItem","workStr","analyzeFormulaStrSub","strArr","makeSharedata","savedata","sharedataArr","myBasename","ARTIFACT_STAT_JA_EN_ABBREV_MAP","match","join","openTwitter","text","url","opt_hashtags","opt_via","baseUrl","params","URLSearchParams","append","query","toString","shareUrl","window","open","shareByTwitter","sharedata","encoded","encodeURI","getMaxConstellation","getMaxTalentLevel","talentObj","pushBuildinfoToSession","teammembers","sessionStorage","setItem","popBuildinfoFromSession","getItem","removeItem","updateConditionsByTeam","myVision","regionCountMap","totalEnergyCost","visionCountMap","characterDetail","region","元素エネルギー","size","updateOptionsElementalResonanceByTeam","newElementResonance","resonanceElementArr","restMemberElementArr","currentElementArr","resonance","getIconUrl","icon_url","import","CHARACTER_MASTER_LIST","片手剣","SWORD_MASTER","両手剣","CLAYMORE_MASTER","長柄武器","POLEARM_MASTER","弓","BOW_MASTER","法器","CATALYST_MASTER","typedMaster","SWORD_MASTER_LIST","CLAYMORE_MASTER_LIST","POLEARM_MASTER_LIST","BOW_MASTER_LIST","CATALYST_MASTER_LIST","WEAPON_MASTER_LIST","ARTIFACT_SET_MASTER_LIST","ENEMY_MASTER","TEAM_OPTION_MASTER_LIST","TEAM_OPTION_MASTER","OPTION1_MASTER_LIST","OPTION1_MASTER","OPTION2_MASTER_LIST","OPTION2_MASTER","CHARACTER_MASTER_DETAIL_MAP","fetch","then","resp","json","WEAPON_IMG_SRC","WEAPON_MASTER_DETAIL_MAP","opt_weaponType","weaponTypeArr","ELEMENT_COLOR_CLASS","炎","水","風","雷","草","氷","岩","ELEMENT_BG_COLOR_CLASS","ELEMENT_IMG_SRC","STAR_BACKGROUND_IMAGE_CLASS","RECOMMEND_ABBREV_EN_MAP","ARTIFACT_STAT_JA_EN_ABBREV_REVERSE_MAP","gensen","ARTIFACT_CAT_NAMES","getArtifactIconUrl","opt_cat_id","SP_SELF","SP_NEXT","SP_LONG","SP_SHRT","C1","C2","C6","PARTICLE_MASTER","pentry","pinfo","CHARACTER_Q_TO_E_ARR","CHARACTER_E_UNTIL_MAP","CHARACTER_E_DELAY_MAP","CHARACTER_Q_NOT_RECHARGEABLE","getElementalSkillActions","particleMaster","action","getParticleInfo","isBursting","keyArr","slice","getParticleNumFromInfo","particleInfo","leftTime","receiveType","getReceiveTypeFromInfo","duration","getDurationFromInfo","getCooltimeFromInfo","_withScopeId","_pushScopeId","_popScopeId","_hoisted_1","class","_hoisted_2","_hoisted_3","style","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_createElementVNode","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","type","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","render","_ctx","_cache","$props","$setup","$data","$options","_component_ArtifactSetSelect","_resolveComponent","_openBlock","_createElementBlock","control","onClick","$event","isEditing","artifactImgSrc","alt","displayName","copiedArtifact","artifactIconOnClick","_toDisplayString","_withDirectives","onChange","args","_Fragment","_renderList","mainStatOptions","option","_vModelSelect","statStep","_vModelText","displayStatValue","starOnChange","dummy","subStat","subStatOptions","disabled","subStatOptionDisabled","selectOnClick","score","_createCommentVNode","selected","_createVNode","visible","artifact","updateArtifactSet","_vShow","isListShow","defineComponent","props","id","initial","Boolean","components","ArtifactSetSelect","emits","setup","context","percent","CompositionFunction","reactive","ref","isSelected","computed","MAINSTAT_CAT_ARR","emit","onLoad","watch","newVal","oldVal","__exports__","artifactSetEffects","item","filteredList","_normalizeClass","bgImageClass","selectedClass","$emit","artifactSetMastersRea","elementList","elementCheckList","checkListOnChange","_vModelCheckbox","elementSrc","weaponList","weaponCheckList","weaponSrc","characterOnClick","visionSrc","selectionNumber","characters","checkList","elementChecked","weaponChecked","blankIndex","t","te","useI18n","useScope","localeList","setI18nLanguage","global","loadLocaleMessages","document","querySelector","setAttribute","messages","setLocaleMessage","nextTick","hasPercent","displayStatName","opt_s","myPercent","p","displayStatAbbrev","targetValue","event","target","HTMLInputElement","HTMLSelectElement","displayOptionName","onDblclick","characterOnDblclick","characterImgClass","characterImgSrc","visionImgSrc","tags","tagColorClass","replacements","replaceImgSrc","displayStat","showEquipment","imgWeaponSrc","imgArtifactSetSrc","viewable","members","watchCount","getBuilddataFromStorage","weaponName","replIndex","artifactSetName","toLowerCase","locate","confirm","colspan","_component_CharacterSelect","_component_MemberItem","characterSelectMode","_createBlock","updateReplacements","updateCharacters","workTeam","minlength","maxlength","placeholder","characterSelectModeOnClick","selectedMemberName","MEMBER_TAG_LIST","tag","tagSelectedClass","tagOnClick","memberSelectedClass","memberOnClick","selectedMemberBuildname","buildnameOnChange","buildnames","workTeamTags","teamTagSelected","teamTagOnClick","txtTeamTags","txtTeamTagsOnChange","cancelOnClick","okOnClick","CharacterSelect","MemberItem","team","teamTags","rotation","rotationDescription","selectedMemberId","replacementIndex","duplicateTeam","setupTxtTeamTags","newCharacters","workBuildnames","getBuildStorageKeys","getBuildnameFromStorageKey","defaultBuildname","others","editable","editOnClick","resonanceElementImgSrcs","memberStats","displayRes","resKey","resBgClass","displayTags","jumpToRotation","requied","constellations","memberResults","initializeRes","watchFunc","onMounted","getElementalResonance","calculateMemberResult","Promise","all","results","calculateStat","teamAdjustments","memberResult","チームバフ","最大値","最小値","dmgElements","artifactSet4s","固有天賦","constellationObj","_createStaticVNode","_component_draggable","_component_ERCalculator","bgColorClass","normalAttackIconSrc","listActionOnClick","elementalSkillIconSrc","elementalBurstIconSrc","removeMode","selectedAction","getActionDetail","selectedActionOnClick","actionDisplay","rotationList","handle","delay","animation","rotationListOnChange","_withCtx","previousRotation","getCharacterMaster","colorClass","selectedActionClass","rotationActionOnClick","removeItemOnClick","rows","updateRotation","_createTextVNode","teamMemberResult","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","for","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_67","rotationLength","inputOnChange","calculatorInput","energyCost","weaponImgSrc","currentWeapon","weaponRefine","refine","energyRechargeGls","onField","inputRowParticleEnemy","row","rowIndex","bgColorClass2","currentValues","reduce","c","columnIndex","inputRowParticle","rowImgSrc1","rowImgSrc1Class","rowImgSrc2","triggerName","particleRecharges","inputRowEnergy","burstCounts","replaceWeapons","weaponIndex","replaceWeaponImgSrc","replaceWeaponClass","replaceWeaponOnClick","combatLength","isOpenSupplyFromEnemy","supplyFromEnemy","message","isShowUsage","CHARACTER_E_DECREMENT_IN_BURST","entries","untilMap","actionName","delayArr","RECHARGE_ENERGY_SKILL","RECHARGE_ENERGY_BURST","RECHARGE_ENERGY_PASSIVE","RECHARGE_ENERGY_CONSTELLATION","RECHARGE_ENERGY_ATTACK","RECHARGE_ENERGY_WEAPON","RECHARGE_ENERGY_ARTIFACT","RECHARGE_PARTICLE_SKILL","RECHARGE_PARTICLE_PASSIVE","RECHARGE_PARTICLE_CONSTELLATION","RECHARGE_PARTICLE_FAVONIUS","RECHARGE_PARTICLE_RESONANCE","RECHARGE_PARTICLE_ENEMY","ATTACK_ENERGY_COUNT_OBJ","NORMAL_ATTACK_LENGTH_OBJ","ACTION_LENGTH_MAP","isRechargeKindEnergy","rechargeKind","isRechargeKindParticle","countN","isQing","countC","countE","untilAction","untilCount","clear","workMap","countQ","getOnFieldRate","NUMBER_OF_MEMBERS","memberNameArr","danArr","getNormalAttackDan","lengthList","preRotation","isNCPIgnoring","actionLength1","actionLength2","maxDan","dan","unitLength","j","multiple","ceil","lengthSum","sumVal","maxVal","memberNum","rate","getMemberResult","getDefaultMemberResult","memberArr","getCharacterDetail","ステータス","getCharacterInputValue","getStatsInputValue","CHARACTER_ENERGY_FUNC","旅人(岩)","constellationLevel","myEnergy","allEnergy","otherEnergy","herEnergies","旅人(雷)","skillLevel","er","messages2","burstLevel","somebodyEnergy","旅人(草)","ガイア","リサ","バーバラ","レザー","行秋","nCount","重雲","ディオナ","ロサリア","早柚","九条裟羅","トーマ","鹿野院平蔵","ドリー","レイラ","ファルザン","ヨォーヨ","ミカ","フレミネ","ジン","七七","ウェンティ","qCount","doBreak","herIndex","herCm","クレー","アルベド","甘雨","楓原万葉","雷電将軍","unit","unit2","珊瑚宮心海","荒瀧一斗","geoCount","八重神子","神里綾人","セノ","ニィロウ","放浪者","electroCount","ディシア","リネ","フリーナ","シャルロット","CHARACTER_PARTICLE_EXTRA_FUNC","onFields","hydroCount","myParticle","allParticle","フィッシュル","刻晴","herParticles","triggerCnt","ct","rindexArr","isRecorded","nxtCharacter","toIndex","WEAPON_ENERGY_FUNC","金珀·試作","天目影打","桂木斬長正","weaponEnergySub_名士の振舞","喜多院十文字槍","不滅の月華","碧落の瓏","正義の報酬","久遠流転の大典","船渠剣","weaponEnergySub_船工の唄","携帯型チェーンソー","isInCt","getParticleByCharacter","resultMap","myIndex","eCount","cCount","num","resultVal","splitNumToArrByOnFieldRate","ousiaLength","isOusia","timeArr","curCharacter","delayActions","delayAction","setSkillParticleNumToArr","getParticleByCharacterExtra","func","ret","particles","getParticleByWeapon","getParticleByResonance","getEnergyByCharacter","energies","workResult","getEnergyByWeapon","getEnergyByArtifact","artifactSet4","getEnergyByAttack","denominator","hitCount","withC","workHitCount","dans","workDan","isNaN","energy","time","addNumToArr","nxtRotation","v","DEFAULT_ROTATION_LENGTH","DEFAULT_COMBAT_LENGTH","REPLACE_WEAPON_MAP","setupCharacterDetailMap","updateRotationLength","setupInput","getConstellation","eLength","qLength","memberIndex","クールタイム","newLength","updateOnFields","setupInputRows","deep","newInput","initialWeapon","pushInputRowParticle","inputRows","newMessages","particle","initialValues","pushInputRowEnergy","newInputRowPacticle1","newInputRowPacticle2","newInputRowEnergy","newInputRowResonance","newinputRowParticleEnemy","energyByCharacter","particleByWeapon","energyByWeapon","energyByArtifact","energyByAttack","particleByResonance","myElement","input","burstCount","particleEnergy","characterMater","getWeaponMaster","artifactSetMater","resetInput","inputRow","draggable","ERCalculator","normalAttackActions","elementalSkillActions","actionId","selectedActionId","isCWith","CHARGED_WITH_NORMAL_WEAPON","CHARGED_WITH_NORMAL_CHARACTER","CHARGED_ONLY_CHARACTER","isSameMember","actions","actionArr","actionKey"],"sourceRoot":""}