{"version":3,"file":"js/TeamManager.cf3227e6.js","mappings":"8LAAM,SAAUA,EAASC,GACrB,MAAwB,kBAAVA,GAAsBA,aAAiBC,MACxD,CAEK,SAAUC,EAASF,GACrB,OAAOG,SAASH,IAAmB,MAATA,CAC7B,CAMK,SAAUI,EAAcJ,GAC1B,MAAMK,EAASC,OAAOC,UAAUC,SAASC,KAAKT,GAC9C,MAAkB,oBAAXK,CACV,CAGK,SAAUK,EAASV,GACrB,MAAMW,EAASC,KAAKC,MAAMD,KAAKE,UAAUd,IACzC,OAAOW,CACV,CAEK,SAAUI,EAAgBC,EAAUC,GACtC,GAAIb,EAAca,IAAQb,EAAcY,GAAM,CAC1C,MAAME,EAAUZ,OAAOa,KAAKF,GAC5B,IAAK,MAAMG,KAAOF,EACdF,EAAII,GAAOH,EAAIG,GAEnB,IAAK,MAAMA,KAAOd,OAAOa,KAAKH,GACrBE,EAAQG,SAASD,WAAaJ,EAAII,EAE9C,CACD,OAAOJ,CACV,C,gfC/BM,MAAMM,EAAe,CACxB,OACA,QACA,SAESC,EAAe,CACxB,OACA,MACA,MACA,QAESC,EAAe,CACxB,MACA,SACA,UACA,UACA,WACA,WACA,UAESC,EAAoB,CAC7B,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YAESC,EAAkB,CAC3B,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QAESC,EAAc,CACvB,aACA,WACA,aACA,cACA,aACA,WAESC,EAAgB,CACzB,cACA,YACA,cACA,eACA,cACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aAESC,EAAc,CACvB,WACA,WACA,YACA,WACA,WACA,YACA,WACA,WACA,WACA,WACA,YACA,YACA,YACA,aAESC,EAAgB,CACzB,SACA,MACA,OACA,OACA,MACA,OACA,QAESC,EAAmB,CAC5B,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SAGSC,EAAiB,IAAIC,IAAI,CAClC,CAAC,UAAWX,GACZ,CAAC,UAAWC,GACZ,CAAC,UAAWC,GACZ,CAAC,eAAgBC,GACjB,CAAC,aAAcC,GACf,CAAC,SAAUC,GACX,CAAC,WAAYC,GACb,CAAC,SAAUC,GACX,CAAC,MAAOC,GACR,CAAC,cAA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","sources":["webpack://gencalc/./src/common.ts","webpack://gencalc/./src/input.ts","webpack://gencalc/./src/master.ts","webpack://gencalc/./src/pages/TeamManager/App.vue?b7d5","webpack://gencalc/./src/pages/TeamManager/team.ts","webpack://gencalc/./src/pages/TeamManager/TeamItem.vue?0ecc","webpack://gencalc/./src/pages/TeamManager/MemberItem.vue?c9fc","webpack://gencalc/./src/calculate.ts","webpack://gencalc/./src/pages/TeamManager/MemberItem.vue?b372","webpack://gencalc/./src/pages/TeamManager/MemberItem.vue","webpack://gencalc/./src/pages/TeamManager/TeamItem.vue?4cc0","webpack://gencalc/./src/pages/TeamManager/TeamItem.vue","webpack://gencalc/./src/pages/TeamManager/App.vue?ab33","webpack://gencalc/./src/pages/TeamManager/App.vue","webpack://gencalc/./src/pages/TeamManager/main.ts","webpack://gencalc/webpack/bootstrap","webpack://gencalc/webpack/runtime/chunk loaded","webpack://gencalc/webpack/runtime/compat get default export","webpack://gencalc/webpack/runtime/define property getters","webpack://gencalc/webpack/runtime/global","webpack://gencalc/webpack/runtime/hasOwnProperty shorthand","webpack://gencalc/webpack/runtime/make namespace object","webpack://gencalc/webpack/runtime/runtimeId","webpack://gencalc/webpack/runtime/jsonp chunk loading","webpack://gencalc/webpack/startup"],"sourcesContent":["export function isString(value: any): boolean {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\n\r\nexport function isNumber(value: any): boolean {\r\n    return isFinite(value) && value != null;\r\n}\r\n\r\nexport function isBoolean(value: any): boolean {\r\n    return value === true || value === false;\r\n}\r\n\r\nexport function isPlainObject(value: any): boolean {\r\n    const myType = Object.prototype.toString.call(value);\r\n    return myType === '[object Object]';\r\n}\r\n\r\n/** 簡易なdeep copy。undefinedなどは消失します */\r\nexport function deepcopy(value: any): any {\r\n    const result = JSON.parse(JSON.stringify(value));\r\n    return result;\r\n}\r\n\r\nexport function overwriteObject(dst: any, src: any) {\r\n    if (isPlainObject(src) && isPlainObject(dst)) {\r\n        const srcKeys = Object.keys(src);\r\n        for (const key of srcKeys) {\r\n            dst[key] = src[key];\r\n        }\r\n        for (const key of Object.keys(dst)) {\r\n            if (!srcKeys.includes(key)) delete dst[key];\r\n        }\r\n    }\r\n    return dst;\r\n}\r\n\r\n// eslint-disable-next-line\r\nexport const basename = (path: string) => path!.split('/')!.pop()!.split('.')!.shift()!;\r\n","import { ARTIFACT_SET_MASTER, ARTIFACT_STAT_JA_EN_ABBREV_MAP, ARTIFACT_SUB_MASTER, CHARACTER_MASTER, DAMAGE_CATEGORY_ARRAY, ELEMENTAL_RESONANCE_MASTER, ENEMY_MASTER_LIST, GENSEN_MASTER_LIST, getCharacterMasterDetail, getWeaponMasterDetail, IMG_SRC_DUMMY, RECOMMEND_ABBREV_MAP, TAnyObject, TArtifactSet, TArtifactSetEntry, TArtifactSetKey, TArtifactSubKey, TCharacterDetail, TCharacterKey, TEnemyEntry, TWeaponDetail, TWeaponKey, TWeaponTypeKey, WEAPON_MASTER, キャラクター構成PROPERTY_MAP } from '@/master';\r\nimport { basename, deepcopy, isNumber, isPlainObject, isString, overwriteObject } from './common';\r\n\r\nexport const 基礎ステータスARRAY = [\r\n    '基礎HP',\r\n    '基礎攻撃力',\r\n    '基礎防御力'\r\n];\r\nexport const 基本ステータスARRAY = [\r\n    'HP上限',\r\n    '攻撃力',\r\n    '防御力',\r\n    '元素熟知'\r\n];\r\nexport const 高級ステータスARRAY = [\r\n    '会心率',\r\n    '会心ダメージ',\r\n    '与える治療効果',\r\n    '受ける治療効果',\r\n    '元素チャージ効率',\r\n    'クールタイム短縮',\r\n    'シールド強化'\r\n];\r\nexport const 元素ステータス_ダメージARRAY = [\r\n    '炎元素ダメージバフ',\r\n    '水元素ダメージバフ',\r\n    '風元素ダメージバフ',\r\n    '雷元素ダメージバフ',\r\n    '草元素ダメージバフ',\r\n    '氷元素ダメージバフ',\r\n    '岩元素ダメージバフ',\r\n    '物理ダメージバフ'\r\n];\r\nexport const 元素ステータス_耐性ARRAY = [\r\n    '炎元素耐性',\r\n    '水元素耐性',\r\n    '風元素耐性',\r\n    '雷元素耐性',\r\n    '草元素耐性',\r\n    '氷元素耐性',\r\n    '岩元素耐性',\r\n    '物理耐性'\r\n];\r\nexport const ダメージバフARRAY = [\r\n    '通常攻撃ダメージバフ',\r\n    '重撃ダメージバフ',\r\n    '落下攻撃ダメージバフ',\r\n    '元素スキルダメージバフ',\r\n    '元素爆発ダメージバフ',\r\n    '与えるダメージ',\r\n];\r\nexport const 実数ダメージ加算ARRAY = [\r\n    '通常攻撃ダメージアップ',\r\n    '重撃ダメージアップ',\r\n    '落下攻撃ダメージアップ',\r\n    '元素スキルダメージアップ',\r\n    '元素爆発ダメージアップ',\r\n    '炎元素ダメージアップ',\r\n    '水元素ダメージアップ',\r\n    '風元素ダメージアップ',\r\n    '雷元素ダメージアップ',\r\n    '草元素ダメージアップ',\r\n    '氷元素ダメージアップ',\r\n    '岩元素ダメージアップ',\r\n    '物理ダメージアップ'\r\n];\r\nexport const 元素反応バフARRAY = [\r\n    '蒸発反応ボーナス',\r\n    '溶解反応ボーナス',\r\n    '過負荷反応ボーナス',\r\n    '感電反応ボーナス',\r\n    '凍結反応ボーナス',\r\n    '超電導反応ボーナス',\r\n    '拡散反応ボーナス',\r\n    '結晶反応ボーナス',\r\n    '燃焼反応ボーナス',\r\n    '開花反応ボーナス',\r\n    '烈開花反応ボーナス',\r\n    '超開花反応ボーナス',\r\n    '超激化反応ボーナス',\r\n    '草激化反応ボーナス',\r\n];\r\nexport const ステータスその他ARRAY = [\r\n    'ダメージ軽減',\r\n    'HP%',\r\n    '攻撃力%',\r\n    '防御力%',\r\n    'HP+',\r\n    '攻撃力+',\r\n    '防御力+'\r\n];\r\nexport const 敵元素ステータス_耐性ARRAY = [\r\n    '敵炎元素耐性',\r\n    '敵水元素耐性',\r\n    '敵風元素耐性',\r\n    '敵雷元素耐性',\r\n    '敵草元素耐性',\r\n    '敵氷元素耐性',\r\n    '敵岩元素耐性',\r\n    '敵物理耐性'\r\n];\r\n\r\nexport const ステータスARRAY_MAP = new Map([\r\n    ['基礎ステータス', 基礎ステータスARRAY],\r\n    ['基本ステータス', 基本ステータスARRAY],\r\n    ['高級ステータス', 高級ステータスARRAY],\r\n    ['元素ステータス·ダメージ', 元素ステータス_ダメージARRAY],\r\n    ['元素ステータス·耐性', 元素ステータス_耐性ARRAY],\r\n    ['ダメージバフ', ダメージバフARRAY],\r\n    ['実数ダメージ加算', 実数ダメージ加算ARRAY],\r\n    ['元素反応バフ', 元素反応バフARRAY],\r\n    ['その他', ステータスその他ARRAY],\r\n    ['敵元素ステータス·耐性', 敵元素ステータス_耐性ARRAY],\r\n]);\r\n\r\nexport const STAT_PERCENT_LIST = [\r\n    ...高級ステータスARRAY, ...元素ステータス_ダメージARRAY, ...元素ステータス_耐性ARRAY, ...ダメージバフARRAY, ...元素反応バフARRAY, ...敵元素ステータス_耐性ARRAY,\r\n    '別枠乗算',\r\n];\r\n\r\nfunction makeStatusTenmplate() {\r\n    const statsObj = {} as { [key: string]: number };\r\n    ステータスARRAY_MAP.forEach((value) => {\r\n        value.forEach(stat => {\r\n            statsObj[stat] = 0;\r\n        });\r\n    });\r\n    statsObj['会心率'] = 5;\r\n    statsObj['会心ダメージ'] = 50;\r\n    statsObj['元素チャージ効率'] = 100;\r\n    statsObj['敵レベル'] = 0;\r\n    statsObj['敵防御力'] = 0;\r\n    return statsObj;\r\n}\r\nexport const ステータスTEMPLATE = makeStatusTenmplate();\r\nexport type TStats = {\r\n    [key: string]: number,\r\n};\r\n\r\nfunction makeEnemyStatusTemplate() {\r\n    const statsObj = {} as { [key: string]: number };\r\n    [元素ステータス_耐性ARRAY].forEach((value) => {\r\n        value.forEach(stat => {\r\n            statsObj[stat] = 0;\r\n        });\r\n    });\r\n    statsObj['防御力'] = 0;\r\n    return statsObj;\r\n}\r\nexport const 敵ステータスTEMPLATE = makeEnemyStatusTemplate();\r\n\r\nexport const 聖遺物メイン効果_生の花ARRAY = [\r\n    '5_HP', '4_HP'\r\n];\r\nexport const 聖遺物メイン効果_死の羽ARRAY = [\r\n    '5_攻撃力', '4_攻撃力'\r\n];\r\nexport const 聖遺物メイン効果_時の砂ARRAY = [\r\n    '5_元素チャージ効率',\r\n    '5_HP%',\r\n    '5_攻撃力%',\r\n    '5_防御力%',\r\n    '5_元素熟知',\r\n    '4_元素チャージ効率',\r\n    '4_HP%',\r\n    '4_攻撃力%',\r\n    '4_防御力%',\r\n    '4_元素熟知'\r\n];\r\nexport const 聖遺物メイン効果_空の杯ARRAY = [\r\n    '5_炎元素ダメージバフ',\r\n    '5_水元素ダメージバフ',\r\n    '5_風元素ダメージバフ',\r\n    '5_雷元素ダメージバフ',\r\n    '5_草元素ダメージバフ',\r\n    '5_氷元素ダメージバフ',\r\n    '5_岩元素ダメージバフ',\r\n    '5_物理ダメージバフ',\r\n    '5_HP%',\r\n    '5_攻撃力%',\r\n    '5_防御力%',\r\n    '5_元素熟知',\r\n    '4_炎元素ダメージバフ',\r\n    '4_水元素ダメージバフ',\r\n    '4_風元素ダメージバフ',\r\n    '4_雷元素ダメージバフ',\r\n    '4_草元素ダメージバフ',\r\n    '4_氷元素ダメージバフ',\r\n    '4_岩元素ダメージバフ',\r\n    '4_物理ダメージバフ',\r\n    '4_HP%',\r\n    '4_攻撃力%',\r\n    '4_防御力%',\r\n    '4_元素熟知'\r\n];\r\nexport const 聖遺物メイン効果_理の冠ARRAY = [\r\n    '5_会心率',\r\n    '5_会心ダメージ',\r\n    '5_HP%',\r\n    '5_攻撃力%',\r\n    '5_防御力%',\r\n    '5_元素熟知',\r\n    '5_与える治療効果',\r\n    '4_会心率',\r\n    '4_会心ダメージ',\r\n    '4_HP%',\r\n    '4_攻撃力%',\r\n    '4_防御力%',\r\n    '4_元素熟知',\r\n    '4_与える治療効果'\r\n];\r\n\r\nexport const 聖遺物サブ効果ARRAY = [\r\n    'HP',\r\n    '攻撃力',\r\n    '防御力',\r\n    '元素熟知',\r\n    '会心率',\r\n    '会心ダメージ',\r\n    '元素チャージ効率',\r\n    '攻撃力%',\r\n    'HP%',\r\n    '防御力%',\r\n];\r\nexport const 聖遺物優先するサブ効果ARRAY = [\r\n    '攻撃力%',\r\n    'HP%',\r\n    '防御力%',\r\n    '元素熟知',\r\n    '会心率',\r\n    '会心ダメージ',\r\n    '元素チャージ効率',\r\n];\r\n\r\nexport const 聖遺物ステータスTEMPLATE = {\r\n    'HP': 0,\r\n    '攻撃力': 0,\r\n    '防御力': 0,\r\n    '元素熟知': 0,\r\n    '会心率': 0,\r\n    '会心ダメージ': 0,\r\n    '元素チャージ効率': 0,\r\n    'HP%': 0,\r\n    '攻撃力%': 0,\r\n    '防御力%': 0,\r\n    '炎元素ダメージバフ': 0,\r\n    '水元素ダメージバフ': 0,\r\n    '風元素ダメージバフ': 0,\r\n    '雷元素ダメージバフ': 0,\r\n    '草元素ダメージバフ': 0,\r\n    '氷元素ダメージバフ': 0,\r\n    '岩元素ダメージバフ': 0,\r\n    '物理ダメージバフ': 0,\r\n    '与える治療効果': 0,\r\n};\r\n\r\nexport const 元素反応TEMPLATE = {\r\n    元素: '炎',\r\n    蒸発倍率: 0,\r\n    溶解倍率: 0,\r\n    過負荷ダメージ: 0,\r\n    感電ダメージ: 0,\r\n    超電導ダメージ: 0,\r\n    拡散ダメージ: 0,\r\n    拡散元素: '炎',\r\n    結晶吸収量: 0,\r\n    燃焼ダメージ: 0,\r\n    開花ダメージ: 0,\r\n    烈開花ダメージ: 0,\r\n    超開花ダメージ: 0,\r\n    超激化ダメージ: 0,\r\n    草激化ダメージ: 0,\r\n};\r\nexport type TDamageResultElementalReaction = typeof 元素反応TEMPLATE;\r\nexport type TDamageResultElementalReactionKey = keyof typeof 元素反応TEMPLATE;\r\n\r\nexport type TDamageResultEntry = [string, string | null, number, number | null, number, string | null, number | null, number | null, number | null];    // 名前, 元素, 期待値, 会心, 非会心, 種類, HIT数, ダメージバフ, 敵の防御補正\r\nexport type TDamageResult = {\r\n    元素反応: TDamageResultElementalReaction,\r\n    通常攻撃: TDamageResultEntry[],\r\n    重撃: TDamageResultEntry[],\r\n    落下攻撃: TDamageResultEntry[],\r\n    元素スキル: TDamageResultEntry[],\r\n    元素爆発: TDamageResultEntry[],\r\n    その他: TDamageResultEntry[],\r\n    キャラクター注釈: string[],\r\n    [key: string]: TDamageResultElementalReaction | TDamageResultEntry[] | string[],\r\n};\r\n\r\nexport const DAMAGE_RESULT_TEMPLATE = {\r\n    元素反応: deepcopy(元素反応TEMPLATE) as TDamageResultElementalReaction,\r\n    通常攻撃: [] as TDamageResultEntry[],\r\n    重撃: [] as TDamageResultEntry[],\r\n    落下攻撃: [] as TDamageResultEntry[],\r\n    元素スキル: [] as TDamageResultEntry[],\r\n    元素爆発: [] as TDamageResultEntry[],\r\n    その他: [] as TDamageResultEntry[],\r\n    キャラクター注釈: [] as string[],\r\n};\r\n\r\nexport const 突破レベルレベルARRAY = [\r\n    Array.from({ length: 20 }, (_, i) => i + 1),\r\n    Array.from({ length: 21 }, (_, i) => i + 20),\r\n    Array.from({ length: 11 }, (_, i) => i + 40),\r\n    Array.from({ length: 11 }, (_, i) => i + 50),\r\n    Array.from({ length: 11 }, (_, i) => i + 60),\r\n    Array.from({ length: 11 }, (_, i) => i + 70),\r\n    Array.from({ length: 11 }, (_, i) => i + 80),\r\n];\r\n\r\n\r\nexport type TDamageDetailObj = {\r\n    名前: string | null,\r\n    種類: string | null,\r\n    元素: string | null,\r\n    数値: number | string | Array<any> | null,\r\n    条件: string | null,\r\n    対象: string | null,\r\n    上限: number | string | Array<any> | null,\r\n    HIT数: number | null,\r\n    ダメージバフ: string | null,\r\n    元素付与無効: boolean | null,\r\n    除外条件: (string | object)[] | null,\r\n    適用条件: (string | object)[] | null,\r\n};\r\n\r\nexport type TDamageDetail = {\r\n    通常攻撃?: TDamageDetailObj[],\r\n    重撃?: TDamageDetailObj[],\r\n    落下攻撃?: TDamageDetailObj[],\r\n    元素スキル?: TDamageDetailObj[],\r\n    元素爆発?: TDamageDetailObj[],\r\n    その他?: TDamageDetailObj[],\r\n    ステータス変更系詳細: TDamageDetailObj[],\r\n    天賦性能変更系詳細: TDamageDetailObj[],\r\n    条件: Map<string, string[]>,\r\n    排他: Map<string, string[]>,\r\n};\r\n\r\nexport const ARTIFACT_SET_MASTER_DUMMY = {\r\n    key: 'NONE' as TArtifactSetKey,\r\n    レアリティ: 5,\r\n    image: IMG_SRC_DUMMY,\r\n} as TArtifactSet;\r\n\r\nexport const CHARACTER_INPUT_TEMPLATE = {\r\n    character: 'アンバー' as TCharacterKey,\r\n    characterMaster: {} as TCharacterDetail,\r\n    突破レベル: 6,\r\n    レベル: 90,\r\n    命ノ星座: 0,\r\n    通常攻撃レベル: 8,\r\n    元素スキルレベル: 8,\r\n    元素爆発レベル: 8,\r\n    weapon: '西風猟弓' as TWeaponKey,\r\n    weaponMaster: {} as TWeaponDetail,\r\n    武器突破レベル: 6,\r\n    武器レベル: 90,\r\n    武器精錬ランク: 1,\r\n    artifactSets: ['NONE' as TArtifactSetKey, 'NONE' as TArtifactSetKey],\r\n    artifactSetMasters: [ARTIFACT_SET_MASTER_DUMMY, ARTIFACT_SET_MASTER_DUMMY] as TArtifactSetEntry[],\r\n    damageDetailMyCharacter: null as TDamageDetail | null,\r\n    damageDetailMyWeapon: null as TDamageDetail | null,\r\n    damageDetailMyArtifactSets: null as TDamageDetail | null,\r\n    buildname: '',\r\n    recommendationSelectedIndex: 0,\r\n    saveDisabled: true,     // ローカルストレージへの構成保存不可か？\r\n    removeDisabled: true,   // ローカルストレージの構成削除不可か？\r\n};\r\nexport type TCharacterInput = typeof CHARACTER_INPUT_TEMPLATE;\r\n\r\nexport const ARTIFACT_DETAIL_INPUT_TEMPLATE = {\r\n    聖遺物メイン効果: ['', '', '', '', ''],\r\n    聖遺物優先するサブ効果: ['', '', ''],\r\n    聖遺物優先するサブ効果上昇値: Array.from(GENSEN_MASTER_LIST[2].values),     // 厳選1ヶ月\r\n    聖遺物優先するサブ効果上昇回数: Array.from(GENSEN_MASTER_LIST[2].counts),   // 厳選1ヶ月\r\n    聖遺物ステータス: deepcopy(聖遺物ステータスTEMPLATE),\r\n    聖遺物ステータスメイン効果: deepcopy(聖遺物ステータスTEMPLATE),\r\n    聖遺物ステータスサブ効果: deepcopy(聖遺物ステータスTEMPLATE),\r\n    聖遺物優先するサブ効果Disabled: false,\r\n};\r\nexport type TArtifactDetailInput = typeof ARTIFACT_DETAIL_INPUT_TEMPLATE;\r\n\r\nexport type TCheckboxEntry = {\r\n    name: string;\r\n    displayName?: string,\r\n};\r\nexport type TSelectEntry = {\r\n    name: string;\r\n    displayName?: string,\r\n    options: string[];\r\n    required: boolean;\r\n};\r\nexport type TConditionValues = {\r\n    [key: string]: boolean | number | null,\r\n};\r\nexport type TConditionAdjustments = {\r\n    [key: string]: number | null,\r\n};\r\nexport const CONDITION_INPUT_TEMPLATE = {\r\n    checkboxList: [] as TCheckboxEntry[],\r\n    selectList: [] as TSelectEntry[],\r\n    conditionValues: {} as TConditionValues,\r\n    conditionAdjustments: {} as TConditionAdjustments,\r\n    攻撃元素: [null, null, null] as (string | null)[],\r\n};\r\nexport type TConditionInput = typeof CONDITION_INPUT_TEMPLATE;\r\n\r\nexport const STATS_INPUT_TEMPLATE = {\r\n    statsObj: deepcopy(ステータスTEMPLATE) as TStats,\r\n    statAdjustments: deepcopy(ステータスTEMPLATE) as TStats,\r\n    enemyMaster: ENEMY_MASTER_LIST[0] as TEnemyEntry,\r\n};\r\nfor (const stat of Object.keys(STATS_INPUT_TEMPLATE.statAdjustments)) {\r\n    STATS_INPUT_TEMPLATE.statAdjustments[stat] = 0;\r\n}\r\nexport type TStatsInput = typeof STATS_INPUT_TEMPLATE;\r\n\r\nexport const OPTION_INPUT_TEMPLATE = {\r\n    elementalResonance: {\r\n        conditionValues: {} as TConditionValues,\r\n        conditionAdjustments: {} as TConditionAdjustments,\r\n    },\r\n    supporterList: [],\r\n    isSupporterOptionOpened: {} as { [key: string]: boolean },\r\n    teamOption: deepcopy(CONDITION_INPUT_TEMPLATE) as TConditionInput,\r\n    miscOption: deepcopy(CONDITION_INPUT_TEMPLATE) as TConditionInput,\r\n};\r\nexport type TOptionInput = typeof OPTION_INPUT_TEMPLATE;\r\n\r\nexport const SUPPORTER_INPUT_TEMPLATE = {\r\n    characterInput: deepcopy(CHARACTER_INPUT_TEMPLATE) as TCharacterInput,\r\n    artifactDetailInput: deepcopy(ARTIFACT_DETAIL_INPUT_TEMPLATE) as TArtifactDetailInput,\r\n    conditionInput: deepcopy(CONDITION_INPUT_TEMPLATE) as TConditionInput,\r\n    statusInput: deepcopy(STATS_INPUT_TEMPLATE) as TStatsInput,\r\n};\r\nexport type TSupporterInput = typeof SUPPORTER_INPUT_TEMPLATE;\r\n\r\n/** レベル文字列（1+,20,20+,...,90）を突破レベルとレベルに分割します */\r\nexport function parseLevelStr(levelStr: number | string): [number, number] {\r\n    try {\r\n        let level: number;\r\n        if (isString(levelStr)) {\r\n            level = Number(String(levelStr).replace('+', ''));\r\n        } else {\r\n            level = Number(levelStr);\r\n        }\r\n        let ascension = 0;\r\n        for (let i = (突破レベルレベルARRAY.length - 1); i >= 0; i--) {\r\n            ascension = i;\r\n            if (突破レベルレベルARRAY[i][0] > level) continue;\r\n            if (突破レベルレベルARRAY[i][0] == level && !String(levelStr).endsWith('+')) {\r\n                ascension--;\r\n            }\r\n            break;\r\n        }\r\n        return [ascension, level];\r\n    } catch (error) {\r\n        console.error(levelStr);\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport type TRecommendation = {\r\n    name: string,\r\n    build: any,\r\n    overwrite: boolean\r\n}\r\n\r\nexport function makeDefaultBuildname(character: any) {\r\n    return 'あなたの' + character;\r\n}\r\n\r\n/** おすすめセットのリストを作成します. [おすすめセットの名前, おすすめセットの内容, 上書き可不可][] */\r\nexport function makeRecommendationList(characterMaster: { [key: string]: any }, opt_buildData?: { [key: string]: any }): TRecommendation[] {\r\n    const result: TRecommendation[] = [];\r\n\r\n    const character = characterMaster['名前'];\r\n    let isSavable: boolean | null = null;\r\n\r\n    if (opt_buildData) {\r\n        result.push({ name: 'IMPORTED DATA', build: opt_buildData, overwrite: false });\r\n        isSavable = true;\r\n        console.log(opt_buildData);\r\n    }\r\n\r\n    const storageKeyArr: string[] = [];\r\n    Object.keys(localStorage).forEach(key => {\r\n        if (key.startsWith('構成_' + character)) {\r\n            storageKeyArr.push(key);\r\n            if (isSavable == null) {\r\n                isSavable = false;\r\n            }\r\n        }\r\n    });\r\n    storageKeyArr.sort();\r\n    const re = new RegExp('^構成_' + character + '_');\r\n    storageKeyArr.forEach(key => {\r\n        let buildname;\r\n        if (key == '構成_' + character) {\r\n            buildname = makeDefaultBuildname(character);\r\n        } else {\r\n            buildname = key.replace(re, '');\r\n        }\r\n        const buildObj = JSON.parse(localStorage[key]);\r\n        const key2 = 'オプション' + key;\r\n        if (key2 in localStorage) {\r\n            const optionsObj = JSON.parse(localStorage[key2]);\r\n            buildObj.options = optionsObj;\r\n        }\r\n        const key3 = key.replace(/^構成/, 'ArtifactScoring');\r\n        if (key3 in localStorage) {\r\n            const artifactScoringObj = JSON.parse(localStorage[key3]);\r\n            buildObj.artifactScoring = artifactScoringObj;\r\n        }\r\n        result.push({ name: buildname, build: buildObj, overwrite: true });\r\n    });\r\n\r\n    characterMaster['おすすめセット'].forEach((obj: { [key: string]: any }) => {\r\n        const myRecommendation = obj;\r\n        ['聖遺物優先するサブ効果1', '聖遺物優先するサブ効果2', '聖遺物優先するサブ効果3'].forEach(stat => {\r\n            if (!(stat in obj)) {\r\n                obj[stat] = null;\r\n            }\r\n        });\r\n        const artifactRarerityArrArr = [[5, 5, 5, 5, 5], [4, 4, 5, 5, 5], [4, 4, 4, 5, 4]];\r\n        let artifactRarerity4Num = 0;\r\n        const artifactSet1 = myRecommendation['聖遺物セット効果1'] as TArtifactSetKey;\r\n        const artifactSet2 = myRecommendation['聖遺物セット効果2'] as TArtifactSetKey;\r\n        if (ARTIFACT_SET_MASTER[artifactSet1]['レアリティ'] == 4) {\r\n            artifactRarerity4Num++;\r\n        }\r\n        if (ARTIFACT_SET_MASTER[artifactSet2]['レアリティ'] == 4) {\r\n            artifactRarerity4Num++;\r\n        }\r\n        for (let i = 0; i < 2; i++) {\r\n            const name = '聖遺物メイン効果' + (i + 1);\r\n            if (!(name in myRecommendation)) {\r\n                if (i == 0) {\r\n                    myRecommendation[name] = artifactRarerityArrArr[artifactRarerity4Num][i] + '_HP';\r\n                } else if (i == 1) {\r\n                    myRecommendation[name] = artifactRarerityArrArr[artifactRarerity4Num][i] + '_攻撃力';\r\n                }\r\n            }\r\n        }\r\n\r\n        let buildname = myRecommendation['武器'];\r\n        buildname += ' ';\r\n        if (myRecommendation['聖遺物セット効果1'] == myRecommendation['聖遺物セット効果2']) {\r\n            buildname += myRecommendation['聖遺物セット効果1'];\r\n        } else {\r\n            buildname += makeArtifactSetAbbrev(myRecommendation['聖遺物セット効果1']);\r\n            buildname += '/';\r\n            buildname += makeArtifactSetAbbrev(myRecommendation['聖遺物セット効果2']);\r\n        }\r\n        buildname += ' [';\r\n        for (let i = 3; i <= 5; i++) {\r\n            const statusName = myRecommendation['聖遺物メイン効果' + i].split('_')[1];\r\n            if (RECOMMEND_ABBREV_MAP.has(statusName)) {\r\n                buildname += RECOMMEND_ABBREV_MAP.get(statusName);\r\n            } else {\r\n                buildname += statusName.substring(0, 1);\r\n            }\r\n        }\r\n        buildname += ']';\r\n        result.push({ name: buildname, build: myRecommendation, overwrite: false });\r\n    });\r\n\r\n    return result;\r\n}\r\n\r\n/** 聖遺物セット名の略称を作成します */\r\nfunction makeArtifactSetAbbrev(name: string): string {\r\n    const abbrRe = /[\\p{sc=Hiragana}\\p{sc=Katakana}ー]+/ug;\r\n    let abbr = name.replace(abbrRe, '');\r\n    if (abbr.length > 2) {\r\n        abbr = name.split(abbrRe).sort((a, b) => {\r\n            return b.length - a.length;\r\n        })[0];\r\n    }\r\n    if (abbr.length > 3) {\r\n        abbr = abbr.substring(0, 2);\r\n    }\r\n    return abbr;\r\n}\r\n\r\nexport function makePrioritySubstatValueList(\r\n    prioritySubstats: TArtifactSubKey[],\r\n    index: number,\r\n    opt_substat?: TArtifactSubKey\r\n) {\r\n    const result: number[] = [];\r\n    if (prioritySubstats[index]) {\r\n        if (!opt_substat) opt_substat = prioritySubstats[index];\r\n        if (opt_substat && opt_substat in ARTIFACT_SUB_MASTER) {\r\n            const valueArr = ARTIFACT_SUB_MASTER[opt_substat];\r\n            for (let i = 0; i < valueArr.length; i++) {\r\n                result.push(valueArr[i]);\r\n                if (i < valueArr.length - 1) {\r\n                    const diff = valueArr[i + 1] - valueArr[i];\r\n                    result.push(valueArr[i] + diff / 2);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/** おすすめセットをロードします */\r\nexport async function loadRecommendation(\r\n    characterInput: TCharacterInput,\r\n    artifactDetailInput: TArtifactDetailInput,\r\n    conditionInput: TConditionInput,\r\n    optionInput: TOptionInput,\r\n    build: { [key: string]: any }\r\n) {\r\n    try {\r\n        const character = characterInput.character;\r\n        const characterMaster = await getCharacterMasterDetail(character);\r\n        characterInput.characterMaster = characterMaster;\r\n        const artifactStatsSub = deepcopy(聖遺物ステータスTEMPLATE);\r\n\r\n        if ('レベル' in build) {\r\n            [characterInput.突破レベル, characterInput.レベル] = parseLevelStr(build['レベル']);\r\n        }\r\n        ['命ノ星座', '通常攻撃レベル', '元素スキルレベル', '元素爆発レベル'].forEach(key => {\r\n            if (key in build) {\r\n                (characterInput as any)[key] = Number(build[key]);\r\n            }\r\n        });\r\n\r\n        const weaponType = characterMaster['武器'];\r\n        if ('武器' in build) {\r\n            if (Object.keys(WEAPON_MASTER[weaponType]).includes(build['武器'])) {\r\n                characterInput.weapon = build['武器'] as TWeaponKey;\r\n            } else {\r\n                characterInput.weapon = Object.keys(WEAPON_MASTER[weaponType]).filter(s => s.startsWith('西風'))[0] as TWeaponKey;\r\n            }\r\n            characterInput.weaponMaster = await getWeaponMasterDetail(characterInput.weapon, weaponType);\r\n        }\r\n        if ('武器レベル' in build) {\r\n            [characterInput.武器突破レベル, characterInput.武器レベル] = parseLevelStr(build['武器レベル']);\r\n        }\r\n        if ('精錬ランク' in build) {\r\n            characterInput.武器精錬ランク = Number(build['精錬ランク']);\r\n        }\r\n\r\n        let prioritySubstatsDisabled = false;\r\n        for (const key of Object.keys(build).filter((s: string) => s.startsWith('聖遺物サブ効果'))) {\r\n            let toKey = key.replace(/^聖遺物サブ効果/, '');\r\n            if (toKey != 'HP') toKey = toKey.replace(/P$/, '%');\r\n            if (build[key] || build[key] == 0) {\r\n                prioritySubstatsDisabled = true;\r\n                artifactStatsSub[toKey] = Number(build[key]);\r\n            }\r\n        }\r\n        artifactDetailInput.聖遺物優先するサブ効果Disabled = prioritySubstatsDisabled;\r\n\r\n        ['聖遺物セット効果1', '聖遺物セット効果2'].forEach((key, index) => {\r\n            if (!(key in build)) return;\r\n            const artifactSet = build[key] as TArtifactSetKey;\r\n            if (artifactSet && artifactSet in ARTIFACT_SET_MASTER) {\r\n                characterInput.artifactSets[index] = artifactSet;\r\n                characterInput.artifactSetMasters[index] = ARTIFACT_SET_MASTER[artifactSet] as TArtifactSetEntry;\r\n            } else {\r\n                characterInput.artifactSetMasters[index] = ARTIFACT_SET_MASTER_DUMMY as TArtifactSetEntry;\r\n            }\r\n        });\r\n\r\n        ['聖遺物メイン効果1', '聖遺物メイン効果2'].forEach((key, index) => {\r\n            if (key in build) {\r\n                artifactDetailInput['聖遺物メイン効果'][index] = build[key];\r\n            } else {\r\n                artifactDetailInput['聖遺物メイン効果'][index] = ['5_HP', '5_攻撃力'][index];\r\n            }\r\n        });\r\n        ['聖遺物メイン効果3', '聖遺物メイン効果4', '聖遺物メイン効果5'].forEach((key, index) => {\r\n            if (!(key in build)) return;\r\n            const mainstat = build[key];\r\n            artifactDetailInput['聖遺物メイン効果'][index + 2] = mainstat;\r\n        });\r\n        // for (const entry of artifactDetailInput['聖遺物メイン効果']) {\r\n        //     const [rarity, stat] = entry.split('_');\r\n        //     artifactStatsMain[stat] += (ARTIFACT_MAIN_MASTER as any)[rarity][stat];\r\n        // }\r\n        // overwriteObject(artifactDetailInput.聖遺物ステータスメイン効果, artifactStatsMain);\r\n\r\n        if (!prioritySubstatsDisabled) {\r\n            ['聖遺物優先するサブ効果1', '聖遺物優先するサブ効果2', '聖遺物優先するサブ効果3'].forEach((key, index) => {\r\n                if (!(key in build)) return;\r\n                const substat = build[key];\r\n                artifactDetailInput['聖遺物優先するサブ効果'][index] = substat;\r\n            });\r\n            ['聖遺物優先するサブ効果1上昇値', '聖遺物優先するサブ効果2上昇値', '聖遺物優先するサブ効果3上昇値'].forEach((key, index) => {\r\n                let doUpdate = false;\r\n                if (artifactDetailInput['聖遺物優先するサブ効果'][index]) {\r\n                    if ((key in build) && isNumber(build[key])) {\r\n                        doUpdate = true;\r\n                    }\r\n                }\r\n                if (doUpdate) {\r\n                    const substatValue = Number(build[key]);\r\n                    const substat = artifactDetailInput['聖遺物優先するサブ効果'][index] as TArtifactSubKey;\r\n                    const prioritySubstatValueList = makePrioritySubstatValueList([substat], 0);\r\n                    prioritySubstatValueList.forEach((v, i) => {\r\n                        if (substatValue <= v) {\r\n                            artifactDetailInput['聖遺物優先するサブ効果上昇値'][index] = i;\r\n                        }\r\n                    })\r\n                } else {\r\n                    if (artifactDetailInput['聖遺物優先するサブ効果'][index] && !artifactDetailInput['聖遺物優先するサブ効果上昇値'][index]) {\r\n                        artifactDetailInput['聖遺物優先するサブ効果上昇値'][index] = GENSEN_MASTER_LIST[2].values[index];\r\n                    }\r\n                }\r\n            });\r\n            ['聖遺物優先するサブ効果1上昇回数', '聖遺物優先するサブ効果2上昇回数', '聖遺物優先するサブ効果3上昇回数'].forEach((key, index) => {\r\n                let doUpdate = false;\r\n                if (artifactDetailInput['聖遺物優先するサブ効果'][index]) {\r\n                    if ((key in build) && isNumber(build[key])) {\r\n                        doUpdate = true;\r\n                    }\r\n                }\r\n                if (doUpdate) {\r\n                    const substatCount = Number(build[key]);\r\n                    artifactDetailInput['聖遺物優先するサブ効果上昇回数'][index] = substatCount;\r\n                } else {\r\n                    if (artifactDetailInput['聖遺物優先するサブ効果'][index] && !artifactDetailInput['聖遺物優先するサブ効果上昇回数'][index]) {\r\n                        artifactDetailInput['聖遺物優先するサブ効果上昇回数'][index] = GENSEN_MASTER_LIST[2].counts[index];\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        Object.keys(build).filter(s => !キャラクター構成PROPERTY_MAP.has(s) && !['options', 'artifactScoring'].includes(s)).forEach(key => {\r\n            if (build[key] == null) {\r\n                conditionInput.conditionValues[key] = build[key];   // null\r\n            } else if (isString(build[key])) {\r\n                conditionInput.conditionValues[key] = Number(build[key]);\r\n            } else {\r\n                conditionInput.conditionValues[key] = build[key];\r\n            }\r\n        });\r\n\r\n        if ('options' in build) {\r\n            const keys = Object.keys(build.options);\r\n            if (keys.length) {\r\n                overwriteObject(optionInput.elementalResonance.conditionValues, {});\r\n                overwriteObject(optionInput.teamOption.conditionValues, {});\r\n                overwriteObject(optionInput.miscOption.conditionValues, {});\r\n                keys.forEach(key => {\r\n                    if (key in ELEMENTAL_RESONANCE_MASTER || key == 'dendroOption') {\r\n                        // 元素共鳴\r\n                        optionInput.elementalResonance.conditionValues[key] = build.options[key];\r\n                    } else {\r\n                        const astarIndex = key.indexOf('*');\r\n                        if (astarIndex != -1) {\r\n                            const workCharacter = key.substring(0, astarIndex);\r\n                            if (workCharacter in CHARACTER_MASTER) {\r\n                                // チーム\r\n                                optionInput.teamOption.conditionValues[key] = build.options[key];\r\n                            } else {\r\n                                // その他\r\n                                optionInput.miscOption.conditionValues[key] = build.options[key];\r\n                            }\r\n                        } else {\r\n                            // その他\r\n                            optionInput.miscOption.conditionValues[key] = build.options[key];\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n        }\r\n\r\n        overwriteObject(artifactDetailInput.聖遺物ステータスサブ効果, artifactStatsSub);\r\n\r\n        console.debug('loadRecommendation', characterInput, artifactDetailInput, conditionInput, build);\r\n    }\r\n    catch (error) {\r\n        console.error(characterInput, artifactDetailInput, conditionInput, build);\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport function makeSavedata(characterInput: TCharacterInput, artifactDetailInput: TArtifactDetailInput, conditionInput: TConditionInput) {\r\n    const resultObj = {} as any;\r\n\r\n    // キャラクター\r\n    resultObj['キャラクター'] = characterInput.character;\r\n    // レベル\r\n    resultObj['レベル'] = characterInput.レベル + (突破レベルレベルARRAY[characterInput.突破レベル][0] == characterInput.レベル ? '+' : '');\r\n    // 命ノ星座\r\n    resultObj['命ノ星座'] = characterInput.命ノ星座;\r\n    // 通常攻撃レベル\r\n    resultObj['通常攻撃レベル'] = characterInput.通常攻撃レベル;\r\n    // 元素スキルレベル\r\n    resultObj['元素スキルレベル'] = characterInput.元素スキルレベル;\r\n    // 元素爆発レベル\r\n    resultObj['元素爆発レベル'] = characterInput.元素爆発レベル;\r\n    // 武器\r\n    resultObj['武器'] = characterInput.weapon;\r\n    // 武器レベル\r\n    resultObj['武器レベル'] = characterInput.武器レベル + (突破レベルレベルARRAY[characterInput.突破レベル][0] == characterInput.武器レベル ? '+' : '');\r\n    // 精錬ランク\r\n    resultObj['精錬ランク'] = characterInput.武器精錬ランク;\r\n    // 聖遺物セット効果1\r\n    resultObj['聖遺物セット効果1'] = characterInput.artifactSets[0];\r\n    // 聖遺物セット効果2\r\n    resultObj['聖遺物セット効果2'] = characterInput.artifactSets[1];\r\n    // 聖遺物メイン効果1\r\n    resultObj['聖遺物メイン効果1'] = artifactDetailInput.聖遺物メイン効果[0];\r\n    // 聖遺物メイン効果2\r\n    resultObj['聖遺物メイン効果2'] = artifactDetailInput.聖遺物メイン効果[1];\r\n    // 聖遺物メイン効果3\r\n    resultObj['聖遺物メイン効果3'] = artifactDetailInput.聖遺物メイン効果[2];\r\n    // 聖遺物メイン効果4\r\n    resultObj['聖遺物メイン効果4'] = artifactDetailInput.聖遺物メイン効果[3];\r\n    // 聖遺物メイン効果5\r\n    resultObj['聖遺物メイン効果5'] = artifactDetailInput.聖遺物メイン効果[4];\r\n    // 聖遺物サブ効果HP\r\n    resultObj['聖遺物サブ効果HP'] = artifactDetailInput.聖遺物ステータスサブ効果['HP'];\r\n    // 聖遺物サブ効果攻撃力\r\n    resultObj['聖遺物サブ効果攻撃力'] = artifactDetailInput.聖遺物ステータスサブ効果['攻撃力'];\r\n    // 聖遺物サブ効果防御力\r\n    resultObj['聖遺物サブ効果防御力'] = artifactDetailInput.聖遺物ステータスサブ効果['防御力'];\r\n    // 聖遺物サブ効果元素熟知\r\n    resultObj['聖遺物サブ効果元素熟知'] = artifactDetailInput.聖遺物ステータスサブ効果['元素熟知'];\r\n    // 聖遺物サブ効果会心率\r\n    resultObj['聖遺物サブ効果会心率'] = artifactDetailInput.聖遺物ステータスサブ効果['会心率'];\r\n    // 聖遺物サブ効果会心ダメージ\r\n    resultObj['聖遺物サブ効果会心ダメージ'] = artifactDetailInput.聖遺物ステータスサブ効果['会心ダメージ'];\r\n    // 聖遺物サブ効果元素チャージ効率\r\n    resultObj['聖遺物サブ効果元素チャージ効率'] = artifactDetailInput.聖遺物ステータスサブ効果['元素チャージ効率'];\r\n    // 聖遺物サブ効果HPP\r\n    resultObj['聖遺物サブ効果HPP'] = artifactDetailInput.聖遺物ステータスサブ効果['HP%'];\r\n    // 聖遺物サブ効果攻撃力P\r\n    resultObj['聖遺物サブ効果攻撃力P'] = artifactDetailInput.聖遺物ステータスサブ効果['攻撃力%'];\r\n    // 聖遺物サブ効果防御力P\r\n    resultObj['聖遺物サブ効果防御力P'] = artifactDetailInput.聖遺物ステータスサブ効果['防御力%'];\r\n    // 聖遺物優先するサブ効果1\r\n    resultObj['聖遺物優先するサブ効果1'] = artifactDetailInput.聖遺物優先するサブ効果[0];\r\n    // 聖遺物優先するサブ効果1上昇値\r\n    resultObj['聖遺物優先するサブ効果1上昇値'] = artifactDetailInput.聖遺物優先するサブ効果上昇値[0];\r\n    // 聖遺物優先するサブ効果1上昇回数\r\n    resultObj['聖遺物優先するサブ効果1上昇回数'] = artifactDetailInput.聖遺物優先するサブ効果上昇回数[0];\r\n    // 聖遺物優先するサブ効果2\r\n    resultObj['聖遺物優先するサブ効果2'] = artifactDetailInput.聖遺物優先するサブ効果[1];\r\n    // 聖遺物優先するサブ効果2上昇値\r\n    resultObj['聖遺物優先するサブ効果2上昇値'] = artifactDetailInput.聖遺物優先するサブ効果上昇値[1];\r\n    // 聖遺物優先するサブ効果2上昇回数\r\n    resultObj['聖遺物優先するサブ効果2上昇回数'] = artifactDetailInput.聖遺物優先するサブ効果上昇回数[1];\r\n    // 聖遺物優先するサブ効果3\r\n    resultObj['聖遺物優先するサブ効果3'] = artifactDetailInput.聖遺物優先するサブ効果[2];\r\n    // 聖遺物優先するサブ効果3上昇値\r\n    resultObj['聖遺物優先するサブ効果3上昇値'] = artifactDetailInput.聖遺物優先するサブ効果上昇値[2];\r\n    // 聖遺物優先するサブ効果3上昇回数\r\n    resultObj['聖遺物優先するサブ効果3上昇回数'] = artifactDetailInput.聖遺物優先するサブ効果上昇回数[2];\r\n\r\n    for (const entry of conditionInput.checkboxList) {\r\n        resultObj[entry.name] = conditionInput.conditionValues[entry.name];\r\n    }\r\n    for (const entry of conditionInput.selectList) {\r\n        resultObj[entry.name] = conditionInput.conditionValues[entry.name];\r\n    }\r\n\r\n    return resultObj;\r\n}\r\n\r\nexport function makeOptionsSavedata(character: string, optionInput: TOptionInput) {\r\n    const resultObj = {} as any;\r\n\r\n    // 元素共鳴\r\n    {\r\n        const conditionValues = optionInput.elementalResonance.conditionValues;\r\n        Object.keys(conditionValues).forEach(key => {\r\n            if (conditionValues[key]) {\r\n                resultObj[key] = conditionValues[key];\r\n            }\r\n        })\r\n    }\r\n\r\n    // チーム\r\n    {\r\n        const conditionValues = optionInput.teamOption.conditionValues;\r\n        Object.keys(conditionValues).forEach(key => {\r\n            if (key.startsWith(character + '*')) return;\r\n            if (conditionValues[key]) {\r\n                resultObj[key] = conditionValues[key];\r\n            }\r\n        })\r\n    }\r\n\r\n    // その他\r\n    {\r\n        const conditionValues = optionInput.miscOption.conditionValues;\r\n        Object.keys(conditionValues).forEach(key => {\r\n            if (conditionValues[key]) {\r\n                resultObj[key] = conditionValues[key];\r\n            }\r\n        })\r\n    }\r\n\r\n    return resultObj;\r\n}\r\n\r\nexport const CHANGE_KIND_STATUS = 'ステータス変更系詳細';\r\nexport const CHANGE_KIND_TALENT = '天賦性能変更系詳細';\r\n\r\nexport function makeDamageDetailObjArrObjCharacter(characterInput: TCharacterInput): TDamageDetail {\r\n    try {\r\n        const characterMaster = characterInput.characterMaster as any;\r\n\r\n        const result = {} as any;\r\n\r\n        let myTalentDetail;\r\n        let myTalentLevel: number;\r\n        let myDefaultKind: string | null;\r\n        let myDefaultElement: string | null;\r\n        const myInputCategory = 'キャラクター';\r\n\r\n        const myStatusChangeDetailObjArr = [] as any[];\r\n        const myTalentChangeDetailObjArr = [] as any[];\r\n\r\n        // 通常攻撃 重撃 落下攻撃\r\n        myTalentLevel = characterInput['通常攻撃レベル'];\r\n        myDefaultElement = characterMaster['武器'] === '法器' ? characterMaster['元素'] : null;\r\n        ['通常攻撃', '重撃', '落下攻撃'].forEach(category => {\r\n            myTalentDetail = characterMaster[category];\r\n            myDefaultKind = category + 'ダメージ';\r\n            result[category] = makeDamageDetailObjArr(myTalentDetail, myTalentLevel, myDefaultKind, myDefaultElement, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n        });\r\n\r\n        ['通常攻撃', '重撃', '落下攻撃'].forEach(category => {\r\n            const workCategory = '特殊' + category;\r\n            if (workCategory in characterMaster) {\r\n                myTalentDetail = characterMaster[workCategory];\r\n                if ('種類' in myTalentDetail) {\r\n                    myDefaultKind = myTalentDetail['種類'];\r\n                    switch (myDefaultKind) {\r\n                        case '元素スキルダメージ':\r\n                            myTalentLevel = characterInput['元素スキルレベル'];\r\n                            break;\r\n                        case '元素爆発ダメージ':\r\n                            myTalentLevel = characterInput['元素爆発レベル'];\r\n                            break;\r\n                    }\r\n                }\r\n                if ('元素' in myTalentDetail) {\r\n                    myDefaultElement = myTalentDetail['元素'];\r\n                }\r\n                const workObj = {\r\n                    条件: myTalentDetail['条件'],\r\n                    詳細: makeDamageDetailObjArr(myTalentDetail, myTalentLevel, myDefaultKind, myDefaultElement, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory)\r\n                };\r\n                result[workCategory] = workObj;\r\n            }\r\n        });\r\n\r\n        // 元素スキル\r\n        myTalentLevel = characterInput['元素スキルレベル'];\r\n        myDefaultKind = '元素スキルダメージ';\r\n        myDefaultElement = characterMaster['元素'];\r\n        result['元素スキル'] = makeDamageDetailObjArr(characterMaster['元素スキル'], myTalentLevel, myDefaultKind, myDefaultElement, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n\r\n        // 元素爆発\r\n        myTalentLevel = characterInput['元素爆発レベル'];\r\n        myDefaultKind = '元素爆発ダメージ';\r\n        myDefaultElement = characterMaster['元素'];\r\n        result['元素爆発'] = makeDamageDetailObjArr(characterMaster['元素爆発'], myTalentLevel, myDefaultKind, myDefaultElement, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n\r\n        result['その他'] = [] as TDamageDetailObj[];\r\n\r\n        // その他戦闘天賦\r\n        if ('その他戦闘天賦' in characterMaster) {\r\n            characterMaster['その他戦闘天賦'].forEach((myTalentDetail: any) => {\r\n                const workArr = makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n                if (workArr.length > 0) result['その他'].push(...workArr);\r\n            });\r\n        }\r\n\r\n        // 固有天賦\r\n        characterMaster['固有天賦'].forEach((myTalentDetail: any) => {\r\n            const workArr = makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n            if (workArr.length > 0) result['その他'].push(...workArr);\r\n        });\r\n\r\n        // 命ノ星座\r\n        if ('命ノ星座' in characterMaster) {\r\n            Object.keys(characterMaster['命ノ星座']).forEach(key => {\r\n                if (Number(key) > characterInput.命ノ星座) return;\r\n                myTalentDetail = characterMaster['命ノ星座'][key];\r\n                const workArr = makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n                if (workArr.length > 0) result['その他'].push(...workArr);\r\n            });\r\n        }\r\n\r\n        // 風元素キャラクター\r\n        if (characterMaster['元素'] == '風') {\r\n            if (myTalentChangeDetailObjArr.filter(s => s.条件 && s.条件.startsWith('拡散@')).length == 0) {\r\n                ['炎元素', '水元素', '雷元素', '氷元素'].forEach(cond => {\r\n                    myTalentChangeDetailObjArr.push({\r\n                        名前: null,\r\n                        種類: '固有変数',\r\n                        元素: null,\r\n                        数値: null,\r\n                        条件: '拡散@' + cond,\r\n                        対象: null,\r\n                        上限: null,\r\n                        HIT数: null,\r\n                        ダメージバフ: null,\r\n                        元素付与無効: null,\r\n                        除外条件: null,\r\n                        適用条件: null\r\n                    });\r\n                });\r\n            }\r\n            if ('オプション初期値' in characterMaster) {\r\n                if (Object.keys(characterMaster['オプション初期値']).filter(s => s == '拡散').length == 0) {\r\n                    characterMaster['オプション初期値']['拡散'] = 1;\r\n                }\r\n            } else {\r\n                characterMaster['オプション初期値'] = { 拡散: 1 };\r\n            }\r\n        }\r\n\r\n        result[CHANGE_KIND_STATUS] = myStatusChangeDetailObjArr;\r\n        result[CHANGE_KIND_TALENT] = myTalentChangeDetailObjArr;\r\n\r\n        const conditionMap = new Map();\r\n        const exclusionMap = new Map();\r\n        myStatusChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        myTalentChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        // conditionMap.delete('命ノ星座');\r\n        conditionMap.forEach((value, key) => {\r\n            if (value && Array.isArray(value)) {\r\n                if (!value[0].startsWith('required_')) {\r\n                    conditionMap.set(key, ['', ...value]);\r\n                }\r\n            }\r\n        });\r\n        result['条件'] = conditionMap;\r\n        result['排他'] = exclusionMap;\r\n\r\n        characterInput.damageDetailMyCharacter = result;\r\n\r\n        return result;\r\n    } catch (error) {\r\n        console.error(characterInput);\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport function makeDamageDetailObjArrObjWeapon(characterInput: any) {\r\n    try {\r\n        const name = characterInput.weapon;\r\n        const weaponMaster = characterInput.weaponMaster;\r\n\r\n        const result = {} as any;\r\n\r\n        if (!name || !weaponMaster) return result;\r\n\r\n        let myTalentDetail;\r\n        const myLevel = characterInput.武器精錬ランク;\r\n        const myInputCategory = '武器';\r\n\r\n        const myStatusChangeDetailObjArr = [] as any[];\r\n        const myTalentChangeDetailObjArr = [] as any[];\r\n\r\n        if ('武器スキル' in weaponMaster) {\r\n            myTalentDetail = weaponMaster['武器スキル'];\r\n            result['その他'] = makeDamageDetailObjArr(myTalentDetail, myLevel, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory);\r\n        }\r\n\r\n        result[CHANGE_KIND_STATUS] = myStatusChangeDetailObjArr;\r\n        result[CHANGE_KIND_TALENT] = myTalentChangeDetailObjArr;\r\n\r\n        const conditionMap = new Map();\r\n        const exclusionMap = new Map();\r\n        myStatusChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            let condition = detailObj['条件'];\r\n            if (isPlainObject(condition) && myLevel in condition) {\r\n                condition = condition[myLevel];\r\n            }\r\n            makeConditionExclusionMapFromStr(condition, conditionMap, exclusionMap);\r\n        });\r\n        myTalentChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            let condition = detailObj['条件'];\r\n            if (isPlainObject(condition) && myLevel in condition) {\r\n                condition = condition[myLevel];\r\n            }\r\n            makeConditionExclusionMapFromStr(condition, conditionMap, exclusionMap);\r\n        });\r\n        conditionMap.forEach((value, key) => {\r\n            if (value && Array.isArray(value)) {\r\n                if (!value[0].startsWith('required_')) {\r\n                    conditionMap.set(key, ['', ...value]);\r\n                }\r\n            }\r\n        });\r\n        result['条件'] = conditionMap;\r\n        result['排他'] = exclusionMap;\r\n\r\n        characterInput.damageDetailMyWeapon = result;\r\n\r\n        return result;\r\n    } catch (error) {\r\n        console.error(characterInput);\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport function makeDamageDetailObjArrObjArtifactSets(characterInput: any) {\r\n    try {\r\n        const result = [] as any;\r\n\r\n        let myTalentDetail;\r\n        const myInputCategory = '聖遺物セット効果';\r\n\r\n        const myStatusChangeDetailObjArr = [] as any[];\r\n        const myTalentChangeDetailObjArr = [] as any[];\r\n\r\n        const artifactSetMasters = characterInput.artifactSetMasters.filter((s: any) => s);\r\n\r\n        if (artifactSetMasters.length > 0) {\r\n            const damageDetailObjArr = [] as TDamageDetailObj[];\r\n            if ('2セット効果' in artifactSetMasters[0]) {\r\n                myTalentDetail = artifactSetMasters[0]['2セット効果'];\r\n                damageDetailObjArr.push(...makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory));\r\n            }\r\n            if (artifactSetMasters.length == 2) {\r\n                if (artifactSetMasters[0] == artifactSetMasters[1]) {\r\n                    myTalentDetail = artifactSetMasters[0]['4セット効果'];\r\n                    damageDetailObjArr.push(...makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory));\r\n                } else {\r\n                    myTalentDetail = artifactSetMasters[1]['2セット効果'];\r\n                    damageDetailObjArr.push(...makeDamageDetailObjArr(myTalentDetail, null, null, null, myStatusChangeDetailObjArr, myTalentChangeDetailObjArr, myInputCategory));\r\n                }\r\n            }\r\n            result['その他'] = damageDetailObjArr;\r\n        }\r\n\r\n        result[CHANGE_KIND_STATUS] = myStatusChangeDetailObjArr;\r\n        result[CHANGE_KIND_TALENT] = myTalentChangeDetailObjArr;\r\n\r\n        const conditionMap = new Map();\r\n        const exclusionMap = new Map();\r\n        myStatusChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        myTalentChangeDetailObjArr.filter(s => s['条件']).forEach(detailObj => {\r\n            makeConditionExclusionMapFromStr(detailObj['条件'], conditionMap, exclusionMap);\r\n        });\r\n        conditionMap.forEach((value, key) => {\r\n            if (value && Array.isArray(value)) {\r\n                if (!value[0].startsWith('required_')) {\r\n                    conditionMap.set(key, ['', ...value]);\r\n                }\r\n            }\r\n        });\r\n        result['条件'] = conditionMap;\r\n        result['排他'] = exclusionMap;\r\n\r\n        characterInput.damageDetailMyArtifactSets = result;\r\n\r\n        return result;\r\n    } catch (error) {\r\n        console.error(characterInput);\r\n        throw error;\r\n    }\r\n}\r\n\r\nconst makeDetailObj = function (\r\n    detailObj: any,\r\n    level: number | null,\r\n    defaultKind: string | null,\r\n    defaultElement: string | null,\r\n    inputCategory: string | null,\r\n    opt_condition?: string,\r\n): TDamageDetailObj {\r\n    let my種類 = '種類' in detailObj ? detailObj['種類'] : defaultKind;\r\n    let my対象 = null;\r\n    if (my種類.indexOf('.') != -1) {\r\n        my対象 = my種類.substring(my種類.indexOf('.') + 1);\r\n        my種類 = my種類.substring(0, my種類.indexOf('.'));\r\n    } else if ('対象' in detailObj) {\r\n        my対象 = detailObj['対象'];\r\n    }\r\n    let my数値 = null;\r\n    if ('数値' in detailObj) {\r\n        my数値 = detailObj['数値'];\r\n        if (isNumber(my数値) || isString(my数値)) {\r\n            // nop\r\n        } else if (isPlainObject(my数値) && level && level in my数値) { // キャラクター|武器のサブステータス\r\n            my数値 = my数値[level];\r\n        } else {\r\n            console.error(detailObj, level, defaultKind, defaultElement, my数値);\r\n        }\r\n        if (DAMAGE_CATEGORY_ARRAY.includes(my種類 + 'ダメージ') || my種類.endsWith('ダメージ')) {\r\n            my数値 = analyzeFormulaStr(my数値, '攻撃力');\r\n        } else {\r\n            my数値 = analyzeFormulaStr(my数値, my種類);\r\n        }\r\n    }\r\n    let my条件 = null;\r\n    if ('条件' in detailObj) {\r\n        if (isPlainObject(detailObj['条件']) && level && level in detailObj['条件']) {  // 武器は精錬ランクによって数値を変えたいときがあるので\r\n            my条件 = detailObj['条件'][level];\r\n        } else {\r\n            my条件 = detailObj['条件'];\r\n        }\r\n    } else {\r\n        my条件 = opt_condition ?? null;\r\n    }\r\n    let my上限 = null;\r\n    if ('上限' in detailObj) {\r\n        my上限 = detailObj['上限'];\r\n        if (isPlainObject(my上限) && level && level in my上限) {   // 草薙の稲光\r\n            my上限 = my上限[level];\r\n        }\r\n        my上限 = analyzeFormulaStr(my上限);\r\n    }\r\n    const resultObj: TDamageDetailObj = {\r\n        名前: detailObj['名前'],\r\n        種類: my種類,\r\n        元素: '元素' in detailObj ? detailObj['元素'] : defaultElement,\r\n        数値: my数値,\r\n        条件: my条件,\r\n        対象: my対象,\r\n        上限: my上限,\r\n        HIT数: 'HIT数' in detailObj ? detailObj['HIT数'] : null,\r\n        ダメージバフ: 'ダメージバフ' in detailObj ? detailObj['ダメージバフ'] : null,\r\n        元素付与無効: '元素付与無効' in detailObj ? detailObj['元素付与無効'] : inputCategory == '武器',\r\n        除外条件: '除外条件' in detailObj ? detailObj['除外条件'] : null,\r\n        適用条件: '適用条件' in detailObj ? detailObj['適用条件'] : null,\r\n    }\r\n    return resultObj;\r\n}\r\n\r\nexport function getChangeKind(kind: string) {\r\n    if (kind in ステータスTEMPLATE\r\n        || new RegExp('[自全].+(バフ|アップ)').exec(kind)\r\n        || new RegExp('敵?[自全]元素耐性').exec(kind)\r\n        || ['別枠乗算', '回復量アップ'].includes(kind)\r\n        || ['敵防御力'].includes(kind)\r\n        || ['発動回数', '使用回数'].includes(kind)\r\n        || ['攻撃速度', '通常攻撃速度', '移動速度'].includes(kind)\r\n        || kind.endsWith('継続時間')\r\n        || kind.endsWith('クールタイム')\r\n        || kind.endsWith('会心率')\r\n        || kind.endsWith('会心ダメージ')\r\n    ) {\r\n        return 'STATUS';\r\n    } else if (kind.endsWith('強化')\r\n        || kind.endsWith('付与')\r\n        || kind == '防御無視' ||\r\n        kind == '固有変数'\r\n    ) {   // ex.元素爆発強化,氷元素付与\r\n        return 'TALENT';\r\n    }\r\n    return undefined;\r\n}\r\n\r\nexport const makeDamageDetailObjArr = function (\r\n    talentDataObj: any,\r\n    level: number | null,\r\n    defaultKind: string | null,\r\n    defaultElement: string | null,\r\n    statusChangeDetailObjArr: any[],\r\n    talentChangeDetailObjArr: any[],\r\n    inputCategory: string,\r\n    opt_condition?: string,\r\n): TDamageDetailObj[] {\r\n    const resultArr = [] as any[];\r\n    if (!('詳細' in talentDataObj)) return resultArr;\r\n\r\n    talentDataObj['詳細'].forEach((detailObj: { [x: string]: any; }) => {\r\n        const resultObj = makeDetailObj(detailObj, level, defaultKind, defaultElement, inputCategory, opt_condition);\r\n        const my種類 = resultObj.種類 as string;\r\n        if (statusChangeDetailObjArr != null && getChangeKind(my種類) == 'STATUS') {\r\n            resultObj['元素'] = '元素' in detailObj ? detailObj['元素'] : null;\r\n            statusChangeDetailObjArr.push(resultObj);\r\n            return;\r\n        }\r\n        if (talentChangeDetailObjArr != null && getChangeKind(my種類) == 'TALENT') {\r\n            resultObj['元素'] = '元素' in detailObj ? detailObj['元素'] : null;\r\n            talentChangeDetailObjArr.push(resultObj);\r\n            return;\r\n        }\r\n        resultArr.push(resultObj);\r\n    });\r\n\r\n    return resultArr;\r\n}\r\n\r\nexport const makeTeamOptionDetailObjArr = function (\r\n    detailObjArr: any[],\r\n): TDamageDetailObj[] {\r\n    const resultArr = [] as any[];\r\n\r\n    detailObjArr.forEach((detailObj: { [x: string]: any; }) => {\r\n        const resultObj = makeDetailObj(detailObj, null, null, null, null);\r\n        if (resultObj) {\r\n            resultArr.push(resultObj);\r\n        }\r\n    });\r\n\r\n    return resultArr;\r\n}\r\n\r\nexport const makeConditionExclusionMapFromStr = function (conditionStr: string, conditionMap: Map<string, string[] | null>, exclusionMap: Map<string, string[] | null>) {\r\n    // 排他条件を抽出します\r\n    let exclusionCond: string | null = null;\r\n    let myCondStrArr = conditionStr.split('^');\r\n    if (myCondStrArr.length > 1) {\r\n        exclusionCond = myCondStrArr[1];\r\n    }\r\n    const myCondStr = myCondStrArr[0];\r\n    if (myCondStr.indexOf('|') != -1) {\r\n        // OR条件 for 申鶴\r\n        myCondStrArr = myCondStr.split('|');\r\n        myCondStrArr.forEach((myCondStr: string) => {\r\n            makeConditionExclusionMapFromStrSub(myCondStr, conditionMap, exclusionMap, exclusionCond);\r\n        });\r\n    } else {\r\n        // AND条件\r\n        myCondStrArr = myCondStr.split('&');\r\n        myCondStrArr.forEach((myCondStr: string) => {\r\n            makeConditionExclusionMapFromStrSub(myCondStr, conditionMap, exclusionMap, exclusionCond);\r\n        });\r\n    }\r\n}\r\n\r\nfunction makeConditionExclusionMapFromStrSub(conditionStr: string, conditionMap: Map<string, string[] | null>, exclusionMap: Map<string, string[] | null>, exclusion: string | null) {\r\n    const myCondStrArr = conditionStr.split(/[@=]/);\r\n    const myName = myCondStrArr[0];\r\n    if (myCondStrArr.length == 1) {\r\n        pushToMapValueArray(conditionMap, myName, null);\r\n    } else if (myCondStrArr.length == 2) {\r\n        if (myCondStrArr[1].indexOf(',') != -1) {\r\n            const re = new RegExp('([^0-9]*?)([\\\\+\\\\-0-9\\\\.,]+)(.*)');  // 表現可能:-10,+60%\r\n            const reRet = re.exec(myCondStrArr[1]);\r\n            if (reRet) {\r\n                const prefix = reRet[1];\r\n                const condValueArr = reRet[2].split(',');\r\n                const postfix = reRet[3];\r\n                condValueArr.forEach(value => {\r\n                    pushToMapValueArray(conditionMap, myName, prefix + value + postfix);\r\n                });\r\n            }\r\n        } else if (myCondStrArr[1].indexOf('-') != -1) {\r\n            const re = new RegExp('([^0-9\\\\.]*)(-?[0-9\\\\.]+)-(-?[0-9\\\\.]+)(.*)');   // 数値部に+は含められない。prefixには含められる。\r\n            const re2 = new RegExp('/([0-9\\\\.]+)(.*)');\r\n            const reRet = re.exec(myCondStrArr[1]);\r\n            if (reRet) {\r\n                const prefix = reRet[1];\r\n                const rangeStart = Number(reRet[2]);\r\n                const rangeEnd = Number(reRet[3]);\r\n                let step = rangeStart;\r\n                let postfix = reRet[4];\r\n                if (postfix) {\r\n                    const re2Ret = re2.exec(postfix);\r\n                    if (re2Ret) {\r\n                        step = Number(re2Ret[1]);\r\n                        postfix = re2Ret[2];\r\n                    }\r\n                }\r\n                for (let i = rangeStart; i < rangeEnd; i = addDecimal(i, step, rangeEnd)) {\r\n                    pushToMapValueArray(conditionMap, myName, prefix + String(i) + postfix);\r\n                }\r\n                pushToMapValueArray(conditionMap, myName, prefix + String(rangeEnd) + postfix);\r\n            } else {\r\n                pushToMapValueArray(conditionMap, myName, myCondStrArr[1]);\r\n            }\r\n        } else {\r\n            pushToMapValueArray(conditionMap, myName, myCondStrArr[1]);\r\n        }\r\n    } else {\r\n        console.error(conditionStr, conditionMap, exclusionMap);\r\n    }\r\n    if (exclusion) {\r\n        exclusion.split(',').forEach(e => {\r\n            pushToMapValueArray(exclusionMap, myName, e);\r\n        });\r\n    }\r\n}\r\n\r\nexport function setupConditionValues(conditionInput: TConditionInput, characterInput: TCharacterInput) {\r\n    try {\r\n        const conditionValues = conditionInput.conditionValues;\r\n        const checkboxList = conditionInput.checkboxList as TCheckboxEntry[];\r\n        const selectList = conditionInput.selectList as TSelectEntry[];\r\n\r\n        checkboxList.splice(0, checkboxList.length);\r\n        selectList.splice(0, selectList.length);\r\n\r\n        const masters = [characterInput.characterMaster, characterInput.weaponMaster, ...characterInput.artifactSetMasters];\r\n        for (const master of masters.filter(s => s)) {\r\n            if ('オプション初期値' in master) {\r\n                for (const key of Object.keys((master as any)['オプション初期値'])) {\r\n                    if (!(key in conditionValues)) {\r\n                        conditionValues[key] = (master as any)['オプション初期値'][key];\r\n                    }\r\n                }\r\n            }\r\n            // 聖遺物セット効果のオプション初期値は変な位置にあります\r\n            if ('4セット効果' in master && 'オプション初期値' in (master as any)['4セット効果']) {\r\n                for (const key of Object.keys((master as any)['4セット効果']['オプション初期値'])) {\r\n                    if (!(key in conditionValues)) {\r\n                        conditionValues[key] = (master as any)['4セット効果']['オプション初期値'][key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        for (const myDamageDetail of [characterInput.damageDetailMyCharacter, characterInput.damageDetailMyWeapon, characterInput.damageDetailMyArtifactSets]) {\r\n            if (myDamageDetail) {\r\n                const conditionMap: Map<string, any[] | null> = myDamageDetail.条件;\r\n                const exclusionMap: Map<string, string[] | null> = myDamageDetail.排他;\r\n\r\n                conditionMap.forEach((value: string[] | null, key: string) => {\r\n                    if (value == null) {\r\n                        if (checkboxList.filter(s => s.name == key).length == 0) {\r\n                            checkboxList.push({ name: key });\r\n                        }\r\n                    } else {\r\n                        if (selectList.filter(s => s.name == key).length == 0) {\r\n                            const required = value[0].startsWith(\"required_\");\r\n                            selectList.push({\r\n                                name: key,\r\n                                options: value,\r\n                                required: required,\r\n                            });\r\n                        }\r\n                    }\r\n\r\n                    if (key in conditionValues && conditionValues[key] != null) {\r\n                        const exclusions = exclusionMap.get(key);\r\n                        if (exclusions) {\r\n                            for (const exclusion of exclusions) {\r\n                                if (exclusion in conditionValues) {\r\n                                    const conditionValue = conditionMap.get(exclusion);\r\n                                    if (conditionValue !== undefined) {\r\n                                        if (conditionValue === null) {  // checkbox\r\n                                            conditionValues[exclusion] = false;\r\n                                        } else {    // select\r\n                                            conditionValues[exclusion] = 0;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (value === null) {   // checkbox\r\n                            let checked = true;\r\n                            const arr = exclusionMap.get(key);\r\n                            if (arr && arr.filter(s => conditionValues[s]).length > 0) {\r\n                                checked = false;\r\n                            }\r\n                            conditionValues[key] = checked;\r\n                        } else {   // select\r\n                            let selectedIndex = value.length - 1;\r\n                            const arr = exclusionMap.get(key);\r\n                            if (arr && arr.filter(s => conditionValues[s]).length > 0) {\r\n                                selectedIndex = 0;\r\n                            }\r\n                            conditionValues[key] = selectedIndex;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    } catch (error) {\r\n        console.error(conditionInput, characterInput);\r\n        throw error;\r\n    }\r\n}\r\n\r\nfunction pushToMapValueArray(map: Map<any, any>, key: any, value: any) {\r\n    if (value == null) {\r\n        if (!map.has(key)) {\r\n            map.set(key, null);\r\n        }\r\n    } else if (map.has(key)) {\r\n        const oldValue = map.get(key);\r\n        if (oldValue == null) {\r\n            map.set(key, [value]);\r\n        } else if (!oldValue.includes(value)) {\r\n            map.get(key).push(value);\r\n        }\r\n    } else {\r\n        map.set(key, [value]);\r\n    }\r\n}\r\n\r\nfunction getDecimalLength(value: number): number {\r\n    const arr = ('' + value).split('.');\r\n    return arr.length > 1 ? arr[1].length : 0;\r\n}\r\n\r\nexport function multiplyDecimal(value1: number, value2: number): number {\r\n    const decimalLength = getDecimalLength(value1) + getDecimalLength(value2);\r\n    const intValue1 = Number(('' + value1).replace('.', ''));\r\n    const intValue2 = Number(('' + value2).replace('.', ''));\r\n    const result = (intValue1 * intValue2) / Math.pow(10, decimalLength);\r\n    return Number(result);\r\n}\r\n\r\nexport function addDecimal(value1: number, value2: number, opt_max?: number): number {\r\n    const k = Math.pow(10, Math.max(getDecimalLength(value1), getDecimalLength(value2)));\r\n    let result = (multiplyDecimal(value1, k) + multiplyDecimal(value2, k)) / k;\r\n    if (opt_max != undefined) {\r\n        result = Math.min(result, opt_max);\r\n    }\r\n    return result;\r\n}\r\n\r\nconst analyzeFormulaStr = function (formulaStr: number | string, opt_defaultItem: string | null = null) {\r\n    const resultArr = [] as any[];\r\n    const re = new RegExp('([\\\\+\\\\-\\\\*/]?)([^\\\\+\\\\-\\\\*/]+)(.*)');\r\n    let workStr = String(formulaStr);\r\n    // eslint-disable-next-line no-constant-condition\r\n    while (true) {\r\n        const reRet = re.exec(workStr);\r\n        if (!reRet) {\r\n            resultArr.push(workStr);\r\n            break;\r\n        }\r\n        if (reRet[1]) { // + - * /\r\n            resultArr.push(reRet[1]);\r\n        }\r\n        resultArr.push(analyzeFormulaStrSub(reRet[2], opt_defaultItem));\r\n        if (!reRet[3]) {\r\n            break;\r\n        }\r\n        workStr = reRet[3];\r\n    }\r\n    return resultArr;\r\n}\r\n\r\nfunction analyzeFormulaStrSub(formulaStr: string, opt_defaultItem: string | null = null) {\r\n    const resultArr = [] as any;\r\n    if (isNumber(formulaStr)) {\r\n        resultArr.push(Number(formulaStr));\r\n    } else {\r\n        const strArr = (formulaStr as string).split('%');\r\n        if (strArr.length == 1) {\r\n            resultArr.push(strArr[0]);\r\n        } else {\r\n            resultArr.push(Number(strArr[0]) / 100);\r\n            resultArr.push('*');\r\n            if (strArr[1].length > 0) {\r\n                resultArr.push(strArr[1]);\r\n            } else if (opt_defaultItem != null) {\r\n                resultArr.push(opt_defaultItem);\r\n            }\r\n        }\r\n    }\r\n    return resultArr;\r\n}\r\n\r\nexport function makeSharedata(savedata: TAnyObject) {\r\n    const sharedataArr = [] as any[];\r\n\r\n    let character: TCharacterKey;\r\n    let weaponType: TWeaponTypeKey;\r\n\r\n    キャラクター構成PROPERTY_MAP.forEach((value, key) => {\r\n        let newValue = savedata[key];\r\n        let myBasename;\r\n        switch (key) {\r\n            case 'キャラクター':\r\n                character = newValue as TCharacterKey;\r\n                myBasename = basename(CHARACTER_MASTER[character]['import']);\r\n                newValue = myBasename.split('_')[myBasename.split('_').length - 1];\r\n                break;\r\n            case '武器':\r\n                weaponType = CHARACTER_MASTER[character]['武器'] as TWeaponTypeKey;\r\n                myBasename = basename((WEAPON_MASTER as any)[weaponType][newValue]['import']);\r\n                newValue = myBasename.split('_')[myBasename.split('_').length - 1];\r\n                break;\r\n            case '聖遺物セット効果1':\r\n            case '聖遺物セット効果2':\r\n                if (newValue == 'NONE') {\r\n                    newValue = '';  // 聖遺物セット効果なし\r\n                } else {\r\n                    myBasename = basename(ARTIFACT_SET_MASTER[newValue as TArtifactSetKey]['image']);\r\n                    newValue = myBasename.split('_')[myBasename.split('_').length - 1];\r\n                }\r\n                break;\r\n            case '聖遺物メイン効果1':\r\n            case '聖遺物メイン効果2':\r\n            case '聖遺物メイン効果3':\r\n            case '聖遺物メイン効果4':\r\n            case '聖遺物メイン効果5':\r\n                if (newValue) {\r\n                    newValue = newValue.split('_')[0] + '_' + ARTIFACT_STAT_JA_EN_ABBREV_MAP.get(newValue.split('_')[1]);\r\n                }\r\n                break;\r\n            case '聖遺物優先するサブ効果1':\r\n            case '聖遺物優先するサブ効果2':\r\n            case '聖遺物優先するサブ効果3':\r\n                if (newValue) {\r\n                    newValue = ARTIFACT_STAT_JA_EN_ABBREV_MAP.get(newValue);\r\n                }\r\n                break;\r\n        }\r\n        sharedataArr.push(newValue);\r\n    });\r\n    Object.keys(savedata).forEach(key => {\r\n        if (!キャラクター構成PROPERTY_MAP.has(key)) {\r\n            sharedataArr.push(key + '=' + savedata[key]);\r\n        }\r\n    });\r\n\r\n    return sharedataArr.join(',');\r\n}\r\n\r\nfunction openTwitter(text: string, url: string, opt_hashtags?: string, opt_via?: string) {\r\n    const baseUrl = 'https://twitter.com/intent/tweet?';\r\n    const params = new URLSearchParams();\r\n    params.append('text', text);\r\n    params.append('url', url);\r\n    if (opt_hashtags) {\r\n        params.append('hashtags', opt_hashtags);\r\n    }\r\n    if (opt_via) {\r\n        params.append('via', opt_via);\r\n    }\r\n    const query = params.toString();\r\n    const shareUrl = `${baseUrl}${query}`;\r\n    console.log(params);\r\n    console.log(shareUrl);\r\n    window.open(shareUrl);\r\n}\r\n\r\nexport function shareByTwitter(characterInput: TCharacterInput, artifactDetailInput: TArtifactDetailInput, conditionInput: TConditionInput) {\r\n    const savedata = makeSavedata(characterInput, artifactDetailInput, conditionInput);\r\n    const sharedata = makeSharedata(savedata);\r\n\r\n    const text = characterInput.buildname;\r\n    const encoded = encodeURI(sharedata);\r\n    const url = 'https://asagume.github.io/gencalc/' + '?allin=' + encoded;\r\n\r\n    openTwitter(text, url);\r\n}\r\n\r\nexport function getMaxConstellation(characterMaster: TCharacterDetail) {\r\n    let max = 0;\r\n    if ('命ノ星座' in characterMaster) {\r\n        max = Object.keys(characterMaster.命ノ星座).length;\r\n    }\r\n    return max;\r\n}\r\n\r\nexport function getMaxTalentLevel(characterMaster: TCharacterDetail, key: string) {\r\n    let max = 10;\r\n    if (key in characterMaster) {\r\n        const talentObj = (characterMaster as any)[key];\r\n        if (\"詳細\" in talentObj) {\r\n            for (const detailObj of talentObj.詳細) {\r\n                if (\"数値\" in detailObj && isPlainObject(detailObj.数値)) {\r\n                    const work = Object.keys(detailObj.数値).length;\r\n                    if (max < work) max = work;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return max;\r\n}\r\n","export type TAnyObject = {\r\n    [key: string]: any\r\n}\r\n\r\nimport CHARACTER_MASTER from '../public/data/CharacterMaster.json'// assert {type: 'json'}\r\n\r\nimport SWORD_MASTER from '../public/data/SwordMaster.json'// assert {type: 'json'}\r\nimport CLAYMORE_MASTER from '../public/data/ClaymoreMaster.json'// assert {type: 'json'}\r\nimport POLEARM_MASTER from '../public/data/PolearmMaster.json'// assert {type: 'json'}\r\nimport BOW_MASTER from '../public/data/BowMaster.json'// assert {type: 'json'}\r\nimport CATALYST_MASTER from '../public/data/CatalystMaster.json'// assert {type: 'json'}\r\n\r\nimport ARTIFACT_SET_MASTER from '../public/data/ArtifactSetMaster.json'// assert {type: 'json'}\r\nimport ARTIFACT_MAIN_MASTER from '../public/data/ArtifactMainMaster.json'// assert {type: 'json'}\r\nimport ARTIFACT_SUB_MASTER from '../public/data/ArtifactSubMaster.json'// assert {type: 'json'}\r\n\r\nimport ENEMY_MASTER from '../public/data/EnemyMaster.json'// assert {type: 'json'}\r\n\r\nimport ELEMENTAL_RESONANCE_MASTER from '../public/data/ElementalResonanceMaster.json'// assert {type: 'json'}\r\nimport TEAM_OPTION_MASTER from '../public/data/TeamOptionMaster.json'// assert {type: 'json'}\r\nimport OPTION1_MASTER from '../public/data/OptionMaster1.json'// assert {type: 'json'}\r\nimport OPTION2_MASTER from '../public/data/OptionMaster2.json'// assert {type: 'json'}\r\n\r\nimport ELEMENTAL_REACTION_MASTER from '../public/data/ElementalReactionMaster.json'// assert {type: 'json'}\r\n\r\n// import HOYO_DICTIONARY2 from '../public/data/HoYoDictionary2.json'// assert {type: 'json'}\r\n// import HOYO_DICTIONARY4 from '../public/data/HoYoDictionary4.json'// assert {type: 'json'}\r\n// import HOYO_DICTIONARY5 from '../public/data/HoYoDictionary5.json'// assert {type: 'json'}\r\n// import LOCAL_DICTIONARY from '../public/data/LocalDictionary.json'// assert {type: 'json'}\r\n// import { isPlainObject, isString } from './common'\r\n\r\nexport {\r\n    CHARACTER_MASTER,\r\n    ARTIFACT_SET_MASTER,\r\n    ARTIFACT_MAIN_MASTER,\r\n    ARTIFACT_SUB_MASTER,\r\n    ENEMY_MASTER,\r\n    ELEMENTAL_RESONANCE_MASTER,\r\n    TEAM_OPTION_MASTER,\r\n    OPTION1_MASTER,\r\n    OPTION2_MASTER,\r\n    ELEMENTAL_REACTION_MASTER\r\n};\r\n\r\n// function removeStrFromUrl(obj: any, str: string) {\r\n//     if (isPlainObject(obj)) {\r\n//         for (const key of Object.keys(obj)) {\r\n//             if (isString(obj[key])) {\r\n//                 obj[key] = obj[key].replace(str, '');\r\n//             } else if (isPlainObject(obj[key])) {\r\n//                 removeStrFromUrl(obj[key], str);\r\n//             } else if (Array.isArray(obj[key])) {\r\n//                 for (const entry of obj[key]) {\r\n//                     removeStrFromUrl(entry, str);\r\n//                 }\r\n//             }\r\n//         }\r\n//     }\r\n// }\r\n\r\n// for (const master of [\r\n//     CHARACTER_MASTER,\r\n//     SWORD_MASTER,\r\n//     CLAYMORE_MASTER,\r\n//     POLEARM_MASTER,\r\n//     BOW_MASTER,\r\n//     CATALYST_MASTER,\r\n//     ARTIFACT_SET_MASTER\r\n// ]) {\r\n//     for (const key of Object.keys(master)) {\r\n//         removeStrFromUrl((master as any)[key], '');\r\n//     }\r\n// }\r\n\r\nexport const IMG_SRC_DUMMY = \"data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7\";\r\n\r\nexport type TVisionKey = '炎' | '水' | '風' | '雷' | '草' | '氷' | '岩';\r\nexport type TWeaponTypeKey = '片手剣' | '両手剣' | '長柄武器' | '弓' | '法器';\r\n\r\nexport type TCharacterMaster = typeof CHARACTER_MASTER;\r\nexport type TCharacter = {\r\n    レアリティ: 4 | 5,\r\n    元素: TVisionKey,\r\n    武器: TWeaponTypeKey,\r\n    誕生日?: string,\r\n    import: string,\r\n}\r\nexport type TCharacterKey = keyof typeof CHARACTER_MASTER\r\nexport type TCharacterEntry = TCharacter & {\r\n    key: TCharacterKey,\r\n    icon_url: string,\r\n}\r\n\r\nexport type TCharacterDetail = {\r\n    名前: TCharacterKey,\r\n    説明: string,\r\n    icon_url: string,\r\n    レアリティ: 4 | 5,\r\n    武器: TWeaponTypeKey,\r\n    元素: TVisionKey,\r\n    baseInfo: any,\r\n    ステータス: TCharacterStats,\r\n    通常攻撃: any,\r\n    重撃: any,\r\n    落下攻撃: any,\r\n    元素スキル: any,\r\n    元素爆発: any,\r\n    固有天賦: any[],\r\n    命ノ星座?: any,\r\n    特殊通常攻撃?: any,\r\n    特殊重撃?: any,\r\n    特殊落下攻撃?: any,\r\n    その他天賦?: any,\r\n    チームバフ?: any[],\r\n    オプション初期値?: any,\r\n    固有変数?: any,\r\n    おすすめセット: any[],\r\n}\r\nexport type TCharacterStats = {\r\n    基礎HP: {\r\n        [key: string]: number,\r\n    },\r\n    基礎攻撃力: {\r\n        [key: string]: number,\r\n    },\r\n    基礎防御力: {\r\n        [key: string]: number,\r\n    },\r\n    [key: string]: {\r\n        [key: string]: number,\r\n    }\r\n};\r\nexport type TLeveldValue = {\r\n    [key: number | string]: number,\r\n};\r\nexport type TTalentFormula = number | string | TLeveldValue;\r\nexport type TCharacterTalent = {\r\n    名前?: string,\r\n    詳細?: {\r\n        名前?: string,\r\n        種類?: string,\r\n        対象?: string,\r\n        条件?: string,\r\n    }[],\r\n    [key: string]: string | number | any[] | undefined,\r\n};\r\n\r\nexport type TWeaponRarity = 1 | 2 | 3 | 4 | 5;\r\nexport type TWeaponStats = {\r\n    基礎攻撃力: any,\r\n    [key: string]: any,\r\n}\r\nexport type TWeapon = {\r\n    レアリティ: TWeaponRarity,\r\n    import: string,\r\n}\r\nexport type TSwordKey = keyof typeof SWORD_MASTER;\r\nexport type TClaymoreKey = keyof typeof CLAYMORE_MASTER;\r\nexport type TPolearmKey = keyof typeof POLEARM_MASTER;\r\nexport type TBowKey = keyof typeof BOW_MASTER;\r\nexport type TCatalystKey = keyof typeof CATALYST_MASTER;\r\nexport type TWeaponKey = TSwordKey | TClaymoreKey | TPolearmKey | TBowKey | TCatalystKey;\r\nexport type TWeaponEntry = TWeapon & {\r\n    key: TWeaponKey,\r\n    icon_url: string,\r\n};\r\nexport const WEAPON_DETAIL_TEMPLATE = {\r\n    名前: '西風猟弓',\r\n    説明: '',\r\n    icon_url: IMG_SRC_DUMMY,\r\n    レアリティ: 4,\r\n    種類: '弓',\r\n    ステータス: {\r\n        基礎攻撃力: {}\r\n    },\r\n};\r\nexport type TWeaponDetail = {\r\n    名前: TWeaponKey,\r\n    説明: string,\r\n    icon_url: string,\r\n    レアリティ: TWeaponRarity,\r\n    種類: TWeaponTypeKey,\r\n    ステータス: TWeaponStats,\r\n    武器スキル?: any,\r\n    チームバフ?: any[],\r\n    オプション初期値?: any,\r\n    固有変数?: any,\r\n};\r\n\r\nexport type TArtifactSetEffect = {\r\n    説明: string,\r\n    詳細?: any[]\r\n};\r\nexport type TArtifactSetRarity = 1 | 2 | 3 | 4 | 5;\r\nexport type TArtifactSet = {\r\n    レアリティ: TArtifactSetRarity,\r\n    image: string,\r\n    '2セット効果'?: TArtifactSetEffect,\r\n    '4セット効果'?: TArtifactSetEffect,\r\n    オプション初期値?: { [key: string]: boolean | number }\r\n};\r\nexport type TArtifactSetKey = keyof typeof ARTIFACT_SET_MASTER;\r\nexport type TArtifactSetEntry = TArtifactSet & {\r\n    key: TArtifactSetKey,\r\n    icon_url: string,\r\n};\r\n\r\nexport type TArtifactMainStat = keyof typeof ARTIFACT_MAIN_MASTER[5]\r\nexport type TArtifactMainRarity = 4 | 5;\r\nexport type TArtifactMain = {\r\n    5: TArtifactMainStat,\r\n    4: TArtifactMainStat,\r\n};\r\n\r\nfunction getIconUrl(master: TAnyObject) {\r\n    if (master.icon_url) return master.icon_url;\r\n    if (master.image) return master.image;\r\n    if (master.import) {\r\n        let result = master.import.replace('data/', 'images/');\r\n        if (result.indexOf('characters/') != -1) {\r\n            result = result.replace('characters/', 'characters/face/');\r\n        }\r\n        result = result.replace(/json$/, 'png');\r\n        return result;\r\n    }\r\n    return null;\r\n}\r\n\r\nexport const CHARACTER_MASTER_LIST: TCharacterEntry[] = [];\r\n(Object.keys(CHARACTER_MASTER) as TCharacterKey[]).forEach(key => {\r\n    const master: any = CHARACTER_MASTER[key];\r\n    master.key = key;\r\n    master.icon_url = getIconUrl(master);\r\n    CHARACTER_MASTER_LIST.push(master);\r\n});\r\n\r\nexport const WEAPON_MASTER = {\r\n    片手剣: SWORD_MASTER,\r\n    両手剣: CLAYMORE_MASTER,\r\n    長柄武器: POLEARM_MASTER,\r\n    弓: BOW_MASTER,\r\n    法器: CATALYST_MASTER,\r\n};\r\n(Object.keys(WEAPON_MASTER) as TWeaponTypeKey[]).forEach(key2 => {\r\n    const typedMaster = WEAPON_MASTER[key2] as any; // お手上げ\r\n    Object.keys(typedMaster).forEach(key => {\r\n        const master = typedMaster[key];\r\n        master.key = key;\r\n        master.icon_url = getIconUrl(master);\r\n    });\r\n})\r\nconst SWORD_MASTER_LIST = (Object.keys(SWORD_MASTER) as TSwordKey[]).map(key => SWORD_MASTER[key]);\r\nconst CLAYMORE_MASTER_LIST = (Object.keys(CLAYMORE_MASTER) as TClaymoreKey[]).map(key => CLAYMORE_MASTER[key]);\r\nconst POLEARM_MASTER_LIST = (Object.keys(POLEARM_MASTER) as TPolearmKey[]).map(key => POLEARM_MASTER[key]);\r\nconst BOW_MASTER_LIST = (Object.keys(BOW_MASTER) as TBowKey[]).map(key => BOW_MASTER[key]);\r\nconst CATALYST_MASTER_LIST = (Object.keys(CATALYST_MASTER) as TCatalystKey[]).map(key => CATALYST_MASTER[key]);\r\nexport const WEAPON_MASTER_LIST = {\r\n    片手剣: SWORD_MASTER_LIST,\r\n    両手剣: CLAYMORE_MASTER_LIST,\r\n    長柄武器: POLEARM_MASTER_LIST,\r\n    弓: BOW_MASTER_LIST,\r\n    法器: CATALYST_MASTER_LIST,\r\n};\r\n\r\nexport const ARTIFACT_SET_MASTER_LIST: TArtifactSetEntry[] = [];\r\n(Object.keys(ARTIFACT_SET_MASTER) as TArtifactSetKey[]).forEach(key => {\r\n    const master = ARTIFACT_SET_MASTER[key] as any;\r\n    master.key = key;\r\n    master.icon_url = getIconUrl(master);\r\n    ARTIFACT_SET_MASTER_LIST.push(master);\r\n});\r\n\r\nexport const ARTIFACT_MAIN_MASTER_STATLIST: string[] = Object.keys(ARTIFACT_MAIN_MASTER[5]);\r\n\r\nexport const ARTIFACT_SUB_MASTER_STATLIST = Object.keys(ARTIFACT_SUB_MASTER);\r\nexport type TArtifactSubKey = keyof typeof ARTIFACT_SUB_MASTER;\r\n\r\nexport type TEnemy = {\r\n    炎元素耐性: number,\r\n    水元素耐性: number,\r\n    風元素耐性: number,\r\n    雷元素耐性: number,\r\n    草元素耐性: number,\r\n    氷元素耐性: number,\r\n    岩元素耐性: number,\r\n    物理耐性: number,\r\n    [key: string]: number,\r\n};\r\nexport type TEnemyKey = keyof typeof ENEMY_MASTER;\r\nexport type TEnemyEntry = TEnemy & {\r\n    key: TEnemyKey,\r\n};\r\nfor (const key of Object.keys(ENEMY_MASTER)) {\r\n    for (const stat of Object.keys((ENEMY_MASTER as any)[key])) {\r\n        if ((ENEMY_MASTER as any)[key][stat] >= 1000) { // 完全耐性\r\n            (ENEMY_MASTER as any)[key][stat] = Infinity;\r\n        }\r\n    }\r\n}\r\nexport const ENEMY_MASTER_LIST = (Object.keys(ENEMY_MASTER) as TEnemyKey[])\r\n    .map(key => ({ key: key, ...ENEMY_MASTER[key] }));\r\n\r\nexport type TElementalResonanceKey = keyof typeof ELEMENTAL_RESONANCE_MASTER;\r\nexport const ELEMENTAL_RESONANCE_MASTER_LIST = (Object.keys(ELEMENTAL_RESONANCE_MASTER) as TElementalResonanceKey[])\r\n    .map(key => ({ key: key, ...ELEMENTAL_RESONANCE_MASTER[key] }));\r\n\r\nexport type TTeamOptionKey = keyof typeof TEAM_OPTION_MASTER;\r\nexport const TEAM_OPTION_MASTER_LIST = (Object.keys(TEAM_OPTION_MASTER) as TTeamOptionKey[])\r\n    .map(key => ({ key: key, ...TEAM_OPTION_MASTER[key] }));\r\n\r\nexport type TOption1Key = keyof typeof OPTION1_MASTER;\r\nexport const OPTION1_MASTER_LIST = (Object.keys(OPTION1_MASTER) as TOption1Key[])\r\n    .map(key => ({ key: key, ...OPTION1_MASTER[key] }));\r\n\r\nexport type TOption2Key = keyof typeof OPTION2_MASTER;\r\nexport const OPTION2_MASTER_LIST = (Object.keys(OPTION2_MASTER) as TOption2Key[])\r\n    .map(key => ({ key: key, ...OPTION2_MASTER[key] }));\r\n\r\nexport type TElementalReactionKey = keyof typeof ELEMENTAL_REACTION_MASTER;\r\nexport const ELEMENTAL_REACTION_MASTER_LIST = (Object.keys(ELEMENTAL_REACTION_MASTER) as TElementalReactionKey[])\r\n    .map(key => ({ key: key, ...ELEMENTAL_REACTION_MASTER[key] }));\r\n\r\n// export const DICTIONARY_MASTER = { ...HOYO_DICTIONARY2, ...HOYO_DICTIONARY4, ...HOYO_DICTIONARY5, ...LOCAL_DICTIONARY };\r\n\r\n////////////////\r\n////////////////\r\nconst CHARACTER_MASTER_DETAIL_MAP = new Map();\r\n/**\r\n * \r\n * @param {string} character \r\n * @returns {Promise<any>}\r\n */\r\nexport async function getCharacterMasterDetail(character: TCharacterKey): Promise<TCharacterDetail> {\r\n    try {\r\n        if (!CHARACTER_MASTER_DETAIL_MAP.has(character)) {\r\n            const url = CHARACTER_MASTER[character]['import'].replace(/^\\//, '');\r\n            const characterMaster = await fetch(url).then(resp => resp.json());\r\n            // 通常攻撃の画像URLを共用のURLに差し替えます\r\n            const weaponType = CHARACTER_MASTER[character].武器 as TWeaponTypeKey;\r\n            characterMaster.通常攻撃.icon_url = WEAPON_IMG_SRC[weaponType];\r\n            CHARACTER_MASTER_DETAIL_MAP.set(character, characterMaster);\r\n        }\r\n        return CHARACTER_MASTER_DETAIL_MAP.get(character);\r\n    } catch (error) {\r\n        console.error(character);\r\n        throw error;\r\n    }\r\n}\r\n\r\nconst WEAPON_MASTER_DETAIL_MAP = new Map();\r\n/**\r\n * \r\n * @param weapon \r\n * @param opt_weaponType \r\n * @returns \r\n */\r\nexport async function getWeaponMasterDetail(weapon: TWeaponKey, opt_weaponType?: TWeaponTypeKey): Promise<TWeaponDetail> {\r\n    try {\r\n        if (!WEAPON_MASTER_DETAIL_MAP.has(weapon)) {\r\n            let weaponTypeArr;\r\n            if (opt_weaponType) weaponTypeArr = [opt_weaponType];\r\n            else weaponTypeArr = Object.keys(WEAPON_MASTER);\r\n            for (const weaponType of weaponTypeArr) {\r\n                if (weapon in WEAPON_MASTER[weaponType as TWeaponTypeKey]) {\r\n                    const typedMaster: any = WEAPON_MASTER[weaponType as TWeaponTypeKey];\r\n                    const url = typedMaster[weapon]['import'];\r\n                    const weaponMaster: any = await fetch(url).then(resp => resp.json());\r\n                    weaponMaster.種類 = weaponType; // 上書き\r\n                    WEAPON_MASTER_DETAIL_MAP.set(weapon, weaponMaster);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return WEAPON_MASTER_DETAIL_MAP.get(weapon);\r\n    } catch (error) {\r\n        console.error(weapon, opt_weaponType);\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport const ELEMENT_COLOR_CLASS = {\r\n    炎: 'pyro',\r\n    水: 'hydro',\r\n    風: 'anemo',\r\n    雷: 'electro',\r\n    草: 'dendro',\r\n    氷: 'cryo',\r\n    岩: 'geo'\r\n};\r\nexport type TElementColorClassKey = keyof typeof ELEMENT_COLOR_CLASS;\r\n\r\nexport const ELEMENT_BG_COLOR_CLASS = {\r\n    炎: 'pyro-bg',\r\n    水: 'hydro-bg',\r\n    風: 'anemo-bg',\r\n    雷: 'electro-bg',\r\n    草: 'dendro-bg',\r\n    氷: 'cryo-bg',\r\n    岩: 'geo-bg'\r\n};\r\n\r\nexport const ELEMENT_IMG_SRC = {\r\n    炎: 'images/element_pyro.png',\r\n    水: 'images/element_hydro.png',\r\n    風: 'images/element_anemo.png',\r\n    雷: 'images/element_electro.png',\r\n    草: 'images/element_dendro.png',\r\n    氷: 'images/element_cryo.png',\r\n    岩: 'images/element_geo.png'\r\n};\r\n\r\nexport const WEAPON_IMG_SRC = {\r\n    片手剣: 'images/characters/NormalAttack_sword.png',\r\n    両手剣: 'images/characters/NormalAttack_claymore.png',\r\n    長柄武器: 'images/characters/NormalAttack_polearm.png',\r\n    弓: 'images/characters/NormalAttack_bow.png',\r\n    法器: 'images/characters/NormalAttack_catalyst.png',\r\n};\r\n\r\nexport const STAR_BACKGROUND_IMAGE_CLASS = {\r\n    1: 'star1-bg',\r\n    2: 'star2-bg',\r\n    3: 'star3-bg',\r\n    4: 'star4-bg',\r\n    5: 'star5-bg'\r\n}\r\n\r\nexport const キャラクター構成PROPERTY_MAP = new Map([\r\n    ['キャラクター', null],\r\n    ['レベル', null],\r\n    ['命ノ星座', 0],\r\n    ['通常攻撃レベル', 0],\r\n    ['元素スキルレベル', 0],\r\n    ['元素爆発レベル', 0],\r\n    ['武器', null],\r\n    ['武器レベル', 0],\r\n    ['精錬ランク', 0],\r\n    ['聖遺物セット効果1', null],\r\n    ['聖遺物セット効果2', null],\r\n    ['聖遺物メイン効果1', null],\r\n    ['聖遺物メイン効果2', null],\r\n    ['聖遺物メイン効果3', null],\r\n    ['聖遺物メイン効果4', null],\r\n    ['聖遺物メイン効果5', null],\r\n    ['聖遺物サブ効果HP', 0],\r\n    ['聖遺物サブ効果攻撃力', 0],\r\n    ['聖遺物サブ効果防御力', 0],\r\n    ['聖遺物サブ効果元素熟知', 0],\r\n    ['聖遺物サブ効果会心率', 0],\r\n    ['聖遺物サブ効果会心ダメージ', 0],\r\n    ['聖遺物サブ効果元素チャージ効率', 0],\r\n    ['聖遺物サブ効果HPP', 0],\r\n    ['聖遺物サブ効果攻撃力P', 0],\r\n    ['聖遺物サブ効果防御力P', 0],\r\n    ['聖遺物優先するサブ効果1', null],\r\n    ['聖遺物優先するサブ効果1上昇値', -1],\r\n    ['聖遺物優先するサブ効果1上昇回数', -1],\r\n    ['聖遺物優先するサブ効果2', null],\r\n    ['聖遺物優先するサブ効果2上昇値', -1],\r\n    ['聖遺物優先するサブ効果2上昇回数', -1],\r\n    ['聖遺物優先するサブ効果3', null],\r\n    ['聖遺物優先するサブ効果3上昇値', -1],\r\n    ['聖遺物優先するサブ効果3上昇回数', -1]\r\n]);\r\n\r\nexport const DAMAGE_CATEGORY_ARRAY = ['通常攻撃ダメージ', '重撃ダメージ', '落下攻撃ダメージ', '元素スキルダメージ', '元素爆発ダメージ'];\r\n\r\nexport const RECOMMEND_ABBREV_MAP = new Map([\r\n    ['HP%', 'HP'], ['元素熟知', '熟'], ['元素チャージ効率', 'ﾁｬ'], ['会心率', '率'], ['会心ダメージ', 'ダ'], ['与える治療効果', '治']\r\n]);\r\n\r\nexport const RECOMMEND_ABBREV_EN_MAP = new Map([\r\n    ['HP%', 'HP'], ['攻撃力%', 'AT'], ['防御力%', 'DF'], ['元素熟知', 'EM'],\r\n    ['会心率', 'CR'], ['会心ダメージ', 'CD'], ['元素チャージ効率', 'ER'], ['与える治療効果', 'HE'],\r\n    ['炎元素ダメージバフ', 'Py'], ['水元素ダメージバフ', 'Hy'], ['風元素ダメージバフ', 'An'], ['雷元素ダメージバフ', 'El'], ['草元素ダメージバフ', 'De'], ['氷元素ダメージバフ', 'Cr'], ['岩元素ダメージバフ', 'Ge'], ['物理ダメージバフ', 'Ph'],\r\n]);\r\n\r\nexport const ARTIFACT_STAT_JA_EN_ABBREV_MAP = new Map([\r\n    ['HP', 'HP'],\r\n    ['攻撃力', 'ATK'],\r\n    ['防御力', 'DEF'],\r\n    ['元素熟知', 'ElementalMastery'],\r\n    ['会心率', 'CritRate'],\r\n    ['会心ダメージ', 'CritDMG'],\r\n    ['元素チャージ効率', 'EnergyRecharge'],\r\n    ['炎元素ダメージバフ', 'Pyro'],\r\n    ['水元素ダメージバフ', 'Hydro'],\r\n    ['風元素ダメージバフ', 'Anemo'],\r\n    ['雷元素ダメージバフ', 'Electro'],\r\n    ['草元素ダメージバフ', 'Dendro'],\r\n    ['氷元素ダメージバフ', 'Cryo'],\r\n    ['岩元素ダメージバフ', 'Geo'],\r\n    ['物理ダメージバフ', 'Physical'],\r\n    ['与える治療効果', 'Healing'],\r\n    ['HP%', 'HPp'],\r\n    ['攻撃力%', 'ATKp'],\r\n    ['防御力%', 'DEFp']\r\n]);\r\n\r\nexport const ARTIFACT_STAT_JA_EN_ABBREV_REVERSE_MAP = new Map();\r\nARTIFACT_STAT_JA_EN_ABBREV_MAP.forEach((value, key) => {\r\n    ARTIFACT_STAT_JA_EN_ABBREV_REVERSE_MAP.set(value, key);\r\n});\r\n\r\nexport const GENSEN_MASTER_LIST = [\r\n    {\r\n        key: \"\",\r\n        values: [7, 7, 7],\r\n        counts: [0, 0, 0],\r\n    },\r\n    {\r\n        key: \"厳選初心者\",\r\n        values: [3, 3, 3],\r\n        counts: [7, 4, 4],\r\n    },\r\n    {\r\n        key: \"厳選1ヶ月\",\r\n        values: [3, 3, 3],\r\n        counts: [8, 5, 5],\r\n    },\r\n    {\r\n        key: \"厳選3ヶ月\",\r\n        values: [3, 3, 3],\r\n        counts: [11, 8, 7],\r\n    },\r\n    {\r\n        key: \"日々石割り\",\r\n        values: [1, 1, 1],\r\n        counts: [14, 11, 10],\r\n    },\r\n];\r\nexport type TGensen = { key: string; values: number[]; counts: number[] };\r\n\r\n","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelRadio as _vModelRadio, createElementVNode as _createElementVNode, withDirectives as _withDirectives, toDisplayString as _toDisplayString, vModelText as _vModelText, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, vShow as _vShow, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-442e1d91\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"base-container\" }\nconst _hoisted_2 = { class: \"pane1\" }\nconst _hoisted_3 = { class: \"display-stat-select\" }\nconst _hoisted_4 = [\"value\"]\nconst _hoisted_5 = { class: \"number-of-teams\" }\nconst _hoisted_6 = /*#__PURE__*/_createTextVNode(\" Number of teams \")\nconst _hoisted_7 = [\"min\"]\nconst _hoisted_8 = { class: \"pane2\" }\nconst _hoisted_9 = { class: \"character-select\" }\nconst _hoisted_10 = { class: \"pane3\" }\nconst _hoisted_11 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"pane4\" }, null, -1))\nconst _hoisted_12 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"footer\" }, null, -1))\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_CharacterSelect = _resolveComponent(\"CharacterSelect\")!\n  const _component_TeamItem = _resolveComponent(\"TeamItem\")!\n  const _component_draggable = _resolveComponent(\"draggable\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.DISPLAY_STAT_LIST, (item) => {\n          return (_openBlock(), _createElementBlock(\"label\", {\n            key: item[1]\n          }, [\n            _withDirectives(_createElementVNode(\"input\", {\n              class: \"hidden\",\n              type: \"radio\",\n              name: \"display-stat\",\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.displayStat) = $event)),\n              value: item[0]\n            }, null, 8, _hoisted_4), [\n              [_vModelRadio, _ctx.displayStat]\n            ]),\n            _createElementVNode(\"span\", null, _toDisplayString(item[1]), 1)\n          ]))\n        }), 128))\n      ]),\n      _createElementVNode(\"label\", _hoisted_5, [\n        _hoisted_6,\n        _withDirectives(_createElementVNode(\"input\", {\n          type: \"number\",\n          min: _ctx.NUMBER_OF_TEAMS,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.numberOfTeams) = $event)),\n          onChange: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.numberOfTeamsOnChange && _ctx.numberOfTeamsOnChange(...args)))\n        }, null, 40, _hoisted_7), [\n          [_vModelText, _ctx.numberOfTeams]\n        ])\n      ]),\n      _createElementVNode(\"div\", null, [\n        _createElementVNode(\"button\", {\n          type: \"button\",\n          onClick: _cache[3] || (_cache[3] = \n//@ts-ignore\n(...args) => (_ctx.save && _ctx.save(...args)))\n        }, \"Save\"),\n        _createElementVNode(\"button\", {\n          type: \"button\",\n          onClick: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.load && _ctx.load(...args)))\n        }, \"Reset\"),\n        _createElementVNode(\"button\", {\n          type: \"button\",\n          onClick: _cache[5] || (_cache[5] = \n//@ts-ignore\n(...args) => (_ctx.clear && _ctx.clear(...args)))\n        }, \"Clear\")\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_8, [\n      _withDirectives(_createElementVNode(\"div\", _hoisted_9, [\n        _createVNode(_component_CharacterSelect, {\n          visible: true,\n          characters: _ctx.memberNames,\n          \"onUpdate:characters\": _ctx.updateCharacters\n        }, null, 8, [\"characters\", \"onUpdate:characters\"]),\n        _createElementVNode(\"button\", {\n          type: \"button\",\n          onClick: _cache[6] || (_cache[6] = ($event: any) => (_ctx.characterSelectVisible = false))\n        }, \"hide\")\n      ], 512), [\n        [_vShow, _ctx.characterSelectVisible]\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_10, [\n      _createVNode(_component_draggable, {\n        list: _ctx.teams,\n        \"item-key\": \"id\",\n        sort: true,\n        handle: \".handle\"\n      }, {\n        item: _withCtx(({ element }) => [\n          _createVNode(_component_TeamItem, {\n            team: element,\n            selected: _ctx.teamSelected(element.id),\n            displayStat: _ctx.displayStat,\n            onClick: ($event: any) => (_ctx.teamOnClick(element.id)),\n            \"onChange:name\": _ctx.teamNameOnChange,\n            \"onChange:buildname\": _ctx.buildnameOnChange,\n            \"onClick:character\": ($event: any) => (_ctx.characterOnClick(element))\n          }, null, 8, [\"team\", \"selected\", \"displayStat\", \"onClick\", \"onChange:name\", \"onChange:buildname\", \"onClick:character\"])\n        ]),\n        _: 1\n      }, 8, [\"list\"])\n    ]),\n    _hoisted_11,\n    _hoisted_12\n  ]))\n}","import { makeDefaultBuildname } from \"@/input\";\r\nimport { CHARACTER_MASTER, TCharacterKey } from \"@/master\";\r\n\r\nexport type TMember = {\r\n    id: number;\r\n    name: string;\r\n    buildname: string | undefined;\r\n    savedata: any | undefined;\r\n};\r\n\r\nexport type TTeam = {\r\n    id: number;\r\n    name: string;\r\n    members: TMember[];\r\n};\r\n\r\nexport const NUMBER_OF_TEAMS = 10;\r\nexport const NUMBER_OF_MEMBERS = 4;\r\n\r\nexport function characterMaster(member: TMember) {\r\n    let result;\r\n    if (member.name && member.name in CHARACTER_MASTER) {\r\n        result = CHARACTER_MASTER[member.name as TCharacterKey];\r\n    }\r\n    return result;\r\n}\r\n\r\nconst BUILD_STORAGE_KEY_PREFIX = '構成_';\r\n\r\nexport function makeBuildStorageKey(character: string, buildname?: string) {\r\n    let result = BUILD_STORAGE_KEY_PREFIX + character;\r\n    if (buildname && buildname != makeDefaultBuildname(character)) {\r\n        result += '_' + buildname;\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getBuildnameFromStorageKey(storageKey: string) {\r\n    const work = storageKey.split('_');\r\n    const character = work[1];\r\n    work.splice(0, 2);\r\n    let result;\r\n    if (work.length > 0) {\r\n        result = work.join('_');\r\n    } else {\r\n        result = makeDefaultBuildname(character);\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getBuildStorageKeys(character?: string) {\r\n    return Object.keys(localStorage).filter(s => s.startsWith(BUILD_STORAGE_KEY_PREFIX + (character ?? '')));\r\n}\r\n\r\nexport function getBuilddataFromStorage(character: string, buildname?: string) {\r\n    let result;\r\n    const storageKey = makeBuildStorageKey(character, buildname);\r\n    const storageValue = localStorage.getItem(storageKey);\r\n    if (storageValue) result = JSON.parse(storageValue);\r\n    return result;\r\n}\r\n\r\n","import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, resolveComponent as _resolveComponent, createVNode as _createVNode, normalizeClass as _normalizeClass } from \"vue\"\n\nconst _hoisted_1 = { class: \"title handle\" }\nconst _hoisted_2 = { class: \"name\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", null, \"◇\", -1)\nconst _hoisted_4 = { key: 0 }\nconst _hoisted_5 = { key: 1 }\nconst _hoisted_6 = { class: \"element-resonance\" }\nconst _hoisted_7 = [\"src\"]\nconst _hoisted_8 = { class: \"members\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MemberItem = _resolveComponent(\"MemberItem\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass('team'+_ctx.selectedClass)\n  }, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createElementVNode(\"label\", _hoisted_2, [\n        _hoisted_3,\n        (_ctx.editable)\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, [\n              _withDirectives(_createElementVNode(\"input\", {\n                type: \"text\",\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.name) = $event)),\n                placeholder: \"INPUT TEAM NAME\",\n                onChange: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.nameOnChange && _ctx.nameOnChange(...args)))\n              }, null, 544), [\n                [_vModelText, _ctx.name]\n              ]),\n              _createElementVNode(\"span\", {\n                class: \"button material-symbols-outlined\",\n                onClick: _cache[2] || (_cache[2] = ($event: any) => (_ctx.editable=false))\n              }, \" edit_off \")\n            ]))\n          : (_openBlock(), _createElementBlock(\"span\", _hoisted_5, [\n              _createElementVNode(\"span\", null, _toDisplayString(_ctx.name), 1),\n              _createElementVNode(\"span\", {\n                class: \"button material-symbols-outlined\",\n                onClick: _cache[3] || (_cache[3] = ($event: any) => (_ctx.editable=true))\n              }, \" edit \")\n            ]))\n      ]),\n      _createElementVNode(\"div\", _hoisted_6, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.resonanceElementImgSrcs, (src) => {\n          return (_openBlock(), _createElementBlock(\"img\", {\n            class: \"element-resonance\",\n            key: src,\n            src: src,\n            alt: \"resonance\"\n          }, null, 8, _hoisted_7))\n        }), 128))\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_8, [\n      _createElementVNode(\"table\", null, [\n        _createElementVNode(\"tr\", null, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.team.members, (member) => {\n            return (_openBlock(), _createElementBlock(\"td\", {\n              key: member.id\n            }, [\n              _createVNode(_component_MemberItem, {\n                member: member,\n                \"onClick:character\": _ctx.characterOnClick,\n                \"onChange:buildname\": _ctx.changeBuildname\n              }, null, 8, [\"member\", \"onClick:character\", \"onChange:buildname\"])\n            ]))\n          }), 128))\n        ])\n      ])\n    ])\n  ], 2))\n}","import { normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vShow as _vShow, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelSelect as _vModelSelect, createCommentVNode as _createCommentVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"member\" }\nconst _hoisted_2 = [\"src\", \"alt\"]\nconst _hoisted_3 = [\"src\"]\nconst _hoisted_4 = [\"src\"]\nconst _hoisted_5 = [\"src\"]\nconst _hoisted_6 = [\"src\"]\nconst _hoisted_7 = { class: \"extra-control\" }\nconst _hoisted_8 = { key: 0 }\nconst _hoisted_9 = [\"value\"]\nconst _hoisted_10 = { key: 1 }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", {\n      class: \"member-img\",\n      onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.characterOnClick && _ctx.characterOnClick(...args)))\n    }, [\n      _createElementVNode(\"img\", {\n        class: _normalizeClass('character' + _ctx.characterImgClass),\n        src: _ctx.characterImgSrc,\n        alt: _ctx.displayName(_ctx.member.name)\n      }, null, 10, _hoisted_2),\n      _createElementVNode(\"img\", {\n        class: \"vision\",\n        src: _ctx.visionImgSrc,\n        alt: \"vision\"\n      }, null, 8, _hoisted_3),\n      _withDirectives(_createElementVNode(\"div\", { class: \"constellation\" }, _toDisplayString(_ctx.constellation), 513), [\n        [_vShow, _ctx.constellation]\n      ])\n    ]),\n    _createElementVNode(\"div\", null, _toDisplayString(_ctx.statValue), 1),\n    _createElementVNode(\"div\", null, [\n      _createElementVNode(\"img\", {\n        class: \"weapon\",\n        src: _ctx.imgWeaponSrc,\n        alt: \"weapon\"\n      }, null, 8, _hoisted_4),\n      _createElementVNode(\"img\", {\n        class: \"artifact-set\",\n        src: _ctx.imgArtifactSetSrc(0),\n        alt: \"artifact-set\"\n      }, null, 8, _hoisted_5),\n      _createElementVNode(\"img\", {\n        class: \"artifact-set\",\n        src: _ctx.imgArtifactSetSrc(1),\n        alt: \"artifact-set\"\n      }, null, 8, _hoisted_6)\n    ]),\n    _createElementVNode(\"div\", null, [\n      _createElementVNode(\"span\", {\n        class: \"button material-symbols-outlined\",\n        onClick: _cache[1] || (_cache[1] = ($event: any) => (_ctx.extraControl='buildname'))\n      }, \" manage_accounts \"),\n      _createElementVNode(\"span\", {\n        class: \"button material-symbols-outlined\",\n        onClick: _cache[2] || (_cache[2] = ($event: any) => (_ctx.extraControl='locate'))\n      }, \" edit_note \")\n    ]),\n    _createElementVNode(\"div\", _hoisted_7, [\n      (_ctx.extraControl=='buildname')\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n            _withDirectives(_createElementVNode(\"select\", {\n              \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((_ctx.buildname) = $event)),\n              onChange: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.buildnameOnChange && _ctx.buildnameOnChange(...args)))\n            }, [\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.buildnames, (value) => {\n                return (_openBlock(), _createElementBlock(\"option\", {\n                  key: value,\n                  value: value\n                }, _toDisplayString(value), 9, _hoisted_9))\n              }), 128))\n            ], 544), [\n              [_vModelSelect, _ctx.buildname]\n            ])\n          ]))\n        : _createCommentVNode(\"\", true),\n      (_ctx.extraControl=='locate')\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n            _createElementVNode(\"button\", {\n              type: \"button\",\n              onClick: _cache[5] || (_cache[5] = \n//@ts-ignore\n(...args) => (_ctx.locate && _ctx.locate(...args)))\n            }, \"open\")\n          ]))\n        : _createCommentVNode(\"\", true)\n    ])\n  ]))\n}","import { deepcopy, isNumber, isBoolean, isPlainObject, isString, overwriteObject } from \"@/common\";\r\nimport { CHANGE_KIND_STATUS, CHANGE_KIND_TALENT, DAMAGE_RESULT_TEMPLATE, TArtifactDetailInput, TCharacterInput, TConditionInput, TDamageResult, TDamageResultEntry, TOptionInput, TStats, TStatsInput, ステータスTEMPLATE, 元素ステータス_耐性ARRAY, 元素反応TEMPLATE, 基礎ステータスARRAY, 突破レベルレベルARRAY, 聖遺物サブ効果ARRAY } from \"@/input\";\r\nimport { ARTIFACT_MAIN_MASTER, ARTIFACT_SUB_MASTER, DAMAGE_CATEGORY_ARRAY, ELEMENTAL_REACTION_MASTER, TArtifactMainRarity, TArtifactMainStat } from \"@/master\";\r\n\r\n/** [突破レベル, レベル] => レベル\\+?  */\r\nexport function getLevelStr(ascension: number, level: number): string {\r\n    return level + 突破レベルレベルARRAY[ascension][0] == level ? '+' : '';\r\n}\r\n\r\n/** キャラクターのレベルに応じた（基礎/突破）ステータスを算出します */\r\nexport function getStatValueByLevel(statObj: any, ascension: number, level: number): number {\r\n    if (!statObj) return 0;\r\n    const myLevelStr = getLevelStr(ascension, level);\r\n    if (myLevelStr in statObj) {\r\n        return statObj[myLevelStr];\r\n    }\r\n    const lowLevel = 突破レベルレベルARRAY[ascension][0];\r\n    const highLevel = 突破レベルレベルARRAY[ascension][突破レベルレベルARRAY[ascension].length - 1];\r\n    const lowValue = statObj[lowLevel + '+'];\r\n    const highValue = statObj[highLevel];\r\n    return lowValue + (highValue - lowValue) * (level - lowLevel) / (highLevel - lowLevel);\r\n}\r\n\r\n/** 武器のレベルに応じた（基礎/突破）ステータスを算出します */\r\nexport function getPropertyValueByLevel(statObj: any, ascension: number): number {\r\n    const lowLevel = 突破レベルレベルARRAY[ascension][0];\r\n    return statObj[lowLevel + '+'];\r\n}\r\n\r\nexport function getValueByLevel(level: number | string, valueObj: any): number {\r\n    if (level in valueObj) return valueObj[level];\r\n    level = Number(level);\r\n    const levelArr = Object.keys(valueObj).map(s => Number(s));\r\n    let lowLevel;\r\n    let highLevel;\r\n    for (let i = 0; i < levelArr.length - 1; i++) {\r\n        if (levelArr[i] <= level && levelArr[i + 1] >= level) {\r\n            lowLevel = levelArr[i];\r\n            highLevel = levelArr[i + 1];\r\n        }\r\n    }\r\n    if (!lowLevel || !highLevel) return 0;\r\n    return valueObj[lowLevel] + (valueObj[highLevel] - valueObj[lowLevel]) * (level - lowLevel) / (highLevel - lowLevel);\r\n}\r\n\r\n/** 聖遺物メイン効果のステータスを算出します */\r\nexport function calculateArtifactStatsMain(artifactStatsMain: any, mainstats: string[]) {\r\n    (Object.keys(artifactStatsMain) as (keyof typeof artifactStatsMain)[]).forEach(\r\n        (key) => {\r\n            artifactStatsMain[key] = 0;\r\n        }\r\n    );\r\n    for (const statWithRarity of mainstats) {\r\n        if (!statWithRarity) continue;\r\n        const stat: any[] = statWithRarity.split(\"_\");\r\n        artifactStatsMain[stat[1]] += ARTIFACT_MAIN_MASTER[stat[0] as TArtifactMainRarity][stat[1] as TArtifactMainStat];\r\n    }\r\n}\r\n\r\n/** 聖遺物優先するサブ効果のステータスを算出します */\r\nexport function calculateArtifactSubStatByPriority(\r\n    artifactStatsSub: any,\r\n    mainstats: string[],\r\n    prioritySubstats: string[],\r\n    priotritySubstatIndices: number[],\r\n    priotritySubstatValues: number[][],\r\n    prioritySubstatCounts: number[]) {\r\n    (Object.keys(artifactStatsSub) as (keyof typeof artifactStatsSub)[]).forEach(\r\n        (key) => {\r\n            artifactStatsSub[key] = 0;\r\n        }\r\n    );\r\n    let totalCount = 0;\r\n    for (let i = 0; i < 3; i++) {\r\n        if (!prioritySubstats[i]) continue;\r\n        if (!priotritySubstatIndices[i]) continue;\r\n        if (!prioritySubstatCounts[i]) continue;\r\n        artifactStatsSub[prioritySubstats[i]] += priotritySubstatValues[i][priotritySubstatIndices[i]] * prioritySubstatCounts[i];\r\n        totalCount += prioritySubstatCounts[i];\r\n    }\r\n    // 初期: 3 or 4\r\n    // 強化: 5 (+4 +8 +12 +16 +20)\r\n    // 初期+強化: min=40 max=45\r\n    const noPrioritySubstatArr = 聖遺物サブ効果ARRAY.filter(s => !prioritySubstats.includes(s));\r\n    let noPriorityCount = Math.min(45, 40 + Math.round(Math.max(0, (totalCount - 12) / 4)));\r\n    noPriorityCount -= Math.min(45, totalCount);\r\n    for (let i = noPriorityCount; i > 0; i--) {\r\n        const substat = noPrioritySubstatArr[i % noPrioritySubstatArr.length] as keyof typeof ARTIFACT_SUB_MASTER;\r\n        artifactStatsSub[substat] += ARTIFACT_SUB_MASTER[substat][3];\r\n    }\r\n    const star4Count = mainstats.filter(s => s && s.startsWith('4')).length;\r\n    const multiplier = 1 - (0.07 * star4Count); // ★4聖遺物ひとつにつきステータスを7%下げます\r\n    (Object.keys(artifactStatsSub) as (keyof typeof artifactStatsSub)[]).forEach(\r\n        (key) => {\r\n            artifactStatsSub[key] *= multiplier;\r\n            artifactStatsSub[key] = Math.round(artifactStatsSub[key] * 10) / 10;\r\n        }\r\n    );\r\n}\r\n\r\nexport function calculateArtifactStats(artifactDetailInput: TArtifactDetailInput) {\r\n    const artifactStats = artifactDetailInput.聖遺物ステータス;\r\n    const artifactStatsMain = artifactDetailInput.聖遺物ステータスメイン効果;\r\n    const artifactStatsSub = artifactDetailInput.聖遺物ステータスサブ効果;\r\n    for (const stat of Object.keys(artifactStats)) {\r\n        artifactStats[stat] = 0;\r\n    }\r\n    for (const stat of Object.keys(artifactStatsMain)) {\r\n        if (stat in artifactStats) artifactStats[stat] += artifactStatsMain[stat];\r\n        else artifactStats[stat] = artifactStatsMain[stat];\r\n    }\r\n    for (const stat of Object.keys(artifactStatsSub)) {\r\n        if (stat in artifactStats) artifactStats[stat] += artifactStatsSub[stat];\r\n        else artifactStats[stat] = artifactStatsSub[stat];\r\n    }\r\n}\r\n\r\n/** キャラクターのステータスを計算します */\r\nexport const calculateStats = function (\r\n    statsInput: TStatsInput,\r\n    characterInput: TCharacterInput,\r\n    artifactDetailInput: TArtifactDetailInput,\r\n    conditionInput: TConditionInput,\r\n    optionInput: TOptionInput) {\r\n    if (!characterInput) return;\r\n    if (!artifactDetailInput) return;\r\n    if (!conditionInput) return;\r\n    if (!optionInput) return;\r\n\r\n    try {\r\n        const characterMaster = characterInput.characterMaster;\r\n        const ascension = characterInput.突破レベル;\r\n        const level = characterInput.レベル;\r\n        const constellation = characterInput.命ノ星座;\r\n        const weaponMaster = characterInput.weaponMaster;\r\n        const weaponAscension = characterInput.武器突破レベル;\r\n        const weaponLevel = characterInput.武器レベル;\r\n\r\n        const workStatsObj = deepcopy(ステータスTEMPLATE);\r\n\r\n        workStatsObj['突破レベル'] = ascension;\r\n        workStatsObj['レベル'] = level;\r\n        workStatsObj['命ノ星座'] = constellation;\r\n        workStatsObj['元素'] = characterMaster.元素;\r\n\r\n        // キャラクターマスターから元素エネルギーを設定します\r\n        if ('元素エネルギー' in characterMaster['元素爆発']) {\r\n            workStatsObj['元素エネルギー'] = characterMaster['元素爆発']['元素エネルギー'];\r\n        }\r\n        if ('固有変数' in characterMaster) {\r\n            for (const name of Object.keys(characterMaster['固有変数'])) {\r\n                if (name in conditionInput.conditionValues) {\r\n                    workStatsObj[name] = Number(conditionInput.conditionValues[name]);\r\n                } else {\r\n                    workStatsObj[name] = characterMaster['固有変数'][name];\r\n                }\r\n            }\r\n        }\r\n\r\n        // 敵マスターから敵のステータス（耐性）を設定します\r\n        for (const stat of Object.keys(statsInput.enemyMaster).filter(s => s != 'key')) {\r\n            const toStat = '敵' + stat;\r\n            workStatsObj[toStat] = statsInput.enemyMaster[stat];\r\n        }\r\n\r\n        // ステータス補正を計上します\r\n        Object.keys(statsInput.statAdjustments).forEach(stat => {\r\n            if (stat in workStatsObj) workStatsObj[stat] += statsInput.statAdjustments[stat];\r\n        });\r\n\r\n        // キャラクターの基礎ステータスと突破ステータスを計上します\r\n        for (const stat of Object.keys(characterMaster['ステータス'])) {\r\n            if (基礎ステータスARRAY.includes(stat)) {\r\n                workStatsObj[stat] += getStatValueByLevel(characterMaster['ステータス'][stat], ascension, level);\r\n            } else {\r\n                const toStat = ['HP', '攻撃力', '防御力'].includes(stat) ? stat + '+' : stat;\r\n                if (toStat in workStatsObj) {\r\n                    workStatsObj[toStat] += getPropertyValueByLevel(characterMaster['ステータス'][stat], ascension);\r\n                }\r\n            }\r\n        }\r\n\r\n        // 武器の基礎ステータスと突破ステータスを計上します\r\n        for (const stat of Object.keys(weaponMaster['ステータス'])) {\r\n            workStatsObj[stat] += getStatValueByLevel(weaponMaster['ステータス'][stat], weaponAscension, weaponLevel);\r\n        }\r\n\r\n        // 聖遺物のステータスを計上します\r\n        const artifactStats = artifactDetailInput.聖遺物ステータス;\r\n        for (const stat of Object.keys(artifactStats)) {\r\n            const toStat = ['HP', '攻撃力', '防御力'].includes(stat) ? stat + '+' : stat;\r\n            workStatsObj[toStat] += artifactStats[stat];\r\n        }\r\n\r\n        let 通常攻撃_元素Var = characterMaster.武器 == '法器' ? characterMaster.元素 : '物理';\r\n        let 重撃_元素Var = characterMaster.武器 == '法器' ? characterMaster.元素 : '物理';\r\n        let 落下攻撃_元素Var = characterMaster.武器 == '法器' ? characterMaster.元素 : '物理';\r\n\r\n        if (optionInput) {\r\n            // 元素共鳴、チームオプション、その他オプションを計上します\r\n            [optionInput.elementalResonance, optionInput.teamOption, optionInput.miscOption].forEach(optionObj => {\r\n                if (optionObj) {\r\n                    Object.keys(optionObj.conditionAdjustments).forEach(stat => {\r\n                        if (optionObj.conditionAdjustments[stat] === Infinity) {\r\n                            if (stat.endsWith('元素付与')) {\r\n                                if (['片手剣', '両手剣', '長柄武器'].includes(characterMaster.武器)) {\r\n                                    const my付与元素 = stat.replace(/元素付与$/, '');\r\n                                    通常攻撃_元素Var = my付与元素;\r\n                                    重撃_元素Var = my付与元素;\r\n                                    落下攻撃_元素Var = my付与元素;\r\n                                }\r\n                            }\r\n                        } else if (stat in workStatsObj) {\r\n                            workStatsObj[stat] += optionObj.conditionAdjustments[stat];\r\n                        } else {\r\n                            workStatsObj[stat] = optionObj.conditionAdjustments[stat];\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        }\r\n\r\n        const validConditionValueArr = makeValidConditionValueArr(conditionInput);\r\n\r\n        // ステータス変化\r\n        const conditionAdjustments = updateStatsByCondition(characterInput, validConditionValueArr, workStatsObj);\r\n\r\n        // 天賦性能変化\r\n        for (const myDamageDetail of [characterInput.damageDetailMyCharacter, characterInput.damageDetailMyWeapon, characterInput.damageDetailMyArtifactSets]) {\r\n            if (myDamageDetail && CHANGE_KIND_TALENT in myDamageDetail) {\r\n                for (const myDetailObj of myDamageDetail[CHANGE_KIND_TALENT]) {\r\n                    if (myDetailObj['条件']) {\r\n                        const number = checkConditionMatches(myDetailObj['条件'], validConditionValueArr, constellation);\r\n                        if (number == 0) continue;\r\n                    }\r\n                    if (myDetailObj['種類'] && myDetailObj['種類'].endsWith('元素付与')) {\r\n                        const my元素 = myDetailObj['種類'].replace('元素付与', '');\r\n                        if (!myDetailObj['対象']) {\r\n                            通常攻撃_元素Var = my元素;\r\n                            重撃_元素Var = my元素;\r\n                            落下攻撃_元素Var = my元素;\r\n                        } else if (myDetailObj['対象'] == '通常攻撃ダメージ') {\r\n                            通常攻撃_元素Var = my元素;\r\n                        } else if (myDetailObj['対象'] == '重撃ダメージ') {\r\n                            重撃_元素Var = my元素;\r\n                        } else if (myDetailObj['対象'] == '落下攻撃ダメージ') {\r\n                            落下攻撃_元素Var = my元素;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        conditionInput.攻撃元素 = [通常攻撃_元素Var, 重撃_元素Var, 落下攻撃_元素Var];\r\n\r\n        overwriteObject(statsInput.statsObj, workStatsObj);\r\n        overwriteObject(conditionInput.conditionAdjustments, conditionAdjustments);\r\n    } catch (error) {\r\n        console.error(statsInput, characterInput, artifactDetailInput, conditionInput, optionInput);\r\n        throw error;\r\n    }\r\n}\r\n\r\nfunction updateStatsByCondition(characterInput: TCharacterInput, validConditionValueArr: string[], workStatsObj: TStats) {\r\n    const constellation = characterInput.命ノ星座;\r\n\r\n    const workConditionAdjustments = {} as { [key: string]: number };\r\n\r\n    const myPriority1KindArr = ['元素熟知', '元素チャージ効率'];    // 攻撃力の計算で参照するステータス 草薙の稲光\r\n    const myPriority1KindFormulaArr = [] as any[];\r\n    const myPriority2KindFormulaArr = [] as any[];\r\n    const myKindFormulaArr = [] as any[];\r\n    for (const myDamageDetail of [characterInput.damageDetailMyCharacter, characterInput.damageDetailMyWeapon, characterInput.damageDetailMyArtifactSets]) {\r\n        if (myDamageDetail && CHANGE_KIND_STATUS in myDamageDetail) {\r\n            for (const myDetailObj of myDamageDetail[CHANGE_KIND_STATUS]) {\r\n                let hasCondition = false;\r\n                let myNew数値 = myDetailObj['数値'];\r\n                if (myDetailObj['条件']) {\r\n                    const number = checkConditionMatches(myDetailObj['条件'], validConditionValueArr, constellation);\r\n                    if (number == 0) continue;\r\n                    if (number != 1) {\r\n                        myNew数値 = (myNew数値 as any).concat(['*', number]);\r\n                    }\r\n                    hasCondition = true;\r\n                }\r\n                if (myDetailObj['種類']) {\r\n                    if (myDetailObj['対象']) {\r\n                        const myNew種類 = myDetailObj['種類'] + '.' + myDetailObj['対象'];\r\n                        myKindFormulaArr.push([myNew種類, myNew数値, myDetailObj['上限'], hasCondition]);\r\n                    } else {\r\n                        if (myPriority1KindArr.includes(myDetailObj['種類'])) { // 攻撃力の計算で参照されるものを先に計上するため…\r\n                            myPriority1KindFormulaArr.push([myDetailObj['種類'], myNew数値, myDetailObj['上限'], hasCondition]);\r\n                        } else if (myDetailObj['種類'].endsWith('%')) {  // 乗算系(%付き)のステータスアップを先回しします HP 攻撃力 防御力しかないはず\r\n                            myPriority2KindFormulaArr.push([myDetailObj['種類'], myNew数値, myDetailObj['上限'], hasCondition]);\r\n                        } else {\r\n                            myKindFormulaArr.push([myDetailObj['種類'], myNew数値, myDetailObj['上限'], hasCondition]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // console.log('myPriority1KindFormulaArr', myPriority1KindFormulaArr);\r\n    // console.log('myPriority2KindFormulaArr', myPriority2KindFormulaArr);\r\n    // console.log('myKindFormulaArr', myKindFormulaArr);\r\n    // 攻撃力の計算で参照されるステータスアップを先に計上します\r\n    myPriority1KindFormulaArr.forEach(entry => {\r\n        const diffStats = updateStats(workStatsObj, entry[0], entry[1], entry[2]);\r\n        if (entry[3]) {\r\n            for (const stat of Object.keys(diffStats)) {\r\n                if (stat in workConditionAdjustments) {\r\n                    workConditionAdjustments[stat] += diffStats[stat];\r\n                } else {\r\n                    workConditionAdjustments[stat] = diffStats[stat];\r\n                }\r\n            }\r\n        }\r\n    });\r\n    // 乗算系のステータスアップを計上します HP% 攻撃力% 防御力%\r\n    myPriority2KindFormulaArr.sort(compareFunction);\r\n    myPriority2KindFormulaArr.forEach(entry => {\r\n        const diffStats = updateStats(workStatsObj, entry[0], entry[1], entry[2]);\r\n        if (entry[3]) {\r\n            for (const stat of Object.keys(diffStats)) {\r\n                if (stat in workConditionAdjustments) {\r\n                    workConditionAdjustments[stat] += diffStats[stat];\r\n                } else {\r\n                    workConditionAdjustments[stat] = diffStats[stat];\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    // HP, 攻撃力, 防御力を計算します\r\n    workStatsObj['HP上限'] += workStatsObj['基礎HP'] + workStatsObj['HP+'];\r\n    workStatsObj['HP上限'] += (workStatsObj['基礎HP'] * workStatsObj['HP%']) / 100;\r\n    workStatsObj['攻撃力'] += workStatsObj['基礎攻撃力'] + workStatsObj['攻撃力+'];\r\n    workStatsObj['攻撃力'] += (workStatsObj['基礎攻撃力'] * workStatsObj['攻撃力%']) / 100;\r\n    workStatsObj['防御力'] += workStatsObj['基礎防御力'] + workStatsObj['防御力+'];\r\n    workStatsObj['防御力'] += (workStatsObj['基礎防御力'] * workStatsObj['防御力%']) / 100;\r\n\r\n    // それ以外のステータスアップを計上します\r\n    myKindFormulaArr.sort(compareFunction);\r\n    myKindFormulaArr.forEach(entry => {\r\n        const diffStats = updateStats(workStatsObj, entry[0], entry[1], entry[2]);\r\n        if (entry[3]) {\r\n            for (const stat of Object.keys(diffStats)) {\r\n                if (stat in workConditionAdjustments) {\r\n                    workConditionAdjustments[stat] += diffStats[stat];\r\n                } else {\r\n                    workConditionAdjustments[stat] = diffStats[stat];\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    return workConditionAdjustments;\r\n}\r\n\r\nfunction compareFunction(a: string, b: string) {\r\n    const arr = ['HP%', 'HP', 'HP上限', '防御力%', '防御力', '元素熟知', '会心率', '会心ダメージ', '与える治療効果', '受ける治療効果', '元素チャージ効率', '攻撃力%', '攻撃力'];\r\n    const lowestArr = ['ダメージ軽減'];\r\n    let aIndex = arr.indexOf(a[0]);\r\n    if (lowestArr.indexOf(a[0]) >= 0) {\r\n        aIndex = arr.length + 1;\r\n    }\r\n    let bIndex = arr.indexOf(b[0]);\r\n    if (lowestArr.indexOf(b[0]) >= 0) {\r\n        bIndex = arr.length + 1;\r\n    }\r\n    return (aIndex != -1 ? aIndex : arr.length) - (bIndex != -1 ? bIndex : arr.length);\r\n}\r\n\r\n/** げんかるくスタイルの式データから結果（数値）を計算します */\r\nexport const calculateFormulaArray = function (\r\n    formulaArr: any,\r\n    statsObj: TStats,\r\n    damageResult: TDamageResult,\r\n    opt_max: number | string | Array<number | string> | null = null\r\n): number {\r\n    try {\r\n        let result = 0;\r\n        if (!Array.isArray(formulaArr)) {\r\n            if (isNumber(formulaArr)) {\r\n                result = Number(formulaArr);\r\n            } else {\r\n                if (formulaArr in statsObj) {\r\n                    result = statsObj[formulaArr];\r\n                } else {\r\n                    console.error(statsObj, formulaArr, opt_max);\r\n                }\r\n            }\r\n        } else {\r\n            let operator: string | null = null;\r\n            for (const entry of formulaArr) {\r\n                let subResult = 0;\r\n                if (['+', '-', '*', '/'].includes(entry)) {\r\n                    operator = entry;\r\n                    continue;\r\n                } else if (isNumber(entry)) {\r\n                    subResult = Number(entry);\r\n                } else if (Array.isArray(entry)) {\r\n                    subResult = calculateFormulaArray(entry, statsObj, damageResult);\r\n                } else {\r\n                    if (entry in statsObj) {\r\n                        subResult = Number(statsObj[entry]);\r\n                    } else if (entry.indexOf('#') != -1) {\r\n                        const nameArr = entry.split('#');\r\n                        if (damageResult && nameArr[0] in damageResult) {\r\n                            const damageArrArr = damageResult[nameArr[0]] as TDamageResultEntry[];\r\n                            let damage = null;\r\n                            for (const damageArr of damageArrArr) {\r\n                                if (nameArr[1] == damageArr[0]) {\r\n                                    damage = damageArr[4];  // 非会心\r\n                                    break;\r\n                                }\r\n                            }\r\n                            if (damage != null) {\r\n                                subResult = damage;\r\n                            } else {\r\n                                console.error(formulaArr, statsObj, damageResult, opt_max, entry);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        console.error(formulaArr, statsObj, damageResult, opt_max, entry);\r\n                    }\r\n                }\r\n                if (operator == null) {\r\n                    result += subResult;\r\n                } else {\r\n                    switch (operator) {\r\n                        case '+':\r\n                            result += subResult;\r\n                            break;\r\n                        case '-':\r\n                            result -= subResult;\r\n                            break;\r\n                        case '*':\r\n                            result *= subResult;\r\n                            result = Math.floor(result * 100) / 100;\r\n                            break;\r\n                        case '/':\r\n                            result /= subResult;\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (opt_max != null) {\r\n            const maxValue = calculateFormulaArray(opt_max, statsObj, damageResult);\r\n            if (result > maxValue) {\r\n                result = maxValue;\r\n            }\r\n        }\r\n        return result;\r\n    } catch (error) {\r\n        console.error(formulaArr, statsObj, damageResult, opt_max);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** 文字列からげんかるくスタイルの計算式を生成します（サブ） */\r\nexport function analyzeFormulaStrSub(formulaStr: string, opt_defaultItem?: string): any[] {\r\n    const resultArr: any[] = [];\r\n    if (isNumber(formulaStr)) {\r\n        resultArr.push(Number(formulaStr));\r\n    } else {\r\n        const strArr = formulaStr.split('%');\r\n        if (strArr.length == 1) {\r\n            resultArr.push(strArr[0]);\r\n        } else {\r\n            resultArr.push(Number(strArr[0]) / 100);\r\n            resultArr.push('*');\r\n            if (strArr[1].length > 0) {\r\n                resultArr.push(strArr[1]);\r\n            } else if (opt_defaultItem != null) {\r\n                resultArr.push(opt_defaultItem);\r\n            }\r\n        }\r\n    }\r\n    return resultArr;\r\n}\r\n\r\n/** 文字列からげんかるくスタイルの計算式を生成します */\r\nexport const analyzeFormulaStr = function (formulaStr: string, opt_defaultItem?: string) {\r\n    const resultArr: any[] = [];\r\n    const re = new RegExp('([\\\\+\\\\-\\\\*/]?)([^\\\\+\\\\-\\\\*/]+)(.*)');\r\n    let workStr = formulaStr;\r\n    while (workStr) {\r\n        const reRet = re.exec(workStr);\r\n        if (!reRet) {\r\n            resultArr.push(workStr);\r\n            break;\r\n        }\r\n        if (reRet[1]) { // + - * /\r\n            resultArr.push(reRet[1]);\r\n        }\r\n        resultArr.push(analyzeFormulaStrSub(reRet[2], opt_defaultItem));\r\n        if (!reRet[3]) {\r\n            break;\r\n        }\r\n        workStr = reRet[3];\r\n    }\r\n    return resultArr;\r\n}\r\n\r\n/** ダメージ計算を実施します */\r\nexport function calculateDamageResult(damageResult: TDamageResult, characterInput: TCharacterInput, conditionInput: TConditionInput, statsInput: TStatsInput) {\r\n    try {\r\n        if (!characterInput) return;\r\n        if (!conditionInput) return;\r\n        if (!statsInput) return;\r\n        const characterMaster = characterInput.characterMaster;\r\n        const constellation = characterInput['命ノ星座'];\r\n        const vision = characterMaster['元素'];\r\n\r\n        // 元素反応を計算します\r\n        const reactionResult = deepcopy(元素反応TEMPLATE);\r\n        const reactionMasterArr = [[vision, (ELEMENTAL_REACTION_MASTER as any)[vision]]];\r\n        if (conditionInput.selectList.filter(s => s.name == '元素変化').length) {\r\n            const selectEntry = conditionInput.selectList.filter(s => s.name == '元素変化')[0];\r\n            const selectedIndex = conditionInput.conditionValues['元素変化'] as number;\r\n            if (selectedIndex) {\r\n                const dmgElement = selectEntry.options[selectedIndex].replace(/元素$/, '');\r\n                reactionMasterArr.push([dmgElement, (ELEMENTAL_REACTION_MASTER as any)[dmgElement]]);\r\n            }\r\n        }\r\n        if (conditionInput.selectList.filter(s => s.name == '拡散').length) {\r\n            const selectEntry = conditionInput.selectList.filter(s => s.name == '拡散')[0];\r\n            const selectedIndex = conditionInput.conditionValues['拡散'] as number;\r\n            if (selectedIndex) {\r\n                const dmgElement = selectEntry.options[selectedIndex].replace(/元素$/, '');\r\n                reactionMasterArr.push([dmgElement, (ELEMENTAL_REACTION_MASTER as any)[dmgElement]]);\r\n            }\r\n        }\r\n        reactionResult['元素'] = vision;\r\n        reactionMasterArr.forEach(entry => {\r\n            const element = entry[0];\r\n            const reactionMaster = entry[1];\r\n            Object.keys(reactionMaster).forEach(reaction => {\r\n                const reactionObj = reactionMaster[reaction];\r\n                let resultValue = 0;\r\n                if (reaction == '結晶') {\r\n                    resultValue = calculate結晶シールド吸収量(element, statsInput.statsObj);\r\n                } else if (reaction == '拡散') {\r\n                    let dmgElement = '炎';\r\n                    for (const entry of conditionInput.selectList) {\r\n                        if (entry.name == '拡散') {\r\n                            const optionValue = entry.options[Number(conditionInput.conditionValues['拡散'])];\r\n                            if (optionValue) dmgElement = optionValue.replace(/元素$/, '');\r\n                            break;\r\n                        }\r\n                    }\r\n                    reactionResult['拡散元素'] = dmgElement;\r\n                    resultValue = calculate固定値系元素反応ダメージ(reaction, element, statsInput.statsObj, dmgElement);\r\n                } else {\r\n                    switch (reactionObj['種類']) {\r\n                        case '乗算':    // 蒸発 溶解\r\n                            resultValue = calculate乗算系元素反応倍率(reaction, element, statsInput.statsObj);\r\n                            break;\r\n                        case '固定':    // 過負荷 感電 超電導\r\n                            resultValue = calculate固定値系元素反応ダメージ(reaction, element, statsInput.statsObj);\r\n                            break;\r\n                        case '加算':    // 超激化 草激化\r\n                            resultValue = calculate加算系元素反応ダメージ(reaction, element, statsInput.statsObj);\r\n                            break;\r\n                    }\r\n                }\r\n                Object.keys(reactionResult).forEach(key => {\r\n                    if (key.startsWith(reaction) && isNumber(reactionResult[key])) {\r\n                        reactionResult[key] = resultValue;\r\n                    }\r\n                });\r\n            });\r\n        })\r\n        overwriteObject(damageResult.元素反応, reactionResult);\r\n        console.debug('元素反応', damageResult.元素反応);\r\n\r\n        // 戦闘天賦およびその他のダメージを計算します\r\n        const validConditionValueArr = makeValidConditionValueArr(conditionInput);\r\n\r\n        const damageDetailMyCharacter = characterInput.damageDetailMyCharacter;\r\n        const damageDetailMyWeapon = characterInput.damageDetailMyWeapon;\r\n        const damageDetailMyArtifactSets = characterInput.damageDetailMyArtifactSets;\r\n\r\n        if (Array.isArray(damageResult.キャラクター注釈)) {\r\n            damageResult.キャラクター注釈.splice(0, damageResult.キャラクター注釈.length);\r\n        }\r\n\r\n        if (damageDetailMyCharacter) {\r\n            for (const category of ['通常攻撃', '重撃', '落下攻撃']) {\r\n                damageResult[category] = [];\r\n                if (!(category in damageDetailMyCharacter)) continue;\r\n                const element = conditionInput.攻撃元素[['通常攻撃', '重撃', '落下攻撃'].indexOf(category)];\r\n                let talentDetailArr = (damageDetailMyCharacter as any)[category];\r\n                if (('特殊' + category) in damageDetailMyCharacter) {\r\n                    const workObj = (damageDetailMyCharacter as any)['特殊' + category];\r\n                    if (checkConditionMatches(workObj['条件'], validConditionValueArr, constellation) != 0) {\r\n                        talentDetailArr = workObj['詳細'];\r\n                    }\r\n                }\r\n                for (const talentDetail of talentDetailArr) {\r\n                    if (talentDetail['条件'] && checkConditionMatches(talentDetail['条件'], validConditionValueArr, constellation) == 0) {\r\n                        continue;\r\n                    }\r\n                    const resultArr = calculateDamageFromDetail(talentDetail, characterInput, conditionInput, statsInput.statsObj, damageResult, element);\r\n                    (damageResult[category] as any).push(resultArr);\r\n                }\r\n                if (category == '通常攻撃') {\r\n                    let n = 0;\r\n                    const sum = ['合計ダメージ', null, 0, 0, 0, null, 0, 0, 1] as TDamageResultEntry;\r\n                    for (const entry of damageResult[category]) {\r\n                        if (entry[0].endsWith('段ダメージ') && !entry[0].startsWith('非表示_')) {\r\n                            sum[1] = entry[1];\r\n                            sum[2] += entry[2];\r\n                            if (entry[3] == null) sum[3] = null;\r\n                            else if (sum[3] != null) sum[3] += entry[3];\r\n                            sum[4] += entry[4];\r\n                            if (sum[6] != null) {   // HIT数\r\n                                if (entry[6]) sum[6] += entry[6];\r\n                                else sum[6]++;\r\n                            }\r\n                            sum[7] = entry[7];  // ダメージバフ\r\n                            sum[8] = entry[8];  // 敵の防御補正\r\n                            n++;\r\n                        }\r\n                    }\r\n                    if (n > 0) {\r\n                        damageResult[category].splice(n, 0, sum);\r\n                    }\r\n                }\r\n            }\r\n            for (const category of ['元素スキル', '元素爆発', 'その他']) {\r\n                damageResult[category] = [];\r\n                if (!(category in damageDetailMyCharacter)) continue;\r\n                const talentDetailArr = (damageDetailMyCharacter as any)[category];\r\n                for (const talentDetail of talentDetailArr) {\r\n                    if (talentDetail['条件'] && checkConditionMatches(talentDetail['条件'], validConditionValueArr, constellation) == 0) {\r\n                        continue;\r\n                    }\r\n                    const resultArr = calculateDamageFromDetail(talentDetail, characterInput, conditionInput, statsInput.statsObj, damageResult);\r\n                    (damageResult[category] as TDamageResultEntry[]).push(resultArr);\r\n                }\r\n            }\r\n        }\r\n\r\n        // 武器と聖遺物セット効果\r\n        for (const myDamageDetail of [damageDetailMyWeapon, damageDetailMyArtifactSets]) {\r\n            const category = 'その他';\r\n            if (!myDamageDetail || !(category in myDamageDetail)) continue;\r\n            const talentDetailArr = (myDamageDetail as any)[category];\r\n            for (const talentDetail of talentDetailArr) {\r\n                if (talentDetail['条件'] && checkConditionMatches(talentDetail['条件'], validConditionValueArr, constellation) == 0) {\r\n                    continue;\r\n                }\r\n                const resultArr = calculateDamageFromDetail(talentDetail, characterInput, conditionInput, statsInput.statsObj, damageResult);\r\n                (damageResult[category] as TDamageResultEntry[]).push(resultArr);\r\n            }\r\n        }\r\n\r\n        // 被ダメージを計算します\r\n        const damageTakenArr = [] as any;\r\n        for (const stat of 元素ステータス_耐性ARRAY) {\r\n            const element = stat.replace(/元素耐性$/, '').replace(/耐性$/, '');\r\n            const damageTaken = calculateDamageTaken(statsInput.statsObj, 10000, element);\r\n            damageTakenArr.push({ key: element, value: damageTaken });\r\n        }\r\n        damageResult['被ダメージ'] = damageTakenArr;\r\n\r\n        // 耐久スコアを計算します\r\n        const resScoreArr = [] as any;\r\n        for (const damageTaken of damageTakenArr) {\r\n            resScoreArr.push({ key: damageTaken.key, value: statsInput.statsObj['HP上限'] * 10000 / damageTaken.value });\r\n        }\r\n        damageResult['耐久スコア'] = resScoreArr;\r\n\r\n        console.debug(damageResult);\r\n    } catch (error) {\r\n        console.error(damageResult, characterInput, conditionInput, statsInput);\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport function makeValidConditionValueArr(conditionInput: any) {\r\n    try {\r\n        const result = [] as string[];\r\n        if (!conditionInput) return result;\r\n        const checkboxList = conditionInput.checkboxList;\r\n        if (checkboxList) {\r\n            checkboxList.forEach((entry: any) => {\r\n                if (conditionInput.conditionValues[entry.name]) {\r\n                    result.push(entry.name);\r\n                }\r\n            });\r\n        }\r\n        const selectList = conditionInput.selectList;\r\n        if (selectList) {\r\n            selectList.forEach((entry: any) => {\r\n                const value = conditionInput.conditionValues[entry.name];\r\n                if (value !== undefined && value !== null) {\r\n                    if (value > 0 || (value == 0 && entry.required)) {\r\n                        result.push(entry.name + '@' + entry.options[value]);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return result;\r\n    } catch (error) {\r\n        console.error(conditionInput);\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport const checkConditionMatches = function (conditionStr: string, validConditionValueArr: string[], constellation: number): number {\r\n    const myCondStr = conditionStr.split('^')[0];\r\n\r\n    if (myCondStr.indexOf('|') != -1) {  // |はOR条件です\r\n        const myCondStrArr = myCondStr.split('|');\r\n        for (let i = 0; i < myCondStrArr.length; i++) {\r\n            const resultSub = checkConditionMatchesSub(myCondStrArr[i], validConditionValueArr, constellation);\r\n            if (resultSub == 1) {\r\n                return 1;   // マッチ\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    const myCondStrArr = myCondStr.split('&');    // &はAND条件です\r\n    let result = 1;\r\n    for (let i = 0; i < myCondStrArr.length; i++) {\r\n        const resultSub = checkConditionMatchesSub(myCondStrArr[i], validConditionValueArr, constellation);\r\n        if (resultSub == 0) {\r\n            return 0;   // アンマッチ\r\n        }\r\n        if (resultSub != 1) {\r\n            result = resultSub;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction checkConditionMatchesSub(conditionStr: string, validConditionValueArr: string[], constellation: number): number {\r\n    const myCondArr = conditionStr.split(/[@=]/);\r\n    if (myCondArr[0] == '命ノ星座') {\r\n        if (myCondArr.length == 2) {\r\n            if (isNumber(myCondArr[1])) {\r\n                const work = Number(myCondArr[1]);\r\n                if (work <= constellation) {\r\n                    return 1;\r\n                }\r\n            }\r\n        }\r\n        return 0;   // アンマッチ\r\n    }\r\n    if (validConditionValueArr.includes(conditionStr) || validConditionValueArr.includes(conditionStr.replace('=', '@'))) {\r\n        return 1;   // マッチ 等倍\r\n    }\r\n    if (myCondArr.length == 1) {\r\n        if (validConditionValueArr.filter(s => s.split('@')[0] == conditionStr).length > 0) {\r\n            return 1;   // マッチ 等倍\r\n        }\r\n        return 0;   // アンマッチ\r\n    }\r\n    if (conditionStr.indexOf('=') != -1) {\r\n        return 0;   // アンマッチ\r\n    }\r\n    const re = new RegExp('[^0-9]*?([\\\\-0-9\\\\.]+).*');    // 条件値={prefix}{倍率}{postfix}\r\n    for (let i = 0; i < validConditionValueArr.length; i++) {\r\n        if (validConditionValueArr[i].startsWith(myCondArr[0] + '@')) {\r\n            const workCondArr = validConditionValueArr[i].split('@');\r\n            const reRet = re.exec(workCondArr[1]);\r\n            if (reRet) {\r\n                const work = Number(reRet[1]);\r\n                return work;    // マッチ 倍率\r\n            }\r\n        }\r\n    }\r\n    return 0;   // アンマッチ\r\n}\r\n\r\n/** 蒸発、溶解のダメージを計算します */\r\nfunction calculate乗算系元素反応倍率(reaction: any, element: string, statsObj: any) {\r\n    try {\r\n        if (!element || element == '物理') return 0;\r\n        const elementalMastery = statsObj['元素熟知'];\r\n        const dmgBuff = statsObj[reaction + '反応ボーナス'] ?? 0;\r\n        let result = (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['数値'];\r\n        result *= 1 + (25 * elementalMastery / (9 * (elementalMastery + 1400))) + dmgBuff / 100;\r\n        return result;\r\n    } catch (error) {\r\n        console.error(reaction, element, statsObj);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * 過負荷、感電、超電導、拡散のダメージを計算します\r\n */\r\nfunction calculate固定値系元素反応ダメージ(reaction: any, element: string, statsObj: TStats, opt_dmgElement?: string) {\r\n    try {\r\n        if (!element || element == '物理') return 0;\r\n        const level = statsObj['レベル'];\r\n        const elementalMastery = statsObj['元素熟知'];\r\n        const dmgBuff = statsObj[reaction + '反応ボーナス'] ?? 0;\r\n        const dmgElement = opt_dmgElement ?? (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['元素'];\r\n        let result = getValueByLevel(level, (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['数値']);\r\n        result *= 1 + (16 * elementalMastery / (elementalMastery + 2000)) + dmgBuff / 100;\r\n        result *= calculateEnemyRes(dmgElement, statsObj);\r\n        return result;\r\n    } catch (error) {\r\n        console.error(reaction, element, statsObj, opt_dmgElement);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** 結晶シールドの吸収量を計算します */\r\nfunction calculate結晶シールド吸収量(element: string, statsObj: TStats) {\r\n    try {\r\n        if (!element || element == '物理') return 0;\r\n        const level = statsObj['レベル'];\r\n        const elementalMastery = statsObj['元素熟知'];\r\n        const dmgBuff = statsObj['結晶反応ボーナス'] ?? 0;\r\n        let result = getValueByLevel(level, (ELEMENTAL_REACTION_MASTER as any)[element]['結晶']['数値']);\r\n        result *= 1 + (40 * elementalMastery / (9 * (elementalMastery + 1400))) + dmgBuff / 100;\r\n        return result;\r\n    } catch (error) {\r\n        console.error(element, statsObj);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** 超激化、草激化のダメージを計算します */\r\nfunction calculate加算系元素反応ダメージ(reaction: any, element: string, statsObj: TStats) {\r\n    try {\r\n        if (!element || element == '物理') return 0;\r\n        const level = statsObj['レベル'];\r\n        const elementalMastery = statsObj['元素熟知'];\r\n        const dmgBuff = statsObj[reaction + '反応ボーナス'] ?? 0;\r\n        const dmgElement = (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['元素'];\r\n        let result = getValueByLevel(level, (ELEMENTAL_REACTION_MASTER as any)[element][reaction]['数値']);\r\n        result *= 1 + (5 * elementalMastery / (elementalMastery + 1200)) + dmgBuff / 100;\r\n        result *= calculateEnemyRes(dmgElement, statsObj);\r\n        return result;\r\n    } catch (error) {\r\n        console.error(reaction, element, statsObj);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** 防御力補正を計算します */\r\nexport function calculateEnemyDef(statsObj: TStats, opt_ignoreDef = 0) { // 防御力, 防御無視\r\n    try {\r\n        const level = statsObj['レベル'] ?? 0;\r\n        const enemyLevel = statsObj['敵レベル'] ?? 0;\r\n        const calcIgnoreDef = opt_ignoreDef / 100;\r\n        const calcDef = Math.max(-100, statsObj['敵防御力'] ?? 0) / 100;    // 下限 -100%\r\n        const result = (level + 100) / ((1 - calcIgnoreDef) * (1 + calcDef) * (enemyLevel + 100) + level + 100);\r\n        return result;\r\n    } catch (error) {\r\n        console.error(statsObj, opt_ignoreDef);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** 元素(物理)耐性補正を計算します */\r\nfunction calculateRes(res: number) {\r\n    if (res == Infinity) return 0;  // 完全耐性\r\n    let result = res;\r\n    if (result < 0) {\r\n        result = 100 - result / 2;\r\n    } else if (result < 75) {\r\n        result = 100 - result;\r\n    } else {\r\n        result = 10000 / (4 * result + 100)\r\n    }\r\n    result /= 100;\r\n    return result;\r\n}\r\n\r\n/** 敵の元素(物理)耐性補正を計算します */\r\nexport function calculateEnemyRes(element: string, statsObj: TStats) {\r\n    try {\r\n        const statName = '敵' + element + (element != '物理' ? '元素' : '') + '耐性';\r\n        const result = calculateRes(statsObj[statName] ?? 0);\r\n        return result;\r\n    } catch (error) {\r\n        console.error(element, statsObj);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/** ダメージを計算します */\r\nfunction calculateDamageFromDetail(\r\n    detailObj: any,\r\n    characterInput: TCharacterInput,\r\n    conditionInput: TConditionInput,\r\n    statsObj: TStats,\r\n    damageResult: TDamageResult,\r\n    opt_element: string | null = null): TDamageResultEntry {\r\n    try {\r\n        const myバフArr = [] as Array<string>;\r\n        let is会心Calc = true;\r\n        let is防御補正Calc = true;\r\n        let is耐性補正Calc = true;\r\n        let my元素 = detailObj['元素'] != null ? detailObj['元素'] : opt_element != null ? opt_element : null;\r\n        let my防御無視 = 0; // for 雷電将軍\r\n        let my別枠乗算 = 0; // for 宵宮\r\n        const myHIT数 = detailObj['HIT数'] != null ? Number(detailObj['HIT数']) : 1;\r\n        const myステータス補正 = {} as { [key: string]: number };\r\n\r\n        const constellation = statsObj['命ノ星座'];\r\n\r\n        const talentChangeDetailObjArr = getChangeDetailObjArr(characterInput, CHANGE_KIND_TALENT);\r\n\r\n        let validConditionValueArr = makeValidConditionValueArr(conditionInput);  // 有効な条件\r\n\r\n        const myConditionValuesAfter = deepcopy(conditionInput.conditionValues);\r\n\r\n        if (detailObj['除外条件']) {\r\n            for (const delCondition of detailObj['除外条件']) {\r\n                let work = delCondition;\r\n                if (isPlainObject(delCondition)) {\r\n                    work = delCondition.名前;\r\n                }\r\n                if (work in myConditionValuesAfter) {\r\n                    if (isNumber(myConditionValuesAfter[work])) {\r\n                        myConditionValuesAfter[work] = 0;\r\n                    } else if (isBoolean(myConditionValuesAfter[work])) {\r\n                        myConditionValuesAfter[work] = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (detailObj['適用条件']) {\r\n            for (const addCondition of detailObj['適用条件']) {\r\n                if (isString(addCondition)) {\r\n                    if (addCondition in myConditionValuesAfter) {\r\n                        if (isBoolean(myConditionValuesAfter[addCondition])) {\r\n                            myConditionValuesAfter[addCondition] = true;\r\n                        }\r\n                    }\r\n                } else if (isPlainObject(addCondition)) {\r\n                    if (addCondition.名前 in myConditionValuesAfter) {\r\n                        let newValue = myConditionValuesAfter[addCondition.名前];\r\n                        if ('数値' in addCondition) {\r\n                            if (isString(addCondition.数値)) {\r\n                                const work = String(addCondition.数値).replace(/^\\+/, '');\r\n                                newValue += Number(work);\r\n                            } else if (isNumber(addCondition.数値)) {\r\n                                newValue = addCondition.数値;\r\n                            } else {\r\n                                newValue = addCondition.数値;\r\n                            }\r\n                            if (isNumber(newValue)) {\r\n                                if (newValue < 0) {\r\n                                    newValue = 0;\r\n                                } else {\r\n                                    conditionInput.selectList.filter(s => s.name == addCondition.名前).forEach(entry => {\r\n                                        if (newValue >= entry.options.length) {\r\n                                            newValue = entry.options.length - 1;\r\n                                        }\r\n                                    })\r\n                                }\r\n                            }\r\n                        } else {\r\n                            newValue = true;\r\n                        }\r\n                        myConditionValuesAfter[addCondition.名前] = newValue;\r\n                    }\r\n                    if (addCondition.説明) {\r\n                        if (Array.isArray(addCondition.説明)) {\r\n                            addCondition.説明.forEach((desc: string) => {\r\n                                if (!damageResult['キャラクター注釈'].includes(desc)) {\r\n                                    damageResult['キャラクター注釈'].push(desc);\r\n                                }\r\n                            })\r\n                        } else {\r\n                            const desc = addCondition.説明;\r\n                            if (!damageResult['キャラクター注釈'].includes(desc)) {\r\n                                damageResult['キャラクター注釈'].push(desc);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            console.log('myConditionValuesAfter', myConditionValuesAfter);\r\n        }\r\n        if (detailObj['除外条件'] || detailObj['適用条件']) {\r\n            const myConditionInputAfter: TConditionInput = deepcopy(conditionInput);\r\n            myConditionInputAfter.conditionValues = myConditionValuesAfter;\r\n            const validConditionValueArrAfter = makeValidConditionValueArr(myConditionInputAfter);\r\n\r\n            [characterInput.damageDetailMyCharacter, characterInput.damageDetailMyWeapon, characterInput.damageDetailMyArtifactSets].forEach(damageDetail => {\r\n                if (!damageDetail) return;\r\n                damageDetail.ステータス変更系詳細.filter(s => s.条件).forEach(damageDetailObj => {\r\n                    const conditionStr = damageDetailObj.条件 as string;\r\n                    let valueBefore = 0;\r\n                    let valueAfter = 0;\r\n                    const matchesBefore = checkConditionMatches(conditionStr, validConditionValueArr, constellation);\r\n                    const matchesAfter = checkConditionMatches(conditionStr, validConditionValueArrAfter, constellation);\r\n                    if (matchesBefore == matchesAfter) return;\r\n                    if (matchesBefore != 0) {\r\n                        let new数値 = damageDetailObj.数値;\r\n                        if (matchesBefore != 1) {\r\n                            new数値 = (new数値 as any[]).concat(['*', matchesBefore]);\r\n                        }\r\n                        valueBefore = calculateFormulaArray(new数値, statsObj, damageResult, damageDetailObj.上限);\r\n                    }\r\n                    if (matchesAfter != 0) {\r\n                        let new数値 = damageDetailObj.数値;\r\n                        if (matchesAfter != 1) {\r\n                            new数値 = (new数値 as any[]).concat(['*', matchesAfter]);\r\n                        }\r\n                        valueAfter = calculateFormulaArray(new数値, statsObj, damageResult, damageDetailObj.上限);\r\n                    }\r\n                    const diff = valueAfter - valueBefore;\r\n                    if (diff) {\r\n                        let new種類 = damageDetailObj.種類 as string;\r\n                        if (damageDetailObj.対象) {\r\n                            new種類 += '.' + damageDetailObj.対象;\r\n                        }\r\n                        if (new種類 in myステータス補正) {\r\n                            myステータス補正[new種類] += diff;\r\n                        } else {\r\n                            myステータス補正[new種類] = diff;\r\n                        }\r\n                    }\r\n                })\r\n            })\r\n\r\n            validConditionValueArr = validConditionValueArrAfter;\r\n        }\r\n\r\n        const myTalentChangeDetailObjArr = [] as any[];\r\n        if (talentChangeDetailObjArr) {\r\n            // 対象指定ありのダメージ計算（主に加算）を適用したい\r\n            talentChangeDetailObjArr.forEach(valueObj => {\r\n                let number = null;\r\n                if (valueObj['条件']) {\r\n                    number = checkConditionMatches(valueObj['条件'], validConditionValueArr, constellation);\r\n                    if (number == 0) {\r\n                        return;\r\n                    }\r\n                }\r\n                if (valueObj['対象']) {\r\n                    if (valueObj['対象'].endsWith('元素ダメージ')) {    // for 申鶴\r\n                        if (!valueObj['対象'].startsWith(my元素)) {\r\n                            return;\r\n                        }\r\n                    } else if (valueObj['対象'] == '物理ダメージ') {\r\n                        if (my元素 != '物理') {\r\n                            return;\r\n                        }\r\n                    } else {\r\n                        // 大分類 or 大分類.小分類\r\n                        const myダメージ種類 = detailObj.種類;\r\n                        const my対象カテゴリArr = valueObj['対象'].split('.');\r\n                        if (my対象カテゴリArr[0] != myダメージ種類) {\r\n                            return;\r\n                        }\r\n                        if (my対象カテゴリArr.length > 1 && my対象カテゴリArr[my対象カテゴリArr.length - 1] != detailObj['名前']) {\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n                if (valueObj['種類'].endsWith('元素付与')) {   // 元素付与は先んじて適用します\r\n                    if (['通常攻撃ダメージ', '重撃ダメージ', '落下攻撃ダメージ'].includes(detailObj['種類'])) {\r\n                        if (!detailObj['元素付与無効']) {\r\n                            my元素 = valueObj['種類'].replace('元素付与', '');\r\n                        }\r\n                    }\r\n                } else if (valueObj['種類'] == '防御無視') {   // 防御無視は先んじて適用します for 雷電将軍\r\n                    const myValue = calculateFormulaArray(valueObj['数値'], statsObj, damageResult, valueObj['上限']);\r\n                    my防御無視 += myValue;\r\n                } else if (valueObj['種類'] == '固有変数') {\r\n                    // nop\r\n                } else {\r\n                    if (number != null && number != 1) {    // オプションの@以降の数値でスケールする場合あり\r\n                        const myNewValueObj = JSON.parse(JSON.stringify(valueObj)); // deepcopy\r\n                        myNewValueObj['数値'] = myNewValueObj['数値'].concat(['*', number]);\r\n                        myTalentChangeDetailObjArr.push(myNewValueObj);\r\n                    } else {\r\n                        myTalentChangeDetailObjArr.push(valueObj);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        console.debug(detailObj['名前'] + ':myTalentChangeDetailObjArr');\r\n        console.debug(myTalentChangeDetailObjArr);\r\n\r\n        // 対象指定ありのステータスアップを適用したい\r\n        const tempStatsObj: TStats = {};\r\n        [statsObj, myステータス補正].forEach(entryObj => {\r\n            Object.keys(entryObj).forEach(stat => {\r\n                const tempArr = stat.split('.');\r\n                if (tempArr.length == 1) return;\r\n                let isValid = false;\r\n                if (tempArr[1] == detailObj.種類) {\r\n                    if (tempArr.length == 2) {\r\n                        isValid = true;\r\n                    } else if (tempArr[2] == detailObj.名前) {\r\n                        if (tempArr.length == 3) {\r\n                            isValid = true;\r\n                        }\r\n                    }\r\n                }\r\n                if (isValid) {\r\n                    const toStat = tempArr[0];\r\n                    if (toStat in tempStatsObj) {\r\n                        if (toStat == '別枠乗算' && tempStatsObj[toStat] > 0) {\r\n                            tempStatsObj[toStat] *= entryObj[stat] / 100;   // for ディオナ\r\n                        } else {\r\n                            tempStatsObj[toStat] += entryObj[stat];\r\n                        }\r\n                    } else {\r\n                        tempStatsObj[toStat] = entryObj[stat];\r\n                    }\r\n                }\r\n            })\r\n        })\r\n        Object.keys(tempStatsObj).forEach(stat => {\r\n            if (stat in myステータス補正) {\r\n                if (stat.startsWith('別枠乗算') && myステータス補正[stat] > 0) {\r\n                    myステータス補正[stat] *= tempStatsObj[stat] / 100;   // for ディオナ\r\n                } else {\r\n                    myステータス補正[stat] += tempStatsObj[stat];\r\n                }\r\n            } else {\r\n                myステータス補正[stat] = tempStatsObj[stat];\r\n            }\r\n        });\r\n        console.debug('myステータス補正', myステータス補正);\r\n\r\n        // for 来歆の余響 「ダメージを与えた0.05秒後にクリアされる」\r\n        const damageDetailMyArtifactSets = characterInput.damageDetailMyArtifactSets;\r\n        if (damageDetailMyArtifactSets) {\r\n            if (detailObj.種類 == '通常攻撃ダメージ' && detailObj['HIT数'] > 1\r\n                && characterInput.artifactSets[0] == '来歆の余響' && characterInput.artifactSets[1] == '来歆の余響') {\r\n                let isValid = false;\r\n                for (const valueObj of damageDetailMyArtifactSets[CHANGE_KIND_STATUS].filter(s => s.条件 && s.種類 && s.数値)) {\r\n                    const my種類 = valueObj.種類 as string; // 通常攻撃ダメージアップ\r\n                    const my条件 = valueObj.条件 as string;\r\n                    const myHIT数 = detailObj.HIT数;\r\n                    if (checkConditionMatches(my条件, validConditionValueArr, constellation) != 0) {\r\n                        const myValue = calculateFormulaArray(valueObj.数値, statsObj, damageResult, valueObj.上限);\r\n                        if (!(my種類 in myステータス補正)) {\r\n                            myステータス補正[my種類] = 0;\r\n                        }\r\n                        myステータス補正[my種類] -= myValue * (myHIT数 - Math.max(1, Math.floor(myHIT数 / 2))) / myHIT数;\r\n                        isValid = true;\r\n                    }\r\n                }\r\n                if (isValid) {\r\n                    const description = '来歆の余響4セット効果の幽谷祭祀のダメージアップは多段HITダメージの全てには乗らない。3HIT以下：1回分、4HIT：2回分を計上する';\r\n                    if (!damageResult['キャラクター注釈'].includes(description)) {\r\n                        damageResult['キャラクター注釈'].push(description);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // 一時的にステータスを書き換えます。\r\n        Object.keys(myステータス補正).forEach(stat => {\r\n            if (stat in statsObj) {\r\n                if (stat.startsWith('別枠乗算') && statsObj[stat] > 0) {\r\n                    statsObj[stat] *= myステータス補正[stat];\r\n                } else {\r\n                    statsObj[stat] += myステータス補正[stat];\r\n                }\r\n            } else {\r\n                statsObj[stat] = myステータス補正[stat];\r\n            }\r\n            console.debug('ステータス補正', stat, myステータス補正[stat]);\r\n        });\r\n\r\n        if (statsObj['別枠乗算']) {\r\n            my別枠乗算 = statsObj['別枠乗算'];\r\n        }\r\n\r\n        switch (detailObj['種類']) {\r\n            case 'HP回復':\r\n                myバフArr.push('与える治療効果');\r\n                myバフArr.push('受ける治療効果');\r\n                is会心Calc = false;\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                my元素 = null;\r\n                break;\r\n            case 'シールド':\r\n                myバフArr.push('シールド強化');\r\n                is会心Calc = false;\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                break;\r\n            case '元素創造物HP':    // for アンバー 甘雨\r\n                is会心Calc = false;\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                my元素 = null;\r\n                break;\r\n            case '他所基準ダメージ':\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                break;\r\n            case '他所基準HP回復':\r\n                is会心Calc = false;\r\n                is防御補正Calc = false;\r\n                is耐性補正Calc = false;\r\n                my元素 = null;\r\n                break;\r\n            case '付加元素ダメージ':    // for 風キャラ\r\n                if (!['炎', '水', '雷', '氷'].includes(my元素)) {\r\n                    my元素 = '炎';\r\n                }\r\n                break;\r\n            default:\r\n                if (detailObj['種類'].startsWith('表示') || detailObj['種類'].startsWith('非表示')) {\r\n                    is会心Calc = false;\r\n                    is防御補正Calc = false;\r\n                    is耐性補正Calc = false;\r\n                    my元素 = null;\r\n                } else {\r\n                    myバフArr.push('与えるダメージ');\r\n                    if (detailObj['ダメージバフ'] != 'NONE') {  // for コレイ\r\n                        if (detailObj['ダメージバフ']) {\r\n                            myバフArr.push(detailObj['ダメージバフ']);\r\n                        } else if (DAMAGE_CATEGORY_ARRAY.includes(detailObj['種類'])) {\r\n                            myバフArr.push(detailObj['種類'] + 'バフ');\r\n                        }\r\n                    }\r\n                    if (my元素) {\r\n                        myバフArr.push(my元素 == '物理' ? '物理ダメージバフ' : my元素 + '元素ダメージバフ');\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n        const my計算Result = calculateDamageFromDetailSub(statsObj, damageResult, detailObj['数値'], myバフArr, is会心Calc, is防御補正Calc, is耐性補正Calc, my元素, my防御無視, my別枠乗算, detailObj['上限']);\r\n\r\n        myTalentChangeDetailObjArr.forEach(valueObj => {\r\n            const myResultWork = calculateDamageFromDetailSub(statsObj, damageResult, valueObj['数値'], myバフArr, is会心Calc, is防御補正Calc, is耐性補正Calc, my元素, my防御無視, null, valueObj['上限']);\r\n            if (valueObj['種類'].endsWith('ダメージアップ')) {  // 実数ダメージ加算\r\n                if (detailObj['名前'] == 'ダメージアップ') return;  // for 申鶴\r\n                if (DAMAGE_CATEGORY_ARRAY.includes(detailObj['種類'])) {\r\n                    // 複数回HITするダメージについては、HIT数を乗算します\r\n                    if (myHIT数 > 1) {\r\n                        myResultWork[2] *= myHIT数;\r\n                        if (myResultWork[3] != null) {\r\n                            myResultWork[3] *= myHIT数;\r\n                        }\r\n                        myResultWork[4] *= myHIT数;\r\n                    }\r\n                }\r\n            }\r\n            my計算Result[2] += myResultWork[2];\r\n            if (my計算Result[3] != null && myResultWork[3]) {\r\n                my計算Result[3] += myResultWork[3];\r\n            }\r\n            my計算Result[4] += myResultWork[4];\r\n        });\r\n\r\n        // ステータスによる実数ダメージ加算を計算します\r\n        if (DAMAGE_CATEGORY_ARRAY.includes(detailObj['種類'])) {\r\n            let myダメージ種類 = detailObj['種類'];\r\n            if (detailObj['ダメージバフ']) {    // for 夢想の一心状態の時、雷電将軍の通常攻撃、重撃、落下攻撃のダメージは元素爆発ダメージと見なす\r\n                const temp = detailObj['ダメージバフ'].replace(/バフ$/, '');\r\n                if (DAMAGE_CATEGORY_ARRAY.includes(temp)) {\r\n                    myダメージ種類 = temp;\r\n                }\r\n            }\r\n\r\n            const dmgUpStatArr = [];\r\n            dmgUpStatArr.push(myダメージ種類 + 'アップ');\r\n            if (my元素) {\r\n                dmgUpStatArr.push(my元素 == '物理' ? '物理ダメージアップ' : my元素 + '元素ダメージアップ');\r\n            }\r\n            dmgUpStatArr.forEach(dmgUpStat => {\r\n                if (!statsObj[dmgUpStat]) return;\r\n                if (!is防御補正Calc || !is耐性補正Calc) return;\r\n\r\n                if (detailObj['名前'].startsWith('非表示_狼の魂基礎')) return;    // for レザー\r\n\r\n                const myResultWork = calculateDamageFromDetailSub(statsObj, damageResult, statsObj[dmgUpStat], myバフArr, is会心Calc, is防御補正Calc, is耐性補正Calc, my元素, my防御無視, null);\r\n                // 複数回HITするダメージについては、HIT数を乗算します\r\n                if (myHIT数 > 1) {\r\n                    myResultWork[2] *= myHIT数;\r\n                    if (myResultWork[3] != null) {\r\n                        myResultWork[3] *= myHIT数;\r\n                    }\r\n                    myResultWork[4] *= myHIT数;\r\n                }\r\n                my計算Result[2] += myResultWork[2];\r\n                if (my計算Result[3] != null && myResultWork[3]) {\r\n                    my計算Result[3] += myResultWork[3];\r\n                }\r\n                my計算Result[4] += myResultWork[4];\r\n            });\r\n        }\r\n\r\n        // 書き換えたステータスを元に戻します。\r\n        Object.keys(myステータス補正).forEach(statName => {\r\n            statsObj[statName] -= myステータス補正[statName];\r\n        });\r\n\r\n        if (detailObj['種類'] == 'シールド') {\r\n            if (my計算Result[1] == '岩') {  // 岩元素シールド for ノエル 鍾離\r\n                my計算Result[2] = my計算Result[2] * 1.5;\r\n                my計算Result[4] = my計算Result[4] * 1.5;\r\n            }\r\n        }\r\n\r\n        const resultArr = [detailObj['名前'], my計算Result[1], my計算Result[2], my計算Result[3], my計算Result[4], detailObj['種類'], detailObj['HIT数'], my計算Result[7], my計算Result[8]] as TDamageResultEntry;\r\n        console.debug('calculateDamageFromDetail', detailObj, characterInput, conditionInput, statsObj, opt_element, resultArr);\r\n        return resultArr;\r\n    } catch (error) {\r\n        console.error(detailObj, characterInput, conditionInput, statsObj, opt_element);\r\n        throw error;\r\n    }\r\n}\r\n\r\nfunction calculateDamageFromDetailSub(\r\n    statsObj: TStats,\r\n    damageResult: TDamageResult,\r\n    formula: number | string | (number | string)[],\r\n    buffArr: Array<string> | null,\r\n    is会心Calc: boolean,\r\n    is防御補正Calc: boolean,\r\n    is耐性補正Calc: boolean,\r\n    元素: string,\r\n    防御無視: number,\r\n    別枠乗算: number | null,\r\n    opt_max: number | string | Array<number | string> | null = null\r\n): TDamageResultEntry {\r\n    const myダメージ基礎値 = calculateFormulaArray(formula, statsObj, damageResult, opt_max);\r\n    let myダメージ = myダメージ基礎値;\r\n\r\n    if (別枠乗算) { // 別枠乗算 for 宵宮\r\n        myダメージ *= 別枠乗算 / 100;\r\n    } else {\r\n        別枠乗算 = 1;\r\n    }\r\n\r\n    // 計算済みの値を参照する場合は、バフと防御、耐性補正の計算を省略します\r\n    if (isUseReference(formula)) {\r\n        buffArr = null;\r\n        is防御補正Calc = false;\r\n        is耐性補正Calc = false;\r\n    }\r\n\r\n    let myダメージバフ補正 = 1;\r\n    if (buffArr) {\r\n        myダメージバフ補正 = 100;   // percent\r\n        buffArr.forEach(buff => {\r\n            if (statsObj[buff]) {\r\n                myダメージバフ補正 += statsObj[buff];\r\n            }\r\n        });\r\n        myダメージバフ補正 = myダメージバフ補正 / 100;\r\n        myダメージ *= myダメージバフ補正;\r\n    }\r\n\r\n    let my防御補正 = 1;\r\n    if (is防御補正Calc) {\r\n        my防御補正 = calculateEnemyDef(statsObj, 防御無視);\r\n        myダメージ *= my防御補正;\r\n    }\r\n\r\n    let my耐性補正 = 1;\r\n    if (is耐性補正Calc && 元素) {\r\n        my耐性補正 = calculateEnemyRes(元素, statsObj);\r\n        myダメージ *= my耐性補正;\r\n    }\r\n\r\n    let my会心率 = statsObj['会心率'];\r\n    if (元素 == '物理') {\r\n        if ('物理ダメージ会心率' in statsObj) {\r\n            my会心率 += statsObj['物理ダメージ会心率'];\r\n        }\r\n    } else if ((元素 + '元素ダメージ会心率') in statsObj) {\r\n        my会心率 += statsObj[元素 + '元素ダメージ会心率'];\r\n    }\r\n    my会心率 = Math.min(100, Math.max(0, my会心率)) / 100;    // 0≦会心率≦1\r\n\r\n    let my会心ダメージ = statsObj['会心ダメージ'];\r\n    if (元素 == '物理') {\r\n        if ('物理ダメージ会心ダメージ' in statsObj) {\r\n            my会心ダメージ += statsObj['物理ダメージ会心ダメージ'];\r\n        }\r\n    } else if ((元素 + '元素ダメージ会心ダメージ') in statsObj) {\r\n        my会心ダメージ += statsObj[元素 + '元素ダメージ会心ダメージ'];\r\n    }\r\n    my会心ダメージ = (100 + my会心ダメージ) / 100;\r\n\r\n    let my会心Result = null;\r\n    let my期待値Result = myダメージ;\r\n    if (is会心Calc && my会心率 > 0) {\r\n        my会心Result = myダメージ * my会心ダメージ;\r\n        my期待値Result = (my会心Result * my会心率) + (myダメージ * (1 - my会心率));\r\n    }\r\n\r\n    console.debug('%f * %f * [%o]=%f * [%f,%f] * %f * %f => %f,%f,%f', myダメージ基礎値, 別枠乗算, buffArr, myダメージバフ補正, my会心率, my会心ダメージ, my防御補正, my耐性補正, my期待値Result, my会心Result, myダメージ);\r\n    return ['未設定', 元素, my期待値Result, my会心Result, myダメージ, null, null, myダメージバフ補正, my防御補正];\r\n}\r\n\r\nfunction getChangeDetailObjArr(characterInput: TCharacterInput, changeKind: string) {\r\n    let result = [] as any[];\r\n    if (!characterInput) return result;\r\n\r\n    if (characterInput.damageDetailMyCharacter && changeKind in characterInput.damageDetailMyCharacter) {\r\n        result = result.concat((characterInput.damageDetailMyCharacter as any)[changeKind]);\r\n    }\r\n    if (characterInput.damageDetailMyWeapon && changeKind in characterInput.damageDetailMyWeapon) {\r\n        result = result.concat((characterInput.damageDetailMyWeapon as any)[changeKind]);\r\n    }\r\n    if (characterInput.damageDetailMyArtifactSets && changeKind in characterInput.damageDetailMyArtifactSets) {\r\n        result = result.concat((characterInput.damageDetailMyArtifactSets as any)[changeKind]);\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * 計算式内の参照有無を求めます\r\n */\r\nexport function isUseReference(formulaArr: number | string | Array<number | string>): boolean {\r\n    if (!Array.isArray(formulaArr)) {\r\n        if (isNumber(formulaArr)) {\r\n            return false;\r\n        }\r\n        return String(formulaArr).indexOf('#') != -1;\r\n    }\r\n    let result = false;\r\n    formulaArr.forEach(entry => {\r\n        if (['+', '-', '*', '/'].includes(String(entry))) {\r\n            return;\r\n        } else if (isNumber(entry)) {\r\n            return;\r\n        } else if (Array.isArray(entry)) {\r\n            if (isUseReference(entry)) {\r\n                result = true;\r\n            }\r\n        } else {\r\n            if (String(entry).indexOf('#') != -1) {\r\n                result = true;\r\n            }\r\n        }\r\n    });\r\n    return result;\r\n}\r\n\r\nexport const ALL_ELEMENTS = ['炎', '水', '風', '雷', '草', '氷', '岩'];\r\n\r\n/**\r\n * ステータスを更新します\r\n */\r\nfunction updateStats(\r\n    statsObj: TStats,\r\n    statName: string,\r\n    formulaArr: number | string | Array<number | string>,\r\n    opt_max: number | string | Array<number | string> | null = null\r\n) {\r\n    const value = calculateFormulaArray(formulaArr, statsObj, DAMAGE_RESULT_TEMPLATE, opt_max);    // DAMAGE_RESULT_TEMPLATEは参照しない想定なのでダミーです\r\n    if (!isNumber(value)) {\r\n        console.error(statsObj, statName, formulaArr, value);\r\n    }\r\n    const nameArr = [];\r\n    if (statName == 'HP') {\r\n        nameArr.push('HP上限');\r\n    } else if (statName.startsWith('自元素')) {\r\n        nameArr.push(statName.replace(/^自/, String(statsObj['元素'])));\r\n    } else if (statName.startsWith('全元素')) {\r\n        ALL_ELEMENTS.forEach(entry => {\r\n            nameArr.push(statName.replace(/^全/, entry));\r\n        });\r\n    } else if (statName.startsWith('敵自元素')) {\r\n        nameArr.push(statName.replace(/^敵自/, '敵' + String(statsObj['元素'])));\r\n    } else if (statName.startsWith('敵全元素')) {\r\n        ALL_ELEMENTS.forEach(entry => {\r\n            nameArr.push(statName.replace(/^敵全/, '敵' + entry));\r\n        });\r\n    } else {\r\n        nameArr.push(statName);\r\n    }\r\n    const diffStats = {} as { [key: string]: number };\r\n    nameArr.forEach(name => {\r\n        diffStats[name] = value;\r\n    });\r\n    for (const name of Object.keys(diffStats)) {\r\n        if (name in statsObj) {\r\n            if (name.startsWith('別枠乗算') && diffStats[name] > 0) {\r\n                statsObj[name] *= diffStats[name] / 100;    // for ディオナ\r\n            } else {\r\n                statsObj[name] += diffStats[name];\r\n            }\r\n        } else {\r\n            statsObj[name] = diffStats[name];\r\n        }\r\n    }\r\n    console.debug(updateStats.name, null, statName, formulaArr, '=>', diffStats);\r\n    return diffStats;\r\n}\r\n\r\n/** 被ダメージを計算します */\r\nfunction calculateDamageTaken(statsObj: TStats, damage: number, element: string) {\r\n    const def = statsObj['防御力'];\r\n    const enemyLevel = statsObj['敵レベル'];\r\n    const dmgReduction = statsObj['ダメージ軽減'];\r\n    const res = calculateRes(statsObj[element == '物理' ? '物理耐性' : element + '元素耐性']);\r\n    let result = damage * (1 - def / (def + 5 * enemyLevel + 501)) * (100 - dmgReduction) / 100 * res;\r\n    result = Math.max(0, result);\r\n    return result;\r\n}\r\n\r\n// function flattenArray(value: any) {\r\n//     const result: any[] = [];\r\n//     if (Array.isArray(value)) {\r\n//         value.forEach(e => {\r\n//             if (Array.isArray(e)) {\r\n//                 result.push(...flattenArray(e));\r\n//             } else {\r\n//                 result.push(e);\r\n//             }\r\n//         });\r\n//     }\r\n//     return result;\r\n// }\r\n\r\nexport type TArtifactScoreFormulaElement = [string, number];\r\nexport type TArtifactScoreFormula = TArtifactScoreFormulaElement[];\r\n\r\nexport const ARTIFACT_SCORE_FACTORS = [\r\n    'HP%', '攻撃力%', '防御力%', '元素熟知', '会心率', '会心ダメージ', '元素チャージ効率',\r\n];\r\n\r\nexport const ARTIFACT_SCORE_FORMULA_TEMPLATE: TArtifactScoreFormula[] = [\r\n    [['攻撃力%', 1], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['HP%', 1], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['防御力%', 1], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['HP%', 0.5], ['攻撃力%', 0.5], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['攻撃力%', 0.5], ['防御力%', 0.5], ['会心率', 2], ['会心ダメージ', 1]],\r\n    [['攻撃力%', 0.5], ['元素熟知', 0.125], ['会心率', 2], ['会心ダメージ', 1]],\r\n];\r\n\r\nexport function calculateArtifactScore(characterInput: TCharacterInput, artifactDetailInput: TArtifactDetailInput, scoringStats: [string, number][]) {\r\n    let result = 0;\r\n    for (const scoringStat of scoringStats) {\r\n        const stat = scoringStat[0];\r\n        const magnification = scoringStat[1];\r\n        if (artifactDetailInput.聖遺物ステータスサブ効果[stat]) {\r\n            result += artifactDetailInput.聖遺物ステータスサブ効果[stat] * magnification;\r\n        }\r\n    }\r\n    return result;\r\n}","\r\nimport CompositionFunction from '@/components/CompositionFunction.vue';\r\nimport { deepcopy, overwriteObject } from \"@/common\";\r\nimport { ARTIFACT_DETAIL_INPUT_TEMPLATE, CHARACTER_INPUT_TEMPLATE, CONDITION_INPUT_TEMPLATE, makeDefaultBuildname, OPTION_INPUT_TEMPLATE, STATS_INPUT_TEMPLATE, TArtifactDetailInput, TCharacterInput, TConditionInput, TOptionInput, TStatsInput, loadRecommendation, makeDamageDetailObjArrObjCharacter, makeDamageDetailObjArrObjWeapon, makeDamageDetailObjArrObjArtifactSets, setupConditionValues } from '@/input';\r\nimport { ARTIFACT_SET_MASTER, CHARACTER_MASTER, ELEMENT_IMG_SRC, getCharacterMasterDetail, IMG_SRC_DUMMY, STAR_BACKGROUND_IMAGE_CLASS, TCharacterDetail, TCharacterEntry, TCharacterKey, TWeaponDetail } from '@/master';\r\nimport { computed, defineComponent, PropType, ref, watch } from 'vue';\r\nimport { getBuilddataFromStorage, getBuildnameFromStorageKey, getBuildStorageKeys, TMember } from './team';\r\nimport { calculateArtifactStats, calculateArtifactStatsMain, calculateStats } from '@/calculate';\r\n\r\nexport default defineComponent({\r\n    name: \"MemberItem\",\r\n    props: {\r\n        member: { type: Object as PropType<TMember>, required: true },\r\n        displayStat: { type: String },\r\n    },\r\n    emits: ['click:character', 'change:buildname'],\r\n    setup(props, context) {\r\n        const { displayName, displayStatValue } = CompositionFunction();\r\n\r\n        const buildname = ref(props.member.buildname);\r\n        const buildnameOnChange = () => {\r\n            context.emit('change:buildname', props.member.id, buildname.value);\r\n        };\r\n\r\n        const characterInput = deepcopy(CHARACTER_INPUT_TEMPLATE) as TCharacterInput;\r\n        const artifactDetailInput = deepcopy(ARTIFACT_DETAIL_INPUT_TEMPLATE) as TArtifactDetailInput;\r\n        const conditionInput = deepcopy(CONDITION_INPUT_TEMPLATE) as TConditionInput;\r\n        const optionInput = deepcopy(OPTION_INPUT_TEMPLATE) as TOptionInput;\r\n        const statsInput = deepcopy(STATS_INPUT_TEMPLATE) as TStatsInput;\r\n\r\n        const extraControl = ref('locate');\r\n\r\n        watch(props, (newVal) => {\r\n            buildname.value = newVal.member.buildname;\r\n            setupMemberStats();\r\n        });\r\n\r\n        const setupMemberStats = async () => {\r\n            overwriteObject(characterInput, CHARACTER_INPUT_TEMPLATE);\r\n            overwriteObject(artifactDetailInput, ARTIFACT_DETAIL_INPUT_TEMPLATE);\r\n            overwriteObject(conditionInput, CONDITION_INPUT_TEMPLATE);\r\n            overwriteObject(optionInput, OPTION_INPUT_TEMPLATE);\r\n            overwriteObject(statsInput, STATS_INPUT_TEMPLATE);\r\n\r\n            if (props.member.name) {\r\n                characterInput.character = props.member.name as TCharacterKey;\r\n                characterInput.characterMaster = await getCharacterMasterDetail(\r\n                    characterInput.character\r\n                );\r\n            } else {\r\n                characterInput.characterMaster = {} as TCharacterDetail;\r\n                characterInput.weaponMaster = {} as TWeaponDetail;\r\n                return;\r\n            }\r\n\r\n            const builddata = savedata.value;\r\n            if (!builddata) {\r\n                characterInput.weaponMaster = {} as TWeaponDetail;\r\n                return;\r\n            }\r\n\r\n            await loadRecommendation(\r\n                characterInput,\r\n                artifactDetailInput,\r\n                conditionInput,\r\n                optionInput,\r\n                builddata\r\n            );\r\n            makeDamageDetailObjArrObjCharacter(characterInput);\r\n            makeDamageDetailObjArrObjWeapon(characterInput);\r\n            makeDamageDetailObjArrObjArtifactSets(characterInput);\r\n            setupConditionValues(conditionInput, characterInput);\r\n            calculateArtifactStatsMain(\r\n                artifactDetailInput.聖遺物ステータスメイン効果,\r\n                artifactDetailInput.聖遺物メイン効果\r\n            );\r\n            calculateArtifactStats(artifactDetailInput);\r\n            calculateStats(\r\n                statsInput,\r\n                characterInput,\r\n                artifactDetailInput,\r\n                conditionInput,\r\n                optionInput\r\n            );\r\n\r\n            return statsInput.statsObj;\r\n        }\r\n\r\n        const characterMaster = computed(() =>\r\n            props.member.name ? CHARACTER_MASTER[props.member.name as TCharacterKey] as TCharacterEntry ?? undefined : undefined\r\n        );\r\n        const characterImgSrc = computed(() => characterMaster.value?.icon_url ?? IMG_SRC_DUMMY);\r\n        const characterImgClass = computed(() => {\r\n            const rarity = characterMaster.value?.レアリティ;\r\n            return rarity ? \" \" + (STAR_BACKGROUND_IMAGE_CLASS as any)[String(rarity)] : '';\r\n        });\r\n        const visionImgSrc = computed(() =>\r\n            characterMaster.value?.元素 ? (ELEMENT_IMG_SRC as any)[characterMaster.value.元素] : IMG_SRC_DUMMY\r\n        );\r\n        const constellation = computed(() => characterInput.命ノ星座);\r\n        const imgWeaponSrc = computed(() => characterInput.weaponMaster?.icon_url ?? IMG_SRC_DUMMY);\r\n        const imgArtifactSetSrc = (index: number) => {\r\n            let result = IMG_SRC_DUMMY;\r\n            const artifactSet = characterInput.artifactSets[index];\r\n            if (artifactSet && artifactSet in ARTIFACT_SET_MASTER) {\r\n                result = (ARTIFACT_SET_MASTER as any)[artifactSet].icon_url;\r\n            }\r\n            return result;\r\n        };\r\n\r\n        const characterOnClick = () => {\r\n            context.emit('click:character');\r\n        }\r\n\r\n        const buildnames = computed(() => {\r\n            const character = props.member.name;\r\n            let result = getBuildStorageKeys(character).map(s => getBuildnameFromStorageKey(s));\r\n            const defaultBuildname = makeDefaultBuildname(character);\r\n            if (result.includes(defaultBuildname)) {\r\n                const others = result.filter(s => s != defaultBuildname).sort();\r\n                if (others.length) {\r\n                    result = [defaultBuildname, ...others];\r\n                }\r\n            }\r\n            return result;\r\n        });\r\n\r\n        const savedata = computed(() => {\r\n            let result = undefined;\r\n            const character = props.member.name;\r\n            if (character && buildname.value) {\r\n                result = getBuilddataFromStorage(character, buildname.value);\r\n            }\r\n            return result;\r\n        });\r\n\r\n        const statValue = computed(() => {\r\n            let result = '';\r\n            let stat = props.displayStat;\r\n            if (stat) {\r\n                if (stat === '会心率/ダメージ') {\r\n                    result += displayStatValue('会心率', statsInput.statsObj['会心率']);\r\n                    result += '/';\r\n                    result += displayStatValue('会心ダメージ', statsInput.statsObj['会心ダメージ']);\r\n                } else {\r\n                    result += displayStatValue(stat, statsInput.statsObj[stat]);\r\n                }\r\n            }\r\n            return result;\r\n        });\r\n\r\n        const locate = () => {\r\n            const member = props.member;\r\n            sessionStorage.setItem(\"character\", member.name);\r\n            if (buildname.value) {\r\n                sessionStorage.setItem(\"buildname\", buildname.value);\r\n            } else {\r\n                sessionStorage.removeItem(\"buildname\");\r\n            }\r\n            window.open(\"./\", \"_blank\");\r\n        };\r\n\r\n        return {\r\n            displayName,\r\n\r\n            characterImgSrc,\r\n            characterImgClass,\r\n            visionImgSrc,\r\n            constellation,\r\n            imgWeaponSrc,\r\n            imgArtifactSetSrc,\r\n\r\n            statValue,\r\n\r\n            extraControl,\r\n\r\n            buildname,\r\n            buildnameOnChange,\r\n            buildnames,\r\n            locate,\r\n\r\n            characterOnClick,\r\n        }\r\n    }\r\n});\r\n","import { render } from \"./MemberItem.vue?vue&type=template&id=690d3e1f&ts=true\"\nimport script from \"./MemberItem.vue?vue&type=script&lang=ts\"\nexport * from \"./MemberItem.vue?vue&type=script&lang=ts\"\n\nimport \"./MemberItem.vue?vue&type=style&index=0&id=690d3e1f&lang=css\"\n\nimport exportComponent from \"E:\\\\Github\\\\gencalc\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","\r\nimport CompositionFunction from '@/components/CompositionFunction.vue';\r\nimport { CHARACTER_MASTER, ELEMENT_IMG_SRC, TAnyObject, TCharacterKey } from '@/master';\r\nimport { computed, defineComponent, PropType, ref } from 'vue';\r\nimport { characterMaster, TTeam } from './team';\r\nimport MemberItem from './MemberItem.vue';\r\nimport { TStats } from '@/input';\r\nimport { ALL_ELEMENTS } from '@/calculate';\r\n\r\nexport default defineComponent({\r\n    name: \"TeamItem\",\r\n    props: {\r\n        team: { type: Object as PropType<TTeam>, required: true },\r\n        selected: { type: Boolean, requied: true },\r\n        displayStat: { type: String },\r\n    },\r\n    emits: ['change:name', 'click:character', 'change:buildname'],\r\n    components: {\r\n        MemberItem,\r\n    },\r\n    setup(props, context) {\r\n        const { displayName } = CompositionFunction();\r\n\r\n        const selectedClass = computed(() => props.selected ? ' selected' : '');\r\n        const editable = ref(false);\r\n        const name = ref(props.team.name);\r\n        const nameOnChange = () => {\r\n            context.emit('change:name', name);\r\n        };\r\n\r\n        const elementalResonance = computed(() => {\r\n            const result: string[] = [];\r\n            const work: TAnyObject = {};\r\n            const members = props.team.members.filter((s) => s.name);\r\n            if (members.length == 4) {\r\n                members.forEach((member) => {\r\n                    const master = characterMaster(member);\r\n                    if (master) {\r\n                        if (master.元素 in work) {\r\n                            work[master.元素]++;\r\n                        } else {\r\n                            work[master.元素] = 1;\r\n                        }\r\n                    }\r\n                });\r\n                if (Object.keys(work).length == 4) {\r\n                    result.push('元素共鳴なし');\r\n                } else {\r\n                    Object.keys(work).forEach((key) => {\r\n                        if (work[key] >= 2) {\r\n                            result.push(key + '元素共鳴');\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            return result;\r\n        });\r\n\r\n        const resonanceElementImgSrcs = computed(() => {\r\n            const result: string[] = [];\r\n            elementalResonance.value.forEach(entry => {\r\n                if (entry == '元素共鳴なし') {\r\n                    const members = props.team.members.filter((s) => s.name);\r\n                    members.forEach(member => {\r\n                        const master = CHARACTER_MASTER[member.name as TCharacterKey];\r\n                        const src = (ELEMENT_IMG_SRC as any)[master.元素];\r\n                        result.push(src);\r\n                    });\r\n                } else {\r\n                    const src = (ELEMENT_IMG_SRC as any)[entry.replace('元素共鳴', '')];\r\n                    result.push(src);\r\n                    result.push(src);\r\n                }\r\n            });\r\n            return result;\r\n        });\r\n\r\n        const elementalResonanceAdjustments = computed(() => {\r\n            const result: TStats = {};\r\n            elementalResonance.value.forEach(entry => {\r\n                switch (entry) {\r\n                    case '炎元素共鳴':\r\n                        result['攻撃力%'] = 25;\r\n                        break;\r\n                    case '水元素共鳴':\r\n                        result['HP%'] = 25;\r\n                        break;\r\n                    case '草元素共鳴':\r\n                        result['元素熟知'] = 50;\r\n                        break;\r\n                    case '元素共鳴なし':\r\n                        ALL_ELEMENTS.forEach(element => {\r\n                            result[element + '元素耐性'] = 15;\r\n                        });\r\n                        result['物理耐性'] = 15;\r\n                        break;\r\n                }\r\n            });\r\n            return result;\r\n        });\r\n\r\n        const characterOnClick = () => {\r\n            context.emit('click:character');\r\n        };\r\n\r\n        const changeBuildname = (memberId: number, buildname: string) => {\r\n            context.emit('change:buildname', props.team.id, memberId, buildname);\r\n        };\r\n\r\n        return {\r\n            displayName,\r\n\r\n            selectedClass,\r\n            editable,\r\n            name,\r\n            resonanceElementImgSrcs,\r\n            elementalResonanceAdjustments,\r\n\r\n            nameOnChange,\r\n            characterOnClick,\r\n            changeBuildname,\r\n        }\r\n    }\r\n});\r\n","import { render } from \"./TeamItem.vue?vue&type=template&id=d6634764&ts=true\"\nimport script from \"./TeamItem.vue?vue&type=script&lang=ts\"\nexport * from \"./TeamItem.vue?vue&type=script&lang=ts\"\n\nimport \"./TeamItem.vue?vue&type=style&index=0&id=d6634764&lang=css\"\n\nimport exportComponent from \"E:\\\\Github\\\\gencalc\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","\r\nimport draggable from \"vuedraggable\";\r\nimport { computed, defineComponent, reactive, ref } from \"vue\";\r\nimport CompositionFunction from \"@/components/CompositionFunction.vue\";\r\nimport CharacterSelect from \"@/components/CharacterSelect.vue\";\r\nimport { makeDefaultBuildname } from \"@/input\";\r\nimport { deepcopy } from \"@/common\";\r\nimport { NUMBER_OF_MEMBERS, NUMBER_OF_TEAMS, TMember, TTeam } from \"./team\";\r\nimport TeamItem from \"./TeamItem.vue\";\r\n\r\nlet memberId = 1;\r\n\r\nexport default defineComponent({\r\n  name: \"TeamManager\",\r\n  components: {\r\n    draggable,\r\n    CharacterSelect,\r\n    TeamItem,\r\n  },\r\n  setup() {\r\n    const { displayName } = CompositionFunction();\r\n\r\n    const characterSelectVisible = ref(false);\r\n    const numberOfTeams = ref(NUMBER_OF_TEAMS);\r\n    const DISPLAY_STAT_LIST = [\r\n      ['レベル', 'Lv.'],\r\n      ['HP上限', 'Max HP'],\r\n      ['攻撃力', 'ATK'],\r\n      ['防御力', 'DEF'],\r\n      ['元素熟知', 'EM'],\r\n      ['会心率/ダメージ', 'CRIT'],\r\n      ['元素チャージ効率', 'ER'],\r\n    ];\r\n    const displayStat = ref('元素チャージ効率');\r\n\r\n    const selectedTeamId = ref(0);\r\n    const teamSelected = (index: number) => index == selectedTeamId.value;\r\n\r\n    function makeBlankMember(index: number) {\r\n      return {\r\n        id: index,\r\n        name: \"\",\r\n        buildname: undefined,\r\n        savedata: undefined,\r\n      }\r\n    }\r\n\r\n    function makeBlankTeam(index: number) {\r\n      const team: TTeam = {\r\n        id: index,\r\n        name: index < 4 ? 'チーム' + (index + 1) : \"待機状態のチーム\",\r\n        members: [] as TMember[],\r\n      };\r\n      for (let i = 0; i < NUMBER_OF_MEMBERS; i++) {\r\n        team.members.push(makeBlankMember(memberId++));\r\n      }\r\n      return team;\r\n    }\r\n\r\n    function initializeMember(member: TMember) {\r\n      member.name = '';\r\n      member.buildname = undefined;\r\n      member.savedata = undefined;\r\n    }\r\n\r\n    function initializeTeam(team: TTeam) {\r\n      team.name = '';\r\n      team.members.forEach(member => {\r\n        initializeMember(member);\r\n      });\r\n    }\r\n\r\n    const teams = reactive([] as TTeam[]);\r\n    for (let i = 0; i < numberOfTeams.value; i++) {\r\n      teams.push(makeBlankTeam(i));\r\n    }\r\n\r\n    const teamOnClick = (index: number) => {\r\n      selectedTeamId.value = index;\r\n    };\r\n\r\n    const memberOnClick = (index: number) => {\r\n      if (selectedTeamId.value == index) {\r\n        characterSelectVisible.value = true;\r\n      }\r\n      selectedTeamId.value = index;\r\n    };\r\n\r\n    const clear = () => {\r\n      teams.forEach((team) => {\r\n        initializeTeam(team);\r\n      });\r\n    };\r\n\r\n    const save = () => {\r\n      const work: TTeam[] = deepcopy(teams);\r\n      work.forEach((team) => {\r\n        team.members.forEach((member) => {\r\n          member.savedata = undefined;\r\n        });\r\n      });\r\n      localStorage.setItem(\"teams\", JSON.stringify(work));\r\n    };\r\n\r\n    const load = () => {\r\n      const storageValue = localStorage.getItem(\"teams\");\r\n      if (storageValue) {\r\n        const work = JSON.parse(storageValue);\r\n        for (let i = 0; i < teams.length; i++) {\r\n          const team = teams[i];\r\n          if (work[i]) {\r\n            team.name = work[i].name;\r\n            const members = team.members;\r\n            for (let j = 0; j < members.length; j++) {\r\n              if (work[i].members[j]) {\r\n                members[j].name = work[i].members[j].name;\r\n                members[j].buildname = work[i].members[j].buildname;\r\n                members[j].savedata = undefined; // TODO\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n    load();\r\n\r\n    const numberOfTeamsOnChange = () => {\r\n      if (numberOfTeams.value > teams.length) {\r\n        for (let i = teams.length; i < numberOfTeams.value; i++) {\r\n          teams.push(makeBlankTeam(i));\r\n        }\r\n      } else if (numberOfTeams.value < teams.length) {\r\n        if (selectedTeamId.value > numberOfTeams.value) {\r\n          selectedTeamId.value = 0;\r\n        }\r\n        teams.splice(numberOfTeams.value);\r\n      }\r\n    };\r\n\r\n    const memberNames = computed(() => {\r\n      let result = Array(NUMBER_OF_MEMBERS).fill('');\r\n      const team = teams.filter(s => s.id == selectedTeamId.value)[0];\r\n      if (team) result = team.members.map(s => s.name);\r\n      return result;\r\n    });\r\n\r\n    const updateCharacters = (characters: string[]) => {\r\n      if (selectedTeamId.value != -1) {\r\n        const team = teams.filter((s) => s.id == selectedTeamId.value)[0];\r\n        if (team) {\r\n          const members = team.members;\r\n          for (let i = 0; i < characters.length; i++) {\r\n            if (members[i].name != characters[i]) {\r\n              members[i].name = characters[i];\r\n              members[i].buildname = makeDefaultBuildname(members[i].name);\r\n              members[i].savedata = undefined;  // TODO\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    const characterOnClick = (team: TTeam) => {\r\n      if (teamSelected(team.id)) {\r\n        characterSelectVisible.value = true;\r\n      } else {\r\n        selectedTeamId.value = team.id;\r\n      }\r\n    };\r\n\r\n    const teamNameOnChange = (id: number, name: string) => {\r\n      const team = teams.filter(s => s.id == id)[0];\r\n      if (team) {\r\n        team.name = name;\r\n      }\r\n    }\r\n\r\n    const buildnameOnChange = (teamId: number, memberId: number, buildname: string) => {\r\n      const team = teams.filter(s => s.id == teamId)[0];\r\n      if (team) {\r\n        const member = team.members.filter(s => s.id == memberId)[0];\r\n        if (member) {\r\n          member.buildname = buildname;\r\n        }\r\n      }\r\n    };\r\n\r\n    return {\r\n      displayName,\r\n\r\n      characterSelectVisible,\r\n      NUMBER_OF_TEAMS,\r\n      NUMBER_OF_MEMBERS,\r\n      numberOfTeams,\r\n      numberOfTeamsOnChange,\r\n      DISPLAY_STAT_LIST,\r\n      displayStat,\r\n\r\n      clear,\r\n      save,\r\n      load,\r\n\r\n      teamSelected,\r\n      teams,\r\n      memberNames,\r\n\r\n      teamOnClick,\r\n      characterOnClick,\r\n\r\n      memberOnClick,\r\n      updateCharacters,\r\n\r\n      teamNameOnChange,\r\n      buildnameOnChange,\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./App.vue?vue&type=template&id=442e1d91&scoped=true&ts=true\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=442e1d91&lang=css\"\nimport \"./App.vue?vue&type=style&index=1&id=442e1d91&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Github\\\\gencalc\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-442e1d91\"]])\n\nexport default __exports__","import { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport i18n from '@/i18n';\r\n\r\nasync function main() {\r\n    createApp(App, {\r\n    }).use(i18n).mount('#app')\r\n}\r\n\r\nmain();\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.j = 299;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t299: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkgencalc\"] = self[\"webpackChunkgencalc\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998,64], function() { return __webpack_require__(6269); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["isString","value","String","isNumber","isFinite","isPlainObject","myType","Object","prototype","toString","call","deepcopy","result","JSON","parse","stringify","overwriteObject","dst","src","srcKeys","keys","key","includes","基礎ステータスARRAY","基本ステータスARRAY","高級ステータスARRAY","元素ステータス_ダメージARRAY","元素ステータス_耐性ARRAY","ダメージバフARRAY","実数ダメージ加算ARRAY","元素反応バフARRAY","ステータスその他ARRAY","敵元素ステータス_耐性ARRAY","ステータスARRAY_MAP","Map","STAT_PERCENT_LIST","makeStatusTenmplate","statsObj","forEach","stat","ステータスTEMPLATE","makeEnemyStatusTemplate","聖遺物ステータスTEMPLATE","元素反応TEMPLATE","元素","蒸発倍率","溶解倍率","過負荷ダメージ","感電ダメージ","超電導ダメージ","拡散ダメージ","拡散元素","結晶吸収量","燃焼ダメージ","開花ダメージ","烈開花ダメージ","超開花ダメージ","超激化ダメージ","草激化ダメージ","DAMAGE_RESULT_TEMPLATE","元素反応","通常攻撃","重撃","落下攻撃","元素スキル","元素爆発","その他","キャラクター注釈","突破レベルレベルARRAY","Array","from","length","_","i","ARTIFACT_SET_MASTER_DUMMY","レアリティ","image","IMG_SRC_DUMMY","CHARACTER_INPUT_TEMPLATE","character","characterMaster","突破レベル","レベル","命ノ星座","通常攻撃レベル","元素スキルレベル","元素爆発レベル","weapon","weaponMaster","武器突破レベル","武器レベル","武器精錬ランク","artifactSets","artifactSetMasters","damageDetailMyCharacter","damageDetailMyWeapon","damageDetailMyArtifactSets","buildname","recommendationSelectedIndex","saveDisabled","removeDisabled","ARTIFACT_DETAIL_INPUT_TEMPLATE","聖遺物メイン効果","聖遺物優先するサブ効果","聖遺物優先するサブ効果上昇値","GENSEN_MASTER_LIST","聖遺物優先するサブ効果上昇回数","聖遺物ステータス","聖遺物ステータスメイン効果","聖遺物ステータスサブ効果","聖遺物優先するサブ効果Disabled","CONDITION_INPUT_TEMPLATE","checkboxList","selectList","conditionValues","conditionAdjustments","攻撃元素","STATS_INPUT_TEMPLATE","statAdjustments","enemyMaster","ENEMY_MASTER_LIST","OPTION_INPUT_TEMPLATE","elementalResonance","supporterList","isSupporterOptionOpened","teamOption","miscOption","parseLevelStr","levelStr","level","Number","replace","ascension","endsWith","error","console","makeDefaultBuildname","makePrioritySubstatValueList","prioritySubstats","index","opt_substat","ARTIFACT_SUB_MASTER","valueArr","push","diff","async","loadRecommendation","characterInput","artifactDetailInput","conditionInput","optionInput","build","getCharacterMasterDetail","artifactStatsSub","weaponType","WEAPON_MASTER","filter","s","startsWith","getWeaponMasterDetail","prioritySubstatsDisabled","toKey","artifactSet","ARTIFACT_SET_MASTER","mainstat","substat","doUpdate","substatValue","prioritySubstatValueList","v","substatCount","キャラクター構成PROPERTY_MAP","options","ELEMENTAL_RESONANCE_MASTER","astarIndex","indexOf","workCharacter","substring","CHARACTER_MASTER","debug","CHANGE_KIND_STATUS","CHANGE_KIND_TALENT","makeDamageDetailObjArrObjCharacter","myTalentDetail","myTalentLevel","myDefaultKind","myDefaultElement","myInputCategory","myStatusChangeDetailObjArr","myTalentChangeDetailObjArr","category","makeDamageDetailObjArr","workCategory","workObj","条件","詳細","workArr","cond","名前","種類","数値","対象","上限","HIT数","ダメージバフ","元素付与無効","除外条件","適用条件","拡散","conditionMap","exclusionMap","detailObj","makeConditionExclusionMapFromStr","isArray","set","makeDamageDetailObjArrObjWeapon","name","myLevel","condition","makeDamageDetailObjArrObjArtifactSets","damageDetailObjArr","makeDetailObj","defaultKind","defaultElement","inputCategory","opt_condition","my種類","my対象","my数値","DAMAGE_CATEGORY_ARRAY","analyzeFormulaStr","my条件","my上限","resultObj","getChangeKind","kind","RegExp","exec","talentDataObj","statusChangeDetailObjArr","talentChangeDetailObjArr","resultArr","conditionStr","exclusionCond","myCondStrArr","split","myCondStr","makeConditionExclusionMapFromStrSub","exclusion","myName","pushToMapValueArray","re","reRet","prefix","condValueArr","postfix","re2","rangeStart","rangeEnd","step","re2Ret","addDecimal","e","setupConditionValues","splice","masters","master","myDamageDetail","排他","required","exclusions","get","conditionValue","undefined","checked","arr","selectedIndex","map","has","oldValue","getDecimalLength","multiplyDecimal","value1","value2","decimalLength","intValue1","intValue2","Math","pow","opt_max","k","max","min","formulaStr","opt_defaultItem","workStr","analyzeFormulaStrSub","strArr","getIconUrl","icon_url","import","CHARACTER_MASTER_LIST","片手剣","SWORD_MASTER","両手剣","CLAYMORE_MASTER","長柄武器","POLEARM_MASTER","弓","BOW_MASTER","法器","CATALYST_MASTER","key2","typedMaster","ARTIFACT_SET_MASTER_LIST","ARTIFACT_MAIN_MASTER","ENEMY_MASTER","Infinity","CHARACTER_MASTER_DETAIL_MAP","TEAM_OPTION_MASTER","OPTION1_MASTER","OPTION2_MASTER","ELEMENTAL_REACTION_MASTER","url","fetch","then","resp","json","武器","WEAPON_IMG_SRC","WEAPON_MASTER_DETAIL_MAP","opt_weaponType","weaponTypeArr","ELEMENT_IMG_SRC","炎","水","風","雷","草","氷","岩","STAR_BACKGROUND_IMAGE_CLASS","ARTIFACT_STAT_JA_EN_ABBREV_MAP","ARTIFACT_STAT_JA_EN_ABBREV_REVERSE_MAP","values","counts","_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_createTextVNode","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_createElementVNode","_hoisted_12","render","_ctx","_cache","$props","$setup","$data","$options","_component_CharacterSelect","_resolveComponent","_component_TeamItem","_component_draggable","_openBlock","_createElementBlock","_Fragment","_renderList","DISPLAY_STAT_LIST","item","_withDirectives","type","$event","displayStat","_vModelRadio","_toDisplayString","NUMBER_OF_TEAMS","numberOfTeams","onChange","args","numberOfTeamsOnChange","_vModelText","onClick","save","load","clear","_createVNode","visible","characters","memberNames","updateCharacters","characterSelectVisible","_vShow","list","teams","sort","handle","_withCtx","element","team","selected","teamSelected","id","teamOnClick","teamNameOnChange","buildnameOnChange","characterOnClick","NUMBER_OF_MEMBERS","member","BUILD_STORAGE_KEY_PREFIX","makeBuildStorageKey","getBuildnameFromStorageKey","storageKey","work","join","getBuildStorageKeys","localStorage","getBuilddataFromStorage","storageValue","getItem","_component_MemberItem","_normalizeClass","selectedClass","editable","placeholder","nameOnChange","resonanceElementImgSrcs","alt","members","changeBuildname","characterImgClass","characterImgSrc","displayName","visionImgSrc","constellation","statValue","imgWeaponSrc","imgArtifactSetSrc","extraControl","buildnames","_vModelSelect","_createCommentVNode","locate","getLevelStr","getStatValueByLevel","statObj","myLevelStr","lowLevel","highLevel","lowValue","highValue","getPropertyValueByLevel","calculateArtifactStatsMain","artifactStatsMain","mainstats","statWithRarity","calculateArtifactStats","artifactStats","calculateStats","statsInput","weaponAscension","weaponLevel","workStatsObj","toStat","通常攻撃_元素Var","重撃_元素Var","落下攻撃_元素Var","optionObj","my付与元素","validConditionValueArr","makeValidConditionValueArr","updateStatsByCondition","myDetailObj","number","checkConditionMatches","my元素","workConditionAdjustments","myPriority1KindArr","myPriority1KindFormulaArr","myPriority2KindFormulaArr","myKindFormulaArr","hasCondition","myNew数値","concat","myNew種類","entry","diffStats","updateStats","compareFunction","a","b","lowestArr","aIndex","bIndex","calculateFormulaArray","formulaArr","damageResult","operator","subResult","nameArr","damageArrArr","damage","damageArr","floor","maxValue","resultSub","checkConditionMatchesSub","myCondArr","workCondArr","ALL_ELEMENTS","statName","defineComponent","props","emits","setup","context","displayStatValue","CompositionFunction","ref","emit","watch","newVal","setupMemberStats","builddata","savedata","computed","rarity","defaultBuildname","others","sessionStorage","setItem","removeItem","window","open","__exports__","Boolean","requied","components","MemberItem","elementalResonanceAdjustments","memberId","draggable","CharacterSelect","TeamItem","selectedTeamId","makeBlankMember","makeBlankTeam","initializeMember","initializeTeam","reactive","memberOnClick","j","fill","teamId","main","createApp","App","use","i18n","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","deferred","O","chunkIds","fn","priority","notFulfilled","fulfilled","every","r","getter","__esModule","d","definition","o","defineProperty","enumerable","g","globalThis","this","Function","obj","prop","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","runtime","some","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}