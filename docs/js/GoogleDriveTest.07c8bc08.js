(function(){"use strict";var e={1520:function(e,t,n){var o=n(9242),i=n(3396),l=n(7139);const a=e=>((0,i.dD)("data-v-3010be6a"),e=e(),(0,i.Cn)(),e),c=a((()=>(0,i._)("h2",null,"Google Drive 連携",-1))),s=a((()=>(0,i._)("h3",null,"テスト中",-1))),r=a((()=>(0,i._)("p",null,[(0,i._)("a",{href:"./"},"Back to げんかるく")],-1))),d=a((()=>(0,i._)("p",null,"本画面では、Google Driveのアプリデータフォルダを介して、ブラウザ間および端末間で《げんかるく》のデータを共有するための機能を提供します。",-1))),u=["disabled"],p=["disabled"],f=["disabled"],h={class:"list-of-appdata"},b=a((()=>(0,i._)("tr",null,[(0,i._)("th",null,"name"),(0,i._)("th",null,"modifiedTime"),(0,i._)("th",null,"size")],-1))),g=["onClick"],m=["onClick"],y=["onClick"],k=["disabled"],v=["disabled"],_={class:"remote-appdata"},w={key:0},C=a((()=>(0,i._)("tr",null,[(0,i._)("th",null,"key"),(0,i._)("th",null,"status")],-1)));function j(e,t,n,o,a,j){return(0,i.wg)(),(0,i.iD)(i.HY,null,[c,s,r,d,(0,i._)("div",null,[(0,i._)("button",{type:"button",onClick:t[0]||(t[0]=(...t)=>e.login&&e.login(...t)),disabled:!e.gapiInited},"Googleでログイン",8,u),(0,i._)("button",{type:"button",onClick:t[1]||(t[1]=(...t)=>e.logoff&&e.logoff(...t)),disabled:!e.isSignedIn},"ログアウト",8,p)]),(0,i._)("div",null,[(0,i._)("button",{type:"button",onClick:t[2]||(t[2]=(...t)=>e.handleListClick&&e.handleListClick(...t)),disabled:!e.isSignedIn},"List remote files",8,f)]),(0,i._)("table",h,[b,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.remoteFileList,(t=>((0,i.wg)(),(0,i.iD)("tr",{class:(0,l.C_)(e.loaTrClass(t.id)),key:t.id,onClick:n=>e.overwriteObject(e.selectedFile,t)},[(0,i._)("td",null,(0,l.zw)(t.name),1),(0,i._)("td",null,(0,l.zw)(t.modifiedTime),1),(0,i._)("td",null,(0,l.zw)(t.size),1),(0,i._)("td",null,[(0,i._)("button",{type:"button",onClick:n=>e.handleGetClick(t.id)},"取得",8,m),(0,i._)("button",{type:"button",onClick:n=>e.handleDeleteClick(t.id)},"削除",8,y)])],10,g)))),128))]),(0,i._)("div",null,[(0,i._)("button",{type:"button",onClick:t[3]||(t[3]=(...t)=>e.handleReloadLocalClick&&e.handleReloadLocalClick(...t))},"更新"),(0,i.Uk)("   "),(0,i._)("button",{type:"button",onClick:t[4]||(t[4]=(...t)=>e.handleExportClick&&e.handleExportClick(...t)),disabled:!e.canExport},"エクスポート",8,k),(0,i._)("button",{type:"button",onClick:t[5]||(t[5]=(...t)=>e.handleImportClick&&e.handleImportClick(...t)),disabled:!e.canImport},"インポート",8,v)]),(0,i._)("table",_,[e.downloadedFile.id?((0,i.wg)(),(0,i.iD)("caption",w,(0,l.zw)("name:"+e.downloadedFile.name+" modifiledTime:"+e.downloadedFile.modifiedTime+" size:"+e.downloadedFile.size),1)):(0,i.kq)("",!0),C,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.comparisonList,(e=>((0,i.wg)(),(0,i.iD)("tr",{key:e[0]},[(0,i._)("td",null,(0,l.zw)(e[0]),1),(0,i._)("td",null,(0,l.zw)(["同値","差異あり","ローカルのみ","リモートのみ"][e[1]]),1)])))),128))])],64)}n(7658);var O=n(4870),T=n(4806),E=n.n(T),F=n(6070),q=n(5983),S=(0,i.aZ)({name:"VueGoogle",setup(){const e="507502242382-a7d868j5089106u313q7hd6js3i375l2.apps.googleusercontent.com",t="https://www.googleapis.com/auth/drive.appdata",n="AIzaSyCMehcHxbFkrej2jq_CT4TuAqQz01MTW6g",o="https://www.googleapis.com/discovery/v1/apis/drive/v3/rest",l="appdata_all.json",a=(0,O.iH)(!1);function c(){console.log("initGapiClient"),gapi.client.init({apiKey:n,discoveryDocs:[o]}).then((()=>{a.value=!0}))}(0,i.bv)((()=>{const e=document.createElement("script");e.src="https://apis.google.com/js/api.js",e.onload=async function(){gapi.load("client",{callback:function(){c()},onerror:function(){alert("gapi.client failed to load!")},timeout:3e4,ontimeout:function(){alert("gapi.client could not load in a timely manner!")}})},document.body.appendChild(e)}));const s=(0,O.qj)({}),r=(0,O.qj)({}),d=(0,O.qj)({}),u=(0,O.qj)([]),p=(0,O.qj)({}),f=(0,O.qj)({}),h=(0,i.Fl)((()=>!!s.access_token)),b=(0,i.Fl)((()=>{const e=[],t=Object.keys(r).sort(),n=Object.keys(d).sort();return t.forEach((t=>{n.includes(t)?E().isEqual(r[t],d[t])?e.push([t,0]):e.push([t,1]):e.push([t,2])})),n.filter((e=>!t.includes(e))).forEach((t=>{e.push([t,3])})),e})),g=(0,i.Fl)((()=>0==b.value.filter((e=>0!=e[1])).length)),m=(0,i.Fl)((()=>!d||!g.value)),y=(0,i.Fl)((()=>d&&!g.value)),k=()=>{(0,F.hW)((n=>{n.accounts.oauth2.initTokenClient({client_id:e,scope:t,prompt:"",callback:e=>{e.access_token&&(console.log(e),s.access_token=e.access_token,s.expires_in=Number(e.expires_in),s.scope=e.scope,s.token_type=e.token_type,_())}}).requestAccessToken()}))},v=()=>{s.access_token&&(0,F.hW)((e=>{e.accounts.oauth2.revoke(s.access_token)})),z(s,{}),z(d,{}),u.splice(0,u.length),z(p,{}),z(f,{})},_=async()=>{await G().then((e=>{console.log(e),e?.files&&E().isArray(e.files)&&(u.splice(0,u.length,...e.files),console.log(u))})),z(p,{})},w=async e=>{const t=e||u[0].id;await P(t,{alt:"media"}).then((e=>{if(e?.body){const t=JSON.parse(e?.body);z(d,t),(0,q.fX)(f,e)}else(0,q.fX)(f,{})}))},C=async e=>{await $(e),await _(),p&&p.id==e&&(0,q.fX)(p,{})},j=async()=>{if(x(),await I(l,r,"application/json"),await _(),u.length>10){const e=[];for(let t=10;t<u.length;t++)e.push(u[t].id);await Promise.all(e.map((e=>$(e.id))))}},T=()=>{z(localStorage,d)},S=()=>{x()},D=async()=>{const e=await G();e?.files&&E().isArray(e.files)&&(u.splice(0,u.length,...e.files),await Promise.all(e.files.map((e=>$(e.id)))))},x=()=>{z(r,localStorage)},z=(e,t)=>{Object.keys(e).filter((e=>!(e in t))).forEach((t=>{delete e[t]})),Object.keys(t).forEach((n=>{e[n]=t[n]}))};async function I(e,t,n,o){const i="----====----====----",l={uploadType:"multipart"};o&&Object.keys(o).forEach((e=>{l[e]=o[e]}));const a=[];a.push(["metadata",{name:e,parents:["appDataFolder"]},{"Content-Type":"application/json"}]),a.push(["media",t,{"Content-Type":n}]);try{const e=await gapi.client.request({path:"/upload/drive/v3/files",method:"POST",params:l,headers:{"Content-Type":`multipart/related; boundary=${i}`},body:L(a,i)});return console.debug(e),e}catch(c){A(c)}}function L(e,t){const n=[];return e.forEach((e=>{const o=e[1],i=e[2];n.push(`--${t}`),Object.keys(i).forEach((e=>{n.push(`${e}: ${i[e]}`)})),n.push(""),E().isString(o)?n.push(o):E().isPlainObject(o)&&n.push(JSON.stringify(o))})),n.push(`--${t}--`),n.join("\r\n")}async function G(e){const t={orderBy:"modifiedTime desc",pageSize:10,spaces:"appDataFolder",fields:"nextPageToken, files(id, name, modifiedTime, size)"};e&&Object.keys(e).forEach((n=>{t[n]=e[n]}));try{const e=await gapi.client.request({path:"drive/v3/files",method:"GET",params:t});if(console.debug(e),e.result)return e.result;throw e}catch(n){A(n)}}async function P(e,t){const n={alt:"media"};t&&Object.keys(t).forEach((e=>{n[e]=t[e]}));try{const t=await gapi.client.request({path:`drive/v3/files/${e}`,method:"GET",params:n});return console.debug(t),t}catch(o){A(o)}}async function $(e,t){const n={};t&&Object.keys(t).forEach((e=>{n[e]=t[e]}));try{const t=await gapi.client.request({path:`drive/v3/files/${e}`,method:"DELETE",params:n});return console.debug(t),t}catch(o){A(o)}}function A(e){console.error(e),alert(e),z(s,{}),z(d,{}),u.splice(0,u.length),z(p,{}),z(f,{})}const H=e=>{const t=[];return p&&p.id==e&&t.push("selected"),f&&f.id==e&&t.push("downloaded"),t.join(" ")};return{login:k,logoff:v,handleListClick:_,handleGetClick:w,handleDeleteClick:C,handleExportClick:j,handleImportClick:T,handleReloadLocalClick:S,handleRemoveAllClick:D,gapiInited:a,isSignedIn:h,comparisonList:b,canExport:m,canImport:y,remoteFileList:u,selectedFile:p,downloadedFile:f,loaTrClass:H,overwriteObject:q.fX}}}),D=n(89);const x=(0,D.Z)(S,[["render",j],["__scopeId","data-v-3010be6a"]]);var z=x,I=n(2540);async function L(){(0,o.ri)(z,{}).use(I.Z).mount("#app")}L()}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var l=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(l.exports,l,l.exports,n),l.loaded=!0,l.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,l){if(!o){var a=1/0;for(d=0;d<e.length;d++){o=e[d][0],i=e[d][1],l=e[d][2];for(var c=!0,s=0;s<o.length;s++)(!1&l||a>=l)&&Object.keys(n.O).every((function(e){return n.O[e](o[s])}))?o.splice(s--,1):(c=!1,l<a&&(a=l));if(c){e.splice(d--,1);var r=i();void 0!==r&&(t=r)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[o,i,l]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){n.j=436}(),function(){var e={436:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,l,a=o[0],c=o[1],s=o[2],r=0;if(a.some((function(t){return 0!==e[t]}))){for(i in c)n.o(c,i)&&(n.m[i]=c[i]);if(s)var d=s(n)}for(t&&t(o);r<a.length;r++)l=a[r],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(d)},o=self["webpackChunkgencalc"]=self["webpackChunkgencalc"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998,64],(function(){return n(1520)}));o=n.O(o)})();
//# sourceMappingURL=GoogleDriveTest.07c8bc08.js.map