(function(){"use strict";var t={1069:function(t,a,e){var n=e(9242),l=e(3396),r=e(7139);const i=t=>((0,l.dD)("data-v-2d68cddc"),t=t(),(0,l.Cn)(),t),c={class:"base-container"},s=(0,l.uE)('<div class="pane1" data-v-2d68cddc><div class="header" data-v-2d68cddc><div class="top-left" data-v-2d68cddc><a href="./" data-v-2d68cddc>げんかるく</a></div><div class="top-right" data-v-2d68cddc><a href="https://enka.network/" data-v-2d68cddc>Enka.Network</a></div></div></div>',1),o={class:"pane2"},d={id:"uid"},u=["disabled"],f=i((()=>(0,l._)("span",{class:"material-symbols-outlined"}," send ",-1))),v=[f],p={class:"time"},_={class:"avoid"},h=i((()=>(0,l._)("br",null,null,-1))),I=i((()=>(0,l._)("br",null,null,-1))),m=i((()=>(0,l._)("span",{class:"material-symbols-outlined"}," send ",-1))),b=i((()=>(0,l._)("br",null,null,-1))),g=["href"],y=i((()=>(0,l._)("br",null,null,-1))),k={class:"pane3"},w=i((()=>(0,l._)("th",null,"UID",-1))),E=i((()=>(0,l._)("th",null,"NICKNAME",-1))),S=i((()=>(0,l._)("th",null,"AR",-1))),O=i((()=>(0,l._)("th",null,"WR",-1))),P={colspan:"2"},T={class:"character"},R=["src","alt"],N=["src"],M={key:0,class:"constellation"},A={class:"level"},H=["src"],D=["src"],C=["src"],L=["onClick","disabled"],U=["onClick","disabled"],j=i((()=>(0,l._)("span",{class:"material-symbols-outlined"}," save ",-1))),q=[j],F=i((()=>(0,l._)("label",{class:"toggle-switch no-border",for:"artifacts-toggle",style:{width:"40rem"}}," 聖遺物 - ARTIFACTS - ",-1))),x={key:0},G=["disabled"],z=(0,l.uE)('<div class="footer" data-v-2d68cddc><hr data-v-2d68cddc><h2 data-v-2d68cddc> DATA IMPORTER <span style="font-size:smaller;" data-v-2d68cddc>powered by</span> Enka.Network Ver.0.3.1 </h2> 《Enka.Network》様経由でゲーム内のキャラクターデータ取得して《げんかるく》に取り込むためのリンクを作成します。 <ol style="text-align:left;" data-v-2d68cddc><li data-v-2d68cddc> UIDを入力後、<span class="material-symbols-outlined" data-v-2d68cddc> send </span>をクリックしてください </li></ol><hr data-v-2d68cddc><p data-v-2d68cddc>下記の制約があります。</p><ol style="text-align:left;" data-v-2d68cddc><li data-v-2d68cddc>不可：げんかるくに実装されていないキャラクター</li><li data-v-2d68cddc>不可：げんかるくに実装されていない武器を装備しているデータ</li><li data-v-2d68cddc> 制限：げんかるくに実装されていない聖遺物セット効果はセット効果なし（NONE）に置き換えられる </li></ol><hr data-v-2d68cddc><dl class="history" data-v-2d68cddc><dt data-v-2d68cddc>0.3.0 (2023/02/07)</dt><dd data-v-2d68cddc> Enka Networkの新APIに対応 </dd><dt data-v-2d68cddc>0.2.4</dt><dd data-v-2d68cddc> 聖遺物の個別取込の準備 </dd><dt data-v-2d68cddc>0.2.3</dt><dd data-v-2d68cddc> 旅人対応。 </dd><dt data-v-2d68cddc>0.2.2</dt><dd data-v-2d68cddc> 突破していない武器を装備したキャラクターが含まれる場合に処理が止まる問題に対処。 </dd><dt data-v-2d68cddc>0.2.1</dt><dd data-v-2d68cddc> げんかるくを開く際のデータの受け渡し方法を変更（クエリストリングからセッションストレージへ） </dd><dt data-v-2d68cddc>0.2.0</dt><dd data-v-2d68cddc>Enka.NetworkのAPI(URL)変更に追従。機能復活。</dd></dl></div>',1);function V(t,a,e,i,f,j){const V=(0,l.up)("ArtifactItem");return(0,l.wg)(),(0,l.iD)("div",c,[s,(0,l._)("div",o,[(0,l._)("div",d,[(0,l._)("form",{onSubmit:a[2]||(a[2]=(0,n.iM)(((...a)=>t.submit&&t.submit(...a)),["prevent"]))},[(0,l._)("label",null,[(0,l.Uk)(" UID: "),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":a[0]||(a[0]=a=>t.uid=a),type:"text",maxlength:"9",placeholder:"ENTER UID",pattern:"[0-9]+"},null,512),[[n.nr,t.uid]])]),(0,l._)("button",{type:"submit",disabled:t.timer>0},v,8,u),(0,l._)("span",p,"  "+(0,r.zw)(t.timer),1),(0,l.wy)((0,l._)("div",_,[h,(0,l.Uk)(" 本ページからのEnka.Networkへのリクエストが失敗する場合"),I,(0,l.Uk)(" 下記URLをクリックして表示されたデータをテキストエリアに貼り付けて、再度"),m,(0,l.Uk)("をクリックして下さい。直接処理します。 "),b,(0,l._)("a",{href:"https://enka.network/api/uid/"+t.uid,target:"_blank"},(0,r.zw)("https://enka.network/api/uid/"+t.uid),9,g),y,(0,l.wy)((0,l._)("textarea",{"onUpdate:modelValue":a[1]||(a[1]=a=>t.uStr=a)},null,512),[[n.nr,t.uStr]])],512),[[n.F8,t.uid]])],32)])]),(0,l._)("div",k,[t.u?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("table",null,[(0,l._)("tr",null,[w,(0,l._)("td",null,(0,r.zw)(t.u.uid),1)]),(0,l._)("tr",null,[E,(0,l._)("td",null,(0,r.zw)(t.u.playerInfo.nickname),1)]),(0,l._)("tr",null,[S,(0,l._)("td",null,(0,r.zw)(t.u.playerInfo.level),1)]),(0,l._)("tr",null,[O,(0,l._)("td",null,(0,r.zw)(t.u.playerInfo.worldLevel),1)]),(0,l._)("tr",null,[(0,l._)("td",P,[(0,l._)("p",null,(0,r.zw)(t.u.playerInfo.signature),1)])])]),(0,l._)("ul",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.characterInfoList,((a,e)=>((0,l.wg)(),(0,l.iD)("li",{class:"character",key:e},[a.characterMaster?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",T,[(0,l._)("img",{class:(0,r.C_)("character "+t.characterBgClass(a)),src:t.characterImgSrc(a),alt:t.displayName(a.characterMaster.key)},null,10,R),(0,l._)("img",{class:"vision",src:t.visionImgSrc(a),alt:"vision"},null,8,N),a.constellation?((0,l.wg)(),(0,l.iD)("div",M,(0,r.zw)(a.constellation),1)):(0,l.kq)("",!0)]),(0,l._)("div",A,"Lv."+(0,r.zw)(a.level),1),(0,l._)("img",{class:"weapon",src:t.weaponImgSrc(a),alt:"weapon"},null,8,H),(0,l._)("img",{class:"artifact-set",src:t.artifactSetImgSrc(a,0),alt:"artifact-set"},null,8,D),(0,l._)("img",{class:"artifact-set",src:t.artifactSetImgSrc(a,1),alt:"artifact-set"},null,8,C)],64)):(0,l.kq)("",!0),(0,l.kq)("",!0),(0,l._)("div",null,[(0,l._)("button",{onClick:a=>t.locate(e),disabled:t.buttonDisabled(e)}," OPEN GENCALC ",8,L)]),(0,l._)("div",null,[(0,l._)("button",{onClick:a=>t.save(e),disabled:t.saveButtonDisabled(e)},q,8,U)])])))),128))]),(0,l._)("div",null,[(0,l.wy)((0,l._)("input",{class:"hidden",id:"artifacts-toggle",type:"checkbox","onUpdate:modelValue":a[3]||(a[3]=a=>t.artifactsToggle=a)},null,512),[[n.e8,t.artifactsToggle]]),F]),t.artifactsToggle?((0,l.wg)(),(0,l.iD)("div",x,[(0,l._)("button",{type:"button",onClick:a[4]||(a[4]=(...a)=>t.artifactsSaveOnClick&&t.artifactsSaveOnClick(...a)),disabled:t.artifactsSaveButtonDisabled()}," SAVE ",8,G),(0,l._)("div",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.artifacts,((t,a)=>((0,l.wg)(),(0,l.j4)(V,{key:a,artifact:t},null,8,["artifact"])))),128))])])):(0,l.kq)("",!0)],64)):(0,l.kq)("",!0)]),z])}e(7658);var Y=e(4806),Q=e.n(Y),B=e(4870),J=e(6125),K=e(6552),W=e(2986),Z=e(5983),X=e(5378);const $={itemId:0,ascension:0,refine:1,level:1},tt={itemIds:[],rarities:[0,0,0,0,0],mainStats:["","","","",""],subStatObj:{}},at={1:"生の花",2:"死の羽",3:"時の砂",4:"空の杯",5:"理の冠"},et=["EQUIP_BRACER","EQUIP_NECKLACE","EQUIP_SHOES","EQUIP_RING","EQUIP_DRESS"],nt={FIGHT_PROP_HP:"HP",FIGHT_PROP_ATTACK:"攻撃力",FIGHT_PROP_DEFENSE:"防御力",FIGHT_PROP_HP_PERCENT:"HP%",FIGHT_PROP_ATTACK_PERCENT:"攻撃力%",FIGHT_PROP_DEFENSE_PERCENT:"防御力%",FIGHT_PROP_ELEMENT_MASTERY:"元素熟知",FIGHT_PROP_CRITICAL:"会心率",FIGHT_PROP_CRITICAL_HURT:"会心ダメージ",FIGHT_PROP_CHARGE_EFFICIENCY:"元素チャージ効率",FIGHT_PROP_FIRE_ADD_HURT:"炎元素ダメージバフ",FIGHT_PROP_WATER_ADD_HURT:"水元素ダメージバフ",FIGHT_PROP_WIND_ADD_HURT:"風元素ダメージバフ",FIGHT_PROP_ELEC_ADD_HURT:"雷元素ダメージバフ",FIGHT_PROP_GRASS_ADD_HURT:"草元素ダメージバフ",FIGHT_PROP_ICE_ADD_HURT:"氷元素ダメージバフ",FIGHT_PROP_ROCK_ADD_HURT:"岩元素ダメージバフ",FIGHT_PROP_PHYSICAL_ADD_HURT:"物理ダメージバフ",FIGHT_PROP_HEAL_ADD:"与える治療効果"};var lt=(0,l.aZ)({name:"App",components:{ArtifactItem:X.Z},setup(){const{displayName:t}=(0,K.Z)();let a,e,n,r;async function i(){const t=await Promise.all(["data/HoyoAvatarMaster.json","data/HoyoWeaponMaster.json","data/HoyoArtifactMaster.json","data/HoyoSkillMaster.json"].map((t=>fetch(t).then((t=>t.json())))));a=t[0],e=t[1],n=t[2],r=t[3]}i();const c=(0,B.iH)(""),s=(0,B.iH)(0);let o;const d=(0,B.iH)(""),u=(0,B.qj)({uid:"",playerInfo:{nickname:""}}),f=(0,B.qj)([]),v=(0,B.iH)(!1);function p(t){t=Math.trunc(t/10);const a=n.filter((a=>a.id==t));return a.length?a[0]:void 0}function _(t){const a=J._j.filter((a=>a?.artifact_list?.includes(t)));return a.length?a[0].key:void 0}function h(t){const a=[];for(const e of t.equipList)if("ITEM_RELIQUARY"==e.flat.itemType){const t=p(e.itemId);if(!t)continue;const n=_(t.name);if(!n)continue;const l={name:t.name,rarity:e.flat.rankLevel,setname:n,cat_id:t.reliquary_cat_id,mainStat:nt[e.flat.reliquaryMainstat.mainPropId],mainStatValue:e.flat.reliquaryMainstat.statValue,subStats:[]};for(const a of e.flat.reliquarySubstats){const t={name:nt[a.appendPropId],value:a.statValue};l.subStats.push(t)}a.push(l)}return a}const I=(0,l.Fl)((()=>{const t=[];if(u?.avatarInfoList?.length)for(const a of u.avatarInfoList)t.push(...h(a));return t}));async function m(t,l){const i=t.avatarInfoList[l],c={avatarId:i.avatarId,level:t.playerInfo.showAvatarInfoList[l].level,ascension:i.propMap["1002"]?.ival??0,constellation:i.talentIdList?.length??0,skillLevelList:[],weapon:Q().cloneDeep($),reliq:Q().cloneDeep(tt),artifacts:[]};Object.keys(i.skillLevelMap).forEach((t=>{c.skillLevelList.push([t,i.skillLevelMap[t]])}));for(const a of i.equipList)if("ITEM_RELIQUARY"==a.flat.itemType){c.reliq.itemIds.push(a.itemId);const t=et.indexOf(a.flat.equipType);c.reliq.rarities[t]=a.flat.rankLevel,c.reliq.mainStats[t]=a.flat.reliquaryMainstat.mainPropId;for(const e of a.flat.reliquarySubstats)e.appendPropId in c.reliq.subStatObj?c.reliq.subStatObj[e.appendPropId]+=e.statValue:c.reliq.subStatObj[e.appendPropId]=e.statValue}else"ITEM_WEAPON"==a.flat.itemType&&(c.weapon.itemId=a.itemId,"affixMap"in a.weapon?Object.keys(a.weapon.affixMap).forEach((t=>{c.weapon.refine=a.weapon.affixMap[t]+1})):c.weapon.refine=1,c.weapon.level=a.weapon.level,a.weapon.promoteLevel?c.weapon.ascension=a.weapon.promoteLevel:c.weapon.ascension=1);c.artifacts.push(...h(i));const s=a.filter((t=>t.id==c.avatarId));if(s.length){let t=s[0].name;if(s.length>1){const a=r.filter((t=>t.avatar_id==c.avatarId));let e;for(e of a)if(e.skill_list.filter((t=>String(t.id)==c.skillLevelList[0][0])).length)break;if(e)for(const n of Object.keys(J.bw).filter((t=>t.startsWith("旅人")))){const a=await(0,J.tm)(n),l=a.通常攻撃.名前;if(e.skill_list.filter((t=>t.name==l)).length){t=n;break}}}c.characterMaster=J.bw[t];const a=e.filter((t=>t.id==c.weapon.itemId));a.length&&(c.weaponMaster=J.Nd[c.characterMaster["武器"]][a[0].name])}const o=[void 0,void 0],d=[];c.reliq.itemIds.filter((t=>t)).forEach((t=>{t=Math.trunc(t/10);const a=n.filter((a=>a.id==t));a.length&&d.push(a[0].name)}));const u={};return Object.keys(J.oN).forEach((t=>{const a=J.oN[t];"artifact_list"in a&&d.forEach((e=>{a.artifact_list.includes(e)&&(t in u?u[t]++:u[t]=1)}))})),Object.keys(u).forEach((t=>{if(u[t]>=4)o[0]=J.oN[t],o[1]=J.oN[t];else if(u[t]>=2){const a=o.indexOf(void 0);-1!=a&&(o[a]=J.oN[t])}})),c.artifactSetMasters=o,c.savedata=await b(c),c}async function b(t){const a={};a["キャラクター"]=t.characterMaster?.key,a["レベル"]=t.level+(W.iU[t.ascension][0]==t.level?"+":""),a["命ノ星座"]=t.constellation;const e=r.filter((a=>a.avatar_id==t.avatarId));if(e.length){const n=await(0,J.tm)(a["キャラクター"]);if(t.skillLevelList.forEach((t=>{let l;for(const a of e){const e=a.skill_list.filter((a=>a.id==Number(t[0])));if(e.length){l=e[0];break}}l&&(n.通常攻撃.名前==l.name?a["通常攻撃レベル"]=t[1]:n.元素スキル.名前==l.name?a["元素スキルレベル"]=t[1]:n.元素爆発.名前==l.name&&(a["元素爆発レベル"]=t[1]))})),a["命ノ星座"]>=3){const t=n.命ノ星座["3"]?.説明;t&&(-1!=t.indexOf(n.元素スキル.名前)?a["元素スキルレベル"]+=3:-1!=t.indexOf(n.元素爆発.名前)&&(a["元素爆発レベル"]+=3))}if(a["命ノ星座"]>=5){const t=n.命ノ星座["5"]?.説明;t&&(-1!=t.indexOf(n.元素スキル.名前)?a["元素スキルレベル"]+=3:-1!=t.indexOf(n.元素爆発.名前)&&(a["元素爆発レベル"]+=3))}}a["武器"]=t.weaponMaster?.key,a["武器レベル"]=t.weapon.level+(W.iU[t.weapon.ascension][0]==t.weapon.level?"+":""),a["精錬ランク"]=t.weapon.refine,t.artifactSetMasters?(a["聖遺物セット効果1"]=t.artifactSetMasters[0]?.key??"NONE",a["聖遺物セット効果2"]=t.artifactSetMasters[1]?.key??"NONE"):(a["聖遺物セット効果1"]="NONE",a["聖遺物セット効果2"]="NONE");for(let n=0;n<5;n++)t.reliq.mainStats[n]?a["聖遺物メイン効果"+(n+1)]=t.reliq.rarities[n]+"_"+nt[t.reliq.mainStats[n]]:a["聖遺物メイン効果"+(n+1)]=null;return W.Hx.forEach((t=>{t="聖遺物サブ効果"+t.replace("%","P"),a[t]=0})),Object.keys(t.reliq.subStatObj).forEach((e=>{const n="聖遺物サブ効果"+nt[e].replace("%","P");a[n]=t.reliq.subStatObj[e]})),t.artifacts&&(a["artifact_list"]=t.artifacts),a}const g=async()=>{if(!c.value&&!c.value.match(/^[0-9]{9}$/))return;const t="https://us-west1-gencalc.cloudfunctions.net/enkaproxy/uid?uid="+c.value;fetch(t,{headers:{"User-Agent":"GENCALC"}}).then((t=>t.json())).then((async t=>{console.log(t),(0,Z.fX)(u,t),y()})).catch((t=>{alert("Enka.Netrowkへのリクエストで異常が発生しました!"),console.error(t),d.value&&((0,Z.fX)(u,JSON.parse(d.value)),y())})).catch((t=>{alert("JSON parse error! "+t)}))};async function y(){const t=[];for(let a=0;a<u.playerInfo.showAvatarInfoList.length;a++)t.push(await m(u,a));f.splice(0,f.length,...t),O(),u.ttl&&(s.value=Number(u.ttl),o=window.setInterval((function(){T()}),1e3))}const k=t=>{const a=f[t].savedata;(0,W.Ac)(a.キャラクター,void 0,a),window.open("./","_blank")},w=t=>{const a="構成_"+f[t].characterMaster.key;localStorage.setItem(a,JSON.stringify(f[t].savedata)),S(t)},E=t=>!f[t].characterMaster||!f[t].weaponMaster,S=t=>{let a=E(t);if(!a){const e="構成_"+f[t].characterMaster.key;if(e in localStorage){const n=JSON.stringify(f[t].savedata),l=localStorage[e];a=n==l}}return a},O=()=>{if(0===I.value.length)return!0;const t="artifact_list";let a=[];t in localStorage&&(a=JSON.parse(localStorage[t]));for(const e of I.value)if(0==a.filter((t=>Q().isEqual(t,e))).length)return!1;return!0},P=()=>{const t="artifact_list";let a=[];t in localStorage&&(a=JSON.parse(localStorage[t]));const e=Q().cloneDeep(a);for(const n of I.value)a.filter((t=>Q().isEqual(t,n))).length>0||e.push(n);localStorage[t]=JSON.stringify(e),O()},T=()=>{s.value>0?s.value--:clearInterval(o)},R=t=>t.characterMaster?t.characterMaster.icon_url:J.bx,N=t=>t.characterMaster?J.dr[t.characterMaster.レアリティ]:J.bx,M=t=>t.characterMaster?J.GN[t.characterMaster.元素]:J.bx,A=t=>t.weaponMaster?t.weaponMaster.icon_url:J.bx,H=(t,a)=>{let e=J.bx;if(t.artifactSetMasters){const n=t.artifactSetMasters[a];n&&(e=(0,J.Uk)(n.key))}return e};return{displayName:t,uid:c,timer:s,uStr:d,u:u,characterInfoList:f,submit:g,locate:k,save:w,buttonDisabled:E,saveButtonDisabled:S,artifactsSaveOnClick:P,artifactsSaveButtonDisabled:O,characterImgSrc:R,characterBgClass:N,visionImgSrc:M,weaponImgSrc:A,artifactSetImgSrc:H,artifactsToggle:v,artifacts:I,RELIQUARY_CAT_NAME:at}}}),rt=e(89);const it=(0,rt.Z)(lt,[["render",V],["__scopeId","data-v-2d68cddc"]]);var ct=it,st=e(2540);async function ot(){(0,n.ri)(ct,{}).use(st.Z).mount("#app")}ot()}},a={};function e(n){var l=a[n];if(void 0!==l)return l.exports;var r=a[n]={id:n,loaded:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}e.m=t,function(){var t=[];e.O=function(a,n,l,r){if(!n){var i=1/0;for(d=0;d<t.length;d++){n=t[d][0],l=t[d][1],r=t[d][2];for(var c=!0,s=0;s<n.length;s++)(!1&r||i>=r)&&Object.keys(e.O).every((function(t){return e.O[t](n[s])}))?n.splice(s--,1):(c=!1,r<i&&(i=r));if(c){t.splice(d--,1);var o=l();void 0!==o&&(a=o)}}return a}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[n,l,r]}}(),function(){e.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(a,{a:a}),a}}(),function(){e.d=function(t,a){for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)}}(),function(){e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){e.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){e.j=27}(),function(){var t={27:0};e.O.j=function(a){return 0===t[a]};var a=function(a,n){var l,r,i=n[0],c=n[1],s=n[2],o=0;if(i.some((function(a){return 0!==t[a]}))){for(l in c)e.o(c,l)&&(e.m[l]=c[l]);if(s)var d=s(e)}for(a&&a(n);o<i.length;o++)r=i[o],e.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return e.O(d)},n=self["webpackChunkgencalc"]=self["webpackChunkgencalc"]||[];n.forEach(a.bind(null,0)),n.push=a.bind(null,n.push.bind(n))}();var n=e.O(void 0,[998,64],(function(){return e(1069)}));n=e.O(n)})();
//# sourceMappingURL=EnkaNetwork.5f24eaa1.js.map